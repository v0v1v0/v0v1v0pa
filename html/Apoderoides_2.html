<div class="container">

<table style="width: 100%;"><tr>
<td>calc.Score</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>calc.Score</h2>

<h3>Description</h3>

<p>Calculate scores of a phylogenetic tree to find and prioritize erroneous taxa to delete.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc.Score(tree,OTUrankData=NULL,
allRankNames=NULL,allCentroids=NULL,allMRCAs=NULL,dropIndex=NULL,
sort=TRUE,show_progress=TRUE,num_threads=1,criteria="composite")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogenetic tree to be checked. This is loaded by ape::read.tree() from a file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OTUrankData</code></td>
<td>
<p>A list composed of two character vectors. The first vector is tips of tree. The second vector is the upper rank of the tips. When this is NULL, the function assumes that all the tree tips are expressed as Genus_species like Homo_sapience, and calculate the score for genera. When this is not NULL, the function returns scores based on the upper rank in this list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allRankNames</code></td>
<td>
<p>This can be omitted.
This is a unique character vector of the upper ranks of the tree tips. If given, the calculation will be a little faster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allCentroids</code></td>
<td>
<p>This can be omitted.
This is a list of numeric vectors of the centroids of ranks. If given, the calculation will be a little faster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allMRCAs</code></td>
<td>
<p>This can be omitted.
This is a list of numeric vectors of the MRCAs of ranks. If given, the calculation will be a little faster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropIndex</code></td>
<td>
<p>This can be omitted.
A numeric vector of indices of tree tips. The tree tips indicated by this dropIndex will be removed from the score calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p>If TRUE, the calculation result is sorted by descending order of the total score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_progress</code></td>
<td>
<p>If TRUE, calculation progress is shown on the R console.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_threads</code></td>
<td>
<p>A positive integer to specify the number of threads to calculate the scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>Criteria nodes to calculate the scores."composite", "both", "MRCA" or "centroid". "MRCA" and "centroid" use their corresponding node to calculate both intruder and outlier scores. "composite" calculates intruder scores using MRCA and outlier ones using centroid, which is empirically known to be most effective. "both" calculates both of MRCA-based and centroid-based score.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing one or two matrices of characters showing the scores. Only when criteria is "both", there are two matrices, and the first one is the score based on the centroids, and the second is that based on the MRCAs. The following explains the columns in the matrix.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>OTU</code></td>
<td>
<p>The name of tree tip.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perCladeOTUScore</code></td>
<td>
<p>The final score calculated by "sum" divided by the number of OTUs with the same "#clade".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum</code></td>
<td>
<p>The sum of "intruder" and "outlier" for the OTU.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intruder</code></td>
<td>
<p>The intruder score showing how many ranks the OTU intruding into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier</code></td>
<td>
<p>The outlier score showing how the OTU is far away from the core clade of the belonging rank.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>#clade</code></td>
<td>
<p>The clade number. Monophyletic OTUs with the same rank has the same #clade.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(testTree)
#calculate scores for genus
calc.Score(testTree)
data(testRankList)
#calculate scores for the rank in the list
calc.Score(testTree,testRankList)
</code></pre>


</div>