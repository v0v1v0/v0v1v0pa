<div class="container">

<table style="width: 100%;"><tr>
<td>ldZgbme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>log density for GBME models</h2>

<h3>Description</h3>

<p>Calculation of the log conditional density of the 
latent AMEN matrix <code>Z</code> given observed data <code>Y</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ldZgbme(Z, Y, llYZ, EZ, rho, s2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>n X n latent relational matrix following an AMEN model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>n X n observed relational matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llYZ</code></td>
<td>
<p>a vectorizable function taking two arguments, y and z. See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EZ</code></td>
<td>
<p>n X n mean matrix for <code>Z</code> based on AMEN model (including additive effects)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>dyadic correlation in AMEN model for <code>Z</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>
<p>residual variance in AMEN model for <code>Z</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used for updating dyadic pairs of 
the latent variable matrix <code>Z</code> based on <code>Y</code> and 
an AMEN model for <code>Z</code>. The function <code>llYZ</code> specifies 
the log likelihood for each single <code>z[i,j]</code> based on 
<code>y[i,j]</code>, that is, <code>llYZ</code> gives the log probability 
density (or mass function) of <code>y[i,j]</code> given <code>z[i,j]</code>.
</p>


<h3>Value</h3>

<p>a symmetric matrix where entry i,j is proportional 
to the log conditional bivariate density of <code>z[i,j],z[j,i]</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Hoff
</p>


<h3>Examples</h3>

<pre><code class="language-R">## For (overdispersed) Poisson regression, use
llYZ&lt;-function(y,z){ dpois(y,z,log=TRUE) } 

</code></pre>


</div>