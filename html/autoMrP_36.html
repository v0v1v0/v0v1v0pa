<div class="container">

<table style="width: 100%;"><tr>
<td>run_gb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply gradient boosting classifier to MrP.</h2>

<h3>Description</h3>

<p><code>run_gb</code> is a wrapper function that applies the gradient boosting
classifier to data provided by the user, evaluates prediction performance,
and chooses the best-performing model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_gb(
  y,
  L1.x,
  L2.x,
  L2.eval.unit,
  L2.unit,
  L2.reg,
  loss.unit,
  loss.fun,
  interaction.depth,
  shrinkage,
  n.trees.init,
  n.trees.increase,
  n.trees.max,
  cores = cores,
  n.minobsinnode,
  data,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Outcome variable. A character vector containing the column names of
the outcome variable. A character scalar containing the column name of
the outcome variable in <code>survey</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L1.x</code></td>
<td>
<p>Individual-level covariates. A character vector containing the
column names of the individual-level variables in <code>survey</code> and
<code>census</code> used to predict outcome <code>y</code>. Note that geographic unit
is specified in argument <code>L2.unit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2.x</code></td>
<td>
<p>Context-level covariates. A character vector containing the
column names of the context-level variables in <code>survey</code> and
<code>census</code> used to predict outcome <code>y</code>. To exclude context-level
variables, set <code>L2.x = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2.eval.unit</code></td>
<td>
<p>Geographic unit for the loss function. A character scalar
containing the column name of the geographic unit in <code>survey</code> and
<code>census</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2.unit</code></td>
<td>
<p>Geographic unit. A character scalar containing the column
name of the geographic unit in <code>survey</code> and <code>census</code> at which
outcomes should be aggregated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L2.reg</code></td>
<td>
<p>Geographic region. A character scalar containing the column
name of the geographic region in <code>survey</code> and <code>census</code> by which
geographic units are grouped (<code>L2.unit</code> must be nested within
<code>L2.reg</code>). Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss.unit</code></td>
<td>
<p>Loss function unit. A character-valued scalar indicating
whether performance loss should be evaluated at the level of individual
respondents (<code>individuals</code>) or geographic units (<code>L2 units</code>).
Default is <code>individuals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss.fun</code></td>
<td>
<p>Loss function. A character-valued scalar indicating whether
prediction loss should be measured by the mean squared error (<code>MSE</code>)
or the mean absolute error (<code>MAE</code>). Default is <code>MSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction.depth</code></td>
<td>
<p>GB interaction depth. An integer-valued vector
whose values specify the interaction depth of GB. The interaction depth
defines the maximum depth of each tree grown (i.e., the maximum level of
variable interactions). Default is <code>c(1, 2, 3)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrinkage</code></td>
<td>
<p>GB learning rate. A numeric vector whose values specify the
learning rate or step-size reduction of GB. Values between <code class="reqn">0.001</code>
and <code class="reqn">0.1</code> usually work, but a smaller learning rate typically requires
more trees. Default is <code>c(0.04, 0.01, 0.008, 0.005, 0.001)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees.init</code></td>
<td>
<p>GB initial total number of trees. An integer-valued
scalar specifying the initial number of total trees to fit by GB. Default
is <code class="reqn">50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees.increase</code></td>
<td>
<p>GB increase in total number of trees. An
integer-valued scalar specifying by how many trees the total number of
trees to fit should be increased (until <code>n.trees.max</code> is reached)
or an integer-valued vector of length <code>length(shrinkage)</code> with each
of its values being associated with a learning rate in <code>shrinkage</code>.
Default is <code class="reqn">50</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trees.max</code></td>
<td>
<p>GB maximum number of trees. An integer-valued scalar
specifying the maximum number of trees to fit by GB or an integer-valued
vector of length <code>length(shrinkage)</code> with each of its values being
associated with a learning rate and an increase in the total number of
trees. Default is <code class="reqn">1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>The number of cores to be used. An integer indicating the number
of processor cores used for parallel computing. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.minobsinnode</code></td>
<td>
<p>GB minimum number of observations in the terminal
nodes. An integer-valued scalar specifying the minimum number of
observations that each terminal node of the trees must contain. Default is
<code class="reqn">5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data for cross-validation. A <code>list</code> of <code class="reqn">k</code>
<code>data.frames</code>, one for each fold to be used in <code class="reqn">k</code>-fold
cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output. A logical argument indicating whether or not
verbose output should be printed. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The tuned gradient boosting parameters. A list with three elements:
<code>interaction_depth</code> contains the interaction depth parameter,
<code>shrinkage</code> contains the learning rate, <code>n_trees</code> the number of
trees to be grown.
</p>


</div>