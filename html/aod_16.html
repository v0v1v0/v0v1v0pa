<div class="container">

<table style="width: 100%;"><tr>
<td>donner</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of Proportion Homogeneity using Donner's Adjustment</h2>

<h3>Description</h3>

<p>Tests the homogeneity of proportions between <code class="reqn">I</code> groups (H0: <code class="reqn">p_1 = p_2 = ... = p_I</code> ) from clustered
binomial data <code class="reqn">(n, y)</code> using the adjusted <code class="reqn">\chi^2</code> statistic proposed by Donner (1989).</p>


<h3>Usage</h3>

<pre><code class="language-R">donner(formula = NULL, response = NULL,
       weights = NULL, group = NULL, data, C = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>An optional formula where the left-hand side is either a matrix of the form <code>cbind(y, n-y)</code>, where 
the modelled probability is <code>y/n</code>, or a vector of proportions to be modelled (<code>y/n</code>). In both cases, the 
right-hand side must specify a single grouping variable. When the left-hand side of the formula is a vector of 
proportions, the argument <code>weight</code> must be used to indicate the denominators of the proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>An optional argument indicating either a matrix of the form <code>cbind(y, n-y)</code>, where the modelled 
probability is <code>y/n</code>, or a vector of proportions to be modelled (<code>y/n</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional argument used when the left-hand side of <code>formula</code> or <code>response</code> is a vector 
of proportions: <code>weight</code> is the denominator of the proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>An optional argument only used when <code>response</code> is used. In this case, this argument is a factor 
indicating a grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the response (<code>n</code> and <code>y</code>) and the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>If not NULL, a numerical vector of <code class="reqn">I</code> cluster correction factors.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">\chi^2</code> statistic is adjusted with the correction factor <code class="reqn">C_i</code>
computed in each group <code class="reqn">i</code>. The test statistic is given by:
</p>
<p style="text-align: center;"><code class="reqn">X^2 = \sum_{i}\frac{(y_i - n_i * p)^2}{C_i * n_i * p * (1 - p)}</code>
</p>

<p>where <code class="reqn">C_i = 1 + (nA_i - 1) * \rho</code>, <code class="reqn">nA_i</code> is a scalar depending on the cluster sizes,
and <code class="reqn">rho</code> is the ANOVA estimate of the intra-cluster correlation, assumed common
across groups (see Donner, 1989 or Donner et al., 1994). The statistic is compared to a <code class="reqn">\chi^2</code>
distribution with <code class="reqn">I - 1</code> degrees of freedom. Fixed correction factors can be specified
with the argument <code>C</code>.
</p>


<h3>Value</h3>

<p>An object of formal class “drs”: see <code>drs-class</code> for details. The slot <code>tab</code>
provides the proportion of successes and the correction factor for each group.
</p>


<h3>Author(s)</h3>

<p>Matthieu Lesnoff <a href="mailto:matthieu.lesnoff@cirad.fr">matthieu.lesnoff@cirad.fr</a>, Renaud Lancelot <a href="mailto:renaud.lancelot@cirad.fr">renaud.lancelot@cirad.fr</a></p>


<h3>References</h3>

<p>Donner, A., 1989. <em>Statistical methods in ophthalmology: an adjusted chi-squared approach</em>. Biometrics 45, 605-611.<br>
Donner, A., 1993. <em>The comparison of proportions in the presence of litter effects</em>. Prev. Vet. Med. 18, 17-26.<br>
Donner, A., Eliasziw, M., Klar, N., 1994. <em>A comparison of methods for testing homogeneity of proportions in 
teratologic studies</em>. Stat. Med. 13, 1253-1264.
</p>


<h3>See Also</h3>

<p><code>chisq.test</code>, <code>raoscott</code>, <code>drs-class</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  data(rats)
  donner(formula = cbind(y, n - y) ~ group, data = rats)
  donner(formula = y/n ~ group, weights = n, data = rats)
  donner(response = cbind(y, n - y), group = group, data = rats)
  donner(response = y/n, weights = n, group = group, data = rats)
  # standard test
  donner(cbind(y, n - y) ~ group, data = rats, C = c(1, 1))
  data(antibio)
  donner(cbind(y, n - y) ~ treatment, data = antibio)
  </code></pre>


</div>