<div class="container">

<table style="width: 100%;"><tr>
<td>derive_basetype_records</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derive Basetype Variable</h2>

<h3>Description</h3>

<p>Baseline Type <code>BASETYPE</code> is needed when there is more than one definition of
baseline for a given Analysis Parameter <code>PARAM</code> in the same dataset.  For a
given parameter, if Baseline Value <code>BASE</code> is populated, and there is more than
one definition of baseline, then <code>BASETYPE</code> must be non-null on all records of
any type for that parameter. Each value of <code>BASETYPE</code> refers to a definition of
baseline that characterizes the value of <code>BASE</code> on that row.  Please see
section 4.2.1.6 of the ADaM Implementation Guide, version 1.3 for further
background.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derive_basetype_records(dataset, basetypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Input dataset
</p>
<p>The variables specified by the <code>basetypes</code> argument are expected to be in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basetypes</code></td>
<td>
<p>A <em>named</em> list of expressions created using the
<code>rlang::exprs()</code> function
</p>
<p>The names corresponds to the values of the newly created <code>BASETYPE</code> variables
and the expressions are used to subset the input dataset.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adds the <code>BASETYPE</code> variable to a dataset and duplicates records based upon
the provided conditions.
</p>
<p>For each element of <code>basetypes</code> the input dataset is subset based upon
the provided expression and the <code>BASETYPE</code> variable is set to the name of the
expression. Then, all subsets are stacked. Records which do not match any
condition are kept and <code>BASETYPE</code> is set to <code>NA</code>.
</p>


<h3>Value</h3>

<p>The input dataset with variable <code>BASETYPE</code> added
</p>


<h3>See Also</h3>

<p>BDS-Findings Functions that returns variable appended to dataset: 
<code>derive_var_analysis_ratio()</code>,
<code>derive_var_anrind()</code>,
<code>derive_var_atoxgr()</code>,
<code>derive_var_atoxgr_dir()</code>,
<code>derive_var_base()</code>,
<code>derive_var_chg()</code>,
<code>derive_var_ontrtfl()</code>,
<code>derive_var_pchg()</code>,
<code>derive_var_shift()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)
library(dplyr, warn.conflicts = FALSE)
library(rlang)

bds &lt;- tribble(
  ~USUBJID, ~EPOCH,         ~PARAMCD,  ~ASEQ, ~AVAL,
  "P01",    "RUN-IN",       "PARAM01",     1,  10.0,
  "P01",    "RUN-IN",       "PARAM01",     2,   9.8,
  "P01",    "DOUBLE-BLIND", "PARAM01",     3,   9.2,
  "P01",    "DOUBLE-BLIND", "PARAM01",     4,  10.1,
  "P01",    "OPEN-LABEL",   "PARAM01",     5,  10.4,
  "P01",    "OPEN-LABEL",   "PARAM01",     6,   9.9,
  "P02",    "RUN-IN",       "PARAM01",     1,  12.1,
  "P02",    "DOUBLE-BLIND", "PARAM01",     2,  10.2,
  "P02",    "DOUBLE-BLIND", "PARAM01",     3,  10.8,
  "P02",    "OPEN-LABEL",   "PARAM01",     4,  11.4,
  "P02",    "OPEN-LABEL",   "PARAM01",     5,  10.8
)

bds_with_basetype &lt;- derive_basetype_records(
  dataset = bds,
  basetypes = exprs(
    "RUN-IN" = EPOCH %in% c("RUN-IN", "STABILIZATION", "DOUBLE-BLIND", "OPEN-LABEL"),
    "DOUBLE-BLIND" = EPOCH %in% c("DOUBLE-BLIND", "OPEN-LABEL"),
    "OPEN-LABEL" = EPOCH == "OPEN-LABEL"
  )
)


# Below print statement will print all 23 records in the data frame
# bds_with_basetype
print(bds_with_basetype, n = Inf)

count(bds_with_basetype, BASETYPE, name = "Number of Records")

# An example where all parameter records need to be included for 2 different
# baseline type derivations (such as LAST and WORST)
bds &lt;- tribble(
  ~USUBJID, ~EPOCH,         ~PARAMCD,  ~ASEQ, ~AVAL,
  "P01",    "RUN-IN",       "PARAM01",     1,  10.0,
  "P01",    "RUN-IN",       "PARAM01",     2,   9.8,
  "P01",    "DOUBLE-BLIND", "PARAM01",     3,   9.2,
  "P01",    "DOUBLE-BLIND", "PARAM01",     4,  10.1
)

bds_with_basetype &lt;- derive_basetype_records(
  dataset = bds,
  basetypes = exprs(
    "LAST" = TRUE,
    "WORST" = TRUE
  )
)

print(bds_with_basetype, n = Inf)

count(bds_with_basetype, BASETYPE, name = "Number of Records")
</code></pre>


</div>