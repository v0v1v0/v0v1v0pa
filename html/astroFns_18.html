<div class="container">

<table style="width: 100%;"><tr>
<td>ut2lst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Universal time to local sidereal time or hour angle
</h2>

<h3>Description</h3>

<p>Functions to calculate local sidereal time (LST) or hour angle (HA) from
Universal time (strictly, UTC1).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ut2lst(yr = 2012, mo = 1, dy = 1, hr = 0, mi = 0, se = 0,
lon.obs = "W 79d 50.5m")

ut2ha(yr = 2012, mo = 1, dy = 1, hr = 0, mi = 0, se = 0,
ra.sou = "13h 31m 08.3s", lon.obs = "W 79d 50m 23.4s")

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yr</code></td>
<td>
<p>UT1 Year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mo</code></td>
<td>
<p>UT1 Month number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p>UT1 Day number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hr</code></td>
<td>
<p>UT1 Hour</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mi</code></td>
<td>
<p>UT1 Minute</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>UT1 Seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ra.sou</code></td>
<td>
<p>String with source Right Ascension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon.obs</code></td>
<td>
<p>String with observatory longitude</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p> If this input is <code>hr = Sys.time()</code> the function uses system time,
including conversion to UT.  UT is within a few seconds of UT1.  </p>


<h3>Value</h3>

<p> Returns decimal local sidereal time in range 0 to 24 hours and
hour angle from -1 to 12 hours, with class <code>fracHrs</code> (prints as
h:m:s).  For elapsed siderial time difference over multiple sidereal
days, difference UT days (from e.g. <code>ut2dmjd</code>) and
multiply by 1.002737909350795.  </p>


<h3>Note</h3>

<p>Spot checks show values match tabulated values in The Astronomical Almanac
within ~0.01 seconds.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Greenwich mean sidereal time (GMST) at 0h UT1 from the "Explanatory
Supplement to the Astronomical Almanac, " Seidelmann (ed), c. 1992.
Approximate equation of the equinoxes from
http://aa.usno.navy.mil/faq/docs/GAST.php.
</p>


<h3>See Also</h3>

<p><code>ymd2jd</code>, <code>gmst1</code>, <code>dms2rad</code> and
<code>hms2rad</code> for input formats, <code>Sys.time</code>,
<code>Sys.timezone</code> and time zone examples in <code>as.POSIXlt</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># LST at UT1 midnight on the first of every month for Green Bank, WV, USA
midLST &lt;- ut2lst(yr = 2012, mo = 1:12, dy = 1, hr = 0, mi = 0, se = 0,
                 lon.obs="W 79d 50.5m")
str(midLST)
midLST

# LST at EST midnight on the first of every month for Green Bank, WV, USA
# (EST = UT1-5 hours)
midLST &lt;- ut2lst(yr = 2012, mo = 1:12, dy = 1, hr = -5, mi = 0, se = 0,
                 lon.obs="W 79d 50.5m")
str(midLST)
midLST

# LST in Green Bank, WV, USA, now, and 12 hours from now.
ut2lst(Sys.time())
ut2lst(Sys.time() + 12*3600)

# Hour angle of 3C286 in Green Bank now (using function defaults)
ut2ha(Sys.time())

</code></pre>


</div>