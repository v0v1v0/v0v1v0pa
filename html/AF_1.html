<div class="container">

<table style="width: 100%;"><tr>
<td>AF.cc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Attributable fraction for mached and non-matched case-control sampling designs. NOTE! Deprecated function. Use <code>AFglm</code> (for unmatched case-control studies) or <code>AFclogit</code> (for matched case-control studies).</h2>

<h3>Description</h3>

<p><code>AF.cc</code> estimates the model-based adjusted attributable fraction for data from matched and non-matched case-control sampling designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AF.cc(formula, data, exposure, clusterid, matched = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "<code>formula</code>" (or one that can be coerced to that class): a symbolic description of the model used for confounder adjustment. The exposure and confounders should be specified as independent (right-hand side) variables. The outcome should be specified as dependent (left-hand side) variable. The formula is used to object a logistic regression by <code>glm</code> for non-matched case-control and conditional logistic regression by <code>gee</code> (in package <code>drgee</code>) for matched case-control.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from environment (<code>formula</code>), typically the environment from which the function is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exposure</code></td>
<td>
<p>the name of the exposure variable as a string. The exposure must be binary (0/1) where unexposed is coded as 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterid</code></td>
<td>
<p>the name of the cluster identifier variable as a string, if data are clustered (e.g. matched).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matched</code></td>
<td>
<p>a logical that specifies if the sampling design is matched (TRUE) or non-matched (FALSE) case-control. Default setting is non-matched (<code>matched = FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>Af.cc</code> estimates the attributable fraction for a binary outcome <code>Y</code>
under the hypothetical scenario where a binary exposure <code>X</code> is eliminated from the population.
The estimate is adjusted for confounders <code>Z</code> by logistic regression for unmatched case-control (<code>glm</code>) and conditional logistic regression for matched case-control (<code>gee</code>).
The estimation assumes that the outcome is rare so that the risk ratio can be approximated by the odds ratio, for details see Bruzzi et. al.
Let the AF be defined as
</p>
<p style="text-align: center;"><code class="reqn">AF = 1 - \frac{Pr(Y_0=1)}{Pr(Y = 1)}</code>
</p>

<p>where <code class="reqn">Pr(Y_0=1)</code> denotes the counterfactual probability of the outcome if
the exposure would have been eliminated from the population. If <code>Z</code> is sufficient for confounding control then the probability <code class="reqn">Pr(Y_0=1)</code> can be expressed as
</p>
<p style="text-align: center;"><code class="reqn">Pr(Y_0=1)=E_Z\{Pr(Y=1\mid{X}=0,Z)\}.</code>
</p>

<p>Using Bayes' theorem this implies that the AF can be expressed as
</p>
<p style="text-align: center;"><code class="reqn">AF = 1-\frac{E_Z\{Pr(Y=1\mid X=0,Z)\}}{Pr(Y=1)}=1-E_Z\{RR^{-X}(Z)\mid{Y = 1}\}</code>
</p>

<p>where <code class="reqn">RR(Z)</code> is the risk ratio </p>
<p style="text-align: center;"><code class="reqn">\frac{Pr(Y=1\mid{X=1,Z})}{Pr(Y=1\mid{X=0,Z})}.</code>
</p>

<p>Moreover, the risk ratio can be approximated by the odds ratio if the outcome is rare. Thus,
</p>
<p style="text-align: center;"><code class="reqn"> AF \approx 1 - E_Z\{OR^{-X}(Z)\mid{Y = 1}\}.</code>
</p>

<p>The odds ratio is estimated by logistic regression or conditional logistic regression.
If <code>clusterid</code> is supplied, then a clustered sandwich formula is used in all variance calculations.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>AF.est</code></td>
<td>
<p>estimated attributable fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AF.var</code></td>
<td>
<p>estimated variance of <code>AF.est</code>. The variance is obtained by combining the delta methods with the sandwich formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.or</code></td>
<td>
<p>a vector of the estimated log odds ratio for every individual. <code>log.or</code> contains the estimated coefficient for the exposure variable <code>X</code> for every level of the confounder <code>Z</code> as specified by the user in the formula. If the model to be estimated is
</p>
<p style="text-align: center;"><code class="reqn">logit\{Pr(Y=1|X,Z)\} = \alpha+\beta{X}+\gamma{Z}</code>
</p>

<p>then <code>log.or</code> is the estimate of <code class="reqn">\beta</code>.
If the model to be estimated is
</p>
<p style="text-align: center;"><code class="reqn">logit\{Pr(Y=1|X,Z)\}=\alpha+\beta{X}+\gamma{Z}+\psi{XZ}</code>
</p>

<p>then <code>log.odds</code> is the estimate of
<code class="reqn">\beta + \psi{Z}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the fitted model. Fitted using logistic regression, <code>glm</code>, for non-matched case-control and conditional logistic regression, <code>gee</code>, for matched case-control.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Elisabeth Dahlqwist, Arvid Sj√∂lander
</p>


<h3>References</h3>

<p>Bruzzi, P., Green, S. B., Byar, D., Brinton, L. A., and Schairer, C. (1985). Estimating the population attributable risk for multiple risk factors using case-control data. <em>American Journal of Epidemiology</em> <b>122</b>, 904-914.
</p>


<h3>See Also</h3>

<p>The new and more general version of the function: <code>AFglm</code> for non-matched and <code>AFclogit</code> for matched case-control sampling designs. <code>glm</code> and <code>gee</code> used for fitting the logistic regression model (for non-matched case-control) and the conditional logistic regression model (for matched case-control).
</p>


<h3>Examples</h3>

<pre><code class="language-R">expit &lt;- function(x) 1 / (1 + exp( - x))
NN &lt;- 1000000
n &lt;- 500

# Example 1: non matched case-control
# Simulate a sample from a non matched case-control sampling design
# Make the outcome a rare event by setting the intercept to -6
intercept &lt;- -6
Z &lt;- rnorm(n = NN)
X &lt;- rbinom(n = NN, size = 1, prob = expit(Z))
Y &lt;- rbinom(n = NN, size = 1, prob = expit(intercept + X + Z))
population &lt;- data.frame(Z, X, Y)
Case &lt;- which(population$Y == 1)
Control &lt;- which(population$Y == 0)
# Sample cases and controls from the population
case &lt;- sample(Case, n)
control &lt;- sample(Control, n)
data &lt;- population[c(case, control), ]

# Estimation of the attributable fraction
AF.cc_est &lt;- AF.cc(formula = Y ~ X + Z + X * Z, data = data, exposure = "X")
summary(AF.cc_est)

# Example 2: matched case-control
# Duplicate observations in order to create a matched data sample
# Create an unobserved confounder U common for each pair of individuals
U  &lt;- rnorm(n = NN)
Z1 &lt;- rnorm(n = NN)
Z2 &lt;- rnorm(n = NN)
X1 &lt;- rbinom(n = NN, size = 1, prob = expit(U + Z1))
X2 &lt;- rbinom(n = NN, size = 1, prob = expit(U + Z2))
Y1 &lt;- rbinom(n = NN, size = 1, prob = expit(intercept + U + Z1 + X1))
Y2 &lt;- rbinom(n = NN, size = 1, prob = expit(intercept + U + Z2 + X2))
# Select discordant pairs
discordant &lt;- which(Y1!=Y2)
id &lt;- rep(1:n, 2)
# Sample from discordant pairs
incl &lt;- sample(x = discordant, size = n, replace = TRUE)
data &lt;- data.frame(id = id, Y = c(Y1[incl], Y2[incl]), X = c(X1[incl], X2[incl]),
                   Z = c(Z1[incl], Z2[incl]))

# Estimation of the attributable fraction
AF.cc_match &lt;- AF.cc(formula = Y ~ X + Z + X * Z, data = data,
                         exposure = "X", clusterid = "id", matched = TRUE)
summary(AF.cc_match)
</code></pre>


</div>