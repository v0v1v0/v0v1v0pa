<div class="container">

<table style="width: 100%;"><tr>
<td>PhaseType</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Phase-type Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, random generation, raw moments and
moment generating function for the (continuous) Phase-type
distribution with parameters <code>prob</code> and <code>rates</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dphtype(x, prob, rates, log = FALSE)
pphtype(q, prob, rates, lower.tail = TRUE, log.p = FALSE)
rphtype(n, prob, rates)
mphtype(order, prob, rates)
mgfphtype(t, prob, rates, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length is
taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>vector of initial probabilities for each of the transient
states of the underlying Markov chain. The initial probability of
the absorbing state is <code>1 - sum(prob)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>square matrix of the rates of transition among the states
of the underlying Markov chain.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities/densities
<code class="reqn">p</code> are returned as <code class="reqn">\log(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>order of the moment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>numeric vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The phase-type distribution with parameters <code>prob</code> <code class="reqn">= \pi</code> and <code>rates</code> <code class="reqn">= \boldsymbol{T}</code> has density:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \pi e^{\boldsymbol{T} x} \boldsymbol{t}</code>
</p>

<p>for <code class="reqn">x \ge 0</code> and <code class="reqn">f(0) = 1 - \pi \boldsymbol{e}</code>, where 
<code class="reqn">\boldsymbol{e}</code> 
is a column vector with all components equal to one, 
<code class="reqn">\boldsymbol{t} = -\boldsymbol{T} \boldsymbol{e}</code> 
is the exit rates vector and 
<code class="reqn">e^{\boldsymbol{T}x}</code> 
denotes the matrix exponential of <code class="reqn">\boldsymbol{T}x</code>. The
matrix exponential of a matrix <code class="reqn">\boldsymbol{M}</code> is defined as
the Taylor series
</p>
<p style="text-align: center;"><code class="reqn">e^{\boldsymbol{M}} = \sum_{n = 0}^{\infty}
    \frac{\boldsymbol{M}^n}{n!}.</code>
</p>

<p>The parameters of the distribution must satisfy
<code class="reqn">\pi \boldsymbol{e} \leq 1</code>,
<code class="reqn">\boldsymbol{T}_{ii} &lt; 0</code>,
<code class="reqn">\boldsymbol{T}_{ij} \geq 0</code> and
<code class="reqn">\boldsymbol{T} \boldsymbol{e} \leq 0</code>.
</p>
<p>The <code class="reqn">k</code>th raw moment of the random variable <code class="reqn">X</code> is
<code class="reqn">E[X^k]</code> and the moment generating function is
<code class="reqn">E[e^{tX}]</code>.
</p>


<h3>Value</h3>

<p><code>dphasetype</code> gives the density,
<code>pphasetype</code> gives the distribution function,
<code>rphasetype</code> generates random deviates,
<code>mphasetype</code> gives the <code class="reqn">k</code>th raw moment, and
<code>mgfphasetype</code> gives the moment generating function in <code>x</code>.
</p>
<p>Invalid arguments will result in return value <code>NaN</code>, with a warning.
</p>


<h3>Note</h3>

<p>The <code>"distributions"</code> package vignette provides the
interrelations between the continuous size distributions in
<span class="pkg">actuar</span> and the complete formulas underlying the above functions.
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a> and
Christophe Dutang
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Phase-type_distribution">https://en.wikipedia.org/wiki/Phase-type_distribution</a>
</p>
<p>Neuts, M. F. (1981), <em>Generating random variates from a
distribution of phase type</em>, WSC '81: Proceedings of the 13th
conference on Winter simulation, IEEE Press.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Erlang(3, 2) distribution
T &lt;- cbind(c(-2, 0, 0), c(2, -2, 0), c(0, 2, -2))
pi &lt;- c(1,0,0)
x &lt;- 0:10

dphtype(x, pi, T)		# density
dgamma(x, 3, 2)			# same
pphtype(x, pi, T)		# cdf
pgamma(x, 3, 2)			# same

rphtype(10, pi, T)		# random values

mphtype(1, pi, T)		# expected value

curve(mgfphtype(x, pi, T), from = -10, to = 1)
</code></pre>


</div>