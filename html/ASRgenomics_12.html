<div class="container">

<table style="width: 100%;"><tr>
<td>G.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtains the genomic matrix from SNP data for additive or dominant relationships</h2>

<h3>Description</h3>

<p>Generates the genomic numerator relationship matrix for
additive (VanRaden or Yang) or dominant (Su or Vitezica) relationships.
Matrix provided <code class="reqn">\boldsymbol{M}</code> is of the form <code class="reqn">n \times p</code>, with <code class="reqn">n</code> individuals and <code class="reqn">p</code> markers.
Individual and
marker names are assigned to <code>rownames</code> and <code>colnames</code>, respectively.
SNP data is coded as 0, 1, 2 (integers or decimal numbers).
Missing values, if present, need to be specified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">G.matrix(
  M = NULL,
  method = "VanRaden",
  na.string = "NA",
  sparseform = FALSE,
  digits = 8,
  message = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A matrix with SNP data of form <code class="reqn">n \times p</code>, with <code class="reqn">n</code> individuals and <code class="reqn">p</code> markers.
Individual and marker names are assigned to <code>rownames</code> and <code>colnames</code>, respectively.
SNP data is coded as 0, 1, 2 (integers or decimal numbers) (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method considered for calculation of genomic matrix.
Options are: <code>"VanRaden"</code> and <code>"Yang"</code> for additive matrix,
and <code>"Su"</code> and <code>"Vitezica"</code> for dominant matrix (default =  <code>"VanRaden"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.string</code></td>
<td>
<p>A character that is interpreted as missing values (default = <code>"NA"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparseform</code></td>
<td>
<p>If <code>TRUE</code> it generates a matrix in sparse form to be used directly in <span class="pkg">asreml</span> with
required attributes (default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Set up the number of digits used to round the output matrix (default = 8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>If <code>TRUE</code> diagnostic messages are printed on screen (default = <code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note: If data is provided with missing values, it will process calculations
of relationships on pairwise non-missing data.
</p>
<p>It uses function <code>Gmatrix</code> for calculations
from R package  <span class="pkg">AGHmatrix</span> (Amadeu <em>et al.</em> 2019).
</p>


<h3>Value</h3>

<p>A list with one of these two elements:
</p>

<ul>
<li>
<p><code>G</code>: the <code class="reqn">\boldsymbol{G}</code> matrix in full form (only if <code>sparseform = FALSE</code>).
</p>
</li>
<li>
<p><code>G.sparse</code>: the <code class="reqn">\boldsymbol{G}</code> matrix in sparse form (only if <code>sparseform = TRUE</code>).
</p>
</li>
</ul>
<h3>References</h3>

<p>Amadeu, R.R., Cellon, C., Olmstead, J.W., Garcia, A.A.F, Resende, M.F.R. and P.R. Munoz. 2016.
AGHmatrix: R package to construct relationship matrices for autotetraploid and diploid species:
A blueberry example. The Plant Genome 9(3). doi: 10.3835/plantgenome2016.01.0009
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example: Requesting a full matrix by VanRanden.

# Get G matrix.
G &lt;- G.matrix(M = geno.apple, method = "VanRaden")$G
G[1:5, 1:5]


# Example: Requesting a sparse form by VanRanden.

# Get G matrix.
G &lt;- G.matrix(M = geno.apple, method = "VanRaden", sparseform = TRUE)$G.sparse
head(G)
head(attr(G, "rowNames"))


</code></pre>


</div>