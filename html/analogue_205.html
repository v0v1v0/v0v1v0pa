<div class="container">

<table style="width: 100%;"><tr>
<td>roc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ROC curve analysis</h2>

<h3>Description</h3>

<p>Fits Receiver Operator Characteristic (ROC) curves to training set
data. Used to determine the critical value of a dissimilarity
coefficient that best descriminate between assemblage-types in
palaeoecological data sets, whilst minimising the false positive
error rate (FPF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">roc(object, groups, k = 1, ...)

## Default S3 method:
roc(object, groups, k = 1, thin = FALSE,
    max.len = 10000, ...)

## S3 method for class 'mat'
roc(object, groups, k = 1, ...)

## S3 method for class 'analog'
roc(object, groups, k = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector of group memberships, one entry per
sample in the training set data. Can be a factor, and will be
coerced to one if supplied vecvtor is not a factor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric; the <code>k</code> closest analogues to use to calculate
ROC curves.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>logical; should the points on the ROC curve be thinned?
See Details, below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.len</code></td>
<td>
<p>numeric; length of analolgue and non-analogue
vectors. Used as limit to thin points on ROC curve to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to/from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A ROC curve is generated from the within-group and between-group
dissimilarities.
</p>
<p>For each level of the grouping vector (<code>groups</code>) the
dissimilarity between each group member and it's k closest analogues
within that group are compared with the k closest dissimilarities
between the non-group member and group member samples.
</p>
<p>If one is able to discriminate between members of different group on
the basis of assemblage dissimilarity, then the dissimilarities
between samples within a group will be small compared to the
dissimilarities between group members and non group members.
</p>
<p><code>thin</code> is useful for large problems, where the number of analogue
and non-analogue distances can conceivably be large and thus overflow
the largest number R can work with. This option is also useful to
speed up computations for large problems. If <code>thin == TRUE</code>, then
the larger of the analogue or non-analogue distances is thinned to a
maximum length of <code>max.len</code>. The smaller set of distances is
scaled proportionally. In thinning, we approximate the distribution of
distances by taking <code>max.len</code> (or a fraction of <code>max.len</code>
for the smaller set of distances) equally-spaced probability
quantiles of the distribution as a new set of distances. 
</p>


<h3>Value</h3>

<p>A list with two components; i, <code>statistics</code>, a summary of ROC
statistics for each level of <code>groups</code> and a combined ROC
analysis, and ii, <code>roc</code>, a list of ROC objects, one per level of
<code>groups</code>. For the latter, each ROC object is a list, with the
following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>TPF</code></td>
<td>
<p>The true positive fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPE</code></td>
<td>
<p>The false positive error</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p>The optimal dissimilarity value, asessed where the
slope of the ROC curve is maximal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>The area under the ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.fit</code></td>
<td>
<p>Standard error of the AUC estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.in</code></td>
<td>
<p>numeric; the number of samples within the current group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.out</code></td>
<td>
<p>numeric; the number of samples not in the current group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>The p-value of a Wilcoxon rank sum test on the two sets
of dissimilarities. This is also known as a Mann-Whitney test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc.points</code></td>
<td>
<p>The unique dissimilarities at which the ROC curve
was evaluated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.roc</code></td>
<td>
<p>numeric; the position along the ROC curve at which the
slope of the ROC curve is maximal. This is the index of this point
on the curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>numeric, length 2. Vector of observed prior probabilities
of true analogue and true non-analogues in the group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analogue</code></td>
<td>
<p>a list with components <code>yes</code> and <code>no</code>
containing the dissimilarities for true analogue and true
non-analogues in the group.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on code from Thomas Lumley to optimise
the calculation of the ROC curve.</p>


<h3>References</h3>

<p>Brown, C.D., and Davis, H.T. (2006) Receiver operating characteristics
curves and related decision measures: A tutorial. <em>Chemometrics
and Intelligent Laboratory Systems</em> <b>80</b>, 24–38.
</p>
<p>Gavin, D.G., Oswald, W.W., Wahl, E.R. and Williams, J.W. (2003) A
statistical approach to evaluating distance metrics and analog
assignments for pollen records. <em>Quaternary Research</em>
<strong>60</strong>, 356–367.
</p>
<p>Henderson, A.R. (1993) Assessing test accuracy and its clinical
consequences: a primer for receiver operating characteristic curve
analysis. <em>Annals of Clinical Biochemistry</em> <strong>30</strong>,
834–846.
</p>


<h3>See Also</h3>

<p><code>mat</code> for fitting of MAT models.
<code>bootstrap.mat</code> and <code>mcarlo</code> for alternative
methods for selecting critical values of analogue-ness for
dissimilarity coefficients.</p>


<h3>Examples</h3>

<pre><code class="language-R">## load the example data
data(swapdiat, swappH, rlgh)

## merge training and test set on columns
dat &lt;- join(swapdiat, rlgh, verbose = TRUE)

## extract the merged data sets and convert to proportions
swapdiat &lt;- dat[[1]] / 100
rlgh &lt;- dat[[2]] / 100

## fit an analogue matching (AM) model using the squared chord distance
## measure - need to keep the training set dissimilarities
swap.ana &lt;- analog(swapdiat, rlgh, method = "SQchord",
                   keep.train = TRUE)

## fit the ROC curve to the SWAP diatom data using the AM results
## Generate a grouping for the SWAP lakes
METHOD &lt;- if (getRversion() &lt; "3.1.0") {"ward"} else {"ward.D"}
clust &lt;- hclust(as.dist(swap.ana$train), method = METHOD)
grps &lt;- cutree(clust, 12)

## fit the ROC curve
swap.roc &lt;- roc(swap.ana, groups = grps)
swap.roc

## draw the ROC curve
plot(swap.roc, 1)

## draw the four default diagnostic plots
layout(matrix(1:4, ncol = 2))
plot(swap.roc)
layout(1)
</code></pre>


</div>