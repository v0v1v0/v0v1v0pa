<div class="container">

<table style="width: 100%;"><tr>
<td>FAT2DBC.ad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analysis: DBC experiment in double factorial design with an additional treatment</h2>

<h3>Description</h3>

<p>Analysis of an experiment conducted in a randomized block design in a double factorial scheme using analysis of variance of fixed effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">FAT2DBC.ad(
  f1,
  f2,
  block,
  response,
  responseAd,
  norm = "sw",
  homog = "bt",
  alpha.f = 0.05,
  alpha.t = 0.05,
  quali = c(TRUE, TRUE),
  names.fat = c("F1", "F2"),
  mcomp = "tukey",
  grau = c(NA, NA),
  grau12 = NA,
  grau21 = NA,
  transf = 1,
  constant = 0,
  geom = "bar",
  theme = theme_classic(),
  ylab = "Response",
  xlab = "",
  xlab.factor = c("F1", "F2"),
  legend = "Legend",
  ad.label = "Additional",
  color = "rainbow",
  fill = "lightblue",
  textsize = 12,
  labelsize = 4,
  addmean = TRUE,
  errorbar = TRUE,
  CV = TRUE,
  dec = 3,
  width.column = 0.9,
  width.bar = 0.3,
  angle = 0,
  posi = "right",
  family = "sans",
  point = "mean_sd",
  sup = NA,
  ylim = NA,
  angle.label = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>Numeric or complex vector with factor 1 levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2</code></td>
<td>
<p>Numeric or complex vector with factor 2 levels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>Numeric or complex vector with repetitions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Numerical vector containing the response of the experiment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>responseAd</code></td>
<td>
<p>Numerical vector with additional treatment responses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>Error normality test (<em>default</em> is Shapiro-Wilk)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homog</code></td>
<td>
<p>Homogeneity test of variances (<em>default</em> is Bartlett)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.f</code></td>
<td>
<p>Level of significance of the F test (<em>default</em> is 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.t</code></td>
<td>
<p>Significance level of the multiple comparison test (<em>default</em> is 0.05)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quali</code></td>
<td>
<p>Defines whether the factor is quantitative or qualitative (<em>qualitative</em>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.fat</code></td>
<td>
<p>Name of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcomp</code></td>
<td>
<p>Multiple comparison test (Tukey (<em>default</em>), LSD and Duncan)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grau</code></td>
<td>
<p>Polynomial degree in case of quantitative factor (<em>default</em> is 1). Provide a vector with two elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grau12</code></td>
<td>
<p>Polynomial degree in case of quantitative factor (<em>default</em> is 1). Provide a vector with n levels of factor 2, in the case of interaction f1 x f2 and qualitative factor 2 and quantitative factor 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grau21</code></td>
<td>
<p>Polynomial degree in case of quantitative factor (<em>default</em> is 1). Provide a vector with n levels of factor 1, in the case of interaction f1 x f2 and qualitative factor 1 and quantitative factor 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transf</code></td>
<td>
<p>Applies data transformation (default is 1; for log consider 0; 'angular' for angular transformation)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant</code></td>
<td>
<p>Add a constant for transformation (enter value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geom</code></td>
<td>
<p>Graph type (columns or segments (For simple effect only))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme</code></td>
<td>
<p>ggplot2 theme (<em>default</em> is theme_classic())</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Variable response name (Accepts the <em>expression</em>() function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Treatments name (Accepts the <em>expression</em>() function)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.factor</code></td>
<td>
<p>Provide a vector with two observations referring to the x-axis name of factors 1 and 2, respectively, when there is an isolated effect of the factors. This argument uses 'parse'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Legend title name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ad.label</code></td>
<td>
<p>Aditional label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Column chart color (<em>default</em> is "rainbow")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>Defines chart color (to generate different colors for different treatments, define fill = "trat")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textsize</code></td>
<td>
<p>Font size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelsize</code></td>
<td>
<p>Label Size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addmean</code></td>
<td>
<p>Plot the average value on the graph (<em>default</em> is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorbar</code></td>
<td>
<p>Plot the standard deviation bar on the graph (In the case of a segment and column graph) - <em>default</em> is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>Plotting the coefficient of variation and p-value of Anova (<em>default</em> is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>Number of cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.column</code></td>
<td>
<p>Width column if geom="bar"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width.bar</code></td>
<td>
<p>Width errorbar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>x-axis scale text rotation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posi</code></td>
<td>
<p>legend position</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Font family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point</code></td>
<td>
<p>This function defines whether the point must have all points ("all"), mean ("mean"), standard deviation (<em>default</em> - "mean_sd") or mean with standard error ("mean_se") if quali= FALSE. For quali=TRUE, 'mean_sd' and 'mean_se' change which information will be displayed in the error bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup</code></td>
<td>
<p>Number of units above the standard deviation or average bar on the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-axis scale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle.label</code></td>
<td>
<p>label angle</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The table of analysis of variance, the test of normality of errors (Shapiro-Wilk, Lilliefors, Anderson-Darling, Cramer-von Mises, Pearson and Shapiro-Francia), the test of homogeneity of variances (Bartlett or Levene), the test of independence of Durbin-Watson errors, the test of multiple comparisons (Tukey, LSD, Scott-Knott or Duncan) or adjustment of regression models up to grade 3 polynomial, in the case of quantitative treatments. The column chart for qualitative treatments is also returned.
</p>


<h3>Note</h3>

<p>The order of the chart follows the alphabetical pattern. Please use 'scale_x_discrete' from package ggplot2, 'limits' argument to reorder x-axis. The bars of the column and segment graphs are standard deviation.
</p>
<p>The function does not perform multiple regression in the case of two quantitative factors.
</p>
<p>The assumptions of variance analysis disregard additional treatment
</p>
<p>In the final output when transformation (transf argument) is different from 1, the columns resp and respo in the mean test are returned, indicating transformed and non-transformed mean, respectively.
</p>


<h3>Author(s)</h3>

<p>Gabriel Danilo Shimizu, <a href="mailto:shimizu@uel.br">shimizu@uel.br</a>
</p>
<p>Leandro Simoes Azeredo Goncalves
</p>
<p>Rodrigo Yudi Palhaci Marubayashi
</p>


<h3>References</h3>

<p>Principles and procedures of statistics a biometrical approach Steel, Torry and Dickey. Third Edition 1997
</p>
<p>Multiple comparisons theory and methods. Departament of statistics the Ohio State University. USA, 1996. Jason C. Hsu. Chapman Hall/CRC.
</p>
<p>Practical Nonparametrics Statistics. W.J. Conover, 1999
</p>
<p>Ramalho M.A.P., Ferreira D.F., Oliveira A.C. 2000. Experimentacao em Genetica e Melhoramento de Plantas. Editora UFLA.
</p>
<p>Scott R.J., Knott M. 1974. A cluster analysis method for grouping mans in the analysis of variance. Biometrics, 30, 507-512.
</p>
<p>Mendiburu, F., and de Mendiburu, M. F. (2019). Package ‘agricolae’. R Package, Version, 1-2.
</p>


<h3>See Also</h3>

<p>FAT2DBC
</p>
<p>dunnett
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(AgroR)
data(cloro)
respAd=c(268, 322, 275, 350, 320)
with(cloro, FAT2DBC.ad(f1, f2, bloco, resp, respAd, ylab="Number of nodules", legend = "Stages"))
</code></pre>


</div>