<div class="container">

<table style="width: 100%;"><tr>
<td>harden.rubification</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Harden (1982) Rubification</h2>

<h3>Description</h3>

<p>Calculate "rubification" component of "Profile Development Index" after Harden (1982) "A quantitative index of soil development from field descriptions: Examples from a chronosequence in central California". Accepts vectorized inputs for hue and chroma to produce vector output.
</p>
<p>In Harden (1982) "rubification" is calculated relative to a reference parent material. Several other non-color components are normalized relative to a maximum value and summed to obtain the overall Profile Development Index.
</p>


<h3>Usage</h3>

<pre><code class="language-R">harden.rubification(hue, chroma, hue_ref, chroma_ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hue</code></td>
<td>
<p>A character vector containing Munsell hues (e.g. "7.5YR")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chroma</code></td>
<td>
<p>A numeric vector containing Munsell chromas</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hue_ref</code></td>
<td>
<p>A character vector containing Munsell hue(s) (e.g. "10YR") for reference material</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chroma_ref</code></td>
<td>
<p>A numeric vector containing Munsell chroma(s) for reference material</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric vector reflecting horizon redness increase relative to a reference (e.g. parent) material.
</p>


<h3>Author(s)</h3>

<p>Andrew G. Brown
</p>


<h3>References</h3>

<p>Harden, J.W. (1982) A quantitative index of soil development from field descriptions: Examples from a chronosequence in central California. Geoderma. 28(1) 1-28. doi:  10.1016/0016-7061(82)90037-4
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# keep examples from using more than 2 cores
data.table::setDTthreads(Sys.getenv("OMP_THREAD_LIMIT", unset = 2))

library(aqp)
data("jacobs2000", package="aqp")

# LEFT JOIN hue, value, chroma matrix color columns
horizons(jacobs2000) &lt;- cbind(horizons(jacobs2000)[,c(idname(jacobs2000), hzidname(jacobs2000))],
                              parseMunsell(jacobs2000$matrix_color_munsell, convertColors = FALSE))

#' # calculate a mixed 150-200cm color ~"parent material"
jacobs2000$c_horizon_color &lt;- profileApply(jacobs2000, function(p) {

  # and derive the parent material from the 150-200cm interval
  p150_200 &lt;- glom(p, 150, 200, truncate = TRUE)
  p150_200$thickness &lt;- p150_200$bottom - p150_200$top
  
  # subset colors and thickness
  clrs &lt;- na.omit(horizons(p150_200)[,c('matrix_color_munsell','thickness')])
  
  # simulate a subtractive mixture using thickness as weight
  mixMunsell(
  clrs$matrix_color_munsell, 
  w = clrs$thickness, 
  mixingMethod = 'exact')$munsell
})

# segment profile into 1cm slices (for proper depth weighting)
jacobs2000$rubif &lt;- profileApply(jacobs2000, function(p) {

  # sum the melanization index over the 0-100cm interval
  p0_100 &lt;- hz_segment(p, 0:100)

  ccol &lt;- parseMunsell(p$c_horizon_color, convertColors = FALSE)

  sum(harden.rubification(
    hue = p0_100$hue,
    chroma = as.numeric(p0_100$chroma),
    hue_ref = ccol$hue,
    chroma_ref = as.numeric(ccol$chroma)
  ), na.rm = TRUE)

})

jacobs2000$rubiforder &lt;- order(jacobs2000$rubif)

# Plot in order of increasing Rubification index

plotSPC(jacobs2000,
color = "matrix_color",
label = "rubif",
plot.order = jacobs2000$rubiforder,
max.depth = 250
)

segments(
  x0 = 0.5, 
  x1 = length(jacobs2000) + 0.5, 
  y0 = c(0,100,150,200), 
  y1 = c(0,100,150,200), 
  lty = 2
)

# Add [estimated] parent material color swatches
trash &lt;- sapply(seq_along(jacobs2000$c_horizon_color), function(i) {
  rect(i - 0.15, 250, i + 0.15, 225,
       col = parseMunsell(jacobs2000$c_horizon_color[jacobs2000$rubiforder[i]]))
})
</code></pre>


</div>