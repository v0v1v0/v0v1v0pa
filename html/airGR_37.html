<div class="container">

<table style="width: 100%;"><tr>
<td>RunModel_GR2M</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run with the GR2M hydrological model</h2>

<h3>Description</h3>

<p>Function which performs a single run for the GR2M monthly lumped model over the test period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunModel_GR2M(InputsModel, RunOptions, Param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>InputsModel</code></td>
<td>
<p>[object of class <em>InputsModel</em>] see <code>CreateInputsModel</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RunOptions</code></td>
<td>
<p>[object of class <em>RunOptions</em>] see <code>CreateRunOptions</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param</code></td>
<td>
<p>[numeric] vector of 2 parameters
</p>

<table>
<tr>
<td style="text-align: left;">
    GR2M X1 </td>
<td style="text-align: left;"> production store capacity [mm]       </td>
</tr>
<tr>
<td style="text-align: left;">
    GR2M X2 </td>
<td style="text-align: left;"> groundwater exchange coefficient [-] </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For further details on the model, see the references section. <br>
For further details on the argument structures and initialisation options, see <code>CreateRunOptions</code>.
<br><br><img src="../help/figures/diagramGR2M-EN.png" width="60%" alt="Figure: diagramGR4J-EN.png"></p>


<h3>Value</h3>

<p>[list] containing the function outputs organised as follows:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>$DatesR  </em> </td>
<td style="text-align: left;"> [POSIXlt] series of dates                                             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PotEvap </em> </td>
<td style="text-align: left;"> [numeric] series of input potential evapotranspiration [mm/month] (E) </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Precip  </em> </td>
<td style="text-align: left;"> [numeric] series of input total precipitation [mm/month] (P)          </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AE      </em> </td>
<td style="text-align: left;"> [numeric] series of actual evapotranspiration [mm/month]              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Pn      </em> </td>
<td style="text-align: left;"> [numeric] series of net rainfall (P1) [mm/month]                      </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Ps      </em> </td>
<td style="text-align: left;"> [numeric] series of part of P filling the production store [mm/month] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Perc    </em> </td>
<td style="text-align: left;"> [numeric] series of percolation (P2) [mm/month]                       </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PR      </em> </td>
<td style="text-align: left;"> [numeric] series of PR=Pn+Perc (P3) [mm/month]                        </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch   </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments [mm/month]     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Prod    </em> </td>
<td style="text-align: left;"> [numeric] series of production store level (S) [mm]                   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Rout    </em> </td>
<td style="text-align: left;"> [numeric] series of routing store level (R1) [mm]                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Qsim    </em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge [mm/month] (Q)                </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$WarmUpQsim</em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge (Q) on the warm-up period [mm/month] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$Param     </em> </td>
<td style="text-align: left;"> [numeric] parameter set parameter set used by the model                      </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StateEnd</em> </td>
<td style="text-align: left;"> [numeric] states at the end of the run (production store level and routing store level) [mm]. See <code>CreateIniStates</code> for more details </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Refer to the provided references or to the package source code for further details on these model outputs.
</p>


<h3>Author(s)</h3>

<p>Laurent Coron, Claude Michel, Safouane Mouelhi, Olivier Delaigue, Guillaume Thirel
</p>


<h3>References</h3>

<p>Mouelhi S. (2003).
Vers une chaîne cohérente de modèles pluie-débit conceptuels globaux aux pas de temps pluriannuel, annuel, mensuel et journalier.
PhD thesis (in French), ENGREF - Cemagref Antony, France.
<br><br>
Mouelhi, S., Michel, C., Perrin, C. and Andréassian, V. (2006).
Stepwise development of a two-parameter monthly water balance model.
Journal of Hydrology, 318(1-4), 200-214, <a href="https://doi.org/10.1016/j.jhydrol.2005.06.014">doi:10.1016/j.jhydrol.2005.06.014</a>.
</p>


<h3>See Also</h3>

<p><code>CreateInputsModel</code>, <code>CreateRunOptions</code>, <code>CreateIniStates</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## loading catchment data
data(L0123001)

## preparation of the InputsModel object with daily time step data
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_GR4J, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E)

## conversion of InputsModel to monthly time step
InputsModel &lt;- SeriesAggreg(InputsModel, Format = "%Y%m")

## run period selection
Ind_Run &lt;- seq(which(format(InputsModel$DatesR, format = "%Y-%m")=="1990-01"),
               which(format(InputsModel$DatesR, format = "%Y-%m")=="1999-12"))

## preparation of the RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_GR2M,
                               InputsModel = InputsModel, IndPeriod_Run = Ind_Run)

## simulation
Param &lt;- c(X1 = 265.072, X2 = 1.040)
OutputsModel &lt;- RunModel_GR2M(InputsModel = InputsModel, RunOptions = RunOptions, Param = Param)

## conversion of observed discharge to monthly time step
Qobs &lt;- SeriesAggreg(data.frame(BasinObs$DatesR, BasinObs$Qmm),
                    Format = "%Y%m",
                    ConvertFun = "sum")
Qobs &lt;- Qobs[Ind_Run, 2]

## results preview
plot(OutputsModel, Qobs = Qobs)

## efficiency criterion: Nash-Sutcliffe Efficiency
InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                RunOptions = RunOptions, Obs = Qobs)
OutputsCrit &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit, OutputsModel = OutputsModel)
</code></pre>


</div>