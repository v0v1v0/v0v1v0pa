<div class="container">

<table style="width: 100%;"><tr>
<td>qpWave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the most likely number of ancestry waves using the qpWave method.</h2>

<h3>Description</h3>

<p>Given a set of 'left' populations, estimate the lowest number of necessary
admixture sources related to the set of 'right' populations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qpWave(
  data,
  left,
  right,
  maxrank = NULL,
  details = FALSE,
  outdir = NULL,
  params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>EIGENSTRAT data object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left, right</code></td>
<td>
<p>Character vectors of populations labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxrank</code></td>
<td>
<p>Maximum rank to test for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>Return the A, B matrices used in rank calculations?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outdir</code></td>
<td>
<p>Where to put all generated files (temporary directory by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Named list of parameters and their values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It has been shown (Reich, Nature 2012 - Reconstructing Native American
population history) that if the 'left' populations are mixtures of N
different sources related to the set of 'right' populations, the rank of the
matrix of the form <code class="reqn">f_4(left_i, left_j; right_k, right_l)</code> will have a
rank N - 1. This function uses the ADMIXTOOLS command qpWave to find the
lowest possible rank of this matrix that is consistent with the data.
</p>


<h3>Value</h3>

<p>Table of rank test results.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: # download example data set and prepare it for analysis
snps &lt;- eigenstrat(download_data(dirname = tempdir()))

# run the qpWave wrapper (detailed description in the tutorial vignette)
result &lt;- qpWave(
     left = c("French", "Sardinian", "Han"),
     right = c("Altai", "Yoruba", "Mbuti"),
     data = snps
)

## End(Not run)

</code></pre>


</div>