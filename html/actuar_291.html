<div class="container">

<table style="width: 100%;"><tr>
<td>rmixture</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation from Discrete Mixtures</h2>

<h3>Description</h3>

<p>Generate random variates from a discrete mixture of distributions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rmixture(n, probs, models, shuffle = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random variates to generate. If <code>length(n) &gt;
    1</code>, the length is taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>numeric non-negative vector specifying the probability
for each model; is internally normalized to sum 1. Infinite
and missing values are not allowed. Values are recycled as necessary
to match the length of <code>models</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>vector of expressions specifying the simulation models
with the number of variates omitted; see Details. Models are
recycled as necessary to match the length of <code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shuffle</code></td>
<td>
<p>logical; should the random variates from the
distributions be shuffled?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rmixture</code> generates variates from a discrete mixture, that is
the random variable with a probability density function of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x) = p_1 f_1(x) + ... + p_n f_n(x),</code>
</p>

<p>where <code class="reqn">f_1, \dots, f_n</code> are densities and <code class="reqn">\sum_{i = 1}^n p_i
    = 1</code>.
</p>
<p>The values in <code>probs</code> will be internally normalized to be
used as probabilities <code class="reqn">p_1 + \dots + p_n</code>.
</p>
<p>The specification of simulation models uses the syntax of
<code>rcomphierarc</code>. Models <code class="reqn">f_1, \dots, f_n</code> are expressed in a
semi-symbolic fashion using an object of mode
<code>expression</code> where each element is a complete call
to a random number generation function, with the number of variates
omitted.
</p>
<p>The argument of the random number generation functions for the number
of variates to simulate <strong>must</strong> be named <code>n</code>.
</p>
<p>If <code>shuffle</code> is <code>FALSE</code>, the output vector contains all the
random variates from the first model, then all the random variates
from the second model, and so on. If the order of the variates is
irrelevant, this cuts the time to generate the variates roughly in
half.
</p>


<h3>Value</h3>

<p>A vector of random variates from the mixture with density <code class="reqn">f(x)</code>.
</p>


<h3>Note</h3>

<p>Building the expressions in <code>models</code> from the arguments of
another function is delicate. The expressions must be such that
evaluation is possible in the frame of <code>rmixture</code> or its parent.
See the examples.  
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a>
</p>


<h3>See Also</h3>

<p><code>rcompound</code> to simulate from compound models.
</p>
<p><code>rcomphierarc</code> to simulate from compound hierarchical models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Mixture of two exponentials (with means 1/3 and 1/7) with equal
## probabilities.
rmixture(10, 0.5, expression(rexp(3), rexp(7)))
rmixture(10, 42, expression(rexp(3), rexp(7))) # same

## Mixture of two lognormals with different probabilities.
rmixture(10, probs = c(0.55, 0.45),
         models = expression(rlnorm(3.6, 0.6),
                             rlnorm(4.6, 0.3)))

## Building the model expressions in the following example
## works as 'rate' is defined in the parent frame of
## 'rmixture'.
probs &lt;- c(2, 5)
g &lt;- function(n, p, rate)
    rmixture(n, p, expression(rexp(rate[1]), rexp(rate[2])))
g(10, probs, c(3, 7))

## The following example does not work: 'rate' does not exist
## in the evaluation frame of 'rmixture'.
f &lt;- function(n, p, model) rmixture(n, p, model)
h &lt;- function(n, p, rate)
    f(n, p, expression(rexp(rate[1]), rexp(rate[2])))
## Not run: h(10, probs, c(3, 7))

## Fix: substitute the values in the model expressions.
h &lt;- function(n, p, rate)
{
    models &lt;- eval(substitute(expression(rexp(a[1]), rexp(a[2])),
                              list(a = rate)))
    f(n, p, models)
}
h(10, probs, c(3, 7))
</code></pre>


</div>