<div class="container">

<table style="width: 100%;"><tr>
<td>aou_join</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Join current query to another table</h2>

<h3>Description</h3>

<p>Joins two tables in the All of Us database. A less verbose
wrapper for the dplyr::*_join() functions with some added safeguards.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aou_join(
  data,
  table,
  type,
  by = NULL,
  suffix = c("_x", "_y"),
  x_as = NULL,
  y_as = NULL,
  ...,
  con = getOption("aou.default.con")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>unexecuted SQL query from dbplyr/dplyr.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>the omop table (or other remote table in your schema) you wish
to join, as a character string, or a tbl object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of join; types available in dplyr: "left", "right",
"inner", "anti", "full", etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>columns to join on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>suffix preferences to add when joining data with the same
column names not specified in the by argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_as</code></td>
<td>
<p>optional; a string for the name of the left table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_as</code></td>
<td>
<p>optional; a string for the name of the right table</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to the join function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con</code></td>
<td>
<p>Connection to the allofus SQL database. Defaults to
<code>getOption("aou.default.con")</code>, which is created automatically with
<code>aou_connect()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are a few good reasons to use aou_join() when possible over
the x_join functions from dplyr. First, it reduces the code necessary to join
an existing table to another table. Second, it includes checks/workarounds
for two sources of common errors using dbplyr: it automatically appends the
x_as and y_as arguments to the join call if they are not provided and it
changes the default suffix from .x/.y to _x/_y for cases with shared column
names not specified by the <code>by</code> argument which will result in a SQL error.
</p>


<h3>Value</h3>

<p>Reference to the remote table created by the join.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

con &lt;- aou_connect()
obs_tbl &lt;- dplyr::tbl(con, "observation") %&gt;%
  dplyr::select(-provider_id)
obs_tbl %&gt;%
  aou_join("person", type = "left", by = "person_id")

</code></pre>


</div>