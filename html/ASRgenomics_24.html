<div class="container">

<table style="width: 100%;"><tr>
<td>kinship.pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs a Principal Component Analysis (PCA) based on a kinship matrix K</h2>

<h3>Description</h3>

<p>Generates a PCA and summary statistics from a given kinship matrix for
population structure. This matrix
can be a pedigree-based relationship matrix <code class="reqn">\boldsymbol{A}</code>, a genomic
relationship matrix <code class="reqn">\boldsymbol{G}</code> or a hybrid relationship matrix
<code class="reqn">\boldsymbol{H}</code>. Individual names should be assigned to <code>rownames</code> and
<code>colnames</code>. There is additional output such as plots and other data frames
to be used on other downstream analyses (such as GWAS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kinship.pca(
  K = NULL,
  scale = TRUE,
  label = FALSE,
  ncp = 10,
  groups = NULL,
  ellipses = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Input of a kinship matrix in full form (<code class="reqn">n \times n</code>) (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If <code>TRUE</code> the PCA analysis will scale the kinship matrix, otherwise
it is used in its original scale (default = <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>If <code>TRUE</code> then includes in output individuals names (default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>The number of PC dimensions to be shown in the screeplot, and to provide
in the output data frame (default = <code>10</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Specifies a vector of class factor that will be used to define different
colors for individuals in the PCA plot. It must be presented in the same order as the individuals
in the kinship matrix (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipses</code></td>
<td>
<p>If <code>TRUE</code>, ellipses will will be drawn around each of the define levels in
<code>groups</code> (default = <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It calls function <code>eigen()</code> to obtain eigenvalues and later generate the PCA and the
<code>factoextra</code> R package to extract and visualize results.
</p>


<h3>Value</h3>

<p>A list with the following four elements:
</p>

<ul>
<li>
<p><code>eigenvalues</code>: a data frame with the eigenvalues and its variances associated with each dimension
including only the first <code>ncp</code> dimensions.
</p>
</li>
<li>
<p><code>pca.scores</code>: a data frame with scores (rotated observations on the new components) including
only the first <code>ncp</code> dimensions.
</p>
</li>
<li>
<p><code>plot.pca</code>: a scatterplot with the first two-dimensions (PC1 and PC2) and their scores.
</p>
</li>
<li>
<p><code>plot.scree</code>: a barchart with the percentage of variances explained by the <code>ncp</code> dimensions.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Get G matrix.
G &lt;- G.matrix(M = geno.apple, method = "VanRaden")$G
G[1:5, 1:5]

# Perform the PCA.
G_pca &lt;- kinship.pca(K = G, ncp = 10)
ls(G_pca)
G_pca$eigenvalues
head(G_pca$pca.scores)
G_pca$plot.pca
G_pca$plot.scree

# PCA plot by family (17 groups).
grp &lt;- as.factor(pheno.apple$Family)
G_pca_grp &lt;- kinship.pca(K = G, groups = grp, label = FALSE, ellipses = FALSE)
G_pca_grp$plot.pca

</code></pre>


</div>