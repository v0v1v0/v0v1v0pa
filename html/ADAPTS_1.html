<div class="container">

<table style="width: 100%;"><tr>
<td>AugmentSigMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make an augmented signature matrix</h2>

<h3>Description</h3>

<p>Build an augmented signature matrix from an initial signature matrix, source data, and a list of 
differentially expressed genes (gList).  The user might want to modify gList to make certain that particular 
genes are included in the matrix.  The algorithm will be to add one additional gene from each new cell type
Record the condition number, and plot those.  Will only consider adding rows shared by fullData and newData
</p>
<p>newMatData &lt;- AugmentSigMatrix(origMatrix, fullData, newData, gList)
</p>


<h3>Usage</h3>

<pre><code class="language-R">AugmentSigMatrix(
  origMatrix,
  fullData,
  newData,
  gList,
  nGenes = 1:100,
  plotToPDF = TRUE,
  imputeMissing = TRUE,
  condTol = 1.01,
  postNorm = FALSE,
  minSumToRem = NA,
  addTitle = NULL,
  autoDetectMin = FALSE,
  calcSpillOver = FALSE,
  pdfDir = tempdir(),
  plotIt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>origMatrix</code></td>
<td>
<p>The original signature matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullData</code></td>
<td>
<p>The full data for the signature matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newData</code></td>
<td>
<p>The new data to add signatures from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gList</code></td>
<td>
<p>The ordered list of genes from running rankByT() on newData. NOTE: best genes at the bottom!!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nGenes</code></td>
<td>
<p>The number of additional genes to consider (DEFAULT: 1:100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotToPDF</code></td>
<td>
<p>Plot the output condition numbers to a pdf file. (DEFAULT: TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imputeMissing</code></td>
<td>
<p>Set to TRUE to impute missing values. NOTE: adds stoachasiticity (DEFAULT: TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condTol</code></td>
<td>
<p>Setting higher tolerances will result in smaller numbers extra genes. 1.00 minimizes compliment number (DEFAULT: 1.00)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postNorm</code></td>
<td>
<p>Set to TRUE to normalize new signatures to match old signatures.  (DEFAULT: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minSumToRem</code></td>
<td>
<p>Set to non-NA to remove any row with the sum(abs(row)) &lt; minSumToRem (DEFAULT: NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addTitle</code></td>
<td>
<p>An optional string to add to the plot and savefile (DEFAULT: NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoDetectMin</code></td>
<td>
<p>Set to true to automatically detect the first local minima. GOOD PRELIMINARY RESULTS (DEAFULT: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcSpillOver</code></td>
<td>
<p>Use the training data to calculate a spillover matrix (DEFAULT: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdfDir</code></td>
<td>
<p>A fold to write the pdf file to if plotToPDF=TRUE (DEFAULT: tempdir())</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotIt</code></td>
<td>
<p>Set to FALSE to suppress non-PDF plotting (DEFAULT: TRUE)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an augmented cell type signature matrix
</p>


<h3>Examples</h3>

<pre><code class="language-R">#This toy example treats the LM22 deconvolution matrix as if it were all of the data
#  For a real example, look at the vignette or comments in exprData, fullLM22, small LM22
library(ADAPTS)
fullLM22 &lt;- ADAPTS::LM22[1:200, 1:8]
#Make a fake signature matrix out of 100 genes and the first 8 cell types
smallLM22 &lt;- fullLM22[1:100, 1:8] 

#Make fake data representing two replicates of purified Mast.cells 
exprData &lt;- ADAPTS::LM22[1:200, c("Mast.cells.resting","Mast.cells.activated")]
colnames(exprData) &lt;- c("Mast.cells", "Mast.cells")

#Fake source data with replicates for all purified cell types.
#  Note in this fake data set, many cell types have exactly one replicate
fakeAllData &lt;- cbind(fullLM22, as.data.frame(exprData)) 
gList &lt;- rankByT(geneExpr = fakeAllData, qCut=0.3, oneCore=TRUE)

newSig &lt;- AugmentSigMatrix(origMatrix=smallLM22, fullData=fullLM22, newData=exprData, 
    gList=gList, plotToPDF=FALSE)
</code></pre>


</div>