<div class="container">

<table style="width: 100%;"><tr>
<td>ab_scenario</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate A/B Street Scenario objects by disaggregating aggregate OD data</h2>

<h3>Description</h3>

<p>This function takes a data frame representing origin-destination trip data
in 'long' form, zones and, optionally, buildings from where trips can
start and end as inputs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ab_scenario(
  od,
  zones,
  zones_d = NULL,
  origin_buildings = NULL,
  destination_buildings = NULL,
  pop_var = 3,
  time_fun = ab_time_normal,
  output = "sf",
  modes = c("Walk", "Bike", "Transit", "Drive"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>od</code></td>
<td>
<p>Origin destination data with the first 2 columns containing
zone code of origin and zone code of destination. Subsequent
columns should be mode names such as All and Walk, Bike, Transit, Drive,
representing the number of trips made by each mode of transport
for use in A/B Street.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zones</code></td>
<td>
<p>Zones with IDs that match the desire lines. Class: <code>sf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zones_d</code></td>
<td>
<p>Optional destination zones with IDs
that match the second column of the <code>od</code> data frame (work in progress)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>origin_buildings</code></td>
<td>
<p>Polygons where trips will originate (<code>sf</code> object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>destination_buildings</code></td>
<td>
<p>Polygons where trips can end, represented as <code>sf</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop_var</code></td>
<td>
<p>The variable containing the total population of each desire line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_fun</code></td>
<td>
<p>The function used to calculate departure times.
<code>ab_time_normal()</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Which output format?
<code>"sf"</code> (default) and <code>"json_list"</code> return R objects.
A file name such as <code>"baseline.json"</code> will save the resulting scenario
to a file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modes</code></td>
<td>
<p>Character string containing the names of the modes of travel to
include in the outputs. These must match column names in the <code>od</code> input
data frame. The default is <code>c("Walk", "Bike", "Drive", "Transit")</code>,
matching the mode names allowed in the A/B Street scenario schema.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>ab_json()</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>sf</code> object by default representing individual trips
between randomly selected points (or buildings when available)
between the zones represented in the OD data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">od = leeds_od
zones = leeds_zones
od[[1]] = c("E02006876")
ablines = ab_scenario(od, zones = zones)
plot(ablines)
table(ablines$mode)
colSums(od[3:7]) # 0.17 vs 0.05 for ab_scenario
ablines = ab_scenario(od, zones = zones, origin_buildings = leeds_buildings)
plot(leeds_zones$geometry)
plot(leeds_buildings$geometry, add = TRUE)
plot(ablines["mode"], add = TRUE)
ablines_json = ab_json(ablines, scenario_name = "test")
od = leeds_desire_lines
names(od)[4:6] = c("Walk", "Bike", "Drive")
ablines = ab_scenario(
  od = od,
  zones = leeds_site_area,
  zones_d = leeds_zones,
  origin_buildings = leeds_houses,
  destination_buildings = leeds_buildings,
  output = "sf"
)
plot(ablines)
plot(ablines$geometry)
plot(leeds_site_area$geometry, add = TRUE)
plot(leeds_buildings$geometry, add = TRUE)
</code></pre>


</div>