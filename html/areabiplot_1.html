<div class="container">

<table style="width: 100%;"><tr>
<td>areabiplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Area Biplot</h2>

<h3>Description</h3>

<p>Consider an (n x m) centered data matrix <code class="reqn">X</code> and let <code class="reqn">rank(X) = r</code>.
Alternatively to the ordinary NIPALS decomposition of <code class="reqn">X</code>, where <code class="reqn">X = T P'</code>,
this package uses the resulting matrices from the extended version of the NIPALS
decomposition (<code class="reqn">X = G H P'</code>) to determine <code class="reqn">n</code> triangles whose areas are
used to visually estimate the <code class="reqn">n</code> elements of a specific column of <code class="reqn">X</code>
(a variable of interest). After a 90-degree rotation of the sample points, the
triangles are drawn regarding the following points:
</p>

<ol>
<li>
<p> the origin of the axes.
</p>
</li>
<li>
<p> the sample points.
</p>
</li>
<li>
<p> the vector endpoint representing the selected variable.
</p>
</li>
</ol>
<p>Just keep in mind that The extended NIPALS decomposition, <code class="reqn">X = G H P'</code>, is
equivalent to the SVD decomposition, <code class="reqn">X = U D V'</code>, being that:
</p>

<ol>
<li> <p><code class="reqn">G</code> is the matrix containing in its columns the normalized score vectors
of <code class="reqn">X</code>, i.e., the normalized columns of <code class="reqn">T</code>. If <code class="reqn">t</code> is the i-th score
vector of the matrix <code class="reqn">T</code>, then the i-th column of  <code class="reqn">G</code> will be
<code class="reqn">g = t / || t || </code>, which will correspond to the i-th left singular vector <code class="reqn">u</code>.
</p>
</li>
<li>
<p> If <code class="reqn">t</code> is the i-th column of <code class="reqn">T</code>, then <code class="reqn">|| t || = \sqrt(t' t)</code> gives
the i-th singular value of <code class="reqn">X</code>. In addition, <code class="reqn">H</code> is the diagonal matrix
containing these singular values in decreasing order, i.e., <code class="reqn">H = D</code>.
</p>
</li>
<li> <p><code class="reqn">P</code> is the loadings matrix, which is equivalent to the <code class="reqn">V</code> matrix that
contains the right singular vectors of <code class="reqn">X</code>.
</p>
</li>
</ol>
<h3>Usage</h3>

<pre><code class="language-R">areabiplot(
  L,
  S,
  R,
  ord.row,
  mode = NULL,
  tri.rgb = NULL,
  bg.col = NULL,
  plot.title = NULL,
  plot.title.col = NULL,
  plot.title.font = NULL,
  plot.title.cex = NULL,
  plot.sub = NULL,
  plot.sub.col = NULL,
  plot.sub.font = NULL,
  plot.sub.cex = NULL,
  plot.cex = NULL,
  plot.col = NULL,
  plot.pch = NULL,
  plot.xlab = NULL,
  plot.ylab = NULL,
  plot.xlim = NULL,
  plot.ylim = NULL,
  points.lab = NULL,
  var.lab = NULL,
  text.col.var = NULL,
  text.cex = NULL,
  text.font = NULL,
  text.col = NULL,
  text.pos = NULL,
  axis.col = NULL,
  axis.cex = NULL,
  axis.font = NULL,
  axis.asp = NULL,
  arrow.lwd = NULL,
  arrow.len = NULL,
  arrow.col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>A (n x 2) matrix containing normalized score vectors <code class="reqn">g</code> (or left singular
vectors <code class="reqn">u</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>An appropriate (2 x 2) diagonal matrix containing the corresponding singular
values in decreasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A (m x 2) matrix containing the corresponding loading vectors (or right singular
vectors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord.row</code></td>
<td>
<p>The row  of <code class="reqn">R</code> used as the base of the triangle, e.g.,
if 1 is provided, then the first row of <code class="reqn">R</code> will be taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>a string providing the way the singular values will be allocated. The default
is "SS", i.e., the similar spread proposed by Gower et al.. Alternatively,
one can choose the "HJ" method (see more in Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tri.rgb</code></td>
<td>
<p>The hexadecimal color and alpha transparency code for the triangle. The
default is #19FF811A (green and 90% of transparency).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.col</code></td>
<td>
<p>A string providing the color of the background. The default is #001F3D (blue).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title</code></td>
<td>
<p>A string providing the main title. The default is NONE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.col</code></td>
<td>
<p>A string specifying the color of the main title text. The default is "FFFFFF"
(white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.font</code></td>
<td>
<p>An integer providing the style of the main title text. The default is 1 (normal
text).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.title.cex</code></td>
<td>
<p>A number indicating the amount by which the main title text should be scaled
relative to the default. 1 = default, 1.5 is 50% larger, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.sub</code></td>
<td>
<p>A string providing a sub-title. The default is NONE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.sub.col</code></td>
<td>
<p>A string specifying the color of the sub-title text. The default is "FFFFFF"
(white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.sub.font</code></td>
<td>
<p>An integer providing the style of the main title text. The default is 1 (normal
text).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.sub.cex</code></td>
<td>
<p>A number indicating the amount by which the sun-title text should be scaled
relative to the default. 1 = default, 1.5 is 50% larger, and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.cex</code></td>
<td>
<p>A number indicating the expansion or contraction factor used to specify the
point size. The default is 0.6 (40% smaller).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.col</code></td>
<td>
<p>A string specifying the color of the points. The default is "FFFFFF" (white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pch</code></td>
<td>
<p>An integer specifying the shape of the points. The default is 21 (circle)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.xlab</code></td>
<td>
<p>A string specifying a label to the horizontal axis. The default is NONE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.ylab</code></td>
<td>
<p>A string specifying a label to the vertical axis. The default is NONE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.xlim</code></td>
<td>
<p>The limits for the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.ylim</code></td>
<td>
<p>The limits for the y axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points.lab</code></td>
<td>
<p>A vector of characters containing the names of the data matrix rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.lab</code></td>
<td>
<p>A string providing the variable name used as triangle base.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.col.var</code></td>
<td>
<p>A string specifying the color of the variable label text. The default is
"FFFFFF" (white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.cex</code></td>
<td>
<p>A number indicating the expansion or contraction factor used to specify
the point labels. The default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.font</code></td>
<td>
<p>An integer providing the style of the point labels. The default is 2 (bold).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.col</code></td>
<td>
<p>A string specifying the color of the point labels text. The default is
"FFFFFF" (white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.pos</code></td>
<td>
<p>An integer providing the position of the point labels. The default is 3
(above).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.col</code></td>
<td>
<p>A string specifying the color of the axis. The default is #FFFFFF (white).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.cex</code></td>
<td>
<p>A number indicating the expansion or contraction factor used to specify
the tick label. The default is 0.7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.font</code></td>
<td>
<p>An integer providing the style of the tick label. The default is 1 (normal
text).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.asp</code></td>
<td>
<p>A number specifying the aspect ratio of the axes. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.lwd</code></td>
<td>
<p>A number specifying the line width of the arrow. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.len</code></td>
<td>
<p>The length of the edges of the arrow head (in inches). The default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.col</code></td>
<td>
<p>A string specifying the color of the arrow. The default is "FFFFFF"
(white).</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ol>
<li>
<p> If the variables (the columns of X) are measured in different units or
their variability differs considerably, one could perform a variance scaling
to get better visual results on the graph (see Examples). In this case, the
percentage of variance explained by the first principal components might decrease.
</p>
</li>
<li>
<p> The "HJ" mode is reserved for an application under implementation.
</p>
</li>
</ol>
<h3>Value</h3>

<p>An area biplot is produced on the current graphics device.
</p>


<h3>Author(s)</h3>

<p>Alberto Silva <a href="mailto:albertos@ua.pt">albertos@ua.pt</a>, Adelaide Freitas <a href="mailto:adelaide@ua.pt">adelaide@ua.pt</a>
</p>


<h3>References</h3>

<p>J.C. Gower, P.J.F. Groenen, M. van de Velden (2010). Area Biplots. Journal of Computational and
Graphical Statistics, v.19 (1), pp. 46-61. doi: <a href="https://doi.org/10.1198/jcgs.2010.07134">10.1198/jcgs.2010.07134</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(nipals)
data(uscrime)
Y = uscrime[, -1]

# first case: scale is false
nip = nipals(Y, ncomp = 2, center = TRUE, scale = FALSE, force.na = TRUE)
L = nip$scores
R = nip$loadings
S = diag(nip$eig[1:2])
areabiplot(L, S, R, 5, points.lab = c(uscrime[, 1]),var.lab= "burglary")

# second case: scale is true
nip = nipals(Y, ncomp = 2, center = TRUE, scale = TRUE, force.na = TRUE)
L = nip$scores
R = nip$loadings
S = diag(nip$eig[1:2])
areabiplot(L, S, R, 4, points.lab = c(uscrime[, 1]),var.lab= "assault")


</code></pre>


</div>