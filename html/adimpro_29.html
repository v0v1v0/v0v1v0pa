<div class="container">

<table style="width: 100%;"><tr>
<td>segment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Segmentation by AWS</h2>

<h3>Description</h3>

<p>The function allows to segment an image into two or three level sets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">segment(object, level=0.5, delta = 0, thresh = 3, fov = NULL, channel = 0, 
        hmax = 4, aws = TRUE, varmodel = NULL, ladjust = 1.25, xind = NULL, 
        yind = NULL, wghts = c(0.299, 0.587, 0.114, 0), scorr = TRUE, 
        lkern = "Triangle", plateau = NULL, homogen = TRUE, 
        earlystop = TRUE, demo = FALSE, select = FALSE, sext = 1.4, 
        connected = FALSE, graph = FALSE, max.pixel = 400, compress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Image object, class "adimpro", as from
<code>read.image</code>, <code>read.raw</code>, or <code>make.image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> center of gray/color-values of the second segment, will not be used if <code>select=TRUE</code>. May be specified such that either 
<code>level-delta</code> and <code>level+delta</code> are within the interval (0,1) or such that they are within the interval (0,65535) (2 Byte integers).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> half width of gray/color-values of the second segment, nay be increased if <code>select=TRUE</code>. May be specified such that either 
<code>level-delta</code> and <code>level+delta</code> are within the interval (0,1) or such that they are within the interval (0,65535) (2 Byte integers).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p> Critical value for final assignment to segment 1 or 3 , should be specified as a quantile of the standard Gaussian distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fov</code></td>
<td>
<p> size of field of view in pixel </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>channel</code></td>
<td>
<p> specifies which information to use for segmentation. 
0: use grey valued image obtained from color images, 1-3: use the specified color channel.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmax</code></td>
<td>
<p> Maximum bandwidth to use in the iteration procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aws</code></td>
<td>
<p> (logical). If <code>TRUE</code> the propagation - separation
(PS) approach from Polzehl and Spokoiny (2006) is used.
<code>aws=FALSE</code> turns off the statistical penalty resulting in a
nonadaptive kernel estimate using a kernel with bandwidth <code>hmax</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varmodel</code></td>
<td>
 <p><code>varmodel</code> specifies how variances are to be
estimated. This can be a homogeneous variance estimate
(<code>varmodel="None"</code>) assuming uncorrelated errors (both spatial
and between channels). Alternatives are an adaptive homogeneous or linear 
(function of the mean) variance estimate that depends on estimated
correlations and on residuals from the last iteration step. 
The default <code>varmodel=NULL</code> corresponds to
<code>varmodel == "Linear"</code> if <code>img$gamma==FALSE</code> and
<code>varmodel == "Constant"</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladjust</code></td>
<td>
<p> adjustment factor for lambda (&gt;=1). Default values for
lambda are selected for Gaussian distributions. Skewed or heavy
tailed distributions may require slightly larger values for lambda
to meet the propagation condition. <code>ladjust</code> allows to increase
lambda in such situations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xind, yind</code></td>
<td>
<p>Restrict smoothing to rectangular area defined by pixel
indices <code>xind,yind</code> in x- and y-direction. Full range
if <code>NULL</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wghts</code></td>
<td>
<p> allows to weight the information from
different (up to 4) color channels. The weights are used in the
statistical penalty of the PS-procedure. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scorr</code></td>
<td>
<p> (logical). Specifies whether  spatial correlation is to be
estimated. Defaults to <code>TRUE</code>.  Is set to <code>FALSE</code> if
<code>mask</code> is not <code>NULL</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lkern</code></td>
<td>
<p> Specifies the location kernel. Defaults to
"Triangle", other choices are "Quadratic", "Cubic" and "Uniform".
The use of "Triangle" corresponds to the Epanechnicov kernel 
nonparametric kernel regression. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plateau</code></td>
<td>
<p>Extension of the plateau in the statistical kernel. Can take
values from (0,1), defaults to <code>0.25</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homogen</code></td>
<td>
<p>If TRUE the algorithm determines, in each design point i, a circle of maximum radius,
such that the statistical penalty <code>s_{ij}</code> for all points j within the
circle is less than the value specified in <code>plateau</code>. In subsequent 
iteration steps the statistical penalty  for such points is set to zero. 
This is only used if <code>plateau&gt;0</code>. This results in more stable intermediate estimates and in a smoother reconstruction. <code>homogen=TRUE</code>
leads to increased memory requirements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>earlystop</code></td>
<td>
<p>If TRUE the algorithm determines, in each design point i, a circle of minimal radius,
such that the circle includes all point j with positive weights <code>w_{ij}</code>.
if this radius is considerably smaller than the actual bandwidth then the
estimate in point i is fixed. This should considarably reduce computing time 
in case of large <code>hmax</code>.<code>earlystop=TRUE</code>
slightly increases memory requirements. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demo</code></td>
<td>
<p> (logical). If <code>demo=TRUE</code> the function pauses after each
iteration. Defaults to <code>FALSE</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p> if TRUE a homogeneous rectangular region can be specified interactively. A value of <code>level</code> is the generated 
as the median of values within the selected region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sext</code></td>
<td>
<p> if <code>select==TRUE</code> the value of delta is increased by 
<code>sext</code> times the standard deviation (estimated by IQR) of the values in the selected region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connected</code></td>
<td>
<p> if TRUE the set of pixel within the same segment connected to the specified pixel is extracted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p> (logical). If  <code>graph=TRUE</code> intermediate results are
illustrated after each iteration step. Defaults to <code>FALSE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.pixel</code></td>
<td>
<p> Maximum dimension of images for display
if <code>graph=TRUE</code>. If the true dimension is larger, the 
images are downscaled for display. See also <code>show.image</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compress</code></td>
<td>
<p> logical, determines if image data are stored in raw-format. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The image is segmented into three parts by performing multiscale tests 
of the hypotheses H1
<code>value &gt;= level - delta</code> and H2 <code>value &lt;= level + delta</code>.
Pixel where the first hypotesis is rejected are classified as <code>-1</code> (segment 1)
while rejection of H2 results in classification  <code>1</code> (segment 3).
Pixel where neither H1 or H2 are rejected ar assigned to a value <code>0</code> (segment 2). Critical values for the tests are adjusted for smoothness at the different scales inspected in the iteration process using results from multiscale testing,
see e.g. Duembgen and Spokoiny (2001). Critical values also depend on the 
size of the region of interest specified in parameter <code>fov</code>.
</p>
<p>Within segment 2 structural adaptive smoothing is performed while if a pair of pixel belongs to segment 1 or segment 3 the corresponding weight will be nonadaptive. 
</p>
<p>If <code>connected==TRUE</code> pixel in segment 2 <code>0</code> are reassigned to a value <code>2</code> if they belong to a maximal connected subset of segment2 that contains the center of the specified homogeneous set.
</p>


<h3>Value</h3>

<p> Object of class <code>"adimpro"</code> with 
</p>
<table><tr style="vertical-align: top;">
<td><code>img </code></td>
<td>
<p>containing a greyvalued image with 3 or 4 levels corresponding to the identified segments.</p>
</td>
</tr></table>
<p>and additional list elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>hsegm</code></td>
<td>
<p> containing the maximal bandwidth used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> the value of parameter <code>level</code> used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p> the value of parameter <code>delta</code> used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p> the value of parameter <code>thresh</code> used</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> This function is still experimental and may be changes considerably in future.</p>


<h3>Author(s)</h3>

<p> Karsten Tabelow <a href="mailto:tabelow@wias-berlin.de">tabelow@wias-berlin.de</a> and Joerg Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a></p>


<h3>References</h3>

 
<p>Duembgen, L. and Spokoiny, V. (2001). Multiscale testing of qualitative hypoteses. Ann. Stat. 29, 124–152.
</p>
<p>Polzehl, J. and Spokoiny, V. (2006). Propagation-Separation Approach for Local
Likelihood Estimation. Probability Theory and Related Fields. 3 (135)
335 - 362.
</p>


<h3>See Also</h3>

 <p><code>read.image</code>, <code>read.raw</code>, <code>make.image</code>, <code>show.image</code>, <code>clip.image</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: demo(segment)
</code></pre>


</div>