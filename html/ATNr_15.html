<div class="container">

<table style="width: 100%;"><tr>
<td>jacobian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Jacobian matrix of a ODE system</h2>

<h3>Description</h3>

<p>Estimate the Jacobian matrix of a ODE system
</p>


<h3>Usage</h3>

<pre><code class="language-R">jacobian(bioms, ODE, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bioms</code></td>
<td>
<p>float vector, biomass of species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ODE</code></td>
<td>
<p>function that computes the ODEs from one of the model available</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>float, scale precision of the numerical approximation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function provides a numerical estimation of the Jacobian matrix
based on the 5 points stencil method. The precision of the method is in  </p>
<p style="text-align: center;"><code class="reqn">O(h^5)</code>
</p>
<p>,
where </p>
<p style="text-align: center;"><code class="reqn">h = eps*bioms</code>
</p>
<p>. The choice of eps should ensure that </p>
<p style="text-align: center;"><code class="reqn">h^5</code>
</p>

<p>is always lower to the extinction threshold.
</p>
<p>The dimension of the Jacobian matrix are not always matching the number of species in the system.
This is because we considered that a perturbation can not correspond to the recolonisation of an extinct species.
Therefore, extinct species are removed from the system to calculate the Jacobian matrix.
</p>


<h3>Value</h3>

<p>A matrix corresponding to the Jacobian  of the system estimated at the parameter biomasses
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ATNr)
set.seed(123)
# first run a model to reach equilibrium
masses &lt;- runif(20, 10, 100) #body mass of species
L &lt;- create_Lmatrix(masses, 10, Ropt = 10)
L[L &gt; 0] &lt;- 1
mod &lt;- create_model_Unscaled_nuts(20, 10, 3, masses, L)
mod &lt;- initialise_default_Unscaled_nuts(mod, L)
biomasses &lt;- masses ^ -0.75 * 10 ^ 4 #biomasses of species
biomasses &lt;- append(runif(3, 20, 30), biomasses)
times &lt;- seq(0, 100, 1)
sol &lt;- lsoda_wrapper(times, biomasses, mod)
# get the final biomasses
final.bioms = sol[nrow(sol), -1]
# estimate jacobian
jacobian(final.bioms, mod$ODE)
</code></pre>


</div>