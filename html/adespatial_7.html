<div class="container">

<table style="width: 100%;"><tr>
<td>beta.div</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beta diversity computed as Var(Y)</h2>

<h3>Description</h3>

<p>Compute estimates of total beta diversity as the total variance in a
community data matrix Y, as well as derived SCBD and LCBD statistics, for 19
dissimilarity coefficients or the raw data table. Computing beta diversity as
Var(Y) for raw, untransformed community composition data is not recommended.
Tests of significance of the LCBD indices are also produced.
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta.div(
  Y,
  method = "hellinger",
  sqrt.D = FALSE,
  samp = TRUE,
  nperm = 999,
  adj = TRUE,
  save.D = FALSE,
  clock = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Community composition data. The object class can be either
<code>data.frame</code> or <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of the 19 dissimilarity coefficients available in the
function: <code>"hellinger"</code>, <code>"chord"</code>, <code>"log.chord"</code>,
<code>"chisquare"</code>, <code>"profiles"</code>, <code>"percentdiff"</code>, <code>"ruzicka"</code>,
<code>"divergence"</code>, <code>"canberra"</code>, <code>"whittaker"</code>,
<code>"wishart"</code>, <code>"kulczynski"</code>, <code>"jaccard"</code>, <code>"sorensen"</code>,
<code>"ochiai"</code>, <code>"ab.jaccard"</code>, <code>"ab.sorensen"</code>,
<code>"ab.ochiai"</code>, <code>"ab.simpson"</code>, <code>"euclidean"</code>. See Details.
Names can be abbreviated to a non-ambiguous set of first letters. Default:
<code>method="hellinger"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.D</code></td>
<td>
<p>If <code>sqrt.D=TRUE</code>, the dissimilarities in matrix D are
square-rooted before computation of SStotal, BDtotal and LCBD. This
transformation may be useful for methods <code>"manhattan"</code>,
<code>"whittaker"</code>, <code>"divergence"</code>, <code>"canberra"</code>,
<code>"percentdiff"</code>, <code> "ruzicka"</code>, <code>"wishart"</code> since square-root
transformation of the dissimilarities makes these D matrices Euclidean.
</p>
<ul>
<li>
<p> Note 1 - Euclideanarity is useful for ordination by
principal coordinate analysis; lack of this property does not adversely
affect SStotal, BDtotal and LCBD. </p>
</li>
<li>
<p> Note 2 - The logical value given to
parameter <code>sqrt.D</code> has no incidence on calculations through methods
<code>"euclidean"</code>, <code>"profiles"</code>, <code>"hellinger"</code>, <code>"log.chord"</code>,
<code>"chord"</code>, <code>"chisquare"</code> since no D matrix is computed in those cases. 
</p>
</li>
<li>
<p> Note 3 - For methods <code>"jaccard"</code>, <code>"sorensen"</code>, <code>"ochiai"</code>, 
that function produces the dissimilarity matrix in the form sqrt(D), which is
Euclidean.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p>If <code>samp=TRUE</code>, the abundance-based distances (ab.jaccard,
ab.sorensen, ab.ochiai, ab.simpson) are computed for sample data. If
<code>samp=FALSE</code>, they are computed for true population data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>Number of permutations for the tests of significance of LCBD
indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>Compute adjusted p-values using the Holm method. Default: <code>adj=TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.D</code></td>
<td>
<p>If <code>save.D=TRUE</code>, the distance matrix will appear in the
output list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clock</code></td>
<td>
<p>If <code>clock=TRUE</code>, the computation time is printed. Useful
when nperm is large.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculations may be carried out in two ways, depending on the selected method.
</p>
 
<ul>
<li>
<p> For untransformed or transformed raw data, the total sum of squares (SStotal) 
is first computed, then the total beta diversity (BDtotal), which is SStotal divided 
by (n - 1), is calculated. This algorithm is used for methods <code>"euclidean"</code>, 
<code>"profiles"</code>, <code>"hellinger"</code>, <code>"chord"</code>, <code>"log.chord"</code>, 
<code>"chisquare"</code>. No transformation of the data is computed when the method is 
<code>"euclidean"</code>. For methods <code>"profiles"</code>, <code>"hellinger"</code>, 
<code>"chord"</code>, <code>"log.chord"</code>, <code>"chisquare"</code>, the algorithm begins with 
computation of the same-name transformation of the community data (Legendre and 
Gallagher 2001; Legendre and Legendre 2012, Section 7.7; Legendre and Borcard 
2018); SStotal and BDtotal are then computed for the transformed data, followed 
by calculation of the SCBD and LCBD indices.
</p>
</li>
<li>
<p> Calculations of BDtotal can also be conducted from a dissimilarity
matrix. SStotal is computed by summing the squared dissimilarities in the
lower triangular dissimilarity matrix and dividing by n. Then, total beta
diversity (BDtotal) is obtained by dividing SStotal by (n-1). With option
<code>sqrt.D = TRUE</code>, the computation of SStotal is equivalent to summing
the distances instead of the squared distances. Choices are:
<code>"whittaker"</code>, <code>"divergence"</code>, <code>"canberra"</code>,
<code>"percentdiff"</code>, <code>"ruzicka"</code>, <code>"wishart"</code>,
<code>"kulczynski"</code>, <code>"ab.jaccard"</code>, <code>"ab.sorensen"</code>,
<code>"ab.ochiai"</code>, <code>"ab.simpson"</code>, <code>"jaccard"</code>,
<code>"sorensen"</code>, <code>"ochiai"</code>. Equations for these dissimilarities are
presented in Table 1 of Legendre and De Cáceres (2013). The Ružička index
is described in Legendre (2014); this coefficient is suitable for beta
diversity studies. See Chao et al. (2006) for details about the
abundance-based (ab) coefficients.</p>
</li>
</ul>
<p>Community composition data can be log-transformed prior to analysis with the 
chord distance; see Legendre and Borcard (2018). The log(y+1) transformation
(<code>log1p</code> function of <code>base</code>) reduces the asymmetry of the species 
distributions. The chord-log distance, readily available among the methods of the 
<code>beta.div</code> function, is the chord distance computed on log(y+1)-transformed 
data. This combined transformation is meaningful for community composition data 
because the log is one of the transformations in the Box-Cox series, corresponding to 
exponent 0; see Legendre and Legendre (2012,  Section 1.5.6). Exponent 1 (no 
transformation of the data) followed by the chord transformation and calculation of 
the Euclidean distance would simply produce the chord distance. Exponent 0.5 (square 
root) followed by the chord transformation and the Euclidean distance would produce 
the Hellinger distance. The chord, Hellinger and log-chord distances represent a 
series where the data are increasingly transformed to reduce the asymmetry of the 
distributions. Note that it is meaningless to subject log-transformed community 
compostion data to the <code>"profiles"</code>, <code>"hellinger"</code>, or <code>"chisquare"</code> 
distances available in this function.  
</p>
<p>The Jaccard, Sørensen and Ochiai coefficients are the binary
forms of 10 of the 12 dissimilarity coefficients (including the Ružička
index) that are suitable for beta diversity assessment. The equivalences
are described in Legendre and De Cáceres (2013, Table 1). These popular
coefficients can be computed directly using function <code>beta.div</code>
without going to the trouble of applying the quantitative forms of these
coefficients to data reduced to presence-absence form.  <code>beta.div</code>
produces the dissimilarity matrix in the form sqrt(D), which is Euclidean.
Hence for these three coefficients, function <code>beta.div</code> should be used
with option <code>sqrt.D=FALSE</code>.
</p>
<p>Species contributions to beta diversity (SCBD indices for the species) are computed
for untransformed or transformed raw data, but they cannot be computed from
dissimilarity matrices.
</p>
<p>Local contributions to beta diversity (LCBD indices) represent
the degree of uniqueness of the sites in terms of their species
compositions. They can be computed in all cases: raw (not recommended) or
transformed data, as well as dissimilarity matrices. See Legendre and De
Cáceres (2013) for details. LCBD indices are tested for significance by
random, independent permutations within the columns of Y. This permutation
method tests H0 that the species are distributed at random, independently
of one another, among the sites, while preserving the species abundance
distributions in the observed data. See Legendre and De Cáceres (2013) for
discussion.
</p>
<p>This version of <code>beta.div</code> calls computer code written in C to speed up
computation, especially for the permutation tests of the LCBD indices.
</p>


<h3>Value</h3>

<p>A list containing the following results: </p>
 <ul>
<li>
<p><code>beta</code>: Total sum of squares and total beta diversity [=
Var(Y)] of the data matrix. BDtotal statistics computed with the same D
index are comparable among data sets having the same or different numbers
of sampling units (n), provided that they are of the same size or represent
the same sampling effort. </p>
</li>
<li> <p><code>SCBD</code>: Vector of Species
contributions to beta diversity (SCBD), if computed. </p>
</li>
<li> <p><code>LCBD</code>:
Vector of Local contributions to beta diversity (LCBD) for the sites. </p>
</li>
<li>
<p><code>p.LCBD</code>: P-values associated with the LCBD indices. </p>
</li>
<li>
<p><code>p.adj</code>: Corrected P-values for the LCBD indices, Holm correction. </p>
</li>
<li>
<p><code>method</code>: Method selected. </p>
</li>
<li> <p><code>note</code>: Notes indicate whether
the selected coefficient is Euclidean or not. </p>
</li>
<li> <p><code>D</code>: The distance
matrix if <code>save.D=TRUE</code>. </p>
</li>
</ul>
<p> When all sites contain a different set of
species with no species in common, the maximum value that BDtotal can take
depends on the method used in the calculation. </p>
 <ul>
<li>
<p> With methods
<code>"hellinger"</code>, <code>"chord"</code>, <code>"profiles"</code>, which have maximum values of
sqrt(2), BDtotal produces an index in the range [0, 1] with a maximum value
of 1. </p>
</li>
<li>
<p> For dissimilarity indices with maximum values of 1, BDtotal has
a maximum value of 0.5. </p>
</li>
<li>
<p> Dissimilarity indices that do not have
maximum values of 1 or sqrt(2) produce BDtotal values that do not have an
upper bound; hence they cannot be compared across taxonomic groups or among
study sites. This group includes the chi-square distance.</p>
</li>
</ul>
<p> See Legendre &amp;
De Caceres (2013, p. 957-958), Table 2 and section Maximum value of BD. <br>
For two sites only, the LCBD results are not interesting. With all
coefficients, the two LCBD indices are equal to 0.5. The two associated
p-values are 1 because LCBD is 0.5 for all columnwise permutations of the
data. <br> The calculation is aborted when Y only contains two identical
rows of data. In that case, SStotal and BDtotal are 0 and the LCBD indices
cannot be computed (value NaN).
</p>


<h3>Author(s)</h3>

<p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>
</p>


<h3>References</h3>

<p>Chao, A., R. L. Chazdon, R. K. Colwell and T. J. Shen. 2006.
Abundance-based similarity indices and their estimation when there are
unseen species in samples. Biometrics 62: 361-371.
</p>
<p>Legendre, P. 2014. Interpreting the replacement and richness difference
components of beta diversity. Global Ecology and Biogeography 23:
1324-1334.
</p>
<p>Legendre, P. and D. Borcard. 2018. Box-Cox-chord transformations for
community composition data prior to beta diversity analysis. Ecography 41:
1820-1824.
</p>
<p>Legendre, P. and M. De Cáceres. 2013. Beta diversity as the variance of
community data: dissimilarity coefficients and partitioning. Ecology
Letters 16: 951-963.
</p>
<p>Legendre, P. and E. D. Gallagher, E.D. 2001. Ecologically meaningful
transformations for ordination of species data. Oecologia 129: 271-280.
</p>
<p>Legendre, P. and Legendre, L. 2012. Numerical Ecology. 3rd English edition.
Elsevier Science BV, Amsterdam.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require("vegan", quietly = TRUE) &amp; require("adegraphics", quietly = TRUE)){
data(mite)
res = beta.div(mite, "hellinger", nperm=999)

# Plot a map of the LCBD indices using the Cartesian coordinates
data(mite.xy)
s.value(mite.xy, res$LCBD, symbol = "circle", col = c("white", "brown"), main="Map of mite LCBD")

### Example using the mite abundance data and the percentage difference dissimilarity
res = beta.div(mite, "percentdiff", nperm=999, clock=TRUE)

# Plot a map of the LCBD indices
signif = which(res$p.LCBD &lt;= 0.05)	# Which are the significant LCBD indices?
nonsignif = which(res$p.LCBD &gt; 0.05)	# Which are the non-significant LCBD indices?
g1 &lt;- s.value(mite.xy[signif,], res$LCBD[signif], ppoint.alpha = 0.5, plegend.drawKey = FALSE,
 symbol = "circle", col = c("white", "red"), main="Map of mite LCBD (red = significant indices)")
g2 &lt;- s.value(mite.xy[nonsignif,], res$LCBD[nonsignif], ppoint.alpha = 0.5,
symbol = "circle", col = c("white", "blue"))
g2+g1
}

</code></pre>


</div>