<div class="container">

<table style="width: 100%;"><tr>
<td>rlq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RLQ analysis </h2>

<h3>Description</h3>

<p>RLQ analysis performs a double inertia analysis of two arrays (R and Q) with a link expressed by a contingency table (L).
The rows of L correspond to the rows of R and the columns of L correspond to the rows of Q.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rlq(dudiR, dudiL, dudiQ, scannf = TRUE, nf = 2)
## S3 method for class 'rlq'
print(x, ...)
## S3 method for class 'rlq'
plot(x, xax = 1, yax = 2, ...)
## S3 method for class 'rlq'
summary(object, ...)
## S3 method for class 'rlq'
randtest(xtest,nrepet = 999, modeltype = 6,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudiR</code></td>
<td>
<p> a duality diagram providing from one of the functions dudi.hillsmith, dudi.pca, ... </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dudiL</code></td>
<td>
<p> a duality diagram of the function dudi.coa </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dudiQ</code></td>
<td>
<p> a duality diagram providing from one of the functions dudi.hillsmith, dudi.pca, ... </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p> a logical value indicating whether the eigenvalues bar plot should be displayed </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p> if scannf FALSE, an integer indicating the number of kept axes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> an rlq object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> an rlq object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtest</code></td>
<td>
<p> an rlq object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p> the number of permutations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modeltype</code></td>
<td>
<p>the model used to permute data(2: permute rows of R,
4: permute rows of Q, 5: permute both, 6: sequential approach, see
ter Braak et al. 2012)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of class 'dudi', sub-class 'rlq' containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>rank</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>a numeric value indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RV</code></td>
<td>
<p>a numeric value, the RV coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a numeric vector with all the eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>a numeric vector with the rows weigths (crossed array)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw</code></td>
<td>
<p>a numeric vector with the columns weigths (crossed array)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a crossed array (CA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>R col = CA row: coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>R col = CA row: normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>Q col = CA column: coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>Q col = CA column: normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lR</code></td>
<td>
<p>the row coordinates (R)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mR</code></td>
<td>
<p>the normed row scores (R)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lQ</code></td>
<td>
<p>the row coordinates (Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mQ</code></td>
<td>
<p>the normed row scores (Q)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aR</code></td>
<td>
<p>the axis onto co-inertia axis (R)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aQ</code></td>
<td>
<p>the axis onto co-inertia axis (Q)</p>
</td>
</tr>
</table>
<h3>WARNING </h3>

<p>IMPORTANT : row weights for <code>dudiR</code> and <code>dudiQ</code> must be taken from <code>dudiL</code>.
</p>


<h3>Note</h3>

<p>A testing procedure based on the total coinertia of the RLQ
analysis is available by the function <code>randtest.rlq</code>. The
function allows to deal with various analyses for tables R and Q. Means and variances are recomputed for each
permutation (PCA); for MCA, tables are recentred and column weights are recomputed.The
case of decentred PCA (PCA where centers are entered by the user) for
R or Q is not yet implemented. If you want to use the testing
procedure for this case, you must firstly center the table and then perform a non-centered PCA on the modified table.</p>


<h3>Author(s)</h3>

<p>Stéphane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a></p>


<h3>References</h3>

 
<p>Doledec, S., Chessel, D., ter Braak, C.J.F. and Champely, S. (1996) 
Matching species traits to environmental variables: a new three-table ordination method. <em>Environmental and Ecological Statistics</em>, 
<b>3</b>, 143–166.
</p>
<p>Dray, S., Pettorelli, N., Chessel, D. (2002) Matching data sets from two different spatial samplings. 
<em>Journal of Vegetation Science</em>, <b>13</b>, 867–874.
</p>
<p>Dray, S. and Legendre, P. (2008) 
Testing the species traits-environment relationships: the fourth-corner
problem revisited. <em>Ecology</em>,
<b>89</b>, 3400–3412.
</p>
<p>ter Braak, C., Cormont, A., Dray, S. (2012) Improved testing of species
traits-environment relationships in the fourth corner problem.
<em>Ecology</em>, <b>93</b>, 1525–1526.
</p>


<h3>See Also</h3>

 <p><code>coinertia</code>,   <code>fourthcorner</code></p>


<h3>Examples</h3>

<pre><code class="language-R">   data(aviurba)
   coa1 &lt;- dudi.coa(aviurba$fau, scannf = FALSE, nf = 2)
   dudimil &lt;- dudi.hillsmith(aviurba$mil, scannf = FALSE, nf = 2, row.w = coa1$lw)
   duditrait &lt;- dudi.hillsmith(aviurba$traits, scannf = FALSE, nf = 2, row.w = coa1$cw)
   rlq1 &lt;- rlq(dudimil, coa1, duditrait, scannf = FALSE, nf = 2)
   plot(rlq1)
   summary(rlq1)
   randtest(rlq1)
   fourthcorner.rlq(rlq1,type="Q.axes")
   fourthcorner.rlq(rlq1,type="R.axes")

</code></pre>


</div>