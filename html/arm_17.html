<div class="container">

<table style="width: 100%;"><tr>
<td>coefplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic Function for Making Coefficient Plot</h2>

<h3>Description</h3>

<p>Functions that plot the coefficients plus and minus 1 and 2 sd 
from a lm, glm, bugs, and polr fits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">coefplot(object,...)

## Default S3 method:
coefplot(coefs, sds, CI=2, 
                lower.conf.bounds, upper.conf.bounds,
                varnames=NULL, vertical=TRUE, 
                v.axis=TRUE, h.axis=TRUE,
                cex.var=0.8, cex.pts=0.9, 
                col.pts=1, pch.pts=20, var.las=2,
                main=NULL, xlab=NULL, ylab=NULL, mar=c(1,3,5.1,2),
                plot=TRUE, add=FALSE, offset=.1, ...)

## S4 method for signature 'bugs'
coefplot(object, var.idx=NULL, varnames=NULL, 
            CI=1, vertical=TRUE,
            v.axis=TRUE, h.axis=TRUE, 
            cex.var=0.8, cex.pts=0.9, 
            col.pts=1, pch.pts=20, var.las=2, 
            main=NULL, xlab=NULL, ylab=NULL, 
            plot=TRUE, add=FALSE, offset=.1,
            mar=c(1,3,5.1,2), ...)

## S4 method for signature 'numeric'
coefplot(object, ...)
## S4 method for signature 'lm'
coefplot(object, varnames=NULL, intercept=FALSE, ...)
## S4 method for signature 'glm'
coefplot(object, varnames=NULL, intercept=FALSE, ...)
## S4 method for signature 'polr'
coefplot(object, varnames=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>fitted objects-lm, glm, bugs and polr, or a vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefs</code></td>
<td>
<p>a vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sds</code></td>
<td>
<p>a vector of sds of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>confidence interval, default is 2, which will plot plus and minus 2 sds or
95% CI. If CI=1, plot plus and minus 1 sds or 50% CI instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.conf.bounds</code></td>
<td>
<p>lower bounds of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.conf.bounds</code></td>
<td>
<p>upper bounds of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>a vector of variable names, default is NULL, which will use
the names of variables; if specified, the length of varnames must be equal to
the length of predictors, including the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>orientation of the plot, default is TRUE which will plot
variable names in the 2nd axis. If FALSE, plot variable names in the first
axis instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v.axis</code></td>
<td>
<p>default is TRUE, which shows the bottom axis–axis(1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.axis</code></td>
<td>
<p>default is TRUE, which shows the left axis–axis(2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.var</code></td>
<td>
<p>The fontsize of the varible names, default=0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.pts</code></td>
<td>
<p>The size of data points, default=0.9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.pts</code></td>
<td>
<p>color of points and segments, default is black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch.pts</code></td>
<td>
<p>symbol of points, default is solid dot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.las</code></td>
<td>
<p>the orientation of variable names against the axis, default is 2. 
see the usage of <code>las</code> in <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The main title (on top) using font and size (character
expansion) <code>par("font.main")</code> and color <code>par("col.main")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X axis label using font and character expansion
<code>par("font.lab")</code> and color <code>par("col.lab")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y axis label, same font attributes as <code>xlab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>A numerical vector of the form <code>c(bottom, left, top, right)</code>
which gives the number of lines of margin to be specified on
the four sides of the plot. The default is <code>c(1,3,5.1,2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>default is TRUE, plot the estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>if add=TRUE, plot over the existing plot. default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>add extra spaces to separate from the existing dots. default is 0.1.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>var.idx</code></td>
<td>
<p>the index of the variables of a bugs object, default
is NULL which will plot all the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>If TRUE will plot intercept, default=FALSE to get better presentation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots coefficients from bugs, lm, glm and polr
with 1 sd and 2 sd interval bars.
</p>


<h3>Value</h3>

<p>Plot of the coefficients from a bugs, lm or glm fit. You can add the intercept, 
the variable names and the display the result of the fitted model. 
</p>


<h3>Author(s)</h3>

<p>Yu-Sung Su <a href="mailto:suyusung@tsinghua.edu.cn">suyusung@tsinghua.edu.cn</a>
</p>


<h3>References</h3>

<p>Andrew Gelman and Jennifer Hill, 
Data Analysis Using Regression and Multilevel/Hierarchical Models, 
Cambridge University Press, 2006.</p>


<h3>See Also</h3>

<p><code>display</code>,
<code>par</code>,
<code>lm</code>,
<code>glm</code>,
<code>bayesglm</code>,
<code>plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">old.par &lt;- par(no.readonly = TRUE)

 y1 &lt;- rnorm(1000,50,23)
 y2 &lt;- rbinom(1000,1,prob=0.72)
 x1 &lt;- rnorm(1000,50,2) 
 x2 &lt;- rbinom(1000,1,prob=0.63) 
 x3 &lt;- rpois(1000, 2) 
 x4 &lt;- runif(1000,40,100) 
 x5 &lt;- rbeta(1000,2,2) 
 
 longnames &lt;- c("a long name01","a long name02","a long name03",
                "a long name04","a long name05")

 fit1 &lt;- lm(y1 ~ x1 + x2 + x3 + x4 + x5)
 fit2 &lt;- glm(y2 ~ x1 + x2 + x3 + x4 + x5, 
            family=binomial(link="logit"))
 op &lt;- par()
 # plot 1
 par (mfrow=c(2,2))
 coefplot(fit1)
 coefplot(fit2, col.pts="blue")
 
 # plot 2
 longnames &lt;- c("(Intercept)", longnames) 
 coefplot(fit1, longnames, intercept=TRUE, CI=1)
 
 # plot 3
 coefplot(fit2, vertical=FALSE, var.las=1, frame.plot=TRUE)
 
 # plot 4: comparison to show bayesglm works better than glm
 n &lt;- 100
 x1 &lt;- rnorm (n)
 x2 &lt;- rbinom (n, 1, .5)
 b0 &lt;- 1
 b1 &lt;- 1.5
 b2 &lt;- 2
 y &lt;- rbinom (n, 1, invlogit(b0+b1*x1+b2*x2))
 y &lt;- ifelse (x2==1, 1, y)
 x1 &lt;- rescale(x1)
 x2 &lt;- rescale(x2, "center")
 
 M1 &lt;- glm (y ~ x1 + x2, family=binomial(link="logit"))
       display (M1)
 M2 &lt;- bayesglm (y ~ x1 + x2, family=binomial(link="logit"))
       display (M2)

#=================== 
#    stacked plot
#===================
  coefplot(M2, xlim=c(-1,5), intercept=TRUE)
  coefplot(M1, add=TRUE, col.pts="red")
  
#==================== 
# arrayed plot       
#====================
  par(mfrow=c(1,2))
  x.scale &lt;- c(0, 7.5) # fix x.scale for comparison
  coefplot(M1, xlim=x.scale, main="glm", intercept=TRUE)
  coefplot(M2, xlim=x.scale, main="bayesglm", intercept=TRUE)

# plot 5: the ordered logit model from polr
 M3 &lt;- polr(Sat ~ Infl + Type + Cont, weights = Freq, data = housing)
 coefplot(M3, main="polr")
   
 M4 &lt;- bayespolr(Sat ~ Infl + Type + Cont, weights = Freq, data = housing)
 coefplot(M4, main="bayespolr", add=TRUE, col.pts="red")

## plot 6: plot bugs &amp; lmer
# par &lt;- op
# M5 &lt;- lmer(Reaction ~ Days + (1|Subject), sleepstudy)
# M5.sim &lt;- mcsamp(M5)
# coefplot(M5.sim, var.idx=5:22, CI=1, ylim=c(18,1), main="lmer model")


# plot 7: plot coefficients &amp; sds vectors
 coef.vect &lt;- c(0.2, 1.4, 2.3, 0.5)
 sd.vect &lt;- c(0.12, 0.24, 0.23, 0.15)
 longnames &lt;- c("var1", "var2", "var3", "var4")
 coefplot (coef.vect, sd.vect, varnames=longnames, main="Regression Estimates")
 coefplot (coef.vect, sd.vect, varnames=longnames, vertical=FALSE, 
    var.las=1, main="Regression Estimates")
    
par(old.par)
</code></pre>


</div>