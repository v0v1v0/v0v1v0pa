<div class="container">

<table style="width: 100%;"><tr>
<td>logger_level</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Logging related functions</h2>

<h3>Description</h3>

<p>Logger function defined which are created on top of
<code>log_level</code> and <code>layout_json</code> -
these are part of another package <code>'logger'</code>. Additional
capabilities have been added to those functions which enables this function
to be able to send logs directly to the 'Azure Log Analytics' workspace, and
also have control to post log outputs into the console - as per user input.
Note that, logging threshold can be directly set (if needed) using
<code>log_threshold</code> function from <code>'logger'</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logger_level(
  ...,
  log_fields = get_log_config("log_fields"),
  additional_fields = get_log_config("additional_fields"),
  enforce_ascii_msg = get_log_config("enforce_ascii_msg"),
  enforce_tz_utc = get_log_config("enforce_tz_utc"),
  log_to_azure = get_log_config("log_to_azure"),
  log_type = get_log_config("log_type"),
  log_customer_id = Sys.getenv(get_log_config("customer_id_env"), "abcd"),
  log_shared_key = Sys.getenv(get_log_config("shared_key_env"), "abcd")
)

logger_info(...)

logger_error(...)

logger_warn(...)

logger_debug(...)

logger_fatal(...)

logger_success(...)

logger_trace(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Content(s) of this argument is directly passed on to
<code>log_level</code> function of the <code>'logger'</code>
package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_fields</code></td>
<td>
<p>Character vector of field names to be included in the JSON.
These field names are automatically collected by
<code>get_logger_meta_variables</code> function, please refer
to that function's documentation to see which fields are collected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional_fields</code></td>
<td>
<p>A named vector of type list with key-value pairs of
additional meta data which needs to be added in logging context on top of
<code>log_fields</code>. The respective value of each key is expected to be of
length 1. It is <code>NULL</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enforce_ascii_msg</code></td>
<td>
<p>If <code>TRUE</code> (default), the logging message is
guaranteed to have all non-ASCII characters escaped. If <code>FALSE</code>, the
characters will be logged as-is. Please note, it is better to ensure
ASCII, otherwise there might be error while sending the HTTP POST request
to 'Azure Log Analytics' workspace.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enforce_tz_utc</code></td>
<td>
<p>If <code>TRUE</code> (default), the logging time field is
converted to UTC timezone while sending the logging dump to 'Azure Log
Analytics' workspace. If <code>FALSE</code>, then the local time captured by
<code>Sys.time</code> is recorded in the time field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_to_azure</code></td>
<td>
<p>If <code>TRUE</code> (default), then logs will be sent to
'Azure Log Analytics' workspace and console. Else if <code>FALSE</code> then
logs will not be sent to 'Azure Log Analytics' workspace, it will only be
displayed on console, which is the default layout of <code>'logger'</code>
package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_type</code></td>
<td>
<p>Single element character vector is expected. Logs will be
posted to this event on 'Azure Log Analytics'. For details, check this:
<a href="https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-collector-api?tabs=python/">https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-collector-api?tabs=python/</a>
. Default value is <code>"log_from_r"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_customer_id</code></td>
<td>
<p>Workspace ID of 'Azure Log Analytics' workspace. By
default it fetches from the environment variable named <code>AZ_LOG_ID</code>.
If the environment variable is not set, then a dummy value <code>"abcd"</code>
is used. The environment variable's name can be modified by
<code>set_log_config</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_shared_key</code></td>
<td>
<p>Shared key of 'Azure Log Analytics' workspace. By
default it fetches from the environment variable named <code>AZ_LOG_KEY</code>.
If the environment variable is not set, then a dummy value <code>"abcd"</code>
is used. The environment variable's name can be modified by
<code>set_log_config</code></p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p> Most of the arguments of this function have a default value which
is read from the output of <code>get_log_config</code>. The idea is
to run the <code>set_log_config</code> function once to define the
default arguments; and use them automatically while logging anything
without the need of specifying them every time it is triggered.
</p>
</li>
<li>
<p> 'Azure Log Analytics' workspace id and shared key are intentionally
fetched from environment variables for security purpose. It is not
a good practice to specify them explicitly. Using environment variable
is one easy approach to potentially hide it from unintentional user.
</p>
</li>
<li>
<p> It may take ~5â€“10 minutes to see the logging messages on the 'Azure
Log Analytics' portal after the first time a message is posted to a new
custom log table.
</p>
</li>
</ul>
<h3>Value</h3>

<p>If <code>log_to_azure</code> is <code>FALSE</code> then log output is shown on
console. Else, if <code>TRUE</code>, then log output is shown on console, as
well as posted to 'Azure Log Analytics' workspace under the custom table
name as specified by <code>log_type</code> argument. If POST request is
unsuccessful, then additional warning message is thrown with POST request
response. If POST request is successful, then it invisibly returns the
<code>POST</code> object.
</p>


<h3>Note</h3>

<p>Logging layout is set in JSON format, required to send to 'Azure Log
Analytics'. Note that this layout modifies the global <code>namespace</code> of
<code>'logger'</code> package by default - that is not important for this use
case.
</p>
<p><code>logger_info</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>INFO</code> by default.
</p>
<p><code>logger_error</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>ERROR</code> by default.
</p>
<p><code>logger_warn</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>WARN</code> by default.
</p>
<p><code>logger_debug</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>DEBUG</code> by default.
</p>
<p><code>logger_fatal</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>FATAL</code> by default.
</p>
<p><code>logger_success</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>SUCCESS</code> by default.
</p>
<p><code>logger_trace</code> is a wrapper function around
<code>logger_level</code> - logging level is set as
<code>TRACE</code> by default.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define logging config and then use logger_* functions to log
set_log_config(log_to_azure = FALSE)
logger_level(logger::INFO, "logging message")
# Specify other arguments explicitly inside the logger_level function
logger_level(logger::INFO, "logging message", log_to_azure = FALSE)

# For ease, use wrapper functions instead of using `logger_level` function as
# below
logger_info("logging message info", log_to_azure = FALSE)

# Also, instead of writing `log_to_azure = FALSE` every time, set the
# configuration in one step using `set_log_config`, and continue to use
# wrapper functions as usual.
set_log_config(log_to_azure = FALSE)
logger_info("logging message info")

# Wrapper function for log level 'error'
logger_error("logging message error")

# Wrapper function for log level 'warn'
logger_warn("logging message warn")

# Change log threshold to debug
logger::log_threshold(logger::DEBUG)
# Wrapper function for log level 'debug'
logger_debug("logging message debug")

# Wrapper function for log level 'fatal'
logger_fatal("logging message fatal")

# Wrapper function for log level 'success'
logger_success("logging message success")

# Change logging threshold
logger::log_threshold(logger::TRACE)
# Wrapper function for log level 'trace'
logger_trace("logging message trace")

</code></pre>


</div>