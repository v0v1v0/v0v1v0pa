<div class="container">

<table style="width: 100%;"><tr>
<td>snpzip</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identification of structural SNPs</h2>

<h3>Description</h3>

<p>The function <code>snpzip</code> identifies the set of alleles which contribute most
significantly to phenotypic structure.
</p>
<p>This procedure uses Discriminant Analysis of Principal Components (DAPC)
to quantify the contribution of individual alleles to between-population
structure. Then, defining contribution to DAPC as the measure of distance
between alleles, hierarchical clustering is used to identify two groups
of alleles: structural SNPs and non-structural SNPs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  snpzip(snps, y, plot = TRUE, xval.plot = FALSE, loading.plot = FALSE,
         method = c("complete", "single", "average", "centroid", 
                    "mcquitty", "median", "ward"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>snps</code></td>
<td>
<p>a snps <code>matrix</code> used as input of DAPC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>either a <code>factor</code> indicating the group membership of individuals, 
or a dapc object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a <code>logical</code> indicating whether a graphical representation of the 
DAPC results should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xval.plot</code></td>
<td>
<p>a <code>logical</code> indicating whether the results of the 
cross-validation step should be displayed (iff <code>y</code> is a factor).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loading.plot</code></td>
<td>
<p>a <code>logical</code> indicating whether a loading.plot displaying 
the SNP selection threshold should be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the clustering method to be used. This should be 
(an unambiguous abbreviation of) one of <code>"complete", "single", "average", 
                                                              "centroid", "mcquitty", "median",</code> or <code>"ward"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>snpzip</code> provides an objective procedure to delineate between structural 
and non-structural SNPs identified by Discriminant Analysis of Principal Components 
(DAPC, Jombart et al. 2010). 
<code>snpzip</code> precedes the multivariate analysis with a cross-validation step 
to ensure that the subsequent DAPC is performed optimally.
The contributions of alleles to the DAPC are then submitted to <code>hclust</code>, 
where they define a distance matrix upon which hierarchical clustering is carried out.
To complete the procedure, <code>snpzip</code> uses <code>cutree</code> to automatically 
subdivide the set of SNPs fed into the analysis into two groups: 
those which contribute significantly to the phenotypic structure of interest, 
and those which do not.   
</p>


<h3>Value</h3>

<p>A <code>list</code> with four items if <code>y</code> is a factor, or two items if
<code>y</code> is a dapc object: 
The first cites the number of principal components (PCs) of PCA retained in the DAPC. 
</p>
<p>The second item is an embedded list which
first indicates the number of structural and non-structural SNPs identified by 
<code>snpzip</code>, second provides a list of the structuring alleles, third
gives the names of the selected alleles, and fourth details the 
contributions of these structuring alleles to the DAPC.
</p>
<p>The optional third item provides measures of discrimination success both overall 
and by group.
</p>
<p>The optional fourth item contains the dapc object generated if <code>y</code> was a factor.
</p>
<p>If <code>plot=TRUE</code>, a scatter plot will provide a visualization of the DAPC results.
</p>
<p>If <code>xval.plot=TRUE</code>, the results of the cross-validation step will be displayed 
as an <code>array</code> of the format generated by xvalDapc, and a scatter plot of 
the results of cross-validation will be provided.   
</p>
<p>If <code>loading.plot=TRUE</code>, a loading plot will be generated to show the 
contributions of alleles to the DAPC, and the SNP selection threshold will be indicated.
If the number of Discriminant Axes (<code>n.da</code>) in the DAPC is greater than 1, 
<code>loading.plot=TRUE</code> will generate one loading plot for each discriminant axis.
</p>


<h3>Author(s)</h3>

<p> Caitlin Collins <a href="mailto:caitlin.collins12@imperial.ac.uk">caitlin.collins12@imperial.ac.uk</a> </p>


<h3>References</h3>

<p>Jombart T, Devillard S and Balloux F (2010) Discriminant analysis of principal 
components: a new method for the analysis of genetically structured populations. 
BMC Genetics11:94. doi:10.1186/1471-2156-11-94
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
    simpop &lt;- glSim(100, 10000, n.snp.struc = 10, grp.size = c(0.3,0.7), 
                    LD = FALSE, alpha = 0.4, k = 4)
    snps &lt;- as.matrix(simpop)
    phen &lt;- simpop@pop
    
    outcome &lt;- snpzip(snps, phen, method = "centroid")
    outcome
  
## End(Not run)
  ## Not run: 
    simpop &lt;- glSim(100, 10000, n.snp.struc = 10, grp.size = c(0.3,0.7), 
                    LD = FALSE, alpha = 0.4, k = 4)
    snps &lt;- as.matrix(simpop)
    phen &lt;- simpop@pop
    
    dapc1 &lt;- dapc(snps, phen, n.da = 1, n.pca = 30)
    
    features &lt;- snpzip(dapc1, loading.plot = TRUE, method = "average")
    features
  
## End(Not run)
</code></pre>


</div>