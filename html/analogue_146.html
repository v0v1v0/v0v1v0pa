<div class="container">

<table style="width: 100%;"><tr>
<td>timetrack</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Timetracks of change in species composition</h2>

<h3>Description</h3>

<p>Project passive (e.g. sediment core) samples into an ordination of a
set of training samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">timetrack(X, passive, env, method = c("cca", "rda"),
          transform = "none", formula, scaling = 3,
          rank = "full", join = "left", correlation = FALSE,
          hill = FALSE, ...)

## S3 method for class 'timetrack'
fitted(object, which = c("passive", "ordination"),
       model = NULL, choices = 1:2, ...)

## S3 method for class 'timetrack'
predict(object, newdata, ...)

## S3 method for class 'timetrack'
scores(x, which = c("ordination", "passive"),
       scaling = x$scaling, choices = 1:2, display = "sites", ...)

## S3 method for class 'timetrack'
plot(x, choices = 1:2, display = c("wa", "lc"),
     order, type = c("p", "n"), ptype = c("l", "p", "o", "b", "n"),
     pch = c(1,2), col = c("black","red"), lty = "solid", lwd = 1,
     xlim = NULL, ylim = NULL, ...)

## S3 method for class 'timetrack'
points(x, choices = 1:2, which = c("passive", "ordination"),
       display = c("wa","lc"), order, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix-like object containing the training set or reference
samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>passive</code></td>
<td>
<p>matrix-like object containing the samples to be
projected into the ordination of <code>X</code>. Usually a set of sediment
core samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>optional data frame of environmental or constraining
variables. If provided, a constrained ordination of <code>X</code> is
performed. If <code>formula</code> is supplied variables named in
<code>formula</code> are looked up with <code>env</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character, resolving to an ordination function available
in <span class="pkg">vegan</span>. Currently only <code>"cca"</code>, the default, and
<code>"rda"</code> are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>character; the name of the transformation to apply to
both <code>X</code> and <code>passive</code>. The transformations are performed
using <code>tran</code> and valid options are given by that function's
<code>method</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a one-sided model formula; if provided, it defines the
right hand side of the model formula for the ordination function and
is supplied as argument <code>formula</code> to the ordination
function. E.g.~<code>formula = ~ var1 + var2</code>. If supplied then
<code>env</code> must also be supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>numeric or character; the ordination scaling to
apply. Useful options are likely to be <code>1</code> or <code>3</code> where
the focus is on the samples. For <code>character</code>, see options in
<code>scores.cca</code>: character version of the useful
scalings are <code>"sites"</code> and <code>"symmetric"</code>. See arguments
<code>correlation</code> and <code>hill</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation, hill</code></td>
<td>
<p>logical; additional arguments passed to
<code>predict.cca</code> and
<code>predict.rda</code>. See <code>scores.cca</code>
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>character; see argument of same name in function
<code>predict.cca</code> or
<code>predict.rda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>join</code></td>
<td>
<p>character; the tpe of join to perform. See
<code>join</code> for details of possible choices, but the default,
<code>"left"</code> is most generally applicable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>an object of class <code>"timetrack"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>character; which fitted values should be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>character; which ordination component should be used for
the fitted values; the constrained or unconstrained part? See
<code>fitted.cca</code> for details, but essentially, one of
<code>"CCA"</code> for the constrained part and <code>"CA"</code> for the
unconstrained part. If <code>NULL</code>, the default, <code>"CA"</code> is used
unless the underlying ordination was constrained, in which case
<code>"CCA"</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choices</code></td>
<td>
<p>numeric; the length-2 vector of ordination axes to
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data frame of new observations for which locations in
the plot (or a timetrack) are required. This need not have exactly
the same set of species as the fitted ordination as internally only
those species in <code>newdata</code> that were included in the data used
for the ordination will be retained. In addition, if a
transformation was applied to the species data used to fit the
ordination, the same transformation will be automatically applied to
<code>newdata</code> using <code>tran</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>character; which type of sites scores to display? See
<code>scores.cca</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>numeric; vector of indices to use to reorder the passive
samples. Useful to get passive samples into temporal order for
plotting with a line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character; the type of plotting required for the training
set samples. Options are <code>"p"</code> for points or <code>"n"</code> to not
draw training set samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptype</code></td>
<td>
<p>character; controls how the time track should be
drawn. Default is draw the passive samples connected by a line in
the order in which they appear in the data. With <code>ptype = "p"</code>
no line is drawn. The other types have their usual meaning from
<code>plot.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>The length-2 vector of plotting characters. The first
element is used for the ordination samples, the second for the
passive samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>The length-2 vector of plotting colours. The first
element is used for the ordination samples, the second for the
passive samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>graphical parameters for the plotted time track for
<code>ptype != "p"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>user specified axis limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods.
<code>timetrack</code> passes arguments on to <code>tran</code> and the
ordination function given in <code>method</code>. <code>fitted</code> passes
arguments on to other <code>fitted</code> methods as
appropriate. <code>plot</code> passes arguments on to the underlying
plotting functions. <code>predict</code> passes arguments on to
<code>tran</code> for use in applyign the transformation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The timetrack is a way to visualise changes in species composition
from sediment core samples within an underlying reference ordination
or, usually, training set samples. This technique has been most often
applied in situations where the underlying ordination is a constrained
ordination and thence the timetrack of sediment core samples within
the ordination reflects both the change in species composition and the
indicative changes in the constraining variables.
</p>
<p>The sediment core samples are projected passively into the underlying
ordination. By projected passively, the locations of the core samples
are predicted on the basis of the ordination species scores. A common
set of species (columns) is required to passively place the sediment
samples into the ordination. To achieve this, the left outer join of
the species compositions of the training set and passive set
is determined; the left outer join results in the passive data matrix
having the same set of species (variables; columns) as the training
set. Any training set species not in the passive set are added to
the passive set with abundance 0. Any passive species not in the
training set are removed from the passive set.
</p>


<h3>Value</h3>

<p>The <code>plot</code> method results in a plot on the currently active
device, whilst the <code>fitted</code> and <code>scores</code> methods return the
matrix of fitted locations on the set of ordination axes.
</p>
<p><code>timetrack</code> returns an object of class <code>"timetrack"</code>, a list
with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ordination </code></td>
<td>
<p>the ordination object, the result of the call to
the function of the name <code>method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values </code></td>
<td>
<p>the matrix of fitted locations for the passive
samples on the ordination axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>the ordination function used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula </code></td>
<td>
<p>if supplied, the model formula used to define the
ordination model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling </code></td>
<td>
<p>the ordination scaling applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank </code></td>
<td>
<p>The rank or the number of axes used in the
approximation. The default is to use all axes (full rank) of the
<code>"model"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model </code></td>
<td>
<p>Show constrained (<code>"CCA"</code>) or unconstrained
(<code>"CA"</code>) results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels </code></td>
<td>
<p>a list of names for the <code>X</code>, <code>passive</code>, and
<code>env</code> arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>The training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>The transformation applied, if any.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>See Also</h3>

<p><code>cca</code> and <code>rda</code> for the
underlying ordination functions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load the RLGH and SWAP data sets
data(rlgh, swapdiat)

## Fit the timetrack ordination
mod &lt;- timetrack(swapdiat, rlgh, transform = "hellinger",
                 method = "rda")
mod

## Plot the timetrack
plot(mod, ptype = "b", col = c("forestgreen", "orange"), lwd = 2)

## Other options (reorder the time track)
ord &lt;- rev(seq_len(nrow(rlgh)))
plot(mod, choices = 2:3, order = ord, ptype = "b",
     col = c("forestgreen", "orange"), lwd = 2)

## illustrating use of the formula
data(swappH)
mod2 &lt;- timetrack(swapdiat, rlgh, env = data.frame(pH = swappH),
                  transform = "hellinger", method = "rda",
                  formula = ~ pH)
mod2
plot(mod2)

## scores and fitted methods
## IGNORE_RDIFF_BEGIN
head(fitted(mod, type = "passive"))
head(scores(mod, type = "passive"))
## IGNORE_RDIFF_END

## predict locations in timetrack for new observations
take &lt;- rlgh[1:50, ]
take &lt;- take[ , colSums(take) &gt; 0]
mod3 &lt;- predict(mod, newdata = take)
class(mod3) ## returns a timetrack object
take &lt;- rlgh[-(1:50), ]
take &lt;- take[ , colSums(take) &gt; 0]
mod4 &lt;- predict(mod, newdata = take)

## build a plot up from base parts
plot(mod, type = "n", ptype = "n")
points(mod, which = "ordination", col = "grey", pch = 19, cex = 0.7)
points(mod3, which = "passive", col = "red")
points(mod4, which = "passive", col = "blue")

## Fit the timetrack ordination - passing scaling args
mod &lt;- timetrack(swapdiat, rlgh, transform = "hellinger",
                 method = "rda", scaling = "sites",
                 correlation = TRUE)
mod
plot(mod)

</code></pre>


</div>