<div class="container">

<table style="width: 100%;"><tr>
<td>nll_basic_logscale</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative log-likelihood function: basic model on logscale</h2>

<h3>Description</h3>

<p>Function returning the negative log-likelihood (nll) for the 'basic' relative
survival model, given the functions' parameters and the observed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nll_basic_logscale(
  a1 = a1,
  b1 = b1,
  a2 = a2,
  b2 = b2,
  data = data,
  time = time,
  censor = censor,
  infected_treatment = infected_treatment,
  d1 = "Weibull",
  d2 = "Weibull"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a1, b1</code></td>
<td>
<p>location and scale parameters for background mortality
on a logscale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2, b2</code></td>
<td>
<p>location and scale parameters for mortality due to infection
on a logscale</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of data frame containing survival data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>name of data frame column identifying time of event; time &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>name of data frame column identifying if event was death (0) or
right-censoring (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infected_treatment</code></td>
<td>
<p>name of data frame column identifying if data are
from an infected (1) or uninfected (0) treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1, d2</code></td>
<td>
<p>names of probability distributions describing background
mortality and mortality due to infection, respectively; both default to the
Weibull distribution</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By deafult, this function takes arguments for location and scale parameters
named; a1, b1, a2, b2. These parameters are components of survival functions
describing patterns of background mortality and mortality due to infection.
The particular form of these survival functions depends on the probability
distributions chosen to describe each source of mortality; d1, d2. The
function also takes arguments directing it to the data to be analysed and how
they are labelled; data, time, censor, etc.
</p>
<p>The nll returned by the function depends on the numerical values of the
location and scale parameters, which determine how well the likelihood model
describes the observed data. Maximum likelihood estimation functions, e.g.,
<code>mle2</code> of the package <code>bbmle</code>, can be used find values of the
location and scale parameters minimising the model's nll. The resulting
maximum likelihood estimates can be used to describe host mortality due to
background mortality and mortality due to infection, including the pathogen's
virulence.
</p>
<p>The model assumes all the individuals in the infected population are
infected. It is also assumes infections are homogeneous, i.e., each
infection has the same influence on host survival. Consequently a single
hazard function, with a single pair of values for its location and scale
parameters, can be used to describe the pattern of mortality due to infection
for the infected population as a whole.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># prepare subset of 'data_blanford'; treatments 'cont' and 'Bb06' of Block 3

  data01 &lt;- subset(data_blanford,
    (data_blanford$block == 3) &amp; (
      (data_blanford$treatment == 'cont') |
         (data_blanford$treatment == 'Bb06')) &amp;
           (data_blanford$day &gt; 0))

 head(data01, 4)

# step #1: 'prep function' linking 'nll_basic' to data
  # and identifying parameters to estimate
    m01_prep_function &lt;- function(a1 = a1, b1 = b1, a2 = a2, b2 = b2){
      nll_basic_logscale(
        a1 = a1, b1 = b1, a2 = a2, b2 = b2,
        data = data01,
        time = t,
        censor = censor,
        infected_treatment = inf,
        d1 = 'Weibull', d2 = 'Weibull')
        }

# step #2: send 'prep_function' to mle2 for maximum likelihood estimation with
        #  starting values specified
    m01 &lt;- mle2(m01_prep_function,
             start = list(a1 = 1, b1 = 1, a2 = 1, b2 = 1)
             )

    summary(m01)

</code></pre>


</div>