<div class="container">

<table style="width: 100%;"><tr>
<td>simNmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate data for binomial and multinomial mixture models
</h2>

<h3>Description</h3>

<p>This very general function generates single-season count data under variants of the binomial N-mixture model of Royle (2004) and of the multinomial N-mixture model of Royle et al (2007).
</p>


<h3>Usage</h3>

<pre><code class="language-R">simNmix(nsites = 267, nvisits = 3, mean.theta = 1, mean.lam = 2, mean.p = 0.6,
  area = FALSE, beta1.theta = 0, beta2.theta = 0, beta3.theta = 0,
  beta2.lam = 0, beta3.lam = 0, beta4.lam = 0, beta3.p = 0, beta5.p = 0,
  beta6.p = 0, beta.p.survey = 0, beta.p.N = 0, sigma.lam = 0, dispersion = 10,
  sigma.p.site = 0, sigma.p.visit = 0, sigma.p.survey = 0, sigma.p.ind = 0,
  Neg.Bin = FALSE, open.N = FALSE, show.plots = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsites</code></td>
<td>

<p>number of sites
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvisits</code></td>
<td>

<p>number of visits per site
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.theta</code></td>
<td>

<p>proportion of sites that can have non-zero abundance in principle: suitability model for zero-inflation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lam</code></td>
<td>

<p>Expected abundance at the average value of all abundance covariates (and ignoring random site effects): abundance model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.p</code></td>
<td>

<p>Expected detection at the average value of all detection covariates (and ignoring all random effects): detection model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>

<p>determines area of sites (A), defaults to A=1 (i.e., all identical), but you can supply a vector of site areas of length nsites instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta1.theta</code></td>
<td>

<p>coefficient of site covariate 1 in suitability model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta2.theta</code></td>
<td>

<p>coefficient of site covariate 2 in suitability model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta3.theta</code></td>
<td>

<p>coefficient of site covariate 3 in suitability model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta2.lam</code></td>
<td>

<p>coefficient of site covariate 2 in abundance model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta3.lam</code></td>
<td>

<p>coefficient of site covariate 3 in abundance model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta4.lam</code></td>
<td>

<p>coefficient of site covariate 4 in abundance model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta3.p</code></td>
<td>

<p>coefficient of site covariate 3 in detection model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta5.p</code></td>
<td>

<p>coefficient of site covariate 5 in detection model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta6.p</code></td>
<td>

<p>coefficient of site covariate 6 in detection model
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p.survey</code></td>
<td>

<p>coefficient of survey ('observational') covariate on p
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p.N</code></td>
<td>

<p>coefficient of centered local population size (log(N+1)) in detection model (i.e., coef. for density-dependent detection prob.)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.lam</code></td>
<td>

<p>"Overdispersion SD" in linear predictor of abundance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersion</code></td>
<td>

<p>'size' or extra-Poisson dispersion of Negative binomial
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.p.site</code></td>
<td>

<p>"Overdispersion SD" in linear predictor of detection coming from random site effects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.p.visit</code></td>
<td>

<p>"Overdispersion SD" in linear predictor of detection coming from random visit effects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.p.survey</code></td>
<td>

<p>"Overdispersion SD" in linear predictor of detection coming from random site-by-survey effects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.p.ind</code></td>
<td>

<p>"Overdispersion SD" in linear predictor of detection coming from random site-by-individual effects
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Neg.Bin</code></td>
<td>

<p>if FALSE, any overdispersion in abundance is modeled by a Poisson log-normal; if TRUE, abundance overdispersion is modeled by adoption of a Negative binomial distribution for latent N
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>open.N</code></td>
<td>

<p>if TRUE, data are simulated under one specific form of an open population, where N in the first occasion is drawn from the specified mixture distribution and for all further occasions j, we have  N_ij ~ Poisson(N_i(j-1)). With open.N = TRUE, we must have sigma.p.ind = 0, show.plot = FALSE and nvisits &gt;1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plots</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are simulated at the level of each individual and individual-specific detection heterogeneity can be included. As a side-effect, individual-specific detection histories are generated and hence, data are also be simulated under the corresponding multinomial N-mixture model.
</p>
<p>Broadly, the function can generate data under this most general model:
</p>
<p>'Suitability' (zero-inflation) ~ cov1 + cov2 + cov3
</p>
<p>Abundance ~ offset + cov2 + cov3 + cov4 + overdispersion
</p>
<p>Detection ~ cov3 + cov5 + cov6 + survey.covariate + log(N+1) + eps.site + eps.visit + eps.survey + eps.individual
</p>
<p>Overdispersion in abundance is modeled either as a Poisson-log-normal with a normal random site effect in lambda or with a Negative binomial with mean lambda and a 'size', or dispersion, parameter. Variable site areas can be specified to affect abundance as in an offset.
</p>
<p>Abundance can be zero-inflated (this is the 'suitability' model). Note that the zero-inflation parameter is called theta here (in unmarked it is called psi). mean.phi is the probability that a site is suitable (i.e., 1 minus the expected proportion of sites with structural zero abundance.
</p>
<p>Site covariate 2 can affect both suitability and abundance, while covariate 3 may affect all three levels. Hence, the function permits to simulate the case where a single site covariate affects different levels in the process (e.g., abundance and detection) in opposing directions (as for instance in Kéry, 2008)
</p>
<p>Density-dependent detection can be modeled as a logistic-linear effect of local abundance (centered and log(x+1) transformed). Overdispersion in detection is modeled via normal random effects (the eps terms above) specific to sites, visits, surveys or individuals.
</p>
<p>Effects of covariates and random-effects factors are modeled as additive on the link scale (log for abundance and logit for suitability and detection).
</p>
<p>Data may be generated under one specific open-population model when argument 'open.N' is set to TRUE.
</p>


<h3>Value</h3>

<p>A list with the arguments input and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nobs </code></td>
<td>
<p>The total number of visits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site.cov </code></td>
<td>
<p>An nsites x 6 matrix of values for 6 site covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survey.cov </code></td>
<td>
<p>An nsites x nvisits matrix of values for a survey covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.lam </code></td>
<td>
<p>Linear predictor of PLN abundance model including random effects, a vector of length nsites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s </code></td>
<td>
<p>Site suitability indicator, a vector of length nsites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>Number of individuals at each site, a vector of length nsites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>Probability of detection, an array with dimensions sites occupied x visits x max(N)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DH </code></td>
<td>
<p>Detection history (1/0), an array with dimensions sites occupied x visits x max(N)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.open </code></td>
<td>
<p>Number of individuals at each site for open model, a sites x visits matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C </code></td>
<td>
<p>Summary of DH: number of individuals detected for each site and visit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.lam </code></td>
<td>
<p>Random site effects in lambda, a vector of length nsites, zero if Neg.Bin == TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.p.site </code></td>
<td>
<p>Random site effects in p, a vector of length nsites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.p.visit </code></td>
<td>
<p>Random visit effects in p, a vector of length nvisits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.p.survey </code></td>
<td>
<p>Random survey (= site-by-survey) effects in p, a nsites x nvisits matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta.p.ind </code></td>
<td>
<p>Random individual (= site-by-ind) effects in p (NOT site-ind-visit !), a nsites x max(N) matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odcN </code></td>
<td>
<p>Naive overdispersion measure (var/mean) for true abundance (N)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odcC </code></td>
<td>
<p>Naive overdispersion measure (var/mean) for observed counts (C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal </code></td>
<td>
<p>Total abundance summed over all sites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summax </code></td>
<td>
<p>The sum of maximum counts over all sites</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Royle, J.A. (2004) N-mixture models for estimating population size from spatially replicated counts. <em>Biometrics</em>, 60, 108-115.
</p>
<p>Royle, J.A., et al (2007) Hierarchical spatial models of abundance and occurrence from imperfect survey data. <em>Ecological Monographs</em>, 77, 465-481.
</p>
<p>Kéry, M. (2008) Estimating abundance from bird counts: binomial mixture models uncover complex covariate relationships, <em>Auk</em>, 125, 336-345
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.5.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data with the default arguments and look at the structure:
tmp &lt;- simNmix()
str(tmp)


str(data &lt;- simNmix())                  # Null data-generating model
str(data &lt;- simNmix(mean.theta = 0.60)) # ZIP with 40% structural zeroes
str(data &lt;- simNmix(sigma.lam = 1))     # Poisson-lognormal (PLN) mixture
str(data &lt;- simNmix(Neg.Bin = TRUE))    # Negative-binomial mixture
str(data &lt;- simNmix(mean.theta = 0.6, sigma.lam = 1))  # Zero-inflated PLN
str(data &lt;- simNmix(mean.theta = 0.6, Neg.Bin = TRUE)) # Zero-infl. NegBin
str(data &lt;- simNmix(mean.p = 1))        # Perfect detection (p = 1)
str(data &lt;- simNmix(mean.theta = 0.6, mean.p = 1))     # ZIP with p = 1
str(data &lt;- simNmix(sigma.lam = 1, mean.p = 1))        # PLN with p = 1

</code></pre>


</div>