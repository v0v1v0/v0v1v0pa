<div class="container">

<table style="width: 100%;"><tr>
<td>aSPUr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Sum of powered score (SPU) tests and aSPU test for a quantitative trait</h2>

<h3>Description</h3>

<p>The test is based on the Huber loss function and using the parametric
bootstrap for inference (i.e. bootstrapping residuals).
</p>


<h3>Usage</h3>

<pre><code class="language-R">aSPUr(Y, X, cov = NULL, pow = c(1:8, Inf), B = 1000, C = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector of quantitative traits (QTs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Genotype or other data; each row for a subject, and each column
for an SNP (or a predictor). The value of each SNP is the # of the copies
for an allele. A matrix with dimension n by k (n : number of observation, k : number of SNPs (or predictors) ).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>Covariates. A matrix with dimension n by k2 (n :number of observation, k2 : number of covariates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>power used in SPUr test. A vector of the powers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstraps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Constant in huber loss function. C = 1.345 is chosen to maintain a high efficiency for a Normal error.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>p-values of the SPUr tests in the order of supplied pow values; finally, the p-value of the aSPUr test (that combines the SPUs tests with pow by taking their min P-value and adjust for multiple testing).
</p>


<h3>Author(s)</h3>

<p>Yiwei Zhang and Wei Pan
</p>


<h3>References</h3>

<p>Peng Wei, Ying Cao, Yiwei Zhang, Zhiyuan Xu, Il-Youp Kwak, Eric Boerwinkle, Wei Pan (2016) On Robust Association Testing for Quantitative Traits and Rare Variants, G3, 6(12) 3941-3950.
</p>


<h3>See Also</h3>

<p><code>aSPU</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

data(exdat)

## example analysis using aSPU test on exdat data.

QT &lt;- jitter(exdat$Y)

out &lt;- aSPUr(Y = QT, X = exdat$X, cov = NULL, B = 100)
out
## This is a vector of p-values for SPUr and aSPUr tests.
## SPU1 to SPUInf corresponds with the option pow=c(1:8, Inf)
## They are p-values for corresponding SPUr tests.
## The last element is p-value of aSPUr test.

</code></pre>


</div>