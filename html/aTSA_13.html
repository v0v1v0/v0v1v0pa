<div class="container">

<table style="width: 100%;"><tr>
<td>MA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moving Average Filter</h2>

<h3>Description</h3>

<p>Applies moving average filter to estimate the linear trend or
nonseasonal pattern.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MA(x, nlag = NULL, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector or univariate time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag</code></td>
<td>
<p>the number of period to calculate the average. The default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value indicating to print out the plot. The default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The moving average filter uses the unweight mean of (2*<code>nlag</code> + 1) adjacent
observations. That is,
</p>
<p style="text-align: center;"><code class="reqn">hat{X}[t] = (X[t - nlag] + ... + X[t] + ...+ X[t + nlag])/(2*nlag + 1)</code>
</p>

<p>for <code class="reqn">nlag &lt; t &lt; n - nlag</code>.
For the values at the boundary <code class="reqn">t \le nlag</code> or <code class="reqn">n - nlag \le t \le n</code>, you can
refer to Equation (7) in Qiu <em>et al.,</em> (2013) for details of calculations.
The default method for choosing the optimal <code>nlag</code> uses the rule-of-thumb
criterion proposed by Qiu, <em>et al</em>., (2013), in which they showed that the moving
average
is a special case of local linear estimator in the sense that the kernel function is the
uniform one, and the moving average period <code>nlag</code> is a function of bandwidth. Thus,
choosing the optimal <code>nlag</code> is equivalent to choosing the optimal bandwidth in local
linear regression.
</p>
<p>The plot of original values v.s fitted values will be displayed if <code>plot = TRUE</code>.
</p>


<h3>Value</h3>

<p>A list with class "<code>MA</code>" containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the smoothed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlag</code></td>
<td>
<p>the period used to compute the average.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accurate</code></td>
<td>
<p>the accurate measurements.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Debin Qiu
</p>


<h3>References</h3>

<p>D. Qiu, Q. Shao, and L. Yang (2013), Efficient inference for autoregressive
coefficient in the presence of trend. <em>Journal of Multivariate Analysis</em>
114, 40-53.
</p>
<p>P.J. Brockwell, R.A. Davis, Time Series: Theory and Methods, second ed.,
Springer, New York, 1991.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- arima.sim(list(order = c(1,0,0),ar = 0.4),n = 100)
y &lt;- 5*(1:100)/100 + x
MA(y)

# moving average filter for co2 data
MA(co2)
</code></pre>


</div>