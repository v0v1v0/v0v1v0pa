<div class="container">

<table style="width: 100%;"><tr>
<td>ME_correction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correction of Measurement Error in Survival time and Censoring Status.</h2>

<h3>Description</h3>

<p>This function aims to correct for measurement error in survival time and
misclassification in censoring status. The key strategy in the function <code>ME_correction</code> includes regression
calibration for survival time under additive measurement error models and the unbiased conditional expectation
approach for censoring status under misclassification models. With information of parameters in measurement error
models implemented, this function will give outputs with corrected survival time and censoring status.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ME_correction(
  pi_10,
  pi_01,
  gamma0,
  gamma1,
  cor_covar,
  indicator,
  yast,
  covariate
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi_10</code></td>
<td>
<p>Misclassifcation probability is P(Observed Censoring Status = 1 | Actual Censoring Status = 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi_01</code></td>
<td>
<p>Misclassifcation probability is P(Observed Censoring Status = 0| Actual Censoring Status = 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma0</code></td>
<td>
<p>A scalar that links the observed survival time and true survival time in the classical additive
measurement error model <code>y*=y+gamma0+gamma1*X+v</code>, where <code>y*</code>
is observed survival time and <code>y</code> is true survival time, and <code>x</code> is covariates and <code>v</code> is noise
term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma1</code></td>
<td>
<p>A <code>p</code>-dimensional vector of parameters in the additive
measurement error model <code>y*=y+gamma0+gamma1*X+v</code>, where <code>y*</code> is observed
survival time and <code>y</code> is true survival time, <code>x</code> is covariates and <code>v</code> is
noise term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_covar</code></td>
<td>
<p>A <code>c(p,p)</code> covariance matrix of a <code>p</code>-dimensional vector of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicator</code></td>
<td>
<p>A <code>n</code>-dimensional vector of misclassified censoring status, such as the second column generated
by the function <code>gen_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yast</code></td>
<td>
<p>A <code>n</code>-dimensional vector of error-prone survival time, such as the first column
generated by the function <code>gen_data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>A <code>c(n,p)</code> matrix of covariates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>correction_data A <code>c(n,2)</code> data frame. This first column is the corrected survival time, and the
second column is the corrected censoring indicator.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate data with misclassification = 0.9 with n = 500,
## p = 50 and variance of noise term is 0.75. The y* is related
## to the first covariate.

a &lt;- matrix(0,ncol=50, nrow = 1);a[1,1] &lt;- 1
data &lt;- data_gen(n=500, p=50, pi_01 = 0.9, pi_10 = 0.9,
gamma0=1, gamma1=a, e_var=0.75)

## Assume that covariates are independent and
## observed survival time is related to first covariate with
## weight equals 1. And the scalar in the classical additive
## measurement error model is 1 and is classifcation probability = 0.9.

matrixa &lt;- diag(50)
gamma_0 &lt;-  1 ; gamma_1 &lt;- matrix(0,ncol=50, nrow =1); gamma_1[1,1] &lt;- 1
corrected_data1 &lt;- ME_correction(pi_10=0.9,pi_01=0.9,gamma0 = gamma_0,
gamma1 = gamma_1,
cor_covar=matrixa, y=data[,1],
indicator=data[,2], covariate = data[,3:52])

</code></pre>


</div>