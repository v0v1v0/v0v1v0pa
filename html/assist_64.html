<div class="container">

<table style="width: 100%;"><tr>
<td>snm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a Semi-parametric Nonlinear Mixed-effects Model
</h2>

<h3>Description</h3>

<p>This generic function fits a semi-paramteric nonlinear mixed-effects model 
in the formulation described in Ke and Wang (2001). Current version only allows linear dependence on non-parametric 
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">snm(formula, func, data=list(), fixed, random=fixed, 
groups, start, spar="v", verbose=FALSE, method="REML", control=NULL, 
correlation=NULL, weights=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a formula object, with the response on the left of a ~ operator, and an expression 
of variables, parameters and non-parametric functions on the right.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func</code></td>
<td>

<p>a list of spline formulae each specifying the spline components necessary to 
estimate each non-parametric function. On the left of a <code class="reqn">\mbox{\textasciitilde}</code> operator of each component 
is the unknow function symbol(s) as well as its arguments, while the right side is a 
list of two components <code>nb</code>, an optional one-side formula for representing the null 
space's bases, and a required <code>rk</code> structure. <code>nb</code> and <code>rk</code> are similar to <code>formula</code> 
and <code>rk</code> in ssr. A missing <code>nb</code> denotes an empty null space. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>

<p>a two-sided formula specifying models for the fixed effects.
The syntax of <code>fixed</code> in <code>nlme</code> is adopted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>a numeric vector, the same length as the number of fixed effects, supplying starting
values for the fixed effects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spar</code></td>
<td>

<p>a character string specifying a method for choosing the smoothing parameter. "v", "m" and "u" represent  GCV, GML and
UBR respectively. Default is "v" for GCV.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An optional data frame containing the variables appearing in <code>formula</code>
, <code>random</code>, <code>rk</code>, <code>correlation</code>, <code>weights</code>. By default, the variables 
are taken from the environment from which <code>snm</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>an optional random effects structure specifying models for the random effects.
The same syntax of <code>random</code> in <code>nlme</code> is assumed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>

<p>an optional one-sided formula of the form ~g1 (single level) or ~g1/.../gQ 
(multiple levels of nesting), specifying the partitions of the data over 
which the random effects vary. g1,...,gQ must evaluate to factors in data. 
See nlme for details.	 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>an optional logical numerical value. If <code>TRUE</code>, information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string. If 'REML' the model is fit by maximizing the restricted 
log-likelihood. If 'ML' the log-likelihood is maximized. Default is 'REML. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters to control the performance of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>

<p>an optional <code>corStruct</code> object describing the within-group correlation 
structure. See the documentation of corClasses for a description of the available corStruct classes. 
Default is NULL, corresponding to no within-in group correlations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>an optional <code>varFunc</code> object or one-sided formula describing the 
within-group heteroscedasticity structure. If given as a formula, 
it is used as the argument to <code>varFixed</code>, corresponding to fixed variance weights. 
See the documentation on varClasses for a description of the available varFunc 
classes. Defaults to NULL, corresponding to homoscesdatic within-group errors.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>snm</code> is returned, representing a semi-parametric nonlinear
mixed effects model fit. Generic functions such as print, summary, predict and
intervals have methods to show the results of the fit.
</p>


<h3>Author(s)</h3>

<p>Chunlei Ke <a href="mailto:chunlei_ke@yahoo.com">chunlei_ke@yahoo.com</a> and Yuedong Wang <a href="mailto:yuedong@pstat.ucsb.edu">yuedong@pstat.ucsb.edu</a>.</p>


<h3>References</h3>

<p>Ke, C. and Wang, Y. (2001). Semi-parametric Nonlinear Mixed Effects Models and
Their Applications. JASA 96:1272-1298.
</p>
<p>Pinheiro, J.C. and Bates, D. M. (2000). Mixed-Effects Models in S
and S-PLUS. Springer.
</p>


<h3>See Also</h3>

<p><code>predict.snm</code>, <code>intervals.snm</code>, <code>snm.control</code>,
<code>print.snm</code>,<code>summary.snm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(CO2)

options(contrasts=rep("contr.treatment", 2))	
co2.fit1 &lt;- nlme(uptake~exp(a1)*(1-exp(-exp(a2)*(conc-a3))), 
                 fixed=list(a1+a2~Type*Treatment,a3~1), 
                 random=a1~1, groups=~Plant, 
                 start=c(log(30),0,0,0,log(0.01),0,0,0,50),
                 data=CO2)

M &lt;- model.matrix(~Type*Treatment, data=CO2)[,-1]
co2.fit2 &lt;- snm(uptake~exp(a1)*f(exp(a2)*(conc-a3)),
                func=f(u)~list(~I(1-exp(-u))-1,lspline(u, type="exp")),
                fixed=list(a1~M-1,a3~1,a2~Type*Treatment),
                random=list(a1~1), group=~Plant, verbose=TRUE,
                start=co2.fit1$coe$fixed[c(2:4,9,5:8)], data=CO2)

## End(Not run)
</code></pre>


</div>