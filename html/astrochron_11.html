<div class="container">

<table style="width: 100%;"><tr>
<td>bandpass</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bandpass filter stratigraphic series</h2>

<h3>Description</h3>

<p>Bandpass filter stratigraphic series using rectangular, Gaussian or tapered cosine (a.k.a. Tukey) window. This function can also be used to notch fiter a record (see examples).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bandpass(dat,padfac=2,flow=NULL,fhigh=NULL,win=0,alpha=3,p=0.25,demean=T,
         detrend=F,addmean=T,output=1,xmin=0,xmax=Nyq,genplot=T,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Stratigraphic series for bandpass filtering. First column should be location (e.g., depth), second column should be data value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padfac</code></td>
<td>
<p>Pad with zeros to (padfac*npts) points, where npts is the original number of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flow</code></td>
<td>
<p>Lowest frequency to bandpass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fhigh</code></td>
<td>
<p>Highest frequency to bandpass.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>Window type for bandpass filter: 0 = rectangular , 1= Gaussian, 2= Cosine-tapered window (a.k.a. Tukey window).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Gaussian window parameter: alpha is 1/stdev, a measure of the width of the Dirichlet kernel. Choose alpha &gt;= 2.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Cosine-tapered (Tukey) window parameter: p is the percent of the data series tapered (choose 0-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean</code></td>
<td>
<p>Remove mean from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend</code></td>
<td>
<p>Remove linear trend from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addmean</code></td>
<td>
<p>Add mean value to bandpass result? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Output: (1) filtered series, (2) bandpass filter window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>Smallest frequency for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Largest frequency for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>bandpassed stratigraphic series.
</p>


<h3>See Also</h3>

 <p><code>lowpass</code>, <code>noKernel</code>, <code>noLow</code>, <code>prewhiteAR</code>, <code>prewhiteAR1</code>, and <code>taner</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># generate example series with periods of 405 ka, 100 ka, 40ka, and 20 ka, plus noise
ex=cycles(freqs=c(1/405,1/100,1/40,1/20),end=1000,dt=5,noisevar=.1)

# bandpass precession term using cosine-tapered window 
bandpass_ex &lt;- bandpass(ex,flow=0.045,fhigh=0.055,win=2,p=.4)

# notch filter (remove) obliquity term using cosine-tapered window
#  if you'd like the final notch filtered record to be centered on the mean proxy 
#  value, set addmean=FALSE
notch_ex &lt;- bandpass(ex,flow=0.02,fhigh=0.03,win=2,p=.4,addmean=FALSE)
notch_ex[2] &lt;- ex[2]-notch_ex[2]
pl(2)
plot(ex,type="l",main="Eccentricity+Obliquity+Precession")
plot(notch_ex,type="l",main="Following application of obliquity notch filter")
</code></pre>


</div>