<div class="container">

<table style="width: 100%;"><tr>
<td>selectOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select open pollinating plants</h2>

<h3>Description</h3>

<p>This function models selection in an open pollinating
plant population. It allows for varying the percentage of
selfing. The function also provides an option for modeling
selection as occuring before or after pollination.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectOP(
  pop,
  nInd,
  nSeeds,
  probSelf = 0,
  pollenControl = FALSE,
  trait = 1,
  use = "pheno",
  selectTop = TRUE,
  candidates = NULL,
  simParam = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>and object of <code>Pop-class</code>
or <code>MultiPop-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInd</code></td>
<td>
<p>the number of plants to select</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSeeds</code></td>
<td>
<p>number of seeds per plant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probSelf</code></td>
<td>
<p>percentage of seeds expected from selfing.
Value ranges from 0 to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pollenControl</code></td>
<td>
<p>are plants selected before pollination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>the trait for selection. Either a number indicating
a single trait or a function returning a vector of length nInd.
The function must work on a vector or matrix of <code>use</code> values as
<code>trait(pop@use, ...)</code> - depending on what <code>use</code> is.
See the examples and <code>selIndex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>the selection criterion. Either a character
(genetic values "gv", estimated breeding values "ebv", breeding values "bv",
phenotypes "pheno", or randomly "rand") or
a function returning a vector of length nInd.
The function must work on <code>pop</code> as <code>use(pop, trait, ...)</code> or
as <code>trait(pop@use, ...)</code> depending on what <code>trait</code> is.
See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectTop</code></td>
<td>
<p>selects highest values if true.
Selects lowest values if false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>candidates</code></td>
<td>
<p>an optional vector of eligible selection candidates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParam</code></td>
<td>
<p>an object of <code>SimParam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments if using a function for
<code>trait</code> and <code>use</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of <code>Pop-class</code>
or <code>MultiPop-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create founder haplotypes
founderPop = quickHaplo(nInd=10, nChr=1, segSites=10)

#Set simulation parameters
SP = SimParam$new(founderPop)

SP$addTraitA(10)
SP$setVarE(h2=0.5)

#Create population
pop = newPop(founderPop, simParam=SP)

#Create new population by selecting the best 3 plant
#Assuming 50% selfing in plants and 10 seeds per plant
pop2 = selectOP(pop, nInd=3, nSeeds=10, probSelf=0.5, simParam=SP)

</code></pre>


</div>