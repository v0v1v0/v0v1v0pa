<div class="container">

<table style="width: 100%;"><tr>
<td>derive_var_merged_exist_flag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge an Existence Flag</h2>

<h3>Description</h3>

<p>Adds a flag variable to the input dataset which indicates if
there exists at least one observation in another dataset fulfilling a certain
condition.
</p>
<p><strong>Note:</strong> This is a wrapper function for the more generic <code>derive_vars_merged()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derive_var_merged_exist_flag(
  dataset,
  dataset_add,
  by_vars,
  new_var,
  condition,
  true_value = "Y",
  false_value = NA_character_,
  missing_value = NA_character_,
  filter_add = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Input dataset
</p>
<p>The variables specified by the <code>by_vars</code> argument are expected to be in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset_add</code></td>
<td>
<p>Additional dataset
</p>
<p>The variables specified by the <code>by_vars</code> argument are expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_vars</code></td>
<td>
<p>Grouping variables
</p>
<p><em>Permitted Values</em>: list of variables created by <code>exprs()</code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_var</code></td>
<td>
<p>New variable
</p>
<p>The specified variable is added to the input dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>Condition
</p>
<p>The condition is evaluated at the additional dataset (<code>dataset_add</code>). For
all by groups where it evaluates as <code>TRUE</code> at least once the new variable
is set to the true value (<code>true_value</code>). For all by groups where it
evaluates as <code>FALSE</code> or <code>NA</code> for all observations the new variable is set
to the false value (<code>false_value</code>). The new variable is set to the missing
value (<code>missing_value</code>) for by groups not present in the additional
dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true_value</code></td>
<td>
<p>True value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>false_value</code></td>
<td>
<p>False value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing_value</code></td>
<td>
<p>Values used for missing information
</p>
<p>The new variable is set to the specified value for all by groups without
observations in the additional dataset.
</p>
<p><em>Permitted Value</em>: A character scalar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_add</code></td>
<td>
<p>Filter for additional data
</p>
<p>Only observations fulfilling the specified condition are taken into account
for flagging. If the argument is not specified, all observations are
considered.
</p>
<p><em>Permitted Values</em>: a condition</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ol>
<li>
<p> The additional dataset is restricted to the observations matching the
<code>filter_add</code> condition.
</p>
</li>
<li>
<p> The new variable is added to the input dataset and set to the true value
(<code>true_value</code>) if for the by group at least one observation exists in the
(restricted) additional dataset where the condition evaluates to <code>TRUE</code>. It
is set to the false value (<code>false_value</code>) if for the by group at least one
observation exists and for all observations the condition evaluates to
<code>FALSE</code> or <code>NA</code>. Otherwise, it is set to the missing value
(<code>missing_value</code>).
</p>
</li>
</ol>
<h3>Value</h3>

<p>The output dataset contains all observations and variables of the
input dataset and additionally the variable specified for <code>new_var</code> derived
from the additional dataset (<code>dataset_add</code>).
</p>


<h3>See Also</h3>

<p>General Derivation Functions for all ADaMs that returns variable appended to dataset:
<code>derive_var_extreme_flag()</code>,
<code>derive_var_joined_exist_flag()</code>,
<code>derive_var_merged_ef_msrc()</code>,
<code>derive_var_merged_summary()</code>,
<code>derive_var_obs_number()</code>,
<code>derive_var_relative_flag()</code>,
<code>derive_vars_computed()</code>,
<code>derive_vars_joined()</code>,
<code>derive_vars_merged()</code>,
<code>derive_vars_merged_lookup()</code>,
<code>derive_vars_transposed()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(dplyr, warn.conflicts = FALSE)

dm &lt;- tribble(
  ~STUDYID,  ~DOMAIN,  ~USUBJID, ~AGE,   ~AGEU,
  "PILOT01",    "DM", "01-1028",   71, "YEARS",
  "PILOT01",    "DM", "04-1127",   84, "YEARS",
  "PILOT01",    "DM", "06-1049",   60, "YEARS"
)

ae &lt;- tribble(
  ~STUDYID,  ~DOMAIN,  ~USUBJID,    ~AETERM,     ~AEREL,
  "PILOT01",    "AE", "01-1028", "ERYTHEMA", "POSSIBLE",
  "PILOT01",    "AE", "01-1028", "PRURITUS", "PROBABLE",
  "PILOT01",    "AE", "06-1049",  "SYNCOPE", "POSSIBLE",
  "PILOT01",    "AE", "06-1049",  "SYNCOPE", "PROBABLE"
)


derive_var_merged_exist_flag(
  dm,
  dataset_add = ae,
  by_vars = exprs(STUDYID, USUBJID),
  new_var = AERELFL,
  condition = AEREL == "PROBABLE"
) %&gt;%
  select(STUDYID, USUBJID, AGE, AGEU, AERELFL)

vs &lt;- tribble(
  ~STUDYID,  ~DOMAIN,  ~USUBJID,      ~VISIT, ~VSTESTCD, ~VSSTRESN, ~VSBLFL,
  "PILOT01",    "VS", "01-1028", "SCREENING",  "HEIGHT",     177.8,      NA,
  "PILOT01",    "VS", "01-1028", "SCREENING",  "WEIGHT",     98.88,      NA,
  "PILOT01",    "VS", "01-1028",  "BASELINE",  "WEIGHT",     99.34,     "Y",
  "PILOT01",    "VS", "01-1028",    "WEEK 4",  "WEIGHT",     98.88,      NA,
  "PILOT01",    "VS", "04-1127", "SCREENING",  "HEIGHT",     165.1,      NA,
  "PILOT01",    "VS", "04-1127", "SCREENING",  "WEIGHT",     42.87,      NA,
  "PILOT01",    "VS", "04-1127",  "BASELINE",  "WEIGHT",     41.05,     "Y",
  "PILOT01",    "VS", "04-1127",    "WEEK 4",  "WEIGHT",     41.73,      NA,
  "PILOT01",    "VS", "06-1049", "SCREENING",  "HEIGHT",    167.64,      NA,
  "PILOT01",    "VS", "06-1049", "SCREENING",  "WEIGHT",     57.61,      NA,
  "PILOT01",    "VS", "06-1049",  "BASELINE",  "WEIGHT",     57.83,     "Y",
  "PILOT01",    "VS", "06-1049",    "WEEK 4",  "WEIGHT",     58.97,      NA
)
derive_var_merged_exist_flag(
  dm,
  dataset_add = vs,
  by_vars = exprs(STUDYID, USUBJID),
  filter_add = VSTESTCD == "WEIGHT" &amp; VSBLFL == "Y",
  new_var = WTBLHIFL,
  condition = VSSTRESN &gt; 90,
  false_value = "N",
  missing_value = "M"
) %&gt;%
  select(STUDYID, USUBJID, AGE, AGEU, WTBLHIFL)
</code></pre>


</div>