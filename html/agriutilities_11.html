<div class="container">

<table style="width: 100%;"><tr>
<td>met_analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi-Environmental Trial Analysis</h2>

<h3>Description</h3>

<p>The results of the <code>single_trial_analysis()</code> function are
used in <code>met_analysis()</code> to fit multi-environmental trial models.
Returns an object of class <code>metAgri</code>, with a list of trial effects,
BLUPs, heritability, variance components, stability and the models fitted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">met_analysis(
  sma_output = NULL,
  h2_filter = 0.2,
  workspace = "1gb",
  vcov = NULL,
  filter_traits = NULL,
  remove_trials = NULL,
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sma_output</code></td>
<td>
<p>Object of class <code>smaAgri</code> resulting of executing
<code>single_trial_analysis()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2_filter</code></td>
<td>
<p>Numeric value to filter trials with poor heritability.
0.2 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>workspace</code></td>
<td>
<p>Sets the workspace for the core <code>REML</code> routines in the
form of a number optionally followed directly by a valid measurement unit.
"128mb" by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>A character string specifying the Variance-Covariance structure
to be fitted. Can be "fa2", "fa1", "us", "corh" or "corv". If <code>NULL</code> the
function will try to fit an "us" Variance-Covariance and if it fails, it will
try with "fa2" and then with "fa1".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_traits</code></td>
<td>
<p>A character vector with traits to filter. <code>NULL</code> by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_trials</code></td>
<td>
<p>A character vector with trials to remove. <code>NULL</code> by
default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Should the progress of the modeling be printed.
If <code>TRUE</code>, for every trait a line is output indicating that the model is
being fitted.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>metAgri</code>, with a list of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>trial_effects</code></td>
<td>
<p>A data.frame containing Trial BLUEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overall_BLUPs</code></td>
<td>
<p>A data.frame containing Genotypic BLUPs across trials,
by trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BLUPs_GxE</code></td>
<td>
<p>A data.frame containing Genotypic BLUPs by trial/trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VCOV</code></td>
<td>
<p>A list by trait contanining the variance-covariance fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stability</code></td>
<td>
<p>A data.frame containing several Stability coefficients
resulting of executing the function <code>stability()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heritability</code></td>
<td>
<p>A data.frame containing overall heritabilities by trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>met_models</code></td>
<td>
<p>A list by trait containing the fitted models.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(agridat)
library(agriutilities)
data(besag.met)
dat &lt;- besag.met
results &lt;- check_design_met(
  data = dat,
  genotype = "gen",
  trial = "county",
  traits = c("yield"),
  rep = "rep",
  block = "block",
  col = "col",
  row = "row"
)
out &lt;- single_trial_analysis(results, progress = FALSE)
met_results &lt;- met_analysis(out, progress = FALSE)
print(met_results)
covcor_heat(matrix = met_results$VCOV$yield$CORR)

## End(Not run)
</code></pre>


</div>