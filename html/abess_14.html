<div class="container">

<table style="width: 100%;"><tr>
<td>generate.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate matrix composed of a sparse matrix and low-rank matrix</h2>

<h3>Description</h3>

<p>Generate simulated matrix that is the superposition of
a low-rank component and a sparse component.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate.matrix(
  n,
  p,
  rank = NULL,
  support.size = NULL,
  beta = NULL,
  snr = Inf,
  sigma = NULL,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The number of predictors of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>The rank of low-rank matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support.size</code></td>
<td>
<p>The number of nonzero coefficients in the underlying regression
model. Can be omitted if <code>beta</code> is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>The coefficient values in the underlying regression model.
If it is supplied, <code>support.size</code> would be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snr</code></td>
<td>
<p>A positive value controlling the signal-to-noise ratio (SNR).
A larger SNR implies the identification of sparse matrix is much easier.
Default <code>snr = Inf</code> enforces no noise exists.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>A numerical value supplied the variance of the gaussian noise. 
Default <code>sigma = NULL</code> implies it is determined by <code>snr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed. Default: <code>seed = 1</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The low rank matrix <code class="reqn">L</code> is generated by <code class="reqn">L = UV</code>, where
<code class="reqn">U</code> is an <code class="reqn">n</code>-by-<code class="reqn">rank</code> matrix and
<code class="reqn">V</code> is a <code class="reqn">rank</code>-by-<code class="reqn">p</code> matrix.
Each element in <code class="reqn">U</code> (or <code class="reqn">V</code>) are i.i.d. drawn from <code class="reqn">N(0, 1/n)</code>.
</p>
<p>The sparse matrix <code class="reqn">S</code> is an <code class="reqn">n</code>-by-<code class="reqn">rank</code> matrix.
It is generated by choosing a support set of size
<code>support.size</code> uniformly at random.
The non-zero entries in <code class="reqn">S</code> are independent Bernoulli (-1, +1) entries.
</p>
<p>The noise matrix <code class="reqn">N</code> is an <code class="reqn">n</code>-by-<code class="reqn">rank</code> matrix,
the elements in <code class="reqn">N</code> are i.i.d. gaussian random variable
with standard deviation <code class="reqn">\sigma</code>.
</p>
<p>The SNR is defined as
as the variance of vectorized matrix <code class="reqn">L + S</code> divided
by <code class="reqn">\sigma^2</code>.
</p>
<p>The matrix <code class="reqn">x</code> is the superposition of <code class="reqn">L</code>, <code class="reqn">S</code>, <code class="reqn">N</code>:
</p>
<p style="text-align: center;"><code class="reqn">x = L + S + N.</code>
</p>



<h3>Value</h3>

<p>A <code>list</code> object comprising:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code class="reqn">n</code>-by-<code class="reqn">p</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The latent low rank matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>The latent sparse matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jin Zhu
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate simulated data
n &lt;- 30
p &lt;- 20
dataset &lt;- generate.matrix(n, p)

stats::heatmap(as.matrix(dataset[["S"]]),
  Rowv = NA,
  Colv = NA,
  scale = "none",
  col = grDevices::cm.colors(256),
  frame.plot = TRUE,
  margins = c(2.4, 2.4)
)

</code></pre>


</div>