<div class="container">

<table style="width: 100%;"><tr>
<td>gtreatsel.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ASD simulation for treatment selection
</h2>

<h3>Description</h3>

<p>Function <code>treatsel.sim</code> runs simulations for a trial design that tests a number of experimental treatments against a single control treatment group in a seamless adaptive trial. Test treatments are compared to the control treatment using Dunnett's many-to-one testing procedure. An interim analysis is undertaken using an early outcome measure for each treatment (and control). A decision is made on which of the treatments to take forward, using a pre-defined selection rule. Data are simulated for the final outcome measure, and data from the interim and final analyses for the final outcome measure are combined together using either the inverse normal or Fisher combination test, and hypotheses tested at the selected level.
This function should not generally be called by the user. The more user-friendly function <code>treatsel.sim</code> covers most common applications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gtreatsel.sim(z1=c(0,0,0),z2=c(0,0,0),zearly=c(0,0,0),v1=c(1,1,1,1),
           v2=c(1,1,1,1),vearly=c(1,1,1,1),corr=0,weight=0.5,
           nsim=1000,seed=12345678,select=0,epsilon=1,thresh=1,
           level=0.025,ptest=seq(1:length(z1)),fu=FALSE,
           method="invnorm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>

<p>Vector of test statistics for the final outcome measure based on stage 1 data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>

<p>Vector of test statistics for the final outcome measure based on stage 2 data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zearly</code></td>
<td>

<p>Vector of test statistics for the early outcome measure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v1</code></td>
<td>

<p>Vector of variances for the final outcome measure based on stage 1 data; in format control treatment variance followed by the test treatment variances
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v2</code></td>
<td>

<p>Vector of variances for the final outcome measure based on stage 2 data; format as <code>v1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vearly</code></td>
<td>

<p>Vector of variances for the early outcome measure; format as <code>v1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>

<p>Vector of correlations between the early and final outcome measures for the control and test treatments; format as <code>v1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>Weighting between stages 1 and 2; default is for equal weighting (0.5)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Seed number
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>

<p>Selection rule type; 0 = select all treatments, 1 = select maximum, 2 = select maximum two, 3 = select maximum three, 4 = epsilon rule (select means within epsilon of maximum), 5 = randomly select  a single treatment and 6 = threshold rule (select means greater than or equal to threshold). See <code>select.rule</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>For <code>select</code> = 4, set epsilon criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>

<p>For <code>select</code> = 6, set threshold criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptest</code></td>
<td>

<p>Vector of treatment numbers for determining power; for example, c(1,2) will count rejections of one or both hypotheses for testing treatments 1 and 2 against control
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu</code></td>
<td>

<p>Logical indicating whether patients from dropped treatments (after interim selection) should be followed-up; default <code>TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Select combination method; available options are “<code>invnorm</code>” or “<code>fisher</code>”, with default “<code>invnorm</code>”
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2011) and implementation by Parsons <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>count.total</code></td>
<td>
<p>Number of times one or more treatments are selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.total</code></td>
<td>
<p>Number of times each test treatment is selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject.total</code></td>
<td>
<p>Number of times each hypothesis is rejected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.reject</code></td>
<td>
<p>Number of times one or more of the treatments selected using <code>ptest</code> is rejected</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Friede T, Parsons N, Stallard N, Todd S, Valdes Marquez E, Chataway J, Nicholas R. Designing a Seamless Phase II/III Clinical Trial using Early Outcomes for Treatment Selection: an Application in Multiple Sclerosis. <em>Statistics in Medicine</em> 2011;30:1528-1540.<br></p>
<p>Parsons N, Friede T, Todd S, Valdes Marquez E, Chataway J, Nicholas R, Stallard N. An R package for implementing simulations for seamless phase II/III clinicals trials using early outcomes for treatment selection. <em>Computational Statistics and Data Analysis</em> 2012;56:1150-1160.<br></p>


<h3>See Also</h3>

<p><code>treatsel.sim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
gtreatsel.sim(z1=c(1,0,2),z2=c(1,0,2),zearly=c(1,0,1), 
    v1=c(1,1,1,1),v2=c(1,1,1,1),vearly=c(1,1,1,1), 
    corr=0,weight=0.25,nsim=100,seed=12345678,
    select=1,level=0.025,ptest = c(1:3),method="fisher")

</code></pre>


</div>