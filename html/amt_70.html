<div class="container">

<table style="width: 100%;"><tr>
<td>extract_covariates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract covariate values</h2>

<h3>Description</h3>

<p>Extract the covariate values at relocations, or at the beginning or end of
steps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_covariates(x, ...)

## S3 method for class 'track_xy'
extract_covariates(x, covariates, ...)

## S3 method for class 'random_points'
extract_covariates(x, covariates, ...)

## S3 method for class 'steps_xy'
extract_covariates(x, covariates, where = "end", ...)

extract_covariates_along(x, ...)

## S3 method for class 'steps_xy'
extract_covariates_along(x, covariates, ...)

extract_covariates_var_time(x, ...)

## S3 method for class 'track_xyt'
extract_covariates_var_time(
  x,
  covariates,
  when = "any",
  max_time,
  name_covar = "time_var_covar",
  ...
)

## S3 method for class 'steps_xyt'
extract_covariates_var_time(
  x,
  covariates,
  when = "any",
  max_time,
  name_covar = "time_var_covar",
  where = "end",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>[track_xy, track_xyt, steps]</code> <br> Either a track created with <code>mk_track</code> or <code>track</code>, or <code>steps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>terra::extract()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p><code style="white-space: pre;">⁠[SpatRaster]⁠</code> <br> The
(environmental) covariates. For <code>extract_covariates_var_time</code> the argument
<code>covariates</code> need to have a <code>z</code>-column (i.e. the time stamp).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>where</code></td>
<td>
<p><code style="white-space: pre;">⁠[character(1)="end"]{"start", "end", "both"}⁠</code> <br> For <code>steps</code>
this determines if the covariate values should be extracted at the
beginning or the end of a step. or <code>end</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>when</code></td>
<td>
<p><code style="white-space: pre;">⁠[character(1)="any"]{"any", "before", "after"}⁠</code> <br> Specifies for
for <code>extract_covariates_var_time</code> whether to look before, after or in both
direction (<code>any</code>) for the temporally closest environmental raster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_time</code></td>
<td>
<p><code style="white-space: pre;">⁠[Period(1)]⁠</code> <br> The maximum time difference between a relocation
and the corresponding raster. If no rasters are within the specified max.
distance <code>NA</code> is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_covar</code></td>
<td>
<p><code style="white-space: pre;">⁠[character(1)="time_var_covar"]⁠</code> <br> The name of the new column.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>extract_covariates_along</code> extracts the covariates along a straight line between the start and the end point of a (random) step. It returns a list, which in most cases will have to be processed further.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> with additional columns for covariate values.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(deer)
sh_forest &lt;- get_sh_forest()
mini_deer &lt;- deer[1:20, ]
mini_deer |&gt; extract_covariates(sh_forest)
mini_deer |&gt; steps() |&gt; extract_covariates(sh_forest)


# Illustration of extracting covariates along the a step
mini_deer |&gt; steps() |&gt; random_steps() |&gt;
  extract_covariates(sh_forest) |&gt; # extract at the endpoint
  (\(.) mutate(., for_path = extract_covariates_along(., sh_forest)))()  |&gt;
  # 1 = forest, lets calc the fraction of forest along the path
  mutate(for_per = purrr::map_dbl(for_path, function(x) mean(x == 1)))

</code></pre>


</div>