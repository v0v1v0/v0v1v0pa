<div class="container">

<table style="width: 100%;"><tr>
<td>getArgillicBounds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate upper and lower boundary of argillic diagnostic subsurface horizon</h2>

<h3>Description</h3>

<p><code>getArgillicBounds</code> estimates the upper and lower boundary of argillic diagnostic subsurface horizon for a profile in a single-profile SoilProfileCollection object (<code>p</code>).
</p>
<p>The upper boundary is where the clay increase threshold is met. The function uses <code>crit.clay.argillic</code> as the threshold function for determining whether a clay increase occurs and <code>get.increase.matrix</code> to determine whether the increase is met, whether vertical distance of increase is sufficiently small, and in which horizon.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getArgillicBounds(
  p,
  hzdesgn = hzdesgnname(p, required = TRUE),
  clay.attr = hzmetaname(p, "clay", required = TRUE),
  texcl.attr = hztexclname(p, required = TRUE),
  require_t = TRUE,
  bottom.pattern = "Cr|R|Cd",
  lower.grad.pattern = "^[2-9]*B*CB*[^rtd]*[1-9]*$",
  sandy.texture.pattern = "-S$|^S$|COS$|L[^V]FS$|[^L]VFS$|LS$|LFS$",
  vertical.distance = 30,
  simplify = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A SoilProfileCollection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hzdesgn</code></td>
<td>
<p>the name of the column/attribute containing the horizon designation; default="hzname"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clay.attr</code></td>
<td>
<p>the name of the column/attribute containing the clay content; default="clay"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>texcl.attr</code></td>
<td>
<p>the name of the column/attribute containing the textural class (used for finding sandy horizons); default="texcl"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>require_t</code></td>
<td>
<p>require a "t" subscript for positive identification of upper and lower bound of argillic? default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom.pattern</code></td>
<td>
<p>regular expression passed to <code>estimateSoilDepth</code> to match the lower boundary of the soil. default is "Cr|R|Cd" which approximately matches paralithic, lithic and densic contacts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.grad.pattern</code></td>
<td>
<p>this is a pattern for adjusting the bottom depth of the argillic horizon upwards from the bottom depth of the soil. The absence of illuviation is used as a final control on horizon pattern matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sandy.texture.pattern</code></td>
<td>
<p>this is a pattern for matching sandy textural classes: <code style="white-space: pre;">⁠-S$|^S$|COS$|L[^V]FS$|[^L]VFS$|LS$|LFS$⁠</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical.distance</code></td>
<td>
<p>Vertical distance in which clay increase must be met. Default <code>30</code> cm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>Return a length 2 vector with upper and lower boundary when <code>p</code> has length 1? Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print out information about 't' subscripts, sandy textures, plow layers and lower gradational horizons?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The lower boundary is first approximated as the depth to a lithic/paralithic/densic contact, or some other horizon matchable by a custom regular expression pattern. Subsequently, that boundary is extended upwards to the end of "evidence of illuviation."
</p>
<p>The depth to contact is estimated using 'bottom.pattern' "Cr|R|Cd" by default. It matches anything containing Cr, R or Cd.
</p>
<p>The lower gradational horizon regular expression ‘lower.grad.pattern' default is <code style="white-space: pre;">⁠^[2-9]*B*CB*[^rtd]*[1-9]*$}⁠</code>. It matches anything that starts with a lithologic discontinuity (or none) and a C master horizon designation. May contain B as second horizon designation in transitional horizon. May not contain 'r' or 't' subscript.
</p>
<p>The minimum thickness of the argillic horizon is dependent on whether all subhorizons are "sandy" or not. The <code>sandy.texture.pattern</code> default <code style="white-space: pre;">⁠-S$|^S$|COS$|L[^V]FS$|[^L]VFS$|LS$|LFS$⁠</code> captures USDA textural class fine earth fractions that meet "sandy" particle size class criteria.
</p>
<p>There also is an option ‘require_t' to omit the requirement for evidence of eluviation in form of 't' subscript in 'hzdesgn'. Even if "t" subscript is not required for positive identification, the presence of lower gradational C horizons lacking 't' will still be used to modify the lower boundary upward from a detected contact, if needed. If this behavior is not desired, just set 'lower.grad.pattern' to something that will not match any horizons in your data.
</p>


<h3>Value</h3>

<p>Returns a numeric vector; first value is top depth, second value is bottom depth. If as.list is TRUE, returns a list with top depth named "ubound" and bottom depth named "lbound". If <code>p</code> has more than one profile or if <code>simplify = FALSE</code> the result is a data.frame containing profile ID, upper and lower boundary columns.
</p>


<h3>Author(s)</h3>

<p>Andrew G. Brown
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sp1, package = 'aqp')
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

# set required metadata
hzdesgnname(sp1) &lt;- 'name'
hztexclname(sp1) &lt;- 'texture'
hzmetaname(sp1, 'clay') &lt;- 'prop'

x &lt;- getArgillicBounds(sp1)
x

</code></pre>


</div>