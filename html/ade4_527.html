<div class="container">

<table style="width: 100%;"><tr>
<td>wca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Within-Class Analysis</h2>

<h3>Description</h3>

<p>Performs a particular case of an Orthogonal Principal Component Analysis with
respect to Instrumental Variables (orthopcaiv), in which there is only a
single factor as covariable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dudi'
wca(x, fac, scannf = TRUE, nf = 2, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a duality diagram, object of class <code>dudi</code> from
one of the functions <code>dudi.coa</code>, <code>dudi.pca</code>,...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>a factor partitioning the rows of <code>dudi$tab</code> in classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p>a logical value indicating whether the eigenvalues bar plot should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>if scannf FALSE, an integer indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of the sub-class <code>within</code> in the class <code>dudi</code>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a data frame containing the transformed data (substraction of the class mean)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matching call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the rank of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>percentage of within-class inertia</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a numeric vector containing the eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>a numeric vector of row weigths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw</code></td>
<td>
<p>a numeric vector of column weigths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tabw</code></td>
<td>
<p>a numeric vector of class weigths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>the factor defining the classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>data frame row coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>data frame row normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>data frame column coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>data frame column normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ls</code></td>
<td>
<p>data frame supplementary row coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as</code></td>
<td>
<p>data frame inertia axis onto within axis</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>To avoid conflict names with the <code>base:::within</code> function, the
function <code>within</code> is now deprecated and removed. It 
is replaced by the method <code>wca.dudi</code> of the new generic <code>wca</code> function. 
</p>


<h3>Author(s)</h3>

<p>Daniel Chessel <br>
Anne-Béatrice Dufour <a href="mailto:anne-beatrice.dufour@univ-lyon1.fr">anne-beatrice.dufour@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Benzécri, J. P. (1983) Analyse de l'inertie intra-classe par l'analyse d'un 
tableau de correspondances. <em>Les Cahiers de l'Analyse des données</em>, <b>8</b>, 351–358.<br><br>
Dolédec, S. and Chessel, D. (1987) Rythmes saisonniers et composantes stationnelles 
en milieu aquatique I- Description d'un plan d'observations complet par projection de 
variables. <em>Acta Oecologica, Oecologia Generalis</em>, <b>8</b>, 3, 403–426.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(meaudret)
pca1 &lt;- dudi.pca(meaudret$env, scan = FALSE, nf = 4)
wit1 &lt;- wca(pca1, meaudret$design$site, scan = FALSE, nf = 2)

if(adegraphicsLoaded()) {
  g1 &lt;- s.traject(pca1$li, meaudret$design$site, psub.text = "Principal Component Analysis", 
    plines.lty = 1:nlevels(meaudret$design$site), psub.cex = 1.5, plot = FALSE)
  g2 &lt;- s.traject(wit1$li, meaudret$design$site, 
    psub.text = "Within site Principal Component Analysis", 
    plines.lty = 1:nlevels(meaudret$design$site), psub.cex = 1.5, plot = FALSE)
  g3 &lt;- s.corcircle (wit1$as, plot = FALSE)
  G &lt;- ADEgS(list(g1, g2, g3), layout = c(2, 2))
  
} else {
  par(mfrow = c(2, 2))
  s.traject(pca1$li, meaudret$design$site, sub = "Principal Component Analysis", csub = 1.5)
  s.traject(wit1$li, meaudret$design$site, sub = "Within site Principal Component Analysis", 
    csub = 1.5)
  s.corcircle (wit1$as)
  par(mfrow = c(1,1))
}
plot(wit1)
</code></pre>


</div>