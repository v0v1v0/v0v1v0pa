<div class="container">

<table style="width: 100%;"><tr>
<td>dapc graphics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphics for Discriminant Analysis of Principal Components (DAPC)</h2>

<h3>Description</h3>

<p>These functions provide graphic outputs for Discriminant Analysis of
Principal Components (DAPC, Jombart et al. 2010). See <code>?dapc</code> for
details about this method. DAPC graphics are detailed in the DAPC tutorial
accessible using <code>vignette("adegenet-dapc")</code>.
</p>
<p>These functions all require an object of class <code>dapc</code>
(the ".dapc" can be ommitted when calling the functions):<br>
- <code>scatter.dapc</code>: produces scatterplots of principal components (or
'discriminant functions'), with a screeplot of eigenvalues as inset.<br>
- <code>assignplot</code>: plot showing the probabilities of assignment of
individuals to the different clusters.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dapc'
scatter(x, xax=1, yax=2, grp=x$grp, col=seasun(length(levels(grp))),
      pch=20, bg="white", solid=.7, scree.da=TRUE,
      scree.pca=FALSE, posi.da="bottomright",
      posi.pca="bottomleft", bg.inset="white", ratio.da=.25,
      ratio.pca=.25, inset.da=0.02, inset.pca=0.02,
      inset.solid=.5, onedim.filled=TRUE, mstree=FALSE, lwd=1,
      lty=1, segcol="black", legend=FALSE, posi.leg="topright",
      cleg=1, txt.leg=levels(grp), cstar = 1, cellipse = 1.5,
      axesell = FALSE, label = levels(grp), clabel = 1, xlim =
      NULL, ylim = NULL, grid = FALSE, addaxes = TRUE, origin =
      c(0,0), include.origin = TRUE, sub = "", csub = 1, possub =
      "bottomleft", cgrid = 1, pixmap = NULL, contour = NULL, area
      = NULL, label.inds = NULL, ...)

assignplot(x, only.grp=NULL, subset=NULL, new.pred=NULL, cex.lab=.75,pch=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>dapc</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax,yax</code></td>
<td>
<p><code>integers</code> specifying which principal components of DAPC
should be shown in x and y axes. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grp</code></td>
<td>
<p>a factor defining group membership for the individuals. The scatterplot
is optimal only for the default group, i.e. the one used in the
DAPC analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a suitable color to be used for groups. The specified vector
should match the number of groups, not the number of individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>a <code>numeric</code> indicating the type of point to be used to indicate
the prior group of individuals (see <code>points</code> documentation for
more details); one value is expected for each group; recycled if necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>the color used for the background of the scatterplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solid</code></td>
<td>
<p>a value between 0 and 1 indicating the alpha level for the colors of
the plot; 0=full transparency, 1=solid colours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scree.da</code></td>
<td>
<p>a logical indicating whether a screeplot of Discriminant Analysis
eigenvalues should be displayed in inset (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scree.pca</code></td>
<td>
<p>a logical indicating whether a screeplot of Principal Component Analysis
eigenvalues should be displayed in inset (TRUE) or not (FALSE); retained axes are
displayed in black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posi.da</code></td>
<td>
<p>the position of the inset of DA eigenvalues; can match any
combination of "top/bottom" and "left/right".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posi.pca</code></td>
<td>
<p>the position of the inset of PCA eigenvalues; can match any
combination of "top/bottom" and "left/right".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.inset</code></td>
<td>
<p>the color to be used as background for the inset plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.da</code></td>
<td>
<p>the size of the inset of DA eigenvalues as a proportion of the
current plotting region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.pca</code></td>
<td>
<p>the size of the inset of PCA eigenvalues as a proportion of the
current plotting region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inset.da</code></td>
<td>
<p>a vector with two numeric values (recycled if needed) indicating
the inset to be used for the screeplot of DA eigenvalues as a proportion of the
current plotting region; see <code>?add.scatter</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inset.pca</code></td>
<td>
<p>a vector with two numeric values (recycled if needed) indicating
the inset to be used for the screeplot of PCA eigenvalues as a proportion of the
current plotting region; see <code>?add.scatter</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inset.solid</code></td>
<td>
<p>a value between 0 and 1 indicating the alpha level for the colors of
the inset plots; 0=full transparency, 1=solid colours.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onedim.filled</code></td>
<td>
<p>a logical indicating whether curves should be filled when
plotting a single discriminant function (TRUE), or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mstree</code></td>
<td>
<p>a logical indicating whether a minimum spanning tree linking the
groups and based on the squared distances between the groups inside the entire
space should added to the plot (TRUE), or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd,lty,segcol</code></td>
<td>
<p>the line width, line type, and segment colour to be used for
the minimum spanning tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a logical indicating whether a legend for group colours should added
to the plot (TRUE), or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posi.leg</code></td>
<td>
<p>the position of the legend for group colours; can match any
combination of "top/bottom" and "left/right", or a set of x/y coordinates stored
as a list (<code>locator</code> can be used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cleg</code></td>
<td>
<p>a size factor used for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstar,cellipse,axesell,label,clabel,xlim,ylim,grid,addaxes,origin,include.origin,sub,csub,possub,cgrid,pixmap,contour,area</code></td>
<td>
<p>arguments
passed to <code>s.class</code>; see <code>?s.class</code> for more informations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.grp</code></td>
<td>
<p>a <code>character</code> vector indicating which groups should be
displayed. Values should match values of <code>x$grp</code>. If <code>NULL</code>, all
results are displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p><code>integer</code> or <code>logical</code> vector indicating which
individuals should be displayed. If <code>NULL</code>, all
results are displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.pred</code></td>
<td>
<p>an optional list, as returned by the <code>predict</code> method for
<code>dapc</code> objects; if provided, the individuals with unknown groups are added
at the bottom of the plot. To visualize these individuals only, specify
<code>only.grp="unknown"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>a <code>numeric</code> indicating the size of labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.leg</code></td>
<td>
<p>a character vector indicating the text to be used in
the legend; if not provided, group names stored in <code>x$grp</code> are
used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.inds</code></td>
<td>
<p>Named list of arguments passed to the 
<code>orditorp</code> function. This will label individual points 
witout overlapping. Arguments <code>x</code> and <code>display</code> are hardcoded and 
should not be specified by user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to other functions. For
<code>scatter</code>, arguments passed to <code>points</code>; for <code>compoplot</code>,
arguments passed to <code>barplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the documentation of <code>dapc</code> for more information about the method.
</p>


<h3>Value</h3>

<p>All functions return the matched call.<br></p>


<h3>Author(s)</h3>

<p> Thibaut Jombart <a href="mailto:t.jombart@imperial.ac.uk">t.jombart@imperial.ac.uk</a> </p>


<h3>References</h3>

<p>Jombart T, Devillard S and Balloux F  (2010) Discriminant analysis of
principal components: a new method for the analysis of genetically
structured populations. BMC Genetics11:94. doi:10.1186/1471-2156-11-94
</p>


<h3>See Also</h3>

<p>- <code>dapc</code>: implements the DAPC.
</p>
<p>- <code>find.clusters</code>: to identify clusters without prior.
</p>
<p>- <code>dapcIllus</code>: a set of simulated data illustrating the DAPC
</p>
<p>- <code>eHGDP</code>, <code>H3N2</code>: empirical datasets illustrating
DAPC
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(H3N2)
dapc1 &lt;- dapc(H3N2, pop=H3N2$other$epid, n.pca=30,n.da=6)

## defautl plot ##
scatter(dapc1)

## label individuals at the periphery
# air = 2 is a measure of how much space each label needs
# pch = NA suppresses plotting of points
scatter(dapc1, label.inds = list(air = 2, pch = NA))

## showing different scatter options ##
## remove internal segments and ellipses, different pch, add MStree
scatter(dapc1, pch=18:23, cstar=0, mstree=TRUE, lwd=2, lty=2, posi.da="topleft")

## only ellipse, custom labels, use insets
scatter(dapc1, cell=2, pch="", cstar=0, posi.pca="topleft", posi.da="topleft", scree.pca=TRUE,
inset.pca=c(.01,.3), label=paste("year\n",2001:2006), axesel=FALSE, col=terrain.colors(10))

## without ellipses, use legend for groups
scatter(dapc1, cell=0, cstar=0, scree.da=FALSE, clab=0, cex=3,
solid=.4, bg="white", leg=TRUE, posi.leg="topleft")

## only one axis
scatter(dapc1,1,1,scree.da=FALSE, legend=TRUE, solid=.4,bg="white")



## example using genlight objects ##
## simulate data
x &lt;- glSim(50,4e3-50, 50, ploidy=2)
x
plot(x)

## perform DAPC
dapc2 &lt;- dapc(x, n.pca=10, n.da=1)
dapc2

## plot results
scatter(dapc2, scree.da=FALSE, leg=TRUE, txt.leg=paste("group",
c('A','B')), col=c("red","blue"))

## SNP contributions
loadingplot(dapc2$var.contr)
loadingplot(tail(dapc2$var.contr, 100), main="Loading plot - last 100 SNPs")



## assignplot / compoplot ##
assignplot(dapc1, only.grp=2006)

data(microbov)
dapc3 &lt;- dapc(microbov, n.pca=20, n.da=15)
compoplot(dapc3, lab="")

## End(Not run)
</code></pre>


</div>