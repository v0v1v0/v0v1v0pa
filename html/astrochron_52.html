<div class="container">

<table style="width: 100%;"><tr>
<td>integratePower</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine the total power within a given bandwidth</h2>

<h3>Description</h3>

<p>Determine the total power within a given bandwidth, and also the ratio of this power to the total power in the spectrum (or up to a specified frequency). If bandwidth is not specified, generate interactive plots for bandwidth selection. For use with the function eha, integratePower can process spectrograms (time-frequency) or single spectra.
</p>


<h3>Usage</h3>

<pre><code class="language-R">integratePower(spec,flow=NULL,fhigh=NULL,fmax=NULL,unity=F,f0=T,xmin=NULL,
               xmax=NULL,ymin=NULL,ymax=NULL,npts=NULL,pad=NULL,ydir=1,
               palette=6,ncolors=100,h=6,w=9,ln=F,genplot=T,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>Spectral results to evaluate. If the data frame contains time-frequency results,
it must have the following format: column 1=frequency; remaining columns (2 to n)=power; titles for columns 2 to 
n must be the location (depth or height). Note that this format is ouput by function eha. If the data frame contains
one spectrum, it must have the following format: column 1=frequency, column 2=power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flow</code></td>
<td>
<p>Low frequency cutoff for integration. If flow or fhigh are not specified, interactive plotting is activated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fhigh</code></td>
<td>
<p>High frequency cutoff for integration. If flow or fhigh are not specified, interactive plotting is activated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>Integrate total power up to this frequency.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unity</code></td>
<td>
<p>Normalize spectra such that total variance (up to fmax) is unity. (T of F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>Is f(0) included in the spectra? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>Minimum frequency for PLOTTING.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Maximum frequency for PLOTTING.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>Minimum depth/height/time for PLOTTING. Only used if processing time-frequency results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>Maximum depth/height/time for PLOTTING. Only used if processing time-frequency results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npts</code></td>
<td>
<p>The number of points in the processed time series window. This is needed for proper spectrum normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>The total padded length of the processed time series window. This is needed for proper spectrum normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydir</code></td>
<td>
<p>Direction for y-axis in plots (depth or height). -1 = values increase downwards (slower plotting!), 1 = values increase upwards. Only used if processing time-frequency results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>What color palette would you like to use? (1) rainbow, (2) grayscale, (3) blue, (4) red, (5) blue-white-red, (6) viridis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolors</code></td>
<td>
<p>Number of colors to use in plot. Only used if processing time-frequency results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Height of plot in inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Width of plot in inches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ln</code></td>
<td>
<p>Plot natural log of spectral results? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the normalization used, you may want to preprocess the power spectra prior to integration.
</p>


<h3>See Also</h3>

 <p><code>eha</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># generate etp signal over past 10 Ma
ex=etp(tmax=10000)

# evolutive power
pwr=eha(ex,win=500,fmax=.1,pad=2000,output=2,pl=2)

# integrate power from main obliquity term
integratePower(pwr,flow=0.02,fhigh=0.029,npts=501,pad=2000)
</code></pre>


</div>