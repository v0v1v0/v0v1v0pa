<div class="container">

<table style="width: 100%;"><tr>
<td>ARHT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An adaptable generalized Hotelling's <code class="reqn">T^2</code> test for high dimensional data</h2>

<h3>Description</h3>

<p>This function performs the adaptable regularized Hotelling's <code class="reqn">T^2</code> test (ARHT) (Li et al., (2016) &lt;arXiv:1609.08725&gt;) for the one-sample
and two-sample test problem, where we're interested in detecting the mean vector in the one-sample problem or the difference
between mean vectors in the two-sample problem in a high dimensional regime.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ARHT(X, Y = NULL, mu_0 = NULL, prob_alt_prior = list(c(1, 0, 0), c(0, 1,
  0), c(0, 0, 1)), Type1error_calib = c("cube_root", "sqrt", "chi_sq",
  "none"), lambda_range = NULL, nlambda = 2000, bs_size = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the n1-by-p observation matrix with numeric column variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an optional n2-by-p observation matrix; if <code>NULL</code>, a one-sample test is conducted on <code>X</code>; otherwise, a two-sample test
is conducted on <code>X</code> and <code>Y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_0</code></td>
<td>
<p>the null hypothesis vector to be tested; if <code>NULL</code>, the default value is the 0 vector of length p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob_alt_prior</code></td>
<td>
<p>a non-empty list; Each field is a numeric vector with sum 1. The default value is the "canonical weights"
<code>list(c(1,0,0), c(0,1,0), c(0,0,1))</code>; Each field represents a probabilistic prior model specified by weights of <code class="reqn">I_p</code>,
<code class="reqn">\Sigma</code>, <code class="reqn">\Sigma^2</code>, etc, where <code class="reqn">\Sigma</code> is the population covariance matrix of the observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type1error_calib</code></td>
<td>
<p>the method to calibrate Type 1 error rate of ARHT. Choose its first element when more than one are specified.
Four values are allowed:
</p>
<ul>
<li>
<p><code>cube_root</code> The default value; cube-root transformation;
</p>
</li>
<li>
<p><code>sqrt</code> Square-root transformation;
</p>
</li>
<li>
<p><code>chi_sq</code> Chi-square approximation, not available when more than three models are specified in <code>prob_alt_prior</code>;
</p>
</li>
<li>
<p><code>none</code> No calibration.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_range</code></td>
<td>
<p>optional user-supplied lambda range; If <code>NULL</code>, ARHT chooses its own range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>optional user-supplied number of lambda's in grid search; default to be <code>2000</code>; the grid is progressively coarser.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs_size</code></td>
<td>
<p>positive numeric with default value <code>1e5</code>; only effective when more than one prior models are specified in <code>prob_alt_prior</code>;
control the size of the bootstrap sample used to approximate the ARHT p-value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method incorporates ridge-regularization in the classic Hotelling's <code class="reqn">T^2</code> test with the regularization parameter
chosen such that the asymptotic power under a class of probabilistic alternative prior models is maximized. ARHT combines
different prior models by taking the maximum of statistics under all models. ARHT is distributed as the maximum
of a correlated multivariate normal random vector. We estimate its covariance matrix and bootstrap its distribution. The
returned p-value is a Monte Carlo approximation to its true value using the bootstrap sample, therefore not deterministic.
Various methods are available to calibrate the slightly inflated Type 1 error rate of ARHT, including Cube-root transformation,
square-root transformation and chi-square approximation.
</p>


<h3>Value</h3>


<ul>
<li>
<p><code>ARHT_pvalue</code>: The p-value of ARHT test.
</p>

<ul>
<li>
<p> If <code>length(prob_alt_prior)==1</code>, it is identical to <code>RHT_pvalue</code>.
</p>
</li>
<li>
<p> If <code>length(prob_alt_prior)&gt;1</code>, it is the p-value after combining results from all prior models. The value is
bootstrapped, therefore not deterministic.
</p>
</li>
</ul>
</li>
<li>
<p><code>RHT_opt_lambda</code>: The optimal lambda's chosen under each of the prior models in <code>prob_alt_prior</code>. It has the same length and order as
<code>prob_alt_prior</code>.
</p>
</li>
<li>
<p><code>RHT_pvalue</code>: The p-value of RHT tests with the lambda's in <code>RHT_opt_lambda</code>.
</p>
</li>
<li>
<p><code>RHT_std</code>: The standardized RHT statistics with the lambda's in <code>RHT_opt_lambda</code>.
Take its maximum to get the statistic of ARHT test.
</p>
</li>
<li>
<p><code>Theta1</code>: As defined in Li et al. (2016) &lt;arXiv:1609.08725&gt;, the estimated asymptotic means of RHT statistics with the lambda's in <code>RHT_opt_lambda</code>.
</p>
</li>
<li>
<p><code>Theta2</code>: As defined in Li et al. (2016) &lt;arXiv:1609.08725&gt;, <code>2*Theta2</code> are the estimated asymptotic variances of RHT statistics the lambda's in <code>RHT_opt_lambda</code>.
</p>
</li>
<li>
<p><code>Corr_RHT</code>: The estimated correlation matrix of the statistics in <code>RHT_std</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Li, H. Aue, A., Paul, D. Peng, J., &amp; Wang, P. (2016). <em>An adaptable generalization of Hotelling's <code class="reqn">T^2</code> test in high dimension.</em>
&lt;arXiv:1609:08725&gt;.
</p>
<p>Chen, L., Paul, D., Prentice, R., &amp; Wang, P. (2011). <em>A regularized Hotelling's <code class="reqn">T^2</code> test for pathway analysis in proteomic studies.</em>
Journal of the American Statistical Association, 106(496), 1345-1360.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10086)
# One-sample test
n1 = 300; p =500
dataX = matrix(rnorm(n1 * p), nrow = n1, ncol = p)
res1 = ARHT(dataX)

# Two-sample test
n2= 400
dataY = matrix(rnorm(n2 * p), nrow = n2, ncol = p )
res2 = ARHT(dataX, dataY, mu_0 = rep(0.01,p))

# Specify probabilistic alternative priors model
res3 = ARHT(dataX, dataY, mu_0 = rep(0.01,p),
     prob_alt_prior = list(c(1/3, 1/3, 1/3), c(0,1,0)))

# Change Type 1 error calibration method
res4 = ARHT(dataX, dataY, mu_0 = rep(0.01,p),
     Type1error_calib = "sqrt")

RejectOrNot = res4$ARHT_pvalue &lt; 0.05

</code></pre>


</div>