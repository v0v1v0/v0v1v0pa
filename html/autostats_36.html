<div class="container">

<table style="width: 100%;"><tr>
<td>tidy_xgboost</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tidy xgboost</h2>

<h3>Description</h3>

<p>Accepts a formula to run an xgboost model. Automatically determines whether the formula is
for classification or regression. Returns the xgboost model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tidy_xgboost(
  .data,
  formula,
  ...,
  mtry = 0.75,
  trees = 500L,
  min_n = 2L,
  tree_depth = 7L,
  learn_rate = 0.05,
  loss_reduction = 1,
  sample_size = 0.75,
  stop_iter = 15L,
  counts = FALSE,
  tree_method = c("auto", "exact", "approx", "hist", "gpu_hist"),
  monotone_constraints = 0L,
  num_parallel_tree = 1L,
  lambda = 0.5,
  alpha = 0.1,
  scale_pos_weight = 1,
  verbosity = 0L,
  validate = TRUE,
  booster = c("gbtree", "gblinear")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to  <code>set_engine</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p># Randomly Selected Predictors; defaults to .75; (xgboost: colsample_bynode) (type: numeric, range 0 - 1) (or type: integer if <code>count = TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p># Trees (xgboost: nrounds) (type: integer, default: 500L)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n</code></td>
<td>
<p>Minimal Node Size (xgboost: min_child_weight) (type: integer, default: 2L); [typical range: 2-10] Keep small value for highly imbalanced class data where leaf nodes can have smaller size groups. Otherwise increase size to prevent overfitting outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree_depth</code></td>
<td>
<p>Tree Depth (xgboost: max_depth) (type: integer, default: 7L); Typical values: 3-10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>learn_rate</code></td>
<td>
<p>Learning Rate (xgboost: eta) (type: double, default: 0.05); Typical values: 0.01-0.3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss_reduction</code></td>
<td>
<p>Minimum Loss Reduction (xgboost: gamma) (type: double, default: 1.0);  range: 0 to Inf; typical value: 0 - 20 assuming low-mid tree depth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_size</code></td>
<td>
<p>Proportion Observations Sampled (xgboost: subsample) (type: double, default: .75); Typical values: 0.5 - 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_iter</code></td>
<td>
<p># Iterations Before Stopping (xgboost: early_stop) (type: integer, default: 15L) only enabled if validation set is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>if <code>TRUE</code> specify <code>mtry</code> as an integer number of cols. Default <code>FALSE</code> to specify <code>mtry</code> as fraction of cols from 0 to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree_method</code></td>
<td>
<p>xgboost tree_method. default is <code>auto</code>. reference: <a href="https://xgboost.readthedocs.io/en/stable/treemethod.html">tree method docs</a></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monotone_constraints</code></td>
<td>
<p>an integer vector with length of the predictor cols, of <code>-1, 1, 0</code> corresponding to decreasing, increasing, and no constraint respectively for the index of the predictor col. reference: <a href="https://xgboost.readthedocs.io/en/stable/tutorials/monotonic.html">monotonicity docs</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_parallel_tree</code></td>
<td>
<p>should be set to the size of the forest being trained. default 1L</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>[default=.5] L2 regularization term on weights. Increasing this value will make model more conservative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>[default=.1] L1 regularization term on weights. Increasing this value will make model more conservative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_pos_weight</code></td>
<td>
<p>[default=1] Control the balance of positive and negative weights, useful for unbalanced classes. if set to TRUE, calculates sum(negative instances) / sum(positive instances). If first level is majority class, use values &lt; 1, otherwise normally values &gt;1 are used to balance the class distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbosity</code></td>
<td>
<p>[default=1] Verbosity of printing messages. Valid values are 0 (silent), 1 (warning), 2 (info), 3 (debug).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validate</code></td>
<td>
<p>default TRUE. report accuracy metrics on a validation set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>booster</code></td>
<td>
<p>defaults to 'gbtree' for tree boosting but can be set to 'gblinear'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In binary classification the target variable must be a factor with the first level set to the event of interest.
A higher probability will predict the first level.
</p>
<p>reference for parameters: <a href="https://xgboost.readthedocs.io/en/stable/parameter.html">xgboost docs</a>
</p>


<h3>Value</h3>

<p>xgb.Booster model
</p>


<h3>Examples</h3>

<pre><code class="language-R">
options(rlang_trace_top_env = rlang::current_env())


# regression on numeric variable

iris %&gt;%
 framecleaner::create_dummies(Species) -&gt; iris_dummy

iris_dummy %&gt;%
 tidy_formula(target= Petal.Length) -&gt; petal_form

iris_dummy %&gt;%
 tidy_xgboost(
   petal_form,
   trees = 20,
   mtry = .5
 )  -&gt; xg1


xg1 %&gt;%
 tidy_predict(newdata = iris_dummy, form = petal_form) -&gt; iris_preds

iris_preds %&gt;%
 eval_preds()




</code></pre>


</div>