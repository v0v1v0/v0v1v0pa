<div class="container">

<table style="width: 100%;"><tr>
<td>plot.avophylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Model Fits for an 'avophylo' Object</h2>

<h3>Description</h3>

<p>S3 method for class 'avophylo'.
<code>plot.avophylo</code> creates plots for objects of class
'avophylo'. The exact plot(s) constructed depends on the
argument values provided (see examples below and also the
package vignette). The function uses the ape package's
plot.phylo and can take any argument from that
function (e.g. the <code>type</code> argument).
</p>
<p>If <code>AvoPhylo</code> is used to produce a list of trees
of class 'multiAvophylo', then <code>plot.multiAvophylo</code> is
first called. This plots individual trees in turn (with the
user required to press 'enter' to move to the next plot).
</p>
<p>The user will need to play around with plotting
window size, and/or export the image, particularly if many
tips are included.
</p>
<p>Note - if using the <code>lvls</code> argument, a warning is
provided. This comes from the <code>tidytree::tree_subset</code>
function and appears to be a bug (but the plot should be
checked for sense).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'avophylo'
plot(
  x,
  tips = "extinct",
  tips_col = NULL,
  order = NULL,
  family = NULL,
  genus = NULL,
  species = NULL,
  avotrex,
  tax,
  lvls = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class 'avophylo'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tips</code></td>
<td>
<p>What tip labels to present. Can be one of
"extinct" (just tip labels of extinct species), "none" (no
tip labels) or "all_same" (show all labels, with same colour
labels for all species), or "all_dif" (show all labels, with
different colour labels for extant and extinct species).
The latter needs to be used in combination with the
<code>tips_col</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tips_col</code></td>
<td>
<p>Colour of tip labels. If <code>tips =
"all_dif"</code> this needs to be a vector of length two, with the
first value being the colour for extinct species, and the
second for extant species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>Prune the tree to only show a specific order
(should be a character vector of length = 1). Taxonomy
follows BirdTree, see the <code>data(BirdTree_taxa)</code> file.
For extinct order names, see the <code>data(AvotrexPhylo)</code>
file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>As for <code>order</code>, but for families.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genus</code></td>
<td>
<p>As for <code>order</code>, but for genera.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Prune the tree to only show a specific set of
species. Should be a vector of at least length = 1. If only
a single species name is provided, the <code>lvls</code> argument
also needs to be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avotrex</code></td>
<td>
<p>The Avotrex phylo dataset used to generate the
trees. For most use cases, this will have been loaded using
<code>data(AvotrexPhylo)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax</code></td>
<td>
<p>The Jetz et al. (2012) BirdTree taxonomy .csv.
Supplied as data within the package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lvls</code></td>
<td>
<p>If <code>species</code> is just a single species, how
many levels back (rootward) should be plotted. Uses the
<code>tidytree::tree_subset</code> function (see help
documentation of that function for further info).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other plotting arguments from the ape package's
plot.phylo can be provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Generates a phylogeny plot of <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a set of trees
# data(BirdTree_trees)
# data(BirdTree_tax)
# data(AvotrexPhylo)
# trees &lt;- AvoPhylo(ctrees = BirdTree_trees,
# avotrex = AvotrexPhylo, PER = 0.2, PER_FIXED = 0.75,
# tax = BirdTree_tax, Ntree = 2, n.cores = 2, 
# cluster.ips = NULL)

#For here, we can load in an example set of two trees 
#generated using the above code

data(treesEx)

#order (owls) - just show extinct tip names (in red) and using
#a fan plot
plot(treesEx[[1]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     order = "Strigiformes", tips = "extinct",
     type = "fan", tip.color = "red", cex = 0.4)

#family (plot all three trees this time)
plot(treesEx, avotrex = AvotrexPhylo, tax = BirdTree_tax,
     family = "Threskiornithidae", tips = "extinct",
     tip.color = "red", cex = 0.5)

#genus - cladogram plot
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     genus = "Aplonis", tips = "extinct",
     type = "cladogram",
     tip.color = "red", cex = 0.5)

#species (&amp; show all tip names in same colour)
species2 &lt;- c("Anas_itchtucknee", "Anas_sp_VitiLevu",
              "Anas_platyrhynchos", "Ara_tricolor")

plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = species2, tips = "all_same",
     type = "cladogram",
     tip.color = "blue", cex = 0.5)

#same as previous, but extinct and extant diff colours
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = species2,
     cex = 0.5, tips = "all_dif",
     tips_col = c("red", "darkgreen"),
     type = "cladogram")

##single species 2 levels back
plot(treesEx[[2]], avotrex = AvotrexPhylo, tax = BirdTree_tax,
     species = "Ara_tricolor",
     tips = "all_dif",
     tips_col = c("red", "darkgreen"),
     lvls = 2,
     type = "phylogram",
     cex = 0.6)
</code></pre>


</div>