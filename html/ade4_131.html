<div class="container">

<table style="width: 100%;"><tr>
<td>gearymoran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran's I and Geary'c randomization tests for spatial and phylogenetic autocorrelation</h2>

<h3>Description</h3>

<p>This function performs Moran's I test using phylogenetic and spatial link matrix (binary or general). It uses neighbouring weights so Moran's I and Geary's c randomization tests are equivalent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gearymoran(bilis, X, nrepet = 999, alter=c("greater", "less", "two-sided"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bilis</code></td>
<td>
<p>: a <em>n</em> by <em>n</em> link matrix where <em>n</em> is the row number of X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>: a data frame with continuous variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>: number of random vectors for the randomization test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alter</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of "greater" (default), "less" or "two-sided"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bilis</code> is a squared symmetric matrix which terms are all positive or null. 
</p>
<p><code>bilis</code> is firstly transformed in frequency matrix A by dividing it by the total sum of data matrix :  
</p>
<p style="text-align: center;"><code class="reqn">a_{ij} = \frac{bilis_{ij}}{\sum_{i=1}^{n}\sum_{j=1}^{n}bilis_{ij}}</code>
</p>
 
<p>The neighbouring weights is defined by the matrix <code class="reqn">D = diag(d_1,d_2, \ldots)</code> where <code class="reqn">d_i = \sum_{j=1}^{n}bilis_{ij}</code>.
For each vector x of the data frame X, the test is based on the Moran statistic <code class="reqn">x^{t}Ax</code> where x is D-centred. 
</p>


<h3>Value</h3>

<p>Returns an object of class <code>krandtest</code> (randomization tests).
</p>


<h3>Author(s)</h3>

<p>Sébastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a> <br>
Daniel Chessel 
</p>


<h3>References</h3>

<p>Cliff, A. D. and Ord, J. K. (1973) <em>Spatial autocorrelation</em>, Pion, London.
</p>
<p>Thioulouse, J., Chessel, D. and Champely, S. (1995) Multivariate analysis of spatial patterns: a unified approach to local and global structures. 
<em>Environmental and Ecological Statistics</em>, <b>2</b>, 1–14.
</p>


<h3>See Also</h3>

<p><code>moran.test</code> and <code>geary.test</code> for classical versions of Moran's test and Geary's one</p>


<h3>Examples</h3>

<pre><code class="language-R"># a spatial example
data(mafragh)
tab0 &lt;- (as.data.frame(scalewt(mafragh$env)))
bilis0 &lt;- neig2mat(mafragh$neig)
gm0 &lt;- gearymoran(bilis0, tab0, 999)
gm0
plot(gm0, nclass = 20)

## Not run: 
# a phylogenetic example
data(mjrochet)
mjr.phy &lt;- newick2phylog(mjrochet$tre)
mjr.tab &lt;- log(mjrochet$tab)
gearymoran(mjr.phy$Amat, mjr.tab)
gearymoran(mjr.phy$Wmat, mjr.tab)

if(adegraphicsLoaded()) {
  g1 &lt;- table.value(mjr.phy$Wmat, ppoints.cex = 0.35, nclass = 5,
    axis.text = list(cex = 0), plot = FALSE)
  g2 &lt;- table.value(mjr.phy$Amat, ppoints.cex = 0.35, nclass = 5,
    axis.text = list(cex = 0), plot = FALSE)
  G &lt;- cbindADEg(g1, g2, plot = TRUE)
  
} else {
  par(mfrow = c(1, 2))
  table.value(mjr.phy$Wmat, csi = 0.25, clabel.r = 0)
  table.value(mjr.phy$Amat, csi = 0.35, clabel.r = 0)
  par(mfrow = c(1, 1))
}

## End(Not run)</code></pre>


</div>