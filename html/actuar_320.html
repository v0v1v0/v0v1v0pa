<div class="container">

<table style="width: 100%;"><tr>
<td>rcomphierarc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation from Compound Hierarchical Models</h2>

<h3>Description</h3>

<p>Simulate data for insurance applications allowing hierarchical
structures and separate models for the frequency and severity of
claims distributions.
</p>
<p><code>rcomphierarc</code> is an alias for <code>simul</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rcomphierarc(nodes, model.freq = NULL, model.sev = NULL, weights = NULL)

## S3 method for class 'portfolio'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>a vector or a named list giving the number of "nodes" at each level
in the hierarchy of the portfolio. The nodes are listed from top
(portfolio) to bottom (usually the years of experience).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.freq</code></td>
<td>
<p>a named vector of expressions specifying the
frequency of claims model (see Details); if <code>NULL</code>, only claim
amounts are simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.sev</code></td>
<td>
<p>a named vector of expressions specifying the severity
of claims model (see Details); if <code>NULL</code>, only claim numbers
are simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>portfolio</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>potential further arguments required by generic.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The order and the names of the elements in <code>nodes</code>,
<code>model.freq</code> and <code>model.sev</code> must match. At least one of
<code>model.freq</code> and <code>model.sev</code> must be non <code>NULL</code>.
</p>
<p><code>nodes</code> may be a basic vector, named or not, for non hierarchical
models. The rule above still applies, so <code>model.freq</code> and
<code>model.sev</code> should not be named if <code>nodes</code> is not. However,
for non hierarchical models, <code>rcompound</code> is faster and has
a simpler interface.
</p>
<p><code>nodes</code> specifies the hierarchical layout of the portfolio. Each
element of the list is a vector of the number of nodes at a given
level. Vectors are recycled as necessary.
</p>
<p><code>model.freq</code> and <code>model.sev</code> specify the simulation models
for claim numbers and claim amounts, respectively. A model is
expressed in a semi-symbolic fashion using an object of mode
<code>expression</code>. Each element of the object
must be named and should be a complete call to a random number
generation function, with the number of variates omitted. Hierarchical
(or mixtures of) models are achieved by replacing one or more
parameters of a distribution at a given level by any combination of
the names of the levels above. If no mixing is to take place at a
level, the model for this level can be <code>NULL</code>.
</p>
<p>The argument of the random number generation functions for the number
of variates to simulate <strong>must</strong> be named <code>n</code>.
</p>
<p>Weights will be used wherever the name <code>"weights"</code> appears in a
model. It is the user's responsibility to ensure that the length of
<code>weights</code> will match the number of nodes when weights are to be
used. Normally, there should be one weight per node at the lowest
level of the model.
</p>
<p>Data is generated in lexicographic order, that is by row in the output
matrix.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>"portfolio"</code>. A
<code>print</code> method for this class displays the models used in the
simulation as well as the frequency of claims for each year and entity
in the portfolio.
</p>
<p>An object of class <code>"portfolio"</code> is a list containing the
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a two dimension list where each element is a vector of
claim amounts;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the vector of weights given in argument reshaped as a
matrix matching element <code>data</code>, or <code>NULL</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>classification</code></td>
<td>
<p>a matrix of integers where each row is a unique
set of subscripts identifying an entity in the portfolio
(e.g. integers <code class="reqn">i</code>, <code class="reqn">j</code> and <code class="reqn">k</code> for data
<code class="reqn">X_{ijkt}</code>);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>the <code>nodes</code> argument, appropriately recycled;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.freq</code></td>
<td>
<p>the frequency model as given in argument;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.sev</code></td>
<td>
<p>the severity model as given in argument.</p>
</td>
</tr>
</table>
<p>It is recommended to manipulate objects of class <code>"portfolio"</code> by
means of the corresponding methods of functions <code>aggregate</code>,
<code>frequency</code> and <code>severity</code>.
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a>,
Sébastien Auclair and Louis-Philippe Pouliot
</p>


<h3>References</h3>

<p>Goulet, V. and Pouliot, L.-P. (2008), Simulation of compound
hierarchical models in R, <em>North American Actuarial Journal</em>
<b>12</b>, 401–412.
</p>


<h3>See Also</h3>

<p><code>rcomphierarc.summaries</code> for the functions to create the
matrices of aggregate claim amounts, frequencies and individual claim
amounts.
</p>
<p><code>rcompound</code> for a simpler and much faster way to generate
variates from standard, non hierarchical, compound models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Two level (contracts and years) portfolio with frequency model
## Nit|Theta_i ~ Poisson(Theta_i), Theta_i ~ Gamma(2, 3) and severity
## model X ~ Lognormal(5, 1)
rcomphierarc(nodes = list(contract = 10, year = 5),
             model.freq = expression(contract = rgamma(2, 3),
                                     year = rpois(contract)),
             model.sev = expression(contract = NULL,
                                    year = rlnorm(5, 1)))

## Model with weights and mixtures for both frequency and severity
## models
nodes &lt;- list(entity = 8, year = c(5, 4, 4, 5, 3, 5, 4, 5))
mf &lt;- expression(entity = rgamma(2, 3),
                 year = rpois(weights * entity))
ms &lt;- expression(entity = rnorm(5, 1),
                 year = rlnorm(entity, 1))
wit &lt;- sample(2:10, 35, replace = TRUE)
pf &lt;- rcomphierarc(nodes, mf, ms, wit)
pf 				# print method
weights(pf)			# extraction of weights
aggregate(pf)[, -1]/weights(pf)[, -1] # ratios

## Four level hierarchical model for frequency only
nodes &lt;- list(sector = 3, unit = c(3, 4),
              employer = c(3, 4, 3, 4, 2, 3, 4), year = 5)
mf &lt;- expression(sector = rexp(1),
                 unit = rexp(sector),
                 employer = rgamma(unit, 1),
                 year = rpois(employer))
pf &lt;- rcomphierarc(nodes, mf, NULL)
pf 				# print method
aggregate(pf) 			# aggregate claim amounts
frequency(pf)  			# frequencies
severity(pf)			# individual claim amounts

## Standard, non hierarchical, compound model with simplified
## syntax (function rcompound() is much faster for such cases)
rcomphierarc(10,
             model.freq = expression(rpois(2)),
             model.sev = expression(rgamma(2, 3)))
</code></pre>


</div>