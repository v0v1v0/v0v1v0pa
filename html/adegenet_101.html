<div class="container">

<table style="width: 100%;"><tr>
<td>chooseCN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to choose a connection network</h2>

<h3>Description</h3>

<p>The function <code>chooseCN</code> is a simple interface to build a connection
network (CN) from xy coordinates. The user chooses from 6 types of graph and
one additional weighting scheme.  <code>chooseCN</code> calls functions from
appropriate packages, handles non-unique coordinates and returns a
connection network either with classe <code>nb</code> or <code>listw</code>. For graph
types 1-4, duplicated locations are not accepted and will issue an error.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chooseCN(
  xy,
  ask = TRUE,
  type = NULL,
  result.type = "nb",
  d1 = NULL,
  d2 = NULL,
  k = NULL,
  a = NULL,
  dmin = NULL,
  plot.nb = TRUE,
  edit.nb = FALSE,
  check.duplicates = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>an matrix or data.frame with two columns for x and y coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>a logical stating whether graph should be chosen interactively
(TRUE,default) or not (FALSE). Set to FALSE if <code>type</code> is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>an integer giving the type of graph (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result.type</code></td>
<td>
<p>a character giving the class of the returned object.
Either "nb" (default) or "listw", both from <code>spdep</code> package. See
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1</code></td>
<td>
<p>the minimum distance between any two neighbours. Used if
<code>type=5.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p>the maximum distance between any two neighbours. Used if
<code>type=5</code>. Can also be a character: "dmin" for the minimum distance so
that each site has at least one connection, or "dmax" to have all sites
connected (despite the later has no sense).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>the number of neighbours per point. Used if <code>type=6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the exponent of the inverse distance matrix. Used if <code>type=7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmin</code></td>
<td>
<p>the minimum distance between any two distinct points. Used to
avoid infinite spatial proximities (defined as the inversed spatial
distances). Used if <code>type=7</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.nb</code></td>
<td>
<p>a logical stating whether the resulting graph should be
plotted (TRUE, default) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edit.nb</code></td>
<td>
<p>a logical stating whether the resulting graph should be
edited manually for corrections (TRUE) or not (FALSE, default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.duplicates</code></td>
<td>
<p>a logical indicating if duplicate coordinates should be detected; this can be an issue for some graphs; TRUE by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are 7 kinds of graphs proposed: <br> Delaunay triangulation (type 1)<br>
Gabriel graph (type 2)<br> Relative neighbours (type 3)<br> Minimum spanning
tree (type 4)<br> Neighbourhood by distance (type 5)<br> K nearests neighbours
(type 6)<br> Inverse distances (type 7)<br></p>
<p>The last option (type=7) is not a true neighbouring graph: all sites are
neighbours, but the spatial weights are directly proportional to the
inversed spatial distances.<br> Also not that in this case, the output of the
function is always a <code>listw</code> object, even if <code>nb</code> was
requested.<br></p>
<p>The choice of the connection network has been discuted on the adegenet
forum. Please search the archives from adegenet website (section 'contact')
using 'graph' as keyword.
</p>


<h3>Value</h3>

<p>Returns a connection network having the class <code>nb</code> or
<code>listw</code>. The xy coordinates are passed as attribute to the created
object.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:t.jombart@imperial.ac.uk">t.jombart@imperial.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code>spca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(nancycats)

par(mfrow=c(2,2))
cn1 &lt;- chooseCN(nancycats@other$xy,ask=FALSE,type=1)
cn2 &lt;- chooseCN(nancycats@other$xy,ask=FALSE,type=2)
cn3 &lt;- chooseCN(nancycats@other$xy,ask=FALSE,type=3)
cn4 &lt;- chooseCN(nancycats@other$xy,ask=FALSE,type=4)
par(mfrow=c(1,1))

## End(Not run)

</code></pre>


</div>