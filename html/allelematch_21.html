<div class="container">

<table style="width: 100%;"><tr>
<td>amPairwise</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pairwise matching of multilocus genotypes
</h2>

<h3>Description</h3>

<p>Functions to perform a pairwise matching analysis of a multilocus genotype dataset, and review
the output in formatted text or HTML. For each genotype in the focal dataset all genotypes in
the comparison genotype are returned that match at or above a threshold matching score. The
matching score is also known as the s-hat criterion (see the supplementary documentation). This
is determined using <code>amMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">	amPairwise(
		amDatasetFocal,
		amDatasetComparison = amDatasetFocal,
		alleleMismatch = NULL,
		matchThreshold = NULL,
		missingMethod = 2
		)

	amHTML.amPairwise(
		x,
		htmlFile = NULL,
		htmlCSS = amCSSForHTML()
		)

	amCSV.amPairwise(
		x,
		csvFile
		)

  ## S3 method for class 'amPairwise'
summary(
    object,
    html = NULL,
    csv = NULL,
    ...
    )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amDatasetFocal</code></td>
<td>

<p>An <code>amDataset</code> object containing focal genotypes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amDatasetComparison</code></td>
<td>

<p>Optional.<br>
An <code>amDataset</code> object containing comparison genotypes.<br>
If not supplied, the focal dataset is also the comparison dataset (i.e., all focal dataset
members are compared against one another).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleleMismatch</code></td>
<td>

<p>Maximum number of mismatching alleles which will be tolerated when identifying individuals;
also known as m-hat parameter.<br>
If specified, then <code>matchThreshold</code> should be omitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matchThreshold</code></td>
<td>

<p>Return comparison genotypes that match with the focal genotype at or above this score or
similarity; also known as s-hat parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingMethod</code></td>
<td>

<p>Method used to determine the similarity of multilocus genotypes when data is missing.<br>
The default, (<code>missingMethod = 2</code>), is preferable in all cases.<br>
See <code>amMatrix</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>

<p>An <code>amPairwise</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>htmlFile</code></td>
<td>

<p>HTML filepath to create.<br>
If <code>htmlFile = NULL</code>, a file is created in the operating system temporary directory and
is then opened in the default browser.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>htmlCSS</code></td>
<td>

<p>A string containing a valid cascading style sheet.<br>
A default style sheet is provided in <code>amCSSForHTML</code>.<br>
See <code>amCSSForHTML</code> for details of how to tweak this CSS.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>html</code></td>
<td>

<p>If <code>html = NULL</code> or <code>html=FALSE</code>, formatted textual output is displayed on the
console.<br>
If <code>html = TRUE</code>, the <code>summary.amPairwise</code> method produces and loads an HTML file in the
default browser.<br><code>html</code> can also contain a path to a file where HTML output will be written.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>csvFile, csv</code></td>
<td>

<p>CSV filepath to create containing giving a data frame representation of the pairwise
matching results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to <code>summary.amPairwise</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pairwise matching of genotypes is a useful means to assess data quality and inspect for
genotyping errors.<br></p>
<p><code>matchThreshold</code> represents the similarity between two multilocus genotypes and can be
thought of as a percentage similarity (or a Hamming's distance between two vectors) that has
been corrected where missing data is present, such that missing data represents neither a match
nor a mismatch but a "partial" match. See <code>amMatrix</code> for more discussion of this
metric.
</p>


<h3>Value</h3>

<p><code>amPairwise</code> object or side effects: analysis summary written to an HTML file or to the
console, or written to a CSV file.
</p>


<h3>Note</h3>

<p>As <code>matchThreshold</code> is lowered, the size of the output increases rapidly. Typically
analyses will not be very useful or manageable with thresholds below 0.7.<br></p>
<p>There is an additional side effect of <code>html = TRUE</code> (or of <code>htmlFile = NULL</code>). If
required, there is a clean up of the operating system temporary directory where AlleleMatch
temporary HTML files are stored. Files that match the pattern am*.html and are older 24 hours
are deleted from this temporary directory.
</p>


<h3>Author(s)</h3>

<p>Paul Galpern (<a href="mailto:pgalpern@gmail.com">pgalpern@gmail.com</a>)
</p>


<h3>References</h3>

<p>For a complete vignette, please access via the Data S1 Supplementary documentation and tutorials
(PDF) located at &lt;doi:10.1111/j.1755-0998.2012.03137.x&gt;.
</p>


<h3>See Also</h3>

<p><code>amDataset</code>, <code>amMatrix</code>, <code>amUnique</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	## Not run: 
	data("amExample5")

	## Produce amDataset object
	myDataset &lt;-
		amDataset(
			amExample5,
			missingCode = "-99",
			indexColumn = 1,
			metaDataColumn = 2,
			ignoreColumn = "gender"
			)

	## Typical usage
	myPairwise &lt;-
		amPairwise(
			myDataset,
			alleleMismatch = 2
			)

	## Display analysis as HTML in default browser
	summary.amPairwise(
		myPairwise,
		html = TRUE
		)

	## Save analysis to HTML file
	summary.amPairwise(
		myPairwise,
		html = "myPairwise.htm"
		)

	## Save analysis to CSV file
	summary.amPairwise(
		myPairwise,
		csv = "myPairwise.csv"
		)

	## Display analysis as formatted text on the console
	summary.amPairwise(myPairwise)

	## Compare one dataset against a second
	## Both must have same number of allele columns
	## Here we create two datasets artificially from one for illustration purposes
	myDatasetA &lt;-
		amDataset(
			amExample5[sample(nrow(amExample5))[1:25], ],
			missingCode = "-99",
			indexColumn = 1,
			ignoreColumn = 2
			)
	myDatasetB &lt;-
		amDataset(
			amExample5[sample(nrow(amExample5))[1:100], ],
			missingCode = "-99",
			indexColumn = 1,
			ignoreColumn = 2
			)
	myPairwise2 &lt;-
		amPairwise(
			myDatasetA,
			myDatasetB,
			alleleMismatch = 3
			)
	summary.amPairwise(
		myPairwise2,
		html = TRUE
		)
	
## End(Not run)
</code></pre>


</div>