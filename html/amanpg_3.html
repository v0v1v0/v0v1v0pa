<div class="container">

<table style="width: 100%;"><tr>
<td>spca.amanpg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Alternating Manifold Proximal Gradient algorithm for Sparse PCA
</h2>

<h3>Description</h3>

<p>Performs sparse principal component analysis on the input matrix using an alternating manifold
proximal gradient (AManPG) method
</p>


<h3>Usage</h3>

<pre><code class="language-R">spca.amanpg(z, lambda1, lambda2, f_palm = 1e5, x0 = NULL, y0 = NULL, k = 0, type = 0,
       gamma = 0.5, maxiter = 1e4, tol = 1e-5, normalize = TRUE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Either the data matrix or sample covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>List of parameters of length n for L1-norm penalty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda2</code></td>
<td>
<p>L2-norm penalty term</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_palm</code></td>
<td>
<p>Upper bound for the gradient value to reach convergence, default value is 1e5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>Initial x-values for the gradient method, default value is the first n right singular vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>Initial y-values for the gradient method, default value is the first n right singular vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of principal components desired, default is 0 (returns min(n-1, p) principal components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If 0, b is expected to be a data matrix, and otherwise b is expected to be a covariance matrix; default is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Parameter to control how quickly the step size changes in each iteration, default is 0.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations allowed in the gradient method, default is 1e4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Tolerance value required to indicate convergence (calculated as difference between iteration f-values), default is 1e-5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Center and normalize rows to Euclidean length 1 if True, default is True</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Function prints progress between iterations if True, default is False</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>total number of iterations executed in the algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f_amanpg</code></td>
<td>
<p>final gradient value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity</code></td>
<td>
<p>Number of sparse loadings (loadings == 0) divided by number of all loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>execution time in seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>corresponding matrix in subproblem to the loadings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loadings</code></td>
<td>
<p>loadings of the sparse principal components</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Shixiang Chen, Justin Huang, Benjamin Jochem, Shiqian Ma, Lingzhou Xue and Hui Zou
</p>


<h3>References</h3>

<p>Chen, S., Ma, S., Xue, L., and Zou, H. (2020) "An Alternating Manifold Proximal Gradient Method for Sparse Principal Component Analysis and Sparse Canonical Correlation Analysis" *INFORMS Journal on Optimization* 2:3, 192-208
</p>


<h3>Examples</h3>

<pre><code class="language-R">#see SPCA.R for a more in-depth example
      d &lt;- 500  # dimension
      m &lt;- 1000 # sample size
      a &lt;- normalize(matrix(rnorm(m * d), m, d))
      lambda1 &lt;- 0.1 * matrix(data=1, nrow=4, ncol=1)
      x0 &lt;- svd(a, nv=4)$v
      sprout &lt;- spca.amanpg(a, lambda1, lambda2=Inf, f_palm=1e5, x0=x0, y0=x0, k=4, type=0, 
                            gamma=0.5, maxiter=1e4, tol=1e-5, normalize = FALSE, verbose=FALSE)
      print(paste(sprout$iter, "iterations,", sprout$sparsity, "sparsity,", sprout$time))

      #extract loadings
      #print(sprout$loadings)

</code></pre>


</div>