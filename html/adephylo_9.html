<div class="container">

<table style="width: 100%;"><tr>
<td>distTips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute some phylogenetic distance between tips</h2>

<h3>Description</h3>

<p>The function <code>distTips</code> computes a given distance between a set of tips
of a phylogeny. A vector of tips is supplied: distances between all possible
pairs of these tips are computed.  The distances are computed from the
shortest path between the tips. Several distances can be used, defaulting to
the sum of branch lengths (see argument <code>method</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">distTips(
  x,
  tips = "all",
  method = c("patristic", "nNodes", "Abouheif", "sumDD"),
  useC = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a tree of class <code>phylo</code>,
phylo4 or phylo4d.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tips</code></td>
<td>
<p>A vector of integers identifying tips by their numbers, or a
vector of characters identifying tips by their names. Distances will be
computed between all possible pairs of tips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string (full or abbreviated without ambiguity)
specifying the method used to compute distances ; possible values are:<br> -
<code>patristic</code>: patristic distance, i.e. sum of branch lengths <br> -
<code>nNodes</code>: number of nodes on the path between the nodes <br> -
<code>Abouheif</code>: Abouheif's distance (see details) <br> - <code>sumDD</code>: sum
of direct descendants of all nodes on the path (see details) <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useC</code></td>
<td>
<p>a logical indicating whether computations should be performed
using compiled C code (TRUE, default), or using a pure R version (FALSE). C
version is several orders of magnitude faster, and R version is kept for
backward compatibility.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An option (enabled by default) allows computations to be run using compiled
C code, which is much faster than pure R code. In this case, a matrix of all
pairwise distances is returned (i.e., <code>tips</code> argument is ignored).
</p>
<p><code>Abouheif</code> distance refers to the phylogenetic distance underlying the
test of Abouheif (see references). Let P be the set of all the nodes in the
path going from <code>node1</code> to <code>node2</code>. Let DDP be the number of
direct descendants from each node in P. Then, the so-called 'Abouheif'
distance is the product of all terms in DDP.<br></p>
<p><code>sumDD</code> refers to a phylogenetic distance quite similar to that of
Abouheif. We consider the same sets P and DDP. But instead of computing the
product of all terms in DDP, this distance computes the sum of all terms in
DDP.
</p>


<h3>Value</h3>

<p>An object of class <code>dist</code>, containing phylogenetic distances.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:tjombart@imperial.ac.uk">tjombart@imperial.ac.uk</a>
</p>


<h3>References</h3>

<p>Pavoine, S.; Ollier, S.; Pontier, D. &amp; Chessel, D. (2008)
Testing for phylogenetic signal in life history variable: Abouheif's test
revisited. <em>Theoretical Population Biology</em>: <b>73</b>, 79-91.
</p>


<h3>See Also</h3>

<p><code>distTips</code> which computes several phylogenetic
distances between tips.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(ape) &amp; require(phylobase)){
## make a tree
x &lt;- as(rtree(10),"phylo4")
plot(x, show.node=TRUE)
axisPhylo()
## compute different distances
distTips(x, 1:3)
distTips(x, 1:3, "nNodes")
distTips(x, 1:3, "Abouheif")
distTips(x, 1:3, "sumDD")

## compare C and pure R code outputs
x &lt;- rtree(10)
all.equal(as.matrix(distTips(x)), as.matrix(distTips(x, useC=FALSE)))
all.equal(as.matrix(distTips(x, meth="nNode")),
   as.matrix(distTips(x, meth="nNode", useC=FALSE)))
all.equal(as.matrix(distTips(x, meth="Abou")),
   as.matrix(distTips(x, meth="Abou", useC=FALSE)))
all.equal(as.matrix(distTips(x, meth="sumDD")),
   as.matrix(distTips(x, meth="sumDD", useC=FALSE)))

## compare speed
x &lt;- rtree(50)
tim1 &lt;- system.time(distTips(x, useC=FALSE)) # old pure R version
tim2 &lt;- system.time(distTips(x)) # new version using C
tim1[c(1,3)]/tim2[c(1,3)] # C is about a thousand time faster in this case
}

</code></pre>


</div>