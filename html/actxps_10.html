<div class="container">

<table style="width: 100%;"><tr>
<td>as_exp_df</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Termination summary helper functions</h2>

<h3>Description</h3>

<p>Convert aggregate termination experience studies to the <code>exp_df</code> class.
</p>


<h3>Usage</h3>

<pre><code class="language-R">as_exp_df(
  x,
  expected = NULL,
  wt = NULL,
  col_claims,
  col_exposure,
  col_n_claims,
  col_weight_sq,
  col_weight_n,
  target_status = NULL,
  start_date = as.Date("1900-01-01"),
  end_date = NULL,
  credibility = FALSE,
  conf_level = 0.95,
  cred_r = 0.05,
  conf_int = FALSE
)

is_exp_df(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object. For <code>as_exp_df()</code>, <code>x</code> must be a data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>A character vector containing column names in x with
expected values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>Optional. Length 1 character vector. Name of the column in <code>x</code>
containing weights to use in the calculation of claims, exposures, partial
credibility, and confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_claims</code></td>
<td>
<p>Optional. Name of the column in <code>x</code> containing claims. The
assumed default is "claims".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_exposure</code></td>
<td>
<p>Optional. Name of the column in <code>x</code> containing exposures.
The assumed default is "exposure".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_n_claims</code></td>
<td>
<p>Optional and only used used when <code>wt</code> is passed. Name of
the column in <code>x</code> containing the number of claims.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_weight_sq</code></td>
<td>
<p>Optional and only used used when <code>wt</code> is passed. Name of
the column in <code>x</code> containing the sum of squared weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_weight_n</code></td>
<td>
<p>Optional and only used used when <code>wt</code> is passed. Name of
the column in <code>x</code> containing exposure record counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_status</code></td>
<td>
<p>Character vector of target status values. Default value
= <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_date</code></td>
<td>
<p>Experience study start date. Default value = 1900-01-01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_date</code></td>
<td>
<p>Experience study end date</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>credibility</code></td>
<td>
<p>If <code>TRUE</code>, future calls to <code>summary()</code> will include
partial credibility weights and credibility-weighted termination rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>Confidence level used for the Limited Fluctuation
credibility method and confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred_r</code></td>
<td>
<p>Error tolerance under the Limited Fluctuation credibility
method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_int</code></td>
<td>
<p>If <code>TRUE</code>, future calls to <code>summary()</code> will include
confidence intervals around the observed termination rates and any
actual-to-expected ratios.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>is_exp_df()</code> will return <code>TRUE</code> if <code>x</code> is an <code>exp_df</code> object.
</p>
<p><code>as_exp_df()</code> will coerce a data frame to an <code>exp_df</code> object if that
data frame has columns for exposures and claims.
</p>
<p><code>as_exp_df()</code> is most useful for working with aggregate summaries of
experience that were not created by actxps where individual policy
information is not available. After converting the data to the <code>exp_df</code>
class, <code>summary()</code> can be used to summarize data by any grouping variables,
and <code>autoplot()</code> and <code>autotable()</code> are available for reporting.
</p>
<p>If nothing is passed to <code>wt</code>, the data frame <code>x</code> must include columns
containing:
</p>

<ul>
<li>
<p> Exposures (<code>exposure</code>)
</p>
</li>
<li>
<p> Claim counts (<code>claims</code>)
</p>
</li>
</ul>
<p>If <code>wt</code> is passed, the data must include columns containing:
</p>

<ul>
<li>
<p> Weighted exposures (<code>exposure</code>)
</p>
</li>
<li>
<p> Weighted claims (<code>claims</code>)
</p>
</li>
<li>
<p> Claim counts (<code>n_claims</code>)
</p>
</li>
<li>
<p> The raw sum of weights <strong>NOT</strong> multiplied by exposures
</p>
</li>
<li>
<p> Exposure record counts (<code>.weight_n</code>)
</p>
</li>
<li>
<p> The raw sum of squared weights (<code>.weight_sq</code>)
</p>
</li>
</ul>
<p>The names in parentheses above are expected column names. If the data
frame passed to <code>as_exp_df()</code> uses different column names, these can be
specified using the <code style="white-space: pre;">⁠col_*⁠</code> arguments.
</p>
<p>When a column name is passed to <code>wt</code>, the columns <code>.weight</code>, <code>.weight_n</code>,
and <code>.weight_sq</code> are used to calculate credibility and confidence intervals.
If credibility and confidence intervals aren't required, then it is not
necessary to pass anything to <code>wt</code>. The results of <code>as_exp_df()</code> and any
downstream summaries will still be weighted as long as the exposures and
claims are pre-weighted.
</p>
<p><code>target_status</code>, <code>start_date</code>, and <code>end_date</code> are optional arguments that are
only used for printing the resulting <code>exp_df</code> object.
</p>


<h3>Value</h3>

<p>For <code>is_exp_df()</code>, a length-1 logical vector. For <code>as_exp_df()</code>,
an <code>exp_df</code> object.
</p>


<h3>See Also</h3>

<p><code>exp_stats()</code> for information on how <code>exp_df</code> objects are typically
created from individual exposure records.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># convert pre-aggregated experience into an exp_df object
dat &lt;- as_exp_df(agg_sim_dat, col_exposure = "exposure_n",
                 col_claims = "claims_n",
                 target_status = "Surrender",
                 start_date = 2005, end_date = 2019,
                 conf_int = TRUE)
dat
is_exp_df(dat)

# summary by policy year
summary(dat, pol_yr)

# repeat the prior exercise on a weighted basis
dat_wt &lt;- as_exp_df(agg_sim_dat, wt = "av",
                    col_exposure = "exposure_amt",
                    col_claims = "claims_amt",
                    col_n_claims = "claims_n",
                    col_weight_sq = "av_sq",
                    col_weight_n = "n",
                    target_status = "Surrender",
                    start_date = 2005, end_date = 2019,
                    conf_int = TRUE)
dat_wt

# summary by policy year
summary(dat_wt, pol_yr)


</code></pre>


</div>