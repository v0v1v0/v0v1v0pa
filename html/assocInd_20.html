<div class="container">

<table style="width: 100%;"><tr>
<td>iieSimHWI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate HWI with individual identification error
</h2>

<h3>Description</h3>

<p>Generate an estimated half-weight index under a given rate of missing observations of one individual given that it is present
</p>


<h3>Usage</h3>

<pre><code class="language-R">iieSimHWI(aAB, e, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aAB</code></td>
<td>

<p>The real association rate between individuals A and B
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>

<p>The probability of failing to observe an individual given it is present in a group
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>The number of sampling periods (number of observations of the dyad)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A simple function that simulates data for a given rate of identification error and real association strength. The function returns the simulated half-weight index and whether the value lies within the 95 percent confidence intervals of the half-weight index given the number of samples and under the assumption of no error.
</p>


<h3>Value</h3>

<p>Returns two values: the simulated half weight index and whether or not it falls within the 95 percent confidence intervals (1 = yes, 0 = no)
</p>


<h3>Author(s)</h3>

<p>William Hoppitt &lt;W.J.E.Hoppitt@leeds.ac.uk&gt;
Damien Farine &lt;dfarine@orn.mpg.de&gt;
</p>


<h3>References</h3>

<p>Hoppitt, W. &amp; Farine, D.R. (in prep) Association indices for quantifying social relationships: how to deal with missing observations of individuals or groups.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
	# Set a real association index
	aAB &lt;- 0.5

	# Create a range of errors
	e &lt;- seq(0,0.8,0.01)
	
	# Replicate N times
	replicates &lt;- 100  # small number used to save computation time
	
	# Create a blank storage matrices
	assocStrength &lt;- matrix(NA,nrow=replicates,ncol=length(e))
	inCIs &lt;- matrix(NA,nrow=replicates,ncol=length(e))
	
	# Loop through repeating N times for each error value
	for (i in 1:length(e)) { 
		for (j in 1:replicates) {
			out &lt;- iieSimHWI(aAB,e[i],20)
			assocStrength[j,i] &lt;- out[1]
			inCIs[j,i] &lt;- out[2]
		}
	}
	
	# Plot the results
	par(mfrow=c(1,2))
	plot(e,colMeans(assocStrength, na.rm=TRUE), pch=20, ylim=c(0,1), ylab="Simulated HWI")
	CIs &lt;- apply(assocStrength,2,quantile,c(0.025,0.975),na.rm=TRUE)
	arrows(e,CIs[1,],e,CIs[2,],len=0.1,code=3,angle=90)
	abline(h=0.5,col="red")
	
	plot(e,colMeans(inCIs, na.rm=TRUE), pch=20, ylim=c(0,1), ylab="Percent of times in CIs")
	abline(h=0.95, col="red")

</code></pre>


</div>