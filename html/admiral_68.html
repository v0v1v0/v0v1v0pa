<div class="container">

<table style="width: 100%;"><tr>
<td>derive_param_bsa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adds a Parameter for BSA (Body Surface Area) Using the Specified Method</h2>

<h3>Description</h3>

<p>Adds a record for BSA (Body Surface Area) using the specified derivation
method for each by group (e.g., subject and visit) where the source parameters are
available.
</p>
<p><strong>Note:</strong> This is a wrapper function for the more generic <code>derive_param_computed()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derive_param_bsa(
  dataset,
  by_vars,
  method,
  set_values_to = exprs(PARAMCD = "BSA"),
  height_code = "HEIGHT",
  weight_code = "WEIGHT",
  get_unit_expr,
  filter = NULL,
  constant_by_vars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Input dataset
</p>
<p>The variables specified by the <code>by_vars</code> argument are expected to be in the dataset.
<code>PARAMCD</code>, and <code>AVAL</code> are expected as well.
</p>
<p>The variable specified by <code>by_vars</code> and <code>PARAMCD</code> must be a unique key of
the input dataset after restricting it by the filter condition (<code>filter</code>
parameter) and to the parameters specified by <code>HEIGHT</code> and <code>WEIGHT</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_vars</code></td>
<td>
<p>Grouping variables
</p>
<p>For each group defined by <code>by_vars</code> an observation is added to the output
dataset. Only variables specified in <code>by_vars</code> will be populated
in the newly created records.
</p>
<p><em>Permitted Values</em>: list of variables created by <code>exprs()</code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Derivation method to use. Note that <code>HEIGHT</code> is expected
in cm and <code>WEIGHT</code> is expected in kg:
</p>
<p>Mosteller: <code>sqrt(height * weight / 3600)</code>
</p>
<p>DuBois-DuBois: <code>0.20247 * (height/100) ^ 0.725 * weight ^ 0.425</code>
</p>
<p>Haycock: <code>0.024265 * height ^ 0.3964 * weight ^ 0.5378</code>
</p>
<p>Gehan-George: <code>0.0235 * height ^ 0.42246 * weight ^ 0.51456</code>
</p>
<p>Boyd: <code>0.0003207 * (height ^ 0.3) * (1000 * weight) ^ (0.7285 - (0.0188 * log10(1000 * weight)))</code>
</p>
<p>Fujimoto: <code>0.008883 * height ^ 0.663 * weight ^ 0.444</code>
</p>
<p>Takahira: <code>0.007241 * height ^ 0.725 * weight ^ 0.425</code>
</p>
<p><em>Permitted Values:</em> character value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_values_to</code></td>
<td>
<p>Variables to be set
</p>
<p>The specified variables are set to the specified values for the new
observations. For example <code>exprs(PARAMCD = "MAP")</code> defines the parameter code
for the new parameter.
</p>
<p><em>Permitted Values</em>: List of variable-value pairs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height_code</code></td>
<td>
<p>HEIGHT parameter code
</p>
<p>The observations where <code>PARAMCD</code> equals the specified value are considered
as the HEIGHT assessments. It is expected that HEIGHT is measured in cm.
</p>
<p><em>Permitted Values:</em> character value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight_code</code></td>
<td>
<p>WEIGHT parameter code
</p>
<p>The observations where <code>PARAMCD</code> equals the specified value are considered
as the WEIGHT assessments. It is expected that WEIGHT is measured in kg.
</p>
<p><em>Permitted Values:</em> character value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>get_unit_expr</code></td>
<td>
<p>An expression providing the unit of the parameter
</p>
<p>The result is used to check the units of the input parameters.
</p>
<p>Permitted Values: A variable of the input dataset or a function call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>Filter condition
</p>
<p>The specified condition is applied to the input dataset before deriving the
new parameter, i.e., only observations fulfilling the condition are taken
into account.
</p>
<p><em>Permitted Values:</em> a condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant_by_vars</code></td>
<td>
<p>By variables for when HEIGHT is constant
</p>
<p>When HEIGHT is constant, the HEIGHT parameters (measured only once) are merged
to the other parameters using the specified variables.
</p>
<p>If height is constant (e.g. only measured once at screening or baseline) then
use <code>constant_by_vars</code> to select the subject-level variable to merge on (e.g. <code>USUBJID</code>).
This will produce BSA at all visits where weight is measured.  Otherwise
it will only be calculated at visits with both height and weight collected.
</p>
<p><em>Permitted Values</em>: list of variables created by <code>exprs()</code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The input dataset with the new parameter added. Note, a variable will only
be populated in the new parameter rows if it is specified in <code>by_vars</code>.
</p>


<h3>See Also</h3>

<p><code>compute_bsa()</code>
</p>
<p>BDS-Findings Functions for adding Parameters/Records: 
<code>default_qtc_paramcd()</code>,
<code>derive_expected_records()</code>,
<code>derive_extreme_event()</code>,
<code>derive_extreme_records()</code>,
<code>derive_locf_records()</code>,
<code>derive_param_bmi()</code>,
<code>derive_param_computed()</code>,
<code>derive_param_doseint()</code>,
<code>derive_param_exist_flag()</code>,
<code>derive_param_exposure()</code>,
<code>derive_param_framingham()</code>,
<code>derive_param_map()</code>,
<code>derive_param_qtc()</code>,
<code>derive_param_rr()</code>,
<code>derive_param_wbc_abs()</code>,
<code>derive_summary_records()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)

# Example 1: Derive BSA where height is measured only once using constant_by_vars
advs &lt;- tibble::tribble(
  ~USUBJID, ~PARAMCD, ~PARAM, ~AVAL, ~VISIT,
  "01-701-1015", "HEIGHT", "Height (cm)", 170, "BASELINE",
  "01-701-1015", "WEIGHT", "Weight (kg)", 75, "BASELINE",
  "01-701-1015", "WEIGHT", "Weight (kg)", 78, "MONTH 1",
  "01-701-1015", "WEIGHT", "Weight (kg)", 80, "MONTH 2",
  "01-701-1028", "HEIGHT", "Height (cm)", 185, "BASELINE",
  "01-701-1028", "WEIGHT", "Weight (kg)", 90, "BASELINE",
  "01-701-1028", "WEIGHT", "Weight (kg)", 88, "MONTH 1",
  "01-701-1028", "WEIGHT", "Weight (kg)", 85, "MONTH 2",
)

derive_param_bsa(
  advs,
  by_vars = exprs(USUBJID, VISIT),
  method = "Mosteller",
  set_values_to = exprs(
    PARAMCD = "BSA",
    PARAM = "Body Surface Area (m^2)"
  ),
  get_unit_expr = extract_unit(PARAM),
  constant_by_vars = exprs(USUBJID)
)

derive_param_bsa(
  advs,
  by_vars = exprs(USUBJID, VISIT),
  method = "Fujimoto",
  set_values_to = exprs(
    PARAMCD = "BSA",
    PARAM = "Body Surface Area (m^2)"
  ),
  get_unit_expr = extract_unit(PARAM),
  constant_by_vars = exprs(USUBJID)
)

# Example 2: Derive BSA where height is measured only once and keep only one record
# where both height and weight are measured.

derive_param_bsa(
  advs,
  by_vars = exprs(USUBJID, VISIT),
  method = "Mosteller",
  set_values_to = exprs(
    PARAMCD = "BSA",
    PARAM = "Body Surface Area (m^2)"
  ),
  get_unit_expr = extract_unit(PARAM)
)

# Example 3: Pediatric study where height and weight are measured multiple times
advs &lt;- tibble::tribble(
  ~USUBJID, ~PARAMCD, ~PARAM, ~AVAL, ~VISIT,
  "01-101-1001", "HEIGHT", "Height (cm)", 47.1, "BASELINE",
  "01-101-1001", "HEIGHT", "Height (cm)", 59.1, "WEEK 12",
  "01-101-1001", "HEIGHT", "Height (cm)", 64.7, "WEEK 24",
  "01-101-1001", "HEIGHT", "Height (cm)", 68.2, "WEEK 48",
  "01-101-1001", "WEIGHT", "Weight (kg)", 2.6, "BASELINE",
  "01-101-1001", "WEIGHT", "Weight (kg)", 5.3, "WEEK 12",
  "01-101-1001", "WEIGHT", "Weight (kg)", 6.7, "WEEK 24",
  "01-101-1001", "WEIGHT", "Weight (kg)", 7.4, "WEEK 48",
)
derive_param_bsa(
  advs,
  by_vars = exprs(USUBJID, VISIT),
  method = "Mosteller",
  set_values_to = exprs(
    PARAMCD = "BSA",
    PARAM = "Body Surface Area (m^2)"
  ),
  get_unit_expr = extract_unit(PARAM)
)
</code></pre>


</div>