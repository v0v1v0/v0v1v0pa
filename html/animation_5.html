<div class="container">

<table style="width: 100%;"><tr>
<td>ani.record</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Record and replay animations</h2>

<h3>Description</h3>

<p>These two functions use <code>recordPlot</code> and <code>replayPlot</code>
to record image frames and replay the animation respectively.
</p>
<p>Replay the animation
</p>


<h3>Usage</h3>

<pre><code class="language-R">ani.record(reset = FALSE, replay.cur = FALSE)

ani.replay(list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reset</code></td>
<td>
<p>if <code>TRUE</code>, the recording list will be cleared, otherwise
new plots will be appended to the existing list of recorded plots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replay.cur</code></td>
<td>
<p>whether to replay the current plot (we can set both
<code>reset</code> and <code>replay.cur</code> to <code>TRUE</code> so that low-level
plotting changes can be captured by off-screen graphics devices without
storing all the plots in memory; see Note)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p>a list of recorded plots; if missing, the recorded plots by
<code>ani.record</code> will be used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>One difficulty in capturing images in R (base graphics) is that the
off-screen graphics devices cannot capture low-level plotting commands as
<em>new</em> image files – only high-level plotting commands can produce new
image files; <code>ani.record</code> uses <code>recordPlot</code> to record
the plots when any changes are made on the current plot. For a graphical
device to be recordable, you have to call <code>dev.control('enable')</code> before
plotting.
</p>
<p><code>ani.replay</code> can replay the recorded plots as an
animation. Moreover, we can convert the recorded plots to other formats
too, e.g. use <code>saveHTML</code> and friends.
</p>
<p>The recorded plots are stored as a list in <code>.ani.env$.images</code>, which
is the default value to be passed to <code>ani.replay</code>;
<code>.ani.env</code> is an invisible <code>environment</code> created when this
package is loaded, and it will be used to store some commonly used objects
such as animation options (<code>ani.options</code>).
</p>


<h3>Value</h3>

<p>Invisible <code>NULL</code>.
</p>


<h3>Note</h3>

<p>Although we can record changes made by low-level plotting commands
using <code>ani.record</code>, there is a price to pay – we need memory
to store the recorded plots, which are usually verg large when the plots
are complicated (e.g. we draw millions of points or polygons in a single
plot). However, we can set <code>replay.cur</code> to force R to produce a new
copy of the current plot, which will be automatically recorded by
off-screen grapihcs devices as <em>new</em> image files. This method has a
limitation: we must open a screen device to assist R to record the plots.
See the last example below. We must be very careful that no other graphics
devices are opened before we use this function.
</p>
<p>If we use base graphics, we should bear in mind that the background colors
of the plots might be transparent, which could lead to problems in HTML
animation pages when we use the <code>png</code> device (see the examples
below).
</p>


<h3>Author(s)</h3>

<p>Yihui Xie
</p>


<h3>References</h3>

<p>Examples at <a href="https://yihui.org/animation/example/ani-record/">https://yihui.org/animation/example/ani-record/</a>
</p>


<h3>See Also</h3>

<p><code>recordPlot</code> and <code>replayPlot</code>;
<code>ani.pause</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(animation)

n = 20
x = sort(rnorm(n))
y = rnorm(n)
## set up an empty frame, then add points one by one
par(bg = "white")  # ensure the background color is white
plot(x, y, type = "n")

ani.record(reset = TRUE)  # clear history before recording

for (i in 1:n) {
    points(x[i], y[i], pch = 19, cex = 2)
    ani.record()  # record the current frame
}

## now we can replay it, with an appropriate pause between frames
oopts = ani.options(interval = 0.5)
ani.replay()

## or export the animation to an HTML page
saveHTML(ani.replay(), img.name = "record_plot")

## record plots and replay immediately
saveHTML({
    dev.control("enable")  # enable recording
    par(bg = "white")  # ensure the background color is white
    plot(x, y, type = "n")
    for (i in 1:n) {
        points(x[i], y[i], pch = 19, cex = 2)
        ani.record(reset = TRUE, replay.cur = TRUE)  # record the current frame
    }
})

ani.options(oopts)
</code></pre>


</div>