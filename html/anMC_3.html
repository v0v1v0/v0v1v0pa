<div class="container">

<table style="width: 100%;"><tr>
<td>ANMC_Gauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ANMC estimate for the remainder</h2>

<h3>Description</h3>

<p>Asymmetric nested Monte Carlo estimation of <code class="reqn">P(max X^{-q} &gt; threshold | max X^{q} \le threshold)</code> where X is a normal vector. It is used for the bias correction in <code>ProbaMax</code> and <code>ProbaMin</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ANMC_Gauss(
  compBdg,
  problem,
  delta = 0.4,
  type = "M",
  trmvrnorm = trmvrnorm_rej_cpp,
  typeReturn = 0,
  verb = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>compBdg</code></td>
<td>
<p>total computational budget in seconds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>problem</code></td>
<td>
<p>list defining the problem with mandatory fields </p>

<ul>
<li>
<p> muEq = mean vector of <code class="reqn">X^{q}</code>;
</p>
</li>
<li>
<p> sigmaEq = covariance matrix of <code class="reqn">X^q</code>;
</p>
</li>
<li>
<p> threshold = fixed threshold <code class="reqn">t</code>;
</p>
</li>
<li>
<p> muEmq = mean vector of <code class="reqn">X^{-q}</code>;
</p>
</li>
<li>
<p> wwCondQ = “weights” for <code class="reqn">X^{-q} | X^q</code> [the vector <code class="reqn">\Sigma^{-q,q}(\Sigma^q)^{-1}</code>];
</p>
</li>
<li>
<p> sigmaCondQChol = Cholesky factorization of the conditional covariance matrix <code class="reqn">\Sigma^{-q | q}</code>;
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>total proportion of budget assigned to initial estimate (default 0.4), the actual proportion used might be smaller.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of excursion: "m", for minimum below threshold or "M", for maximum above threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trmvrnorm</code></td>
<td>
<p>function to generate truncated multivariate normal samples, it must have the following signature trmvrnorm(n,mu,sigma,upper,lower,verb), where </p>

<ul>
<li> <p><code>n</code>: number of simulations;
</p>
</li>
<li> <p><code>mu</code>: mean vector of the Normal variable of dimension <code class="reqn">d</code>;
</p>
</li>
<li> <p><code>sigma</code>: covariance matrix of dimension <code class="reqn">d x d</code>;
</p>
</li>
<li> <p><code>upper</code>: vector of upper limits of length <code>d</code>;
</p>
</li>
<li> <p><code>lower</code>: vector of lower limits of length <code>d</code>;
</p>
</li>
<li> <p><code>verb</code>: the level of verbosity 3 basic, 4 extended.
</p>
</li>
</ul>
<p>It must return a matrix <code class="reqn">d x n</code> of realizations. If not specified, the rejection sampler <code>trmvrnorm_rej_cpp</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>typeReturn</code></td>
<td>
<p>integer chosen between </p>

<ul>
<li>
<p> 0 a number with only the probability estimation;
</p>
</li>
<li>
<p> 1 light return: a list with the probability estimator, the variance of the estimator, the vectors of conditional quantities used to obtain m^* and the system dependent parameters;
</p>
</li>
<li>
<p> 2 heavy return: the same list as light return with also the computational times and additional intermediate parameters.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>level of verbosity (0,1 for this function), also sets the verbosity of trmvrnorm (to verb-1).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the estimated probability of excursion, see <code>typeReturn</code> for details.
</p>


<h3>References</h3>

<p>Azzimonti, D. and Ginsbourger, D. (2018). Estimating orthant probabilities of high dimensional Gaussian vectors with an application to set estimation. Journal of Computational and Graphical Statistics, 27(2), 255-267. Preprint at <a href="https://hal.science/hal-01289126">hal-01289126</a>
</p>
<p>Azzimonti, D. (2016). Contributions to Bayesian set estimation relying on random field priors. PhD thesis, University of Bern.
</p>
<p>Dickmann, F. and Schweizer, N. (2014). Faster comparison of stopping times by nested conditional Monte Carlo. arXiv preprint arXiv:1402.0243.
</p>
<p>Genz, A. (1992). Numerical computation of multivariate normal probabilities. Journal of Computational and Graphical Statistics, 1(2):141–149.
</p>


</div>