<div class="container">

<table style="width: 100%;"><tr>
<td>plot.roc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot ROC curves and associated diagnostics</h2>

<h3>Description</h3>

<p>Produces up to four plots (selectable by <code>"which"</code>) from the
results of a call to <code>roc</code>, including the ROC curve
itself.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'roc'
plot(x,
     which = c(1:3,5),
     group = "Combined",
     prior = NULL,
     show.stats = TRUE,
     abline.col = "grey",
     abline.lty = "dashed",
     inGroup.col = "red",
     outGroup.col = "blue",
     lty = "solid",
     caption = c("ROC curve", "Dissimilarity profiles",
                 "TPF - FPF vs Dissimilarity",
                 "Likelihood ratios"),
     legend = "topright",
     ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(),
     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"roc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>numeric vector; which aspects of <code>"roc"</code> object to
plot if a subset of the plots is required, specify a subset of the
numbers <code>1:5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>character vector of length 1 giving the name of the group
to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>numeric vector of length 2 (e.g. <code>c(0.5, 0.5)</code>)
specifiying the prior probabilities of analogue and
no-analogue. Used to generate posterior probability of analogue
using Bayes factors in plot 5 (<code>which = 5</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.stats</code></td>
<td>
<p>logical; should concise summary statistics of the
ROC analysis be displayed on the plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline.col</code></td>
<td>
<p>character string or numeric value; the
colour used to draw vertical lines at the optimal dissimilarity on
the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline.lty</code></td>
<td>
<p>Line type for indicator of optimal ROC dissimilarity
threshold. See <code>par</code> for the allowed line types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inGroup.col</code></td>
<td>
<p>character string or numeric value; the colour used
to draw the density curve for the dissimilarities between sites in
the same group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outGroup.col</code></td>
<td>
<p>character string or numeric value; the colour used
to draw the density curve for the dissimilarities between sites not in
the same group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>vector of at most length 2 (elements past the second in
longer vectors are ignored) line types. The first element of
<code>lty</code> will be used where a single line is drawn on a
plot. Where two lines are drawn (for analogue and non-analogue
cases), the first element pertains to the analogue group and the
second element to the non-analogue group. See <code>par</code> for
the allowed line types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>vector of character strings, containing the captions to
appear above each plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>character; position of legends drawn on plots. See
Details section in <code>legend</code> for keywords that can be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is <em>ask</em>ed before
each plot, see <code>par(ask=.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments passed to other graphics functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plotting function is modelled closely on <code>plot.lm</code>
and many of the conventions and defaults for that function are
replicated here.
</p>
<p>First, some definitions:
</p>

<dl>
<dt><strong>TPF</strong></dt>
<dd>
<p> True Positive Fraction, also known as
<em>sensitivity</em>.</p>
</dd>
<dt><strong>TNF</strong></dt>
<dd>
<p> True Negative Fraction, also known as
<em>specificity</em>.</p>
</dd>
<dt><strong>FPF</strong></dt>
<dd>
<p> False Positive Fraction; the complement of TNF,
calculated as 1 - TNF. This is often referred to a 1 -
specificity. A false positive is also known as a type I error.</p>
</dd> 
<dt><strong>FNF</strong></dt>
<dd>
<p> False Negative Fraction; the complement of TPF,
calculated as 1 - TPF. A false negative is also known as a type II
error. </p>
</dd>
<dt><strong>AUC</strong></dt>
<dd>
<p> The Area Under the ROC Curve.</p>
</dd>
</dl>
<p>The "ROC curve" plot (<code>which = 1</code>,) draws the ROC curve itself as
a plot of the False Positive Fraction against the True Positive
Fraction. A diagonal 1:1 line represents no ability for the
dissimilarity coefficient to differentiate between groups. The AUC
statistic may also be displayed (see argument <code>"show.stats"</code>
above).
</p>
<p>The "Dissimilarity profile" plot (<code>which = 2</code>), draws the density
functions of the dissimilarity values (<em>d</em>) for the correctly
assigned samples and the incorrectly assigned samples. A dissimilarity
coefficient that is able to well distinguish the sample groupings will
have density functions for the correctly and incorrectly assigned
samples that have little overlap. Conversely, a poorly discriminating
dissimilarity coefficient will have density profiles for the two
assignments that overlap considerably. The point where the two curves
cross is the optimal dissimilarity or critical value, <em>d'</em>. This
represents the point where the difference between TPF and FPF is
maximal. The value of <em>d</em> at the point where the difference
between TPF and FPF is maximal will not neccesarily be the
same as the value of <em>d'</em> where the density profiles cross. This
is because the ROC curve has been estimated at discrete points
<em>d</em>, which may not include excatly the optimal <em>d'</em>, but
which should be close to this value if the ROC curve is not sampled on
too coarse an interval.
</p>
<p>The "TPF - FPF vs Dissimilarity" plot, draws the difference between
the ROC curve and the 1:1 line. The point where the ROC curve is
farthest from the 1:1 line is the point at which the ROC curve has
maximal slope. This is the optimal value for <em>d</em>, as discussed
above.
</p>
<p>The "Likelihood ratios" plot, draws two definitions of the
slope of the ROC curve as the likelihood functions LR(+), and
LR(-). LR(+), is the likelihood ratio of a positive test result, that
the value of <em>d</em> assigns the sample to the group it belongs
to. LR(-) is the likelihood ratio of a negative test result, that the
value of <em>d</em> assigns the sample to the wrong group.
</p>
<p>LR(+) is defined as <code class="reqn">LR(+) = TPF / FPF</code> (or sensitivity / (1 -
specificity)), and LR(-) is defined as <code class="reqn">LR(-) = FPF / TNF</code> (or (1
- sensitivity) / specificity), in Henderson (1993).
</p>
<p>The “probability of analogue” plot, draws the posterior
probability of analogue given a dissimilarity. This is the
LR(+) likelihood ratio values multiplied by the prior odds of
analogue, for given values of the dissimilarity, and is then converted
to a  probability. 
</p>


<h3>Value</h3>

<p>One or more plots, drawn on the current device.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson. Code borrows heavily from <code>plot.lm</code>.</p>


<h3>References</h3>

<p>Brown, C.D., and Davis, H.T. (2006) Receiver operating characteristics
curves and related decision measures: A tutorial. <em>Chemometrics
and Intelligent Laboratory Systems</em> <b>80</b>, 24–38.
</p>
<p>Gavin, D.G., Oswald, W.W., Wahl, E.R. and Williams, J.W. (2003) A
statistical approach to evaluating distance metrics and analog
assignments for pollen records. <em>Quaternary Research</em>
<strong>60</strong>, 356–367.
</p>
<p>Henderson, A.R. (1993) Assessing test accuracy and its clinical
consequences: a primer for receiver operating characteristic curve
analysis. <em>Annals of Clinical Biochemistry</em> <strong>30</strong>,
834–846.
</p>


<h3>See Also</h3>

<p><code>roc</code> for a complete example</p>


</div>