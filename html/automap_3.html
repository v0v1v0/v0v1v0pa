<div class="container">

<table style="width: 100%;"><tr>
<td>autoKrige.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic cross-validation</h2>

<h3>Description</h3>

<p>Uses <code>autofitVariogram</code> to fit a variogram model to the data and then calls
<code>krige.cv</code> to perform cross-validation.</p>


<h3>Usage</h3>

<pre><code class="language-R">autoKrige.cv(formula, 
	     input_data, 
	     data_variogram = input_data,
	     model = c("Sph", "Exp", "Gau", "Ste"), 
	     kappa = c(0.05, seq(0.2, 2, 0.1), 5, 10), 
	     fix.values = c(NA,NA,NA), 
	     verbose = c(FALSE, interactive()), 
	     GLS.model = NA,
         start_vals = c(NA,NA,NA),
         miscFitOptions = list(),
	     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula that defines the dependent variable as a linear model
of independent variables; suppose the dependent variable has
name 'z', for ordinary and simple kriging use the formula
'z~1'; for simple kriging also define 'beta' (see below); for
universal kriging, suppose 'z' is linearly dependent on 'x'
and 'y', use the formula 'z~x+y'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input_data</code></td>
<td>
<p>An object of the 
SpatialPointsDataFrame-class containing the data to be interpolated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_variogram</code></td>
<td>
<p>An optional way to provide a different dataset for
the building of the variogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>List of models that will be tested during automatic variogram fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>List of values for the smoothing parameter of the Matern model that will be tested during automatic variogram fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.values</code></td>
<td>
<p>Can be used to fix a variogram parameter to a certain value. It 
consists of a list with a length of three. The items describe the
fixed value for the nugget, range and sill respectively. Setting
the value to NA means that the value is not fixed. Is passed on to autofitVariogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>vector of 2 logicals. The first element sets the verbosity of autofitVariogram, see its documentation
for more information. The second element sets the verbosity level of krige.cv, see its documentation
for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GLS.model</code></td>
<td>
<p>If a variogram model is passed on through this parameter a Generalized Least Squares 
sample variogram is calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_vals</code></td>
<td>
<p>Can be used to give the starting values for the variogram fitting. The items describe the
fixed value for the nugget, range and sill respectively. They need to be given in that order.
Setting the value to NA means that the value will be automatically chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>miscFitOptions</code></td>
<td>
<p>Additional options to set the behavior of autofitVariogram. For details see the 
documentation of autofitVariogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>krige.cv</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>autoKrige.cv</code> returns an object of class <code>autoKrige.cv</code>. This is a list
containing one object of class <code>SpatialPointsDataFrame</code> with the results of
the cross-validation, see <code>krige.cv</code> for more details. The
attribute name is <code>krige.cv_output</code>.</p>


<h3>Author(s)</h3>

<p>Paul Hiemstra, <a href="mailto:paul@numbertheory.nl">paul@numbertheory.nl</a></p>


<h3>See Also</h3>

<p><code>krige.cv</code>, <code>autofitVariogram</code>, <code>compare.cv</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">library(sp)
data(meuse)
coordinates(meuse) = ~x+y
data(meuse.grid)
gridded(meuse.grid) = ~x+y

kr.cv = autoKrige.cv(log(zinc)~1, meuse, model = c("Exp"), nfold = 10)
kr_dist.cv = autoKrige.cv(log(zinc)~sqrt(dist), meuse, 
       model = c("Exp"), nfold = 10)
kr_dist_ffreq.cv = autoKrige.cv(log(zinc)~sqrt(dist)+ffreq, 
       meuse, model = c("Exp"), nfold = 10)
       

</code></pre>


</div>