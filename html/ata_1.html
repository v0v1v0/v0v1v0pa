<div class="container">

<table style="width: 100%;"><tr>
<td>atalp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automated Test Assembly via Linear Constrained Programming</h2>

<h3>Description</h3>

<p>Ingests item metadata jointly with target test form constraints, and can be parametarized to uses either Boolean (0-1) Integer Linear Programming (ILP) or Mixed Integer Linear Programming (MILP) to construct a test form based on the desired objectives. When MILP is desired the selection of the objective function type should be changed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">atalp( ipool,
      id,
      constraints,
      refine = FALSE,
      permutate = FALSE,
      sorttimes = 999,
      tieselect = -1,
      type = "const",
      verbose = TRUE,
      aprioriadd = NA,
      posthocadd = NA )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ipool</code></td>
<td>
<p>Item by characteristic (property) metadata pool.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Name of unique item identifier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints</code></td>
<td>
<p>Complex list object identifying the constraints to be applied in the ATA (see <code>makeconstobj</code> for guided process).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refine</code></td>
<td>
<p>Creates a final test form from permutated solutions, refined to attempt a deviation balance between the observed form and the constraints. Option only effective if <code>permutate</code> is <code>TRUE</code> and <code>type = const</code> in which the constraint weights have meaning; Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permutate</code></td>
<td>
<p>Requests the test form to be assembled by resorting (<code>sorttimes</code>) the metadata and selecting the most frequently occurring item combination satisfying the constraints. Relevant only for <code>type = const</code>; Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sorttimes</code></td>
<td>
<p>Number of how often the original input metadata should be resorted. Only functional if <code>permutate</code> is <code>TRUE</code> and <code>type = const</code>; default <code>999</code>, so that <code>sorttimes</code> + main analysis account for a total of 1,000 selection versions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tieselect</code></td>
<td>
<p>How should tied items be resolved: -1 (default) - do not manipulate items (which allows for identically functioning items to be included), 1 - select the first item in the list of candidates (sensitive to data sorting); not applicable for situations with all categorical constraints only, 0 - randomly select candidate; not applicable for situations with all categorical constraints only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of objective function: <code>const</code> - constraint based only (default), <code>parmin</code> - constraint + minimum non-categorical parameter combination, <code>parmax</code> - constraint + maximum non-categorical parameter combination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should progress be printed to the console? Default <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aprioriadd</code></td>
<td>
<p>Force item addition (via IDs) to test form before ATA, which affects item selection and constraint attainment success (currently not available).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posthocadd</code></td>
<td>
<p>Force item addition (via IDs) to test form after ATA, which affects final form specifications (currently not available).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A complex list object with test assembly specific estimates:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p>Constrained objective function value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items_removed</code></td>
<td>
<p>Removed items from item pool when <code>tieselect</code> is not <code>-1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excluded</code></td>
<td>
<p>Items from pool excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excluded_set</code></td>
<td>
<p>Item sets excluded. Only included if input <code>constobj</code> includes a <code>set_id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>included</code></td>
<td>
<p>Items from pool included in new test form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>included_set</code></td>
<td>
<p>Item sets from pool included in new test form. Only included if input <code>constobj</code> includes a <code>set_id</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_ids</code></td>
<td>
<p>Final item ids in the test form.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_setids</code></td>
<td>
<p>Final set ids in the test form. Only included if input <code>constobj</code> includes a <code>set_id</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael Chajewski (mchajewski@hotmail.com), Gulsah Gurkan (gurkangulsah@gmail.com)
</p>


<h3>References</h3>

<p>Chen, P. (2017). Should we stop developing heuristics and only rely on mixed integer programming solvers in automated test assembly? Applied Psychological Measurement, 41, 227-240.
</p>
<p>Diao, Q., &amp; van der Linden, W. J. (2011). Automated test assembly using lp_Solve Version 5.5 in R. Applied Psychological Measurement, 35, 398-409.
</p>
<p>Shao, C., Liu, S., Yang, H., &amp; Tsai, T. (2019). Automated test assembly using SAS operations research software in a medical licensing examination. Applied Psychological Measurement, 00, 1-15.
</p>
<p>van der Linden, W. J. (2005). A comparison of item-selection methods for adaptive tests with content constraints. Journal of Educational Measurement, 42, 283-302.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Specifying constraints
constin &lt;- list(
  nI = 5,                                     # Number of items on the future test
  nC = 4,                                     # Number of constraints to be satisfied
  nameC = c("Content_A","Content_B","p","iSx"), # Name of constraint; must be numeric and must
  # reflect variable name in input
  lowerC = c(2, 3, 3.00, 0.50),               # Lower bound total constraint value on ATA form
  upperC = c(2, 3, 3.50, 0.60),               # Upper bound total constraint value on ATA form
  wC = c(1, 1, 1, 1),                         # Constraint weight used for weighted sum of
                                              # (positive) deviations St
  set_id = NA                                 # Aggregation ID for units / sets 
)

# Running atalp
testLP &lt;- atalp(ipool = metadata_example,
                id = "Item",
                constraints = constin)

# Summary of results
summary(testLP)

</code></pre>


</div>