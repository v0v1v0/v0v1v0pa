<div class="container">

<table style="width: 100%;"><tr>
<td>create_taxonomic_update_lookup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a table with the best-possible scientific name match for
Australian plant names</h2>

<h3>Description</h3>

<p>This function takes a list of Australian plant names that need to be
reconciled with current taxonomy and generates a lookup table of the
best-possible scientific name match for each input name.
</p>
<p>Usage case: This is APCalign’s core function, merging together the alignment
and updating of taxonomy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">create_taxonomic_update_lookup(
  taxa,
  stable_or_current_data = "stable",
  version = default_version(),
  taxonomic_splits = "most_likely_species",
  full = FALSE,
  fuzzy_abs_dist = 3,
  fuzzy_rel_dist = 0.2,
  fuzzy_matches = TRUE,
  APNI_matches = TRUE,
  imprecise_fuzzy_matches = FALSE,
  identifier = NA_character_,
  resources = load_taxonomic_resources(),
  quiet = FALSE,
  output = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxa</code></td>
<td>
<p>A list of Australian plant species that needs to be reconciled
with current taxonomy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stable_or_current_data</code></td>
<td>
<p>either "stable" for a consistent version,
or "current" for the leading edge version.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>The version number of the dataset to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxonomic_splits</code></td>
<td>
<p>How to handle one_to_many taxonomic matches.
Default is "return_all".  The other options are "collapse_to_higher_taxon"
and "most_likely_species". most_likely_species defaults to the original_name
if that name is accepted by the APC; this will be right for certain species
subsets, but make errors in other cases, use with caution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical for whether the full lookup table is returned or
just key columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy_abs_dist</code></td>
<td>
<p>The number of characters allowed to be different for
a fuzzy match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy_rel_dist</code></td>
<td>
<p>The proportion of characters allowed to be different
for a fuzzy match.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fuzzy_matches</code></td>
<td>
<p>Fuzzy matches are turned on as a default. The relative
and absolute distances allowed for fuzzy matches to species and
infraspecific taxon names are defined by the parameters <code>fuzzy_abs_dist</code>
and <code>fuzzy_rel_dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>APNI_matches</code></td>
<td>
<p>Name matches to the APNI (Australian Plant Names Index)
are turned off as a default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imprecise_fuzzy_matches</code></td>
<td>
<p>Imprecise fuzzy matches uses the fuzzy
matching function with lenient levels set (absolute distance of
5 characters; relative distance = 0.25).
It offers a way to get a wider range of possible names, possibly
corresponding to very distant spelling mistakes.
This is FALSE as default and all outputs should be checked as it often
makes erroneous matches.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identifier</code></td>
<td>
<p>A dataset, location or other identifier,
which defaults to NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resources</code></td>
<td>
<p>These are the taxonomic resources used for cleaning, this
will default to loading them from a local place on your computer. If this is
to be called repeatedly, it's much faster to load the resources using
<code>load_taxonomic_resources</code> separately and pass the data in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Logical to indicate whether to display messages while
aligning taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>file path to save the output. If this file already exists,
this function will check if it's a subset of the species passed in and try
to add to this file. This can be useful for large and growing projects.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul><li>
<p> It uses first the function <code>align_taxa</code>, then the function <code>update_taxonomy</code>
to achieve the output. The aligned name is plant name that has been aligned
to a taxon name in the APC or APNI by the align_taxa function.
</p>
</li></ul>
<p>Notes:
</p>

<ul>
<li>
<p> If you will be running the function APCalign::create_taxonomic_update_lookup
many times, it is best to load the taxonomic resources separately using
<code>resources &lt;- load_taxonomic_resources()</code>, then add the argument
resources = resources
</p>
</li>
<li>
<p> The name Banksia cerrata does not align as the fuzzy matching algorithm
does not allow the first letter of the genus and species epithet to change.
</p>
</li>
<li>
<p> The argument taxonomic_splits allows you to choose the outcome for updating
the names of taxa with ambiguous taxonomic histories; this applies to
scientific names that were once attached to a more broadly circumscribed
taxon concept, that was then split into several more narrowly circumscribed
taxon concepts, one of which retains the original name. There are three
options: most_likely_species returns the name that is retained, with
alternative names documented in square brackets; return_all adds additional
rows to the output, one for each possible taxon concept;
collapse_to_higher_taxon returns the genus with possible names in square
brackets.
</p>
</li>
<li>
<p> The argument identifier allows you to add a fix text string to all genus-
and family- level names, such as identifier = "Royal NP" would return
<code style="white-space: pre;">⁠Acacia sp. \[Royal NP]⁠</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A lookup table containing the accepted and suggested names for each
original name input, and additional taxonomic information such as taxon
rank, taxonomic status, taxon IDs and genera.
</p>

<ul>
<li>
<p> original_name: the original plant name.
</p>
</li>
<li>
<p> aligned_name: the input plant name that has been aligned to a taxon name in
the APC or APNI by the align_taxa function.
</p>
</li>
<li>
<p> accepted_name: the APC-accepted plant name, when available.
</p>
</li>
<li>
<p> suggested_name: the suggested plant name to use. Identical to the
accepted_name, when an accepted_name exists;
otherwise the the suggested_name is the aligned_name.
</p>
</li>
<li>
<p> genus: the genus of the accepted (or suggested) name;
only APC-accepted genus names are filled in.
</p>
</li>
<li>
<p> family: the family of the accepted (or suggested) name;
only APC-accepted family names are filled in.
</p>
</li>
<li>
<p> taxon_rank: the taxonomic rank of the suggested (and accepted) name.
</p>
</li>
<li>
<p> taxonomic_dataset: the source of the suggested (and accepted) names
(APC or APNI).
</p>
</li>
<li>
<p> taxonomic_status: the taxonomic status of the suggested (and accepted) name.
</p>
</li>
<li>
<p> taxonomic_status_aligned: the taxonomic status of the aligned name,
before any taxonomic updates have been applied.
</p>
</li>
<li>
<p> aligned_reason: the explanation of a specific taxon name alignment
(from an original name to an aligned name).
</p>
</li>
<li>
<p> update_reason: the explanation of a specific taxon name update
(from an aligned name to an accepted or suggested name).
</p>
</li>
<li>
<p> subclass: the subclass of the accepted name.
</p>
</li>
<li>
<p> taxon_distribution: the distribution of the accepted name;
only filled in if an APC accepted_name is available.
</p>
</li>
<li>
<p> scientific_name_authorship: the authorship information for the accepted
(or synonymous) name; available for both APC and APNI names.
</p>
</li>
<li>
<p> taxon_ID: the unique taxon concept identifier for the accepted_name;
only filled in if an APC accepted_name is available.
</p>
</li>
<li>
<p> taxon_ID_genus: an identifier for the genus;
only filled in if an APC-accepted genus name is available.
</p>
</li>
<li>
<p> scientific_name_ID: an identifier for the nomenclatural (not taxonomic)
details of a scientific name; available for both APC and APNI names.
</p>
</li>
<li>
<p> row_number: the row number of a specific original_name in the input.
</p>
</li>
<li>
<p> number_of_collapsed_taxa: when taxonomic_splits == "collapse_to_higher_taxon",
the number of possible taxon names that have been collapsed.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>load_taxonomic_resources</code>
</p>
<p>Other taxonomic alignment functions: 
<code>align_taxa()</code>,
<code>update_taxonomy()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
resources &lt;- load_taxonomic_resources()

# example 1
create_taxonomic_update_lookup(c("Eucalyptus regnans",
                                 "Acacia melanoxylon",
                                 "Banksia integrifolia",
                                 "Not a species"),
                                 resources = resources)
                                 
# example 2
input &lt;- c("Banksia serrata", "Banksia serrate", "Banksia cerrata", 
"Banksea serrata", "Banksia serrrrata", "Dryandra")

create_taxonomic_update_lookup(
    taxa = input,
    identifier = "APCalign test",
    full = TRUE,
    resources = resources
  )

# example 3
taxon_list &lt;-
  readr::read_csv(
  system.file("extdata", "test_taxa.csv", package = "APCalign"),
  show_col_types = FALSE)

create_taxonomic_update_lookup(
    taxa = taxon_list$original_name,
    identifier = taxon_list$notes,
    full = TRUE,
    resources = resources
  )


</code></pre>


</div>