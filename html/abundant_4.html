<div class="container">

<table style="width: 100%;"><tr>
<td>pred.response</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predict the response with the fitted high-dimensional principal fitted components model
</h2>

<h3>Description</h3>

<p>Let <code class="reqn">x\in R^p</code> denote the values of the <code class="reqn">p</code> predictors.
This function computes <code class="reqn">\widehat E(Y|X=x)</code> using equation (8.1)
of Cook, Forzani, and Rothman (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pred.response(fit, newx=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>The object returned by <code>fit.pfc()</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newx</code></td>
<td>

<p>A matrix with <code class="reqn">N</code> rows and <code class="reqn">p</code> columns where each row is an instance of <code class="reqn">x</code> described above.
If this argument is unspecified, then the fitted values are returned, i.e, 
<code>newx=X</code>, where <code>X</code> was the predictor matrix used in
the call to <code>fit.pfc()</code>.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Cook, Forzani, and Rothman (2012) for more information.
</p>


<h3>Value</h3>

<p>A vector of response prediction with <code>nrow(newx)</code> entries. 
</p>


<h3>Author(s)</h3>

<p>Adam J. Rothman
</p>


<h3>References</h3>

<p>Cook, R. D., Forzani, L., and Rothman, A. J. (2012).  
Estimating sufficient reductions of the predictors in abundant high-dimensional regressions. 
Annals of Statistics 40(1), 353-384.
</p>


<h3>See Also</h3>

<p><code>fit.pfc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n=25
p=50
d=1
true.G = matrix(rnorm(p*d), nrow=p, ncol=d)
y=rnorm(n)
fy = y
E=matrix(rnorm(n*p), nrow=n, ncol=p) 
X=fy%*%t(true.G) + E
fit=fit.pfc(X=X, r=4, d=d, y=y, weight.type="diag")
fitted.values=pred.response(fit)
mean((y-fitted.values)^2)
plot(fitted.values, y)

n.new=100
y.new=rnorm(n.new)
fy.new=y.new
E.new=matrix(rnorm(n.new*p), nrow=n.new, ncol=p) 
X.new = fy.new%*%t(true.G) + E.new
mean((y.new - pred.response(fit, newx=X.new))^2)  

</code></pre>


</div>