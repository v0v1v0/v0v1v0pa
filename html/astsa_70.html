<div class="container">

<table style="width: 100%;"><tr>
<td>mvspec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Univariate and Multivariate Spectral Estimation
</h2>

<h3>Description</h3>

<p>This is <code>spec.pgram</code> with a few changes in the defaults and written so you can easily extract the estimate of the multivariate spectral matrix as <code>fxx</code>.  The bandwidth calculation has been changed to the more practical definition given in the text and this can be used to replace <code>spec.pgram</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mvspec(x, spans = NULL, kernel = NULL, taper = 0, pad = 0, fast = TRUE, 
        demean = FALSE, detrend = TRUE, lowess = FALSE, log = 'n', plot = TRUE, 
        gg = FALSE, type = NULL, na.action = na.fail, nxm = 2, nym = 1, 
        main = NULL, xlab=NULL, cex.main=NULL, ci.col=4, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>univariate or multivariate time series (i.e., the p columns of x are time series)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spans </code></td>
<td>
<p>vector of odd integers giving the widths of modified Daniell smoothers to be used to smooth the periodogram
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel </code></td>
<td>
<p>alternatively, a kernel smoother of class <code>tskernel</code> 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taper </code></td>
<td>
<p>specifies the proportion of data to taper using a split cosine bell taper (.5 specifies a full taper)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad </code></td>
<td>
<p>proportion of data to pad (zeros are added to the end of the series to increase its length by the proportion pad)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast </code></td>
<td>
<p>logical; if TRUE, pad the series to a highly composite length
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean </code></td>
<td>
<p>if TRUE, series is demeaned first 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend </code></td>
<td>
<p>if TRUE, series is detrended first 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowess </code></td>
<td>
<p>if TRUE and detrend TRUE, series is detrended using lowess first 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log </code></td>
<td>
<p>if <code>log='y'</code>, spectra plotted on a log scale; otherwise a log scale is not used
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot </code></td>
<td>
<p>plot the estimated spectra 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg </code></td>
<td>
<p>if TRUE, will produce a gris-gris plot (gray graphic interior with white grid lines); the default is FALSE. The grammar of astsa is voodoo
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>type of plot to be drawn, defaults to lines (see <code>par</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action </code></td>
<td>
<p>how to handle missing values
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nxm, nym </code></td>
<td>

<p>the number of minor tick mark divisions on x-axis, y-axis; the default is one minor tick on the x-axis and none on the y-axis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main </code></td>
<td>
<p>title of the graphics; if NULL (default), a totally awesome title is generated dude, but if NA there will be no gnarly title and the top margin will be used for the plot
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab </code></td>
<td>
<p>label for frequency axis; if NULL (default), a totally awesome label is generated for your viewing pleasure
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>

<p>magnification for main title; default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.col</code></td>
<td>

<p>color of the confidence interval if one is drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>... </code></td>
<td>
<p>graphical arguments passed to <code>plot.spec</code>
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is built off of <code>spec.pgram</code> from the stats package with a few changes in the defaults and written so you can easily extract the estimate of the multivariate spectral matrix as <code>fxx</code>. 
</p>
<p>The default for the plot is NOT to plot on a log scale and the graphic will have a grid. 
</p>
<p>The bandwidth calculation has been changed to the more practical definition given in the text, <code class="reqn">(L_h/n.used)*frequency(x)</code>.  Also, the bandwidth is not displayed in the graphic, but is returned. 
</p>
<p>Although initially meant to be used to easily obtain multivariate (mv) spectral (spec) estimates, this script can be used for univariate time series as a replacement for <code>spec.pgram</code>.
</p>
<p>Note that the script does not taper by default (<code>taper=0</code>); this forces the user to do "conscious tapering".  
</p>


<h3>Value</h3>

<p>All results are returned invisibly.  
</p>
<p>If <code>plot</code> is TRUE, the bandwidth and degrees of freedom are printed. 
</p>
<p>An object of class "spec", which is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fxx </code></td>
<td>
<p>spectral matrix estimates; an array of dimensions <code>dim = c(p,p,nfreq)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq </code></td>
<td>
<p>vector of frequencies at which the spectral density is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec </code></td>
<td>
<p>vector (for univariate series) or matrix (for multivariate series) of estimates of the spectral density at frequencies corresponding to freq.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details </code></td>
<td>
<p>matrix with columns: frequency, period, spectral ordinate(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coh </code></td>
<td>
<p>NULL for univariate series. For multivariate time series, a matrix containing the squared coherency between different series. Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency between columns i and j of x, where i &lt; j.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase </code></td>
<td>
<p>NULL for univariate series. For multivariate time series a matrix containing the cross-spectrum phase between different series. The format is the same as coh.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lh </code></td>
<td>
<p>Number of frequencies (approximate) used in the band.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.used </code></td>
<td>
<p>Sample length used for the FFT</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df </code></td>
<td>
<p>Degrees of freedom (may be approximate) associated with the spectral estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth </code></td>
<td>
<p>Bandwidth (may be approximate) associated with the spectral estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p>The method used to calculate the spectrum.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class="language-R"># real raw periodogram
mvspec(soi)
mvspec(soi, log='y')  # on a log scale

# smooth and some details printed
mvspec(soi, spans=c(7,7), taper=.5)$details[1:45,]

# multivariate example
deth = cbind(mdeaths, fdeaths)    # two R data sets, male/female monthly deaths ...
tsplot(deth, type='b', col=c(4,6), spaghetti=TRUE, pch=c('M','F'))
dog = mvspec(deth, spans=c(3,3), taper=.1)
dog$fxx        # look at spectral matrix estimates
dog$bandwidth  # bandwidth with time unit = year
dog$df         # degrees of freedom
plot(dog, plot.type="coherency")  # plot of squared coherency
</code></pre>


</div>