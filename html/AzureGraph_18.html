<div class="container">

<table style="width: 100%;"><tr>
<td>graph_request</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Microsoft Graph request</h2>

<h3>Description</h3>

<p>Class representing a request to the Microsoft Graph API. Currently this is used only in building a batch call.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>graph_request</code>.
</p>


<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new request object with the given parameters. See 'Details' below.
</p>
</li>
<li> <p><code>batchify()</code>: Generate a list object suitable for incorporating into a call to the batch endpoint.
</p>
</li>
</ul>
<h3>Details</h3>

<p>The <code>initialize()</code> method takes the following arguments, representing the components of a HTTPS request:
</p>

<ul>
<li> <p><code>op</code>: The path of the HTTPS URL, eg <code style="white-space: pre;">⁠/me/drives⁠</code>.
</p>
</li>
<li> <p><code>body</code>: The body of the HTTPS request, if it is a PUT, POST or PATCH.
</p>
</li>
<li> <p><code>options</code>: A list containing the query parameters for the URL.
</p>
</li>
<li> <p><code>headers</code>: Any optional HTTP headers for the request.
</p>
</li>
<li> <p><code>encode</code>: If a request body is present, how it should be encoded when sending it to the endpoint. The default is <code>json</code>, meaning it will be sent as JSON text; an alternative is <code>raw</code>, for binary data.
</p>
</li>
<li> <p><code>http_verb</code>: One of "GET" (the default), "DELETE", "PUT", "POST", "HEAD", or "PATCH".
</p>
</li>
</ul>
<p>This class is currently used only for building batch calls. Future versions of AzureGraph may be refactored to use it in general API calls as well.
</p>


<h3>See Also</h3>

<p>call_batch_endpoint
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/json-batching">Batch endpoint documentation</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">graph_request$new("me")

# a new email message in Outlook
graph_request$new("me/messages",
    body=list(
        body=list(
            content="Hello from R",
            content_type="text"
        ),
        subject="Hello",
        toRecipients="bob@example.com"
    ),
    http_verb="POST"
)
</code></pre>


</div>