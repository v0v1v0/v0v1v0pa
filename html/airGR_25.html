<div class="container">

<table style="width: 100%;"><tr>
<td>Param_Sets_GR4J</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalist parameter sets for the GR4J model</h2>

<h3>Description</h3>

<p>These parameter sets can be used as an alternative for the grid-screening calibration procedure (i.e. first step in <code>Calibration_Michel</code>).
Please note that the given GR4J X4u variable does not correspond to the actual GR4J X4 parameter. As explained in Andréassian et al. (2014; section 2.1), the given GR4J X4u value has to be adjusted (rescaled) using catchment area (S) [km2] as follows: <code class="reqn">X4 = X4u / 5.995 \times S^{0.3}</code> (please note that the formula is erroneous in the publication). Please, see the example below. <br>
As shown in Andréassian et al. (2014; figure 4), only using these parameters sets as the tested values for calibration is more efficient than a classical calibration when the amount of data is low (6 months or less).
</p>


<h3>Format</h3>

<p>Data frame of parameters containing four numeric vectors:
</p>

<table>
<tr>
<td style="text-align: left;">
    GR4J X1  </td>
<td style="text-align: left;"> production store capacity [mm]             </td>
</tr>
<tr>
<td style="text-align: left;">
    GR4J X2  </td>
<td style="text-align: left;"> intercatchment exchange coefficient [mm/d] </td>
</tr>
<tr>
<td style="text-align: left;">
    GR4J X3  </td>
<td style="text-align: left;"> routing store capacity [mm]                </td>
</tr>
<tr>
<td style="text-align: left;">
    GR4J X4u </td>
<td style="text-align: left;"> unajusted unit hydrograph time constant [d]</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>

<p>Andréassian, V., Bourgin, F., Oudin, L., Mathevet, T., Perrin, C., Lerat, J., Coron, L. and Berthet, L. (2014).
Seeking genericity in the selection of parameter sets: Impact on hydrological model efficiency.
Water Resources Research, 50(10), 8356-8366, <a href="https://doi.org/10.1002/2013WR014761">doi:10.1002/2013WR014761</a>.
</p>


<h3>See Also</h3>

<p><code>RunModel_GR4J</code>, <code>Calibration_Michel</code>, <code>CreateCalibOptions</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## loading catchment data
data(L0123001)

## loading generalist parameter sets
data(Param_Sets_GR4J)
str(Param_Sets_GR4J)

## computation of the real GR4J X4
Param_Sets_GR4J$X4 &lt;- Param_Sets_GR4J$X4u / 5.995 * BasinInfo$BasinArea^0.3
Param_Sets_GR4J$X4u &lt;- NULL
Param_Sets_GR4J &lt;- as.matrix(Param_Sets_GR4J)

## preparation of the InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_GR4J, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E)

## --- calibration step

## short calibration period selection (&lt; 6 months)
Ind_Cal &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-02-28"))

## preparation of the RunOptions object for the calibration period
RunOptions_Cal &lt;- CreateRunOptions(FUN_MOD = RunModel_GR4J,
                                   InputsModel = InputsModel, IndPeriod_Run = Ind_Cal)

## simulation and efficiency criterion (Nash-Sutcliffe Efficiency)
## with all generalist parameter sets on the calibration period
OutputsCrit_Loop &lt;- apply(Param_Sets_GR4J, 1, function(Param) {
  OutputsModel_Cal &lt;- RunModel_GR4J(InputsModel = InputsModel,
                                    RunOptions = RunOptions_Cal,
                                    Param = Param)
  InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                  RunOptions = RunOptions_Cal, Obs = BasinObs$Qmm[Ind_Cal])
  OutputsCrit &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit, OutputsModel = OutputsModel_Cal)
  return(OutputsCrit$CritValue)
})

## best parameter set
Param_Best &lt;- unlist(Param_Sets_GR4J[which.max(OutputsCrit_Loop), ])


## --- validation step

## validation period selection
Ind_Val &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-03-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))

## preparation of the RunOptions object for the validation period
RunOptions_Val &lt;- CreateRunOptions(FUN_MOD = RunModel_GR4J,
                                   InputsModel = InputsModel, IndPeriod_Run = Ind_Val)

## simulation with the best parameter set on the validation period
OutputsModel_Val &lt;- RunModel_GR4J(InputsModel = InputsModel,
                                  RunOptions = RunOptions_Val,
                                  Param = Param_Best)

## results preview of the simulation with the best parameter set on the validation period
plot(OutputsModel_Val, Qobs = BasinObs$Qmm[Ind_Val])

## efficiency criterion (Nash-Sutcliffe Efficiency) on the validation period
InputsCrit_Val  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                RunOptions = RunOptions_Val, Obs = BasinObs$Qmm[Ind_Val])
OutputsCrit_Val &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit_Val, OutputsModel = OutputsModel_Val)
</code></pre>


</div>