<div class="container">

<table style="width: 100%;"><tr>
<td>AtCtEtp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fitting the ACE(t)-p model 
</h2>

<h3>Description</h3>

<p>The ACE(t)-p model with the A, C and E variance components as functions with respect to age modelled by P-splines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AtCtEtp(data_m, data_d, knot_a = 8, knot_c = 8, knot_e = 8, eps = 0.1, 
mod=c('d','d','d'), robust = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_m</code></td>
<td>

<p>An <code class="reqn">N_m</code> x 3 data matrix for MZ twins. <code class="reqn">N_m</code> is the number of MZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_d</code></td>
<td>

<p>An <code class="reqn">N_d</code> x 3 data matrix for DZ twins. <code class="reqn">N_d</code> is the number of DZ twin pairs. The first two columns are centered trait values (i.e. the mean should be zero) and the third column is age (or other covariates). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_a</code></td>
<td>

<p>The number of interior knots of the B-spline for the A component. The default value is 8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_c</code></td>
<td>

<p>The number of interior knots of the B-spline for the C component. The default value is 8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_e</code></td>
<td>

<p>The number of interior knots of the B-spline for the E component. The default value is 8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>Tolerance for convergence of the EM algorithm iterations. The default value is 0.1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>

<p>A character vector of length 3. Each element specifies the function for the A, C or E component respectively. The components can be 'd'(dynamic), 'c'(constant) or 'l'(linear). The default is c('d','d','d').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>An integer indicating the number of different initial values that the function will randomly generate and try in the optimization. The default value is 0.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the 'mod' argument for a component is 'd'(dynamic), the corresponding 'beta' is the spline coefficients.   
When the 'mod' argument for a component is 'l'(linear), the corresponding 'beta' is a vector of two values, the exponential of which (exp(beta)) are the variances at the minimum and maximum age (or other covariates) provided in the data.     
When the 'mod' argument for a component is 'c'(constant), the corresponding 'beta' has only one value and exp(beta) is the variance.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>var_b_a </code></td>
<td>
<p>The estimated variance for the penalized coefficient for the A components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_b_c </code></td>
<td>
<p>The estimated variance for the penalized coefficient for the C components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_b_e </code></td>
<td>
<p>The estimated variance for the penalized coefficient for the E components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_a </code></td>
<td>
<p>The estimated spline coefficients of the A component. See 'details' for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_c </code></td>
<td>
<p>The estimated spline coefficients of the C component. See 'details' for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_e </code></td>
<td>
<p>The estimated spline coefficients of the E component. See 'details' for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con </code></td>
<td>
<p>An indicator of convergence of the optimization algorithm. An integer code 0 indicates successful completion. See 'optim' for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lik </code></td>
<td>
<p>The minus log marginal likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_a </code></td>
<td>
<p>A vector of the knot positions for the A component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_c </code></td>
<td>
<p>A vector of the knot positions for the C component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knot_e </code></td>
<td>
<p>A vector of the knot positions for the E component.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liang He
</p>


<h3>References</h3>

<p>He, L., Sillanpää, M.J., Silventoinen, K., Kaprio, J. and Pitkäniemi, J., 2016. Estimating Modifying Effect of Age on Genetic and Environmental Variance Components in Twin Models. Genetics, 202(4), pp.1313-1328.
</p>
<p>He, L., Pitkäniemi, J., Silventoinen, K. and Sillanpää, M.J., 2017. ACEt: An R package for estimating dynamic heritability and comparing twin models. Behavior Genetics, 47(6), pp.620-641.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data(data_ace)

# result &lt;- AtCtEtp(data_ace$mz, data_ace$dz, knot_e = 7, knot_c = 5, mod=c('d','d','d'))
</code></pre>


</div>