<div class="container">

<table style="width: 100%;"><tr>
<td>ovP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute and visualize overall p-values</h2>

<h3>Description</h3>

<p>This function computes and plots overall p-values for adaptive two-stage tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ovP(typ = NA, fun = NA, dis = NA, p1 = 1:49/50, p2 = p1,
    a1 = 0, a0 = 1, grid = FALSE, plt = FALSE,
    invisible = FALSE, wire = FALSE, round = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>typ</code></td>
<td>
<p>type of test: <code>"b"</code> for Bauer and Koehne (1994), <code>"l"</code> for Lehmacher and Wassmer (1999), <code>"v"</code> for Vandemeulebroecke (2006) and <code>"h"</code> for the horizontal conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>a distortion method for a supplied conditional error function (see details): <code>"pl"</code> for power lines, <code>"vt"</code> for vertical translation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>the p-value <code class="reqn">p_1</code> of the test after the first stage, or a vector of such p-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>the p-value <code class="reqn">p_2</code> of the test after the second stage, or a vector of such p-values; defaults to <code>p1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a1</code></td>
<td>
<p><code class="reqn">\alpha_1</code>, the efficacy stopping bound and local level of the test after the first stage (default: no stopping for efficacy)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p><code class="reqn">\alpha_0</code>, the futility stopping bound (default: no stopping for futility)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>logical determining whether a grid should be spanned by <code>p1</code> and <code>p2</code> (default: no grid is spanned)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p>logical determining whether the overall p-values should be plotted or not (default: not)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invisible</code></td>
<td>
<p>logical determining whether the printing of the overall p-values should be suppressed or not (default: not)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wire</code></td>
<td>
<p>logical determining whether the overall p-values should be plotted in wireframe-style or in cloud-style (default: cloud-style)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p>rounding specification, logical or integer (see details; default: no rounding)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The overall p-value for an adaptive two-stage test is computed as <code class="reqn">p_1</code> if <code class="reqn">p_1 &lt;= \alpha_1</code> or <code class="reqn">p_1 &gt; \alpha_0</code>, and as </p>
<p style="text-align: center;"><code class="reqn">\alpha_1 + \int_{\alpha_1}^{\alpha_0} cef_{(p_1,p_2)}(x) d x</code>
</p>
<p> otherwise, where <code class="reqn">cef_{(p_1,p_2)}</code> is the conditional error function (of a specified family) running through the observed pair of p-values <code>(p1,p2)</code>.
</p>
<p>There are two alternative ways of specifying the family of conditional error functions (i.e., the test): through a type <code>typ</code>, or through an initial conditional error function <code>fun</code> and a distortion method <code>dis</code>; see <code>CEF</code> for details.
</p>
<p>If p1 and p2 are of length 1, a single overall p-value is computed (and not plotted). Otherwise, the behavior of <code>ovP</code> depends on <code>grid</code>:
</p>

<ul>
<li>
<p> If <code>grid = FALSE</code>, overall p-values are computed (and not plotted) for the elementwise pairs of <code>p1</code> and <code>p2</code>. Here, <code>p1</code> and <code>p2</code> must be of the same length. 
</p>
</li>
<li>
<p> If <code>grid = TRUE</code>, a grid is spanned by <code>p1</code> and <code>p2</code>, and p-values are computed (and possibly plotted) over this grid. Here, <code>p1</code> and <code>p2</code> may be of different length. Plotting is triggered by <code>plt = TRUE</code>, and the style of the plot (wireframe or cloud) is determined by <code>wire</code>. <code>invisible = TRUE</code> suppresses the printing of the p-values.
</p>
</li>
</ul>
<p>The p-values are rounded to <code>round</code> digits after the comma (<code>round = TRUE</code> rounds to 1 digit; <code>round = FALSE</code> and <code>round = 0</code> prevent rounding). The plot always shows unrounded values.
</p>


<h3>Value</h3>

<p>A p-value, a vector of p-values or a matrix of p-values.
</p>


<h3>Note</h3>

<p>Provide either <code>typ</code> or <code>fun</code>, not both! If <code>fun</code> is provided, then also specify <code>dis</code>.
</p>


<h3>Author(s)</h3>

<p>Marc Vandemeulebroecke</p>


<h3>References</h3>

<p>Bauer, P., Koehne, K. (1994). Evaluation of experiments with adaptive interim analyses. <em>Biometrics</em> 50, 1029-1041.
</p>
<p>Brannath, W., Posch, M., Bauer, P. (2002). Recursive combination tests. <em>J. Amer. Statist. Assoc.</em> 97, 236-244.
</p>
<p>Lehmacher, W., Wassmer, G. (1999). Adaptive sample size calculations in group sequential trials. <em>Biometrics</em> 55, 1286-1290.
</p>
<p>Vandemeulebroecke, M. (2006). An investigation of two-stage tests. <em>Statistica Sinica</em> 16, 933-951.
</p>


<h3>See Also</h3>

<p><code>adaptTest</code> package description, <code>CEF</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Visualize a Lehmacher Wassmer (1999) test to the overall level 0.1
## and compute and visualize the overall p-value for an observed (p1,p2)=(0.3,0.7)
alpha  &lt;- .1
alpha0 &lt;- .5
alpha1 &lt;- .05
plotBounds(a1=alpha1, a0=alpha0, add=FALSE)
plotCEF(typ="l", a2=tsT(typ="l", a=alpha, a0=alpha0, a1=alpha1))
plotCEF(typ="l", p1=.3, p2=.7)
ovP(typ="l", p1=.3, p2=.7, a1=alpha1, a0=alpha0)
# The overall p-value is the area left of alpha1, plus the area below the 
# conditional error function running though (0.3,0.7) between alpha1 and alpha0.

## Investigate the p-values of the Lehmacher Wassmer (1999) test from above
ovP(typ="l", a1=alpha1, a0=alpha0, grid=TRUE, p1=1:9/10, round=3)
ovP(typ="l", a1=alpha1, a0=alpha0, grid=TRUE, plt=TRUE, invisible=TRUE, wire=TRUE)
</code></pre>


</div>