<div class="container">

<table style="width: 100%;"><tr>
<td>bcml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>BCML estimator</h2>

<h3>Description</h3>

<p>This function estimates a space time linear model according to the specified formula. It implements the BCML (or BCLSDV) estimator as in Elhorst (2010) <a href="https://doi.org/10.1016/j.regsciurbeco.2010.03.003">doi:10.1016/j.regsciurbeco.2010.03.003</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bcml(
  dataset,
  yearStart,
  yearEnd,
  var.agg = "Cod_Provincia",
  eq,
  spatial = NULL,
  estimation = "analytical",
  corrBIAS = TRUE,
  WMAT = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>STFDF with the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yearStart</code></td>
<td>
<p>First year considered in the estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yearEnd</code></td>
<td>
<p>Last Anno considered in the estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.agg</code></td>
<td>
<p>Index of the spatial units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eq</code></td>
<td>
<p>Formula to be estimated. It excludes the spatial lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spatial</code></td>
<td>
<p>Radius to define neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>Either 'analytical' or 'numerical'. If 'analytical' is specified the concentrated maximum likelihood is estimated and then the other parameters are obtained analytically. Otherwise, all parameters are obtained through numerical maximization of the log-likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrBIAS</code></td>
<td>
<p>Boolean. If TRUE, the bias correction is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WMAT</code></td>
<td>
<p>The spatial weight matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two objects. The first object is the estimates table. The second object is the log-likelihood evaluated at its maximum
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(maxLik)
library(matrixcalc)

set.seed(123)
sd = sim_data_fe(dataset=regsamp,N=100,TT=8,
                 spatial = 80,Tau = -0.2,Rho = 0.4,
                 Beta = 2,sdDev = 2,startingT = 10,
                 LONGLAT = TRUE)
est_bcml = bcml(dataset = sd[[1]],yearStart = 3,yearEnd = 9,
                var.agg = 'Cod_Provincia',eq = Y~X1,
                  estimation = 'analytical',corrBIAS = TRUE,WMAT = sd[[2]])
est_bcml


</code></pre>


</div>