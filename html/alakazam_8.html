<div class="container">

<table style="width: 100%;"><tr>
<td>alphaDiversity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate clonal alpha diversity</h2>

<h3>Description</h3>

<p><code>alphaDiversity</code> takes in a data.frame or AbundanceCurve and computes
diversity scores (<code class="reqn">D</code>) over an interval of diversity orders (<code class="reqn">q</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">alphaDiversity(data, min_q = 0, max_q = 4, step_q = 0.1, ci = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame with Change-O style columns containing clonal assignments or
a AbundanceCurve generate by estimateAbundance object 
containing a previously calculated bootstrap distributions of clonal abundance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_q</code></td>
<td>
<p>minimum value of <code class="reqn">q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_q</code></td>
<td>
<p>maximum value of <code class="reqn">q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_q</code></td>
<td>
<p>value by which to increment <code class="reqn">q</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>confidence interval to calculate; the value must be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to pass to estimateAbundance. Additional arguments
are ignored if a AbundanceCurve is provided as input.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Clonal diversity is calculated using the generalized diversity index (Hill numbers) 
proposed by Hill (Hill, 1973). See calcDiversity for further details.
</p>
<p>To generate a smooth curve, <code class="reqn">D</code> is calculated for each value of <code class="reqn">q</code> from
<code>min_q</code> to <code>max_q</code> incremented by <code>step_q</code>.  When <code>uniform=TRUE</code>
variability in total sequence counts across unique values in the <code>group</code> column 
is corrected by repeated resampling from the estimated complete clonal distribution to a 
common number of sequences. The complete clonal abundance distribution that is resampled 
from is inferred by using the Chao1 estimator to infer the number of unseen clones, 
followed by applying the relative abundance correction and unseen clone frequencies 
described in Chao et al, 2015.
</p>
<p>The diversity index (<code class="reqn">D</code>) for each group is the mean value of over all resampling 
realizations. Confidence intervals are derived using the standard deviation of the 
resampling realizations, as described in Chao et al, 2015.
</p>
<p>Significance of the difference in diversity index (<code>D</code>) between groups is tested by 
constructing a bootstrap delta distribution for each pair of unique values in the 
<code>group</code> column. The bootstrap delta distribution is built by subtracting the diversity 
index <code>Da</code> in group <code>a</code> from the corresponding value <code class="reqn">Db</code> in group <code>b</code>, 
for all bootstrap realizations, yielding a distribution of <code>nboot</code> total deltas; where 
group <code>a</code> is the group with the greater mean <code>D</code>. The p-value for hypothesis 
<code>Da  !=  Db</code> is the value of <code>P(0)</code> from the empirical cumulative distribution 
function of the bootstrap delta distribution, multiplied by 2 for the two-tailed correction.
</p>
<p>Note, this method may inflate statistical significance when clone sizes are uniformly small,
such as when most clones sizes are 1, sample size is small, and <code>max_n</code> is near
the total count of the smallest data group. Use caution when interpreting the results 
in such cases.
</p>


<h3>Value</h3>

<p>A DiversityCurve object summarizing the diversity scores.
</p>


<h3>References</h3>


<ol>
<li>
<p>  Hill M. Diversity and evenness: a unifying notation and its consequences. 
Ecology. 1973 54(2):427-32.
</p>
</li>
<li>
<p>  Chao A. Nonparametric Estimation of the Number of Classes in a Population. 
Scand J Stat. 1984 11, 265270.
</p>
</li>
<li>
<p>  Chao A, et al. Rarefaction and extrapolation with Hill numbers: 
A framework for sampling and estimation in species diversity studies. 
Ecol Monogr. 2014 84:45-67.
</p>
</li>
<li>
<p>  Chao A, et al. Unveiling the species-rank abundance distribution by 
generalizing the Good-Turing sample coverage theory. 
Ecology. 2015 96, 11891201.
</p>
</li>
</ol>
<h3>See Also</h3>

<p>See calcDiversity for the basic calculation and 
DiversityCurve for the return object. 
See plotDiversityCurve for plotting the return object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Group by sample identifier in two steps
abund &lt;- estimateAbundance(ExampleDb, group="sample_id", nboot=100)
div &lt;- alphaDiversity(abund, step_q=1, max_q=10)
plotDiversityCurve(div, legend_title="Sample")
                   
# Grouping by isotype rather than sample identifier in one step
div &lt;- alphaDiversity(ExampleDb, group="c_call", min_n=40, step_q=1, max_q=10, 
                      nboot=100)
plotDiversityCurve(div, legend_title="Isotype")

</code></pre>


</div>