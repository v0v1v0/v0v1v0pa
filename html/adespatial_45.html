<div class="container">

<table style="width: 100%;"><tr>
<td>plot.constr.hclust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Method For Space- And Time-Constrained Clustering</h2>

<h3>Description</h3>

<p>Method <code>plot.constr.hclust</code> displays the results of space-constrained or
time-constrained agglomerative cluster analyses obtained from multivariate
dissimilarity matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'constr.hclust'
plot(x, k, xlim, ylim, xlab, ylab, bg, col,
lty, lwd, col.links, links=FALSE, points=TRUE, pch=21L,
hybrids=c("change","single","none"), lty.hyb=1L, lwd.hyb=1, col.hyb="black",
plot=TRUE, axes=TRUE, cex=1, lwd.pt=1, invert.axes=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>constr.hclust-class</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of clusters to delineate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Optional: limits, in abscissa, of the zone to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Optional: limits, in ordinate, of the zone to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Optional: labels for x axis annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Optional: labels for y axis annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>Optional: a colour or set of colours to be used for the point
backgrounds (one for each of the k clusters), see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Optional: a colour or set of colours to be used for the point
outlines (defaults to <code>"black"</code> when omitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Optional: reference line type (see graphical parameters for
details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Optional: reference line width (see graphical parameters
for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.links</code></td>
<td>
<p>Optional: a colour or set of colours to be used for the
links within a cluster (defaults to the point background colours when
omitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>links</code></td>
<td>
<p>Should segments be drawn to represent the edges (links)
(default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>Should observation points be drawn (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Point character to display observations (default: 21, a circle
with a background colour).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hybrids</code></td>
<td>
<p>How should hybrid segments be drawn (default: "change").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.hyb</code></td>
<td>
<p>Line type to use for hybrid segments (default: lty).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.hyb</code></td>
<td>
<p>Width of hybrid segments with respect to lwd (default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.hyb</code></td>
<td>
<p>Colour of hybrid segments, when applicable (default: "black").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Should a new plotting window be opened first (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>Should the axes be displayed (default: TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Text and symbol magnification (see graphical parameters)
(default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.pt</code></td>
<td>
<p>Line width around points with respect to lwd (default: 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invert.axes</code></td>
<td>
<p>Should axes be inverted on the plot (default: FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plotting method uses the coordinates provided by the user of
<code>constr.hclust</code> to display the observations. It cuts the tree
(see cutree) into <code>k</code> clusters and displays each cluster using
the indices returned by <code>cutree</code>. The point background colours
can be provided using argument <code>bg</code>. When they are omitted, default
colours are provided automatically by the function as either a set of
mutually contrasting colours (when <code>k &lt;= 10</code>) or rainbow colours (when
<code>k &gt; 10</code>). When <code>links = TRUE</code>, each edge is displayed as a segment
with a colour corresponding to the identity of the clusters located at its
ends. A special treatment is done for hybrids edges: those whose ends lie in
different clusters; it is controlled by argument <code>hybrids</code>. When
argument <code>hybrids="change"</code> (the default), hybrid links are represented
as segments whose colours change halfway. When <code>hybrids="single"</code>,
hybrid edges are shown as single-color lines, whose color is given as
argument <code>col.hyb</code>, whereas <code>hybrids="none"</code> suppresses the drawing
of hybrid edges. Whenever hybrid edges are displayed, their width with
respect to the lwd value is controlled by argument <code>lwd.hyb</code>.
</p>
<p>When argument <code>plot=FALSE</code>, no <code>plot</code> command is issued and the
points (and segments when <code>links = TRUE</code>) are drawn over an existing
plotting window. This functionality is to allow one to plot the result of a
constrained clustering over an existing map. In that case, arguments
<code>xlim</code>, <code>ylim</code>, <code>axes</code>, and all other
graphical parameters to which the method plot would responds
are ignored.
</p>
<p>When disjoint clusters are present (i.e., when the graph provided to
<code>constr.hclust</code> is not entirely connected), the function does not
allow one to plot fewer clusters than the number of disjoint subsets; a
warning message is issued to notify the user.
</p>


<h3>Author(s)</h3>

<p>Guillaume Gu√©nard <a href="mailto:guillaume.guenard@umontreal.ca">guillaume.guenard@umontreal.ca</a>
and Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Artificial map data from Legendre &amp; Legendre (2012, Fig. 13.26)
## n = 16

dat &lt;- c(41,42,25,38,50,30,41,43,43,41,30,50,38,25,42,41)
coord.dat &lt;- matrix(c(1,3,5,7,2,4,6,8,1,3,5,7,2,4,6,8,
                      4.4,4.4,4.4,4.4,3.3,3.3,3.3,3.3,
                      2.2,2.2,2.2,2.2,1.1,1.1,1.1,1.1),16,2)

## Obtaining a list of neighbours:
library(spdep)
listW &lt;- nb2listw(tri2nb(coord.dat), style="B")
links.mat.dat &lt;- listw2mat(listW)
neighbors &lt;- listw2sn(listW)[,1:2]

## Calculating the (Euclidean) distance between points:
D.dat &lt;- dist(dat)

## Display the points:
plot(coord.dat, type='n',asp=1)
title("Delaunay triangulation")
text(coord.dat, labels=as.character(as.matrix(dat)), pos=3)
for(i in 1:nrow(neighbors))
    lines(rbind(coord.dat[neighbors[i,1],],
          coord.dat[neighbors[i,2],]))

## Clustering with a contiguity constraint described by a list of
## links:
grpWD2cst_constr_hclust &lt;-
    constr.hclust(
        D.dat, method="ward.D2",
        neighbors, coord.dat)

## Plot the results with k=5 clusters on a map:
plot(grpWD2cst_constr_hclust, k=5, links=TRUE, las=1,
     xlab="Eastings", ylab="Northings", cex=3, lwd=3)

## Repeat the plot with other values of k (number of groups)

</code></pre>


</div>