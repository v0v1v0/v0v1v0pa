<div class="container">

<table style="width: 100%;"><tr>
<td>nll_two_inf_subpops_unobs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative log-likelihood function:
two unobserved subpopulations of infected hosts</h2>

<h3>Description</h3>

<p>Function returning negative log-likelihood (nll) for patterns of mortality in
infected and uninfected treatments when an infected population is assumed
to harbour two distinct subpopulations of hosts experiencing different
virulence.
The nll is based on seven parameters, the location and scale
parameters for background mortality, separate location and scale parameters
for each of the two infected subpopulations, and a parameter estimating the
proportions of the two subpopulations
</p>


<h3>Usage</h3>

<pre><code class="language-R">nll_two_inf_subpops_unobs(
  a1 = a1,
  b1 = b1,
  a2 = a2,
  b2 = b2,
  a3 = a3,
  b3 = b3,
  p1 = p1,
  data = data,
  time = time,
  censor = censor,
  infected_treatment = infected_treatment,
  d1 = "Weibull",
  d2 = "Weibull",
  d3 = "Weibull"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a1, b1</code></td>
<td>
<p>location and scale parameters describing background mortality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2, b2</code></td>
<td>
<p>location and scale parameters describing mortality due to
infection in one subpopulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a3, b3</code></td>
<td>
<p>location and scale parameters describing mortality due to
infection in the other subpopulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>parameter estimating the proportion of infected hosts in the
first of the two subpopulations; 0 &lt;= p1 &lt;= 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of data frame containing survival data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>name of data frame column identifying time of event; time &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>name of data frame column idenifying if event was
death (0) or right-censoring (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infected_treatment</code></td>
<td>
<p>name of data frame column identifying if data are
from an infected (1) or uninfected (0) treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1, d2, d3</code></td>
<td>
<p>names of probability distributions chosen to describe
background mortality and mortality due to infection in each subpopulation,
respectively; defaults to the Weibull distribution</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>p1 is the estimated proportion of hosts associated with the location and
scale parameters a2, b2; 0 &lt;= p1 &lt;= 1.
</p>
<p>It is assumed the patterns of mortality within each subpopulation
act independently of one another.
</p>


<h3>See Also</h3>

<p><code>nll_exposed_infected</code>
<code>nll_two_inf_subpops_obs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example using data from Parker et al
    data01 &lt;- data_parker

# step #1: parameterise nll function to be passed to 'mle2'
    m01_prep_function &lt;- function(
      a1 = a1, b1 = b1, a2 = a2, b2 = b2, a3 = a3, b3 = b3, p1 = p1){
        nll_two_inf_subpops_unobs(
          a1 = a1, b1 = b1, a2 = a2, b2 = b2, a3 = a3, b3 = b3, p1 = p1,
          data = data01,
          time = t,
          censor = censored,
          infected_treatment = g,
          d1 = "Frechet",
          d2 = "Weibull",
          d3 = "Weibull"
          )}

# step #2: send 'prep_function' to 'mle2' for maximum likelihood estimation
    m01 &lt;- mle2(
      m01_prep_function,
      start = list(a1 = 2, b1 = 1,
                   a2 = 2, b2 = 0.3,
                   a3 = 2, b3 = 0.7,
                   p1 = 0.5)
      )

    summary(m01)

</code></pre>


</div>