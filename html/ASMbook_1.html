<div class="container">

<table style="width: 100%;"><tr>
<td>demoMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a Poisson GLM with MCMC</h2>

<h3>Description</h3>

<p>This is a demo function that fits a Poisson GLM with one continuous covariate
to some data (y, x) using a random-walk Metropolis Markov chain Monte Carlo algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">demoMCMC(
  y,
  x,
  true.vals = c(2.5, 0.14),
  inits = c(0, 0),
  prior.sd.alpha = 100,
  prior.sd.beta = 100,
  tuning.params = c(0.1, 0.1),
  niter = 10000,
  nburn = 1000,
  quiet = TRUE,
  show.plots = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of counts, e.g., y in the Swiss bee-eater example</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector of a continuous explanatory variable, e.g. year x in the bee-eaters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true.vals</code></td>
<td>
<p>True intercept and slope if known (i.e., when run on simulated data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inits</code></td>
<td>
<p>Initial values in the MCMC algorithm for alpha, beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sd.alpha</code></td>
<td>
<p>SD of normal prior for alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.sd.beta</code></td>
<td>
<p>SD of normal prior for beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning.params</code></td>
<td>
<p>SD of the Gaussian proposal distributions for alpha, beta</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>Total chain length (before burnin)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nburn</code></td>
<td>
<p>Burn-in length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Logical, suppress console output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plots</code></td>
<td>
<p>Logical, should diagnostic plots be shown?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing input settings, acceptance probabilities and MCMC samples.
</p>


<h3>Author(s)</h3>

<p>Marc KÃ©ry
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the real data used in the publication by Mueller (Vogelwarte, 2021)

# Counts of known pairs in the country 1990-2020
y &lt;- c(0,2,7,5,1,2,4,8,10,11,16,11,10,13,19,31,
      20,26,19,21,34,35,43,53,66,61,72,120,102,159,199)
year &lt;- 1990:2020     # Define year range
x &lt;- (year-1989)      # Scaled, but not centered year as a covariate
x &lt;- x-16             # Now it's centered

oldpar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1, 2), mar = c(5,5,5,2), cex.lab = 1.5, cex.axis = 1.5, cex.main = 1.5)
plot(table(y), xlab = 'Count (y)', ylab = 'Frequency', frame = FALSE,
     type = 'h', lend = 'butt', lwd = 5, col = 'gray20', main = 'Frequency distribution of counts')
plot(year, y, xlab = 'Year (x)', ylab = 'Count (y)', frame = FALSE, cex = 1.5,
     pch = 16,  col = 'gray20', main = 'Relationship y ~ x')
fm &lt;- glm(y ~ x, family = 'poisson')        # Add Poisson GLM line of best fit
lines(year, predict(fm, type = 'response'), lwd = 3, col = 'red', lty = 3)


# Execute the function with default function args
# In a real test you should run more iterations
par(mfrow = c(1,1))
str(tmp &lt;- demoMCMC(niter=100, nburn=50))

# Use data created above
par(mfrow = c(1,1))
str(tmp &lt;- demoMCMC(y = y, x = x, niter=100, nburn=50))


par(oldpar)

</code></pre>


</div>