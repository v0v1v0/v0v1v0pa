<div class="container">

<table style="width: 100%;"><tr>
<td>auxiliary</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Auxiliary functions (for internal use)
</h2>

<h3>Description</h3>

<p>Function <code>gethani</code> determines a bandwidth that leads to, for the specified kernel, a variance reduction for a non-adaptive kernel estimate by a factor of <code>value</code>.
<code>getvofh</code> calculates the sum of location weights for a given bandwidth vector and kernel.
<code>sofmchi</code> precomputes the variance of a non-central chi distribution 
with <code>2*L</code> degrees of freedom as a function of the noncentrality parameter for an interval <code>c(0,to)</code>.
Functions <code>residualVariance</code> and <code>residualSpatialCorr</code> are
used in package <code>fmri</code> to calculate variances and spatial correlations from residual objects. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">gethani(x, y, lkern, value, wght, eps = 0.01)
getvofh(bw, lkern, wght)
sofmchi(L, to = 50, delta = 0.01)
residualVariance(residuals, mask, resscale = 1, compact = FALSE)
residualSpatialCorr(residuals, mask, lags = c(5, 5, 3), compact = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>lower bound of search interval
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>upper bound of search interval
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lkern</code></td>
<td>

<p>code for location kernel 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>

<p>target sum of location weights
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wght</code></td>
<td>

<p>relative size of voxel dimensions <code>c(0,0)</code> for 1D and <code>c(w1,0)</code>
for 2D problems.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>attempted precision for bandwidth search
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>

<p>vector of bandwidths, length equal to 1,2 or 3 depending on the dimensionality of the problem.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>number of effective coils, <code>2*L</code> is the degree of freedom of the non-central chi distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>

<p>upper interval bound.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>discretization width.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>

<p>array of residuals, if<code>compact</code> only containing voxel with mask, otherwise for complete data cubes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>

<p>mask of active voxel (e.g. brain masks)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resscale</code></td>
<td>

<p>scale for residuals (residuals may be scaled for optimal integer*2 storage)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compact</code></td>
<td>

<p>logical, determines if only information for voxel within mask or full for full data cubes is given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>

<p>positive integer vector of length 3, maximum lags for spatial correlations
for each coordinate direction to be computed
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These are auxiliary functions not to be used by the user. They are only exported to be available for internal use in packages <code>fmri</code>, <code>dti</code>, <code>qMRI</code> and <code>adimpro</code>.
</p>


<h3>Value</h3>

<p><code>gethani</code> returns a vector of bandwidths,
<code>getvofh</code> returns the variance reduction that would be obtained with a kernel estimate employing the specified kernel and bandwidth,
<code>sofmchi</code> returns a list with, e.g., components <code>ncp</code> and <code>s2</code> containing vectors of noncentralityparameter values and corresponding variances, respectively, for the specified noncentral Chi distribution, 
<code>residualVariance</code> returns a vector (compact==TRUE) or array(compact==FALSE) of voxelwise residual variances,
<code>residualSpatialCorr</code> returns an array of dimension <code>lags</code> 
containing spatial correlations.
</p>


<h3>Note</h3>

<p>These functions are for internal use only. They are only exported to be available in other packages.
</p>


<h3>Author(s)</h3>

<p>Joerg Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a>
</p>


</div>