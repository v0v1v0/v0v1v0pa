<div class="container">

<table style="width: 100%;"><tr>
<td>predict.ah.2ph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction Based on the Additive Hazards Model Fitted from Two-phase Sampling</h2>

<h3>Description</h3>

<p>This function predicts a subject's overall hazard rates at given time points
based on this subject's covariate values. The prediction function is an object
from <code>ah.2ph</code>. The  estimating procedures follow Hu (2014).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ah.2ph'
predict(object, newdata, newtime, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class inhering from 'ah.2ph'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a dataframe of an individual's predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newtime</code></td>
<td>
<p>a given sequence of time points at which the prediction is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe including the given time points, predicted hazards, their
standard errors, their variances, the phase I component of the variance for
predicted hazards and the phase II component of the variance.
</p>


<h3>References</h3>

<p>Jie Hu (2014) A Z-estimation System for Two-phase Sampling with Applications
to Additive Hazards Models and Epidemiologic Studies. Dissertation,
University of Washington.
</p>


<h3>See Also</h3>

<p><code>ah.2ph</code> for fitting the additive hazards model with two-phase
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
### load data
nwts &lt;- nwtsco[1:100,]

### create strata based on  institutional histology and disease status
nwts$strt &lt;- 1+nwts$instit
### add a stratum containing all (relapsed) cases
nwts$strt[nwts$relaps==1] &lt;- 3

### assign phase II subsampling probabilities
### oversample unfavorable histology (instit =1) and cases
### Pi = 0.5 for instit =0, Pi =1 for instit =1 and relaps =1
nwts$Pi&lt;-  0.5 * (nwts$strt == 1) + 1 * (nwts$strt == 2) + 1 * (nwts$strt == 3)

### generate phase II sampling indicators
N &lt;- dim(nwts)[1]
nwts$in.ph2 &lt;-  rbinom(N, 1, nwts$Pi)

### fit an additive hazards model to  two-phase sampling data without calibration
fit1 &lt;- ah.2ph(Surv(trel,relaps) ~ age + histol,
               data = nwts,
               ties = FALSE,
               R = in.ph2, Pi = Pi,
               robust = FALSE)

###  input the new data for prediction
newdata &lt;- nwtsco[101,]
###  based on the fitted model fit1, perform prediction at time points t =3 and t= 5
predict(fit1, newdata, newtime = c(3,5))

### fit an additve hazards model to  two-phase sampling data with calibration
### The calibration variable is stage
fit2 &lt;- ah.2ph(Surv(trel,relaps) ~ age + histol, data = nwts, R = in.ph2, Pi = Pi,
                                   ties = FALSE, robust = FALSE, calibration.variables = "stage")

### based on the fitted model fit2, perform prediction at time points t =3 and t= 5
predict(fit2, newdata, newtime = c(3,5))

## Not run: 
### The calibration variable is stage, when set robust = TRUE
fit3 &lt;- ah.2ph(Surv(trel,relaps) ~ age + histol, data = nwts, R = in.ph2, Pi = Pi,
                                   ties = FALSE, robust = TRUE, calibration.variables = "stage")

### based on the fitted model fit2, perform prediction at time points t =3 and t= 5
predict(fit3, newdata, newtime = c(3,5))

## End(Not run)
</code></pre>


</div>