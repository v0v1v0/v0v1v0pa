<div class="container">

<table style="width: 100%;"><tr>
<td>nipals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Non-linear Iterative Partial Least Squares (NIPALS) algorithm</h2>

<h3>Description</h3>

<p>This function performs NIPALS algorithm, i.e. a principal component
analysis of a data table that can contain missing values.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nipals(df, nf = 2, rec = FALSE, niter = 100, tol = 1e-09)
## S3 method for class 'nipals'
scatter(x, xax = 1, yax = 2, clab.row = 0.75, clab.col
= 1, posieig = "top", sub = NULL, ...)
## S3 method for class 'nipals'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>a data frame that can contain missing values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>an integer, the number of axes to keep</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rec</code></td>
<td>
<p>a logical that specify if the functions must perform the
reconstitution of the data using the <code>nf</code> axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>an integer, the maximum number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a real, the tolerance used in the iterative algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>nipals</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax</code></td>
<td>
<p>the column number for the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax</code></td>
<td>
<p>the column number for the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clab.row</code></td>
<td>
<p>a character size for the rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clab.col</code></td>
<td>
<p>a character size for the columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posieig</code></td>
<td>
<p>if "top" the eigenvalues bar plot is upside, if "bottom" it is downside, if "none" no plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>a string of characters to be inserted as legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Data are scaled (mean 0 and variance 1) prior to the analysis.
</p>


<h3>Value</h3>

<p>Returns a list of classes <code>nipals</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>the scaled data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>the pseudoeigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the rank of the analyzed matrice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>the number of factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>the column normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>the column coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>the row coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>the number of iterations for each axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rec</code></td>
<td>
<p>a data frame obtained by the reconstitution of the scaled
data using the <code>nf</code> axes</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Stéphane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a></p>


<h3>References</h3>

<p>Wold, H. (1966)  Estimation of principal
components and related models by iterative least squares. In
P. Krishnaiah, editors.<em>Multivariate
Analysis</em>, Academic Press, 391–420.<br><br></p>
<p>Wold, S., Esbensen, K. and Geladi, P. (1987) Principal component
analysis <em>Chemometrics and Intelligent Laboratory Systems</em>,
<b>2</b>, 37–52.
</p>


<h3>See Also</h3>

<p><code>dudi.pca</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(doubs)
## nipals is equivalent to dudi.pca when there are no NA
acp1 &lt;- dudi.pca(doubs$env, scannf = FALSE, nf = 2)
nip1 &lt;- nipals(doubs$env)


if(adegraphicsLoaded()) {
  if(requireNamespace("lattice", quietly = TRUE)) {
    g1 &lt;- s1d.barchart(acp1$eig, psub.text = "dudi.pca", p1d.horizontal = FALSE, plot = FALSE)
    g2 &lt;- s1d.barchart(nip1$eig, psub.text = "nipals", p1d.horizontal = FALSE, plot = FALSE)
    g3 &lt;- lattice::xyplot(nip1$c1[, 1] ~ acp1$c1[, 1], main = "col scores", xlab = "dudi.pca", 
      ylab = "nipals")
    g4 &lt;- lattice::xyplot(nip1$li[, 1] ~ acp1$li[, 1], main = "row scores", xlab = "dudi.pca", 
      ylab = "nipals")
    G &lt;- ADEgS(list(g1, g2, g3, g4), layout = c(2, 2))
  }
  
} else {
  par(mfrow = c(2, 2))
  barplot(acp1$eig, main = "dudi.pca")
  barplot(nip1$eig, main = "nipals")
  plot(acp1$c1[, 1], nip1$c1[, 1], main = "col scores", xlab = "dudi.pca", ylab = "nipals")
  plot(acp1$li[, 1], nip1$li[, 1], main = "row scores", xlab = "dudi.pca", ylab = "nipals")
}

## Not run: 
## with NAs:
doubs$env[1, 1] &lt;- NA
nip2 &lt;- nipals(doubs$env)
cor(nip1$li, nip2$li)
nip1$eig
nip2$eig

## End(Not run)</code></pre>


</div>