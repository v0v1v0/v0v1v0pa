<div class="container">

<table style="width: 100%;"><tr>
<td>semiauto.abc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs semi-automatic ABC based on summary statistics regression.</h2>

<h3>Description</h3>

<p>Performs semi-automatic ABC based on summary statistics regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">semiauto.abc(obs, param, sumstats, obspar=NULL, abcmethod = abc, 
saprop = 0.5, abcprop = 0.5, overlap = FALSE, satr = list(), 
plot = FALSE, verbose = TRUE, do.err = FALSE, final.dens = FALSE, 
errfn = rsse, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>(matrix of) observed summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>matrix of simulated model parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumstats</code></td>
<td>
<p>matrix of simulated summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obspar</code></td>
<td>
<p>optional observed parameters (for use to assess simulation performance).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abcmethod</code></td>
<td>
<p>a function to perform ABC inference, e.g. the <code>abc</code> function from package <em>abc</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>saprop</code></td>
<td>
<p>a proportion, denoting the proportion of simulated datasets with which to perform semi-automatic ABC regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abcprop</code></td>
<td>
<p>a proportion, denoting the proportion of simulated datasets with which to perform ABC using <code>abcmethod</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap</code></td>
<td>
<p>a boolean value indicating whether the simulated datasets specified by <code>saprop</code> and <code>abcprop</code> are disjoint (<code>overlap=FALSE</code>) or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>satr</code></td>
<td>
<p>a list of functions indicating transformations of the summary statistics <code>sumstats</code>.  These must be *suitable* functions, and must each return a vector, matrix or array with the number of elements being a multiple of the rows of <code>sumstats</code>.  See details and examples sections for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>When plot==TRUE, a plot of parameter values against fitted values is produced for each parameter as a side-effect.  This is most useful when the number of parameters is reasonably small.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a boolean value indicating whether informative statements should be printed to screen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.err</code></td>
<td>
<p>a boolean value indicating whether the simulation error should be returned.  Note: if <code>do.err=TRUE</code>, <code>obspar</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final.dens</code></td>
<td>
<p>a boolean value indicating whether the posterior sample should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errfn</code></td>
<td>
<p>an error function to assess ABC inference performance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other optional arguments to the ABC inference procedure (e.g. arguments to the <code>abc</code> function).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is essentially a wrapper for <code>saABC</code>.  See the details section of <code>saABC</code> for more details on the implementation.  The argument <code>satr</code> can be almost anything sensible in <code>function</code> form, see Examples section for example specifications.</p>


<h3>Value</h3>

<p> A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>simulation error (if <code>obspar</code> is supplied and <code>do.err=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.sample</code></td>
<td>
<p>an array of dimension <code>nacc x npar x ndatasets</code> giving the posterior sample for each observed dataset.  Not returned if <code>final.dens=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sainfo</code></td>
<td>
<p>A list with the following information about the semi-automatic ABC run:<br><code>saprop</code>, <code>abcprop</code> ,<code>overlap</code>, <code>satr</code>.  See arguments for more details.</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>The argument <code>satr</code> must be supplied with valid functions.  Whilst there are checks, these are minimal, since doing sophisticated checks is quite difficult.
</p>


<h3>Author(s)</h3>

<p>Matt Nunes and Dennis Prangle</p>


<h3>References</h3>

<p>Blum, M. G. B, Nunes, M. A., Prangle, D. and Sisson, S. A. (2013) A
comparative review of dimension reduction methods in approximate
Bayesian computation. <em>Stat. Sci.</em> <b>28</b>, Issue 2, 189–208.<br><br>
Fearnhead, P. and Prangle, D. (2012) Constructing summary statistics for approximate Bayesian computation:
semi-automatic approximate Bayesian
computation. <em>J. R. Stat. Soc. B</em> <b>74</b>, Part 3, 1–28.<br><br>
Nunes, M. A. and Prangle, D. (2016) abctools: an R package for tuning
approximate Bayesian computation analyses. <em>The R Journal</em>
<b>7</b>, Issue 2, 189–205.
</p>


<h3>See Also</h3>

<p><code>saABC</code>, <code>selectsumm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(coal)
data(coalobs)

param&lt;-coal[,2]
simstats&lt;-coal[,4:6]

# use matrix below just in case to preserve dimensions.

obsstats&lt;-matrix(coalobs[1,4:6],nrow=1)
obsparam&lt;-matrix(coalobs[1,1])

# perform semi-automatic ABC with summary statistics defined by 
# X, X^2,X^3,X^4:
# other alternative specifications for this could be:
# list(function(x){ cbind(x,x^2,x^3,x^4) })
# list(as.function(alist(x=,cbind(x,x^2,x^3)))) etc

tmp&lt;-semiauto.abc(obsstats, param, simstats,tol=.01,method="rejection",
satr=list(function(x){outer(x,Y=1:4,"^")}))

tmp$sa.info

# both these functions may be problematic: 

 tmp&lt;-semiauto.abc(obsstats, param, simstats,tol=.01,method="rejection",
satr=list(unique,sum))

## End(Not run)

</code></pre>


</div>