<div class="container">

<table style="width: 100%;"><tr>
<td>mc.ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Diagnostic plots for model choice coverage output
</h2>

<h3>Description</h3>

<p>Plots credible interval estimates for raw model choice output from
<code>cov.mc</code>.  This is used to investigate whether the coverage
property holds and validate whether diagnostic statistics are acting
as intended.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  mc.ci(raw, tol, eps, modname, modtrue, nbins=5, 
bintype=c("interval", "quantile"), bw=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw</code></td>
<td>

<p>The <code>raw</code> item from the list output by <code>cov.mc</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>The value of <code>tol</code> to test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>

<p>The value of <code>eps</code> to test.  This is used when <code>tol</code> is
missing.  One of <code>eps</code> and <code>tol</code> must be supplied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modname</code></td>
<td>

<p>The name of the model to test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modtrue</code></td>
<td>

<p>Vector containing the true models generating the pseudo-observed
test data.  i.e. <code>modtrue[i]</code> is the model generating dataset i.    
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbins</code></td>
<td>

<p>Number of bins to display.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bintype</code></td>
<td>

<p>How to choose the bins (see Details).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>

<p>Whether to produce a black and white image.  Default is FALSE.
Colour is used to make different bins stand out.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional plotting arguments - anything that can be used by <code>plot</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides a plot which can be used as an informal test of
the model choice coverage hypothesis for a particular value of
<code>eps</code> or <code>tol</code> and choice of model.  The plot is more
flexible than the diagnostics, but not suitable as the basis of a
formal test.
</p>
<p>For each pseudo-observed data set, the ABC probability that the model
is <code>modname</code> is taken from <code>raw</code>, and the true model is
taken from <code>modtrue</code>.  The probabilities are binned into
<code>nbins</code> intervals, either of equal length or based on <code>nbins+1</code>
equally spaced empirical quantiles.  The function estimates the
observed probability of <code>modname</code> within each bin using Bayesian
inference for a binomial proportion under a uniform prior.  The plot
shows the mean and 95% credible interval plotted against predicted
probabilities.  Informally, the coverage property should be rejected
if predicted values are too unlikely given the observed values.
</p>


<h3>Author(s)</h3>

<p>Dennis Prangle
</p>


<h3>References</h3>

<p>Nunes, M. A. and Prangle, D. (2016) abctools: an R package for tuning
approximate Bayesian computation analyses. <em>The R Journal</em>
<b>7</b>, Issue 2, 189–205.
</p>
<p>Prangle D., Blum M. G. B., Popovic G., Sisson S. A. (2014) Diagnostic
tools of approximate Bayesian computation using the coverage
property. <em>Australian and New Zealand Journal of Statistics</em>
<b>56</b>, Issue 4, 309–329.
</p>


<h3>See Also</h3>

<p><code>cov.mc</code> to produce the input for this function
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ##The examples below are chosen to run relatively quickly (&lt;5 mins)
  ##and do not represent recommended tuning choices.
  ## Not run: 
  index &lt;- sample(1:2, 1E4, replace=TRUE)
  sumstat &lt;- ifelse(index==1, rnorm(1E4,0,1), rnorm(1E4,0,rexp(1E4,1)))
  sumstat &lt;- data.frame(ss=sumstat)
  covdiag &lt;- cov.mc(index=index, sumstat=sumstat, testsets=1:100, 
  tol=seq(0.1,1,by=0.1), diagnostics=c("freq"))
  mc.ci(covdiag$raw, tol=0.5, modname=1, modtrue=index[1:100])
  
## End(Not run)
</code></pre>


</div>