<div class="container">

<table style="width: 100%;"><tr>
<td>asm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Average Spectral Misfit</h2>

<h3>Description</h3>

<p>Calculate Average Spectral Misfit with Monte Carlo spectra simulations, as updated in Meyers et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">asm(freq,target,fper=NULL,rayleigh,nyquist,sedmin=1,sedmax=5,numsed=50,
    linLog=1,iter=100000,output=F,genplot=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>A vector of candidate astronomical cycles observed in your data spectrum (cycles/m). Maximum allowed is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>A vector of astronomical frequencies to evaluate (1/ka). These must be in order of increasing frequency (e.g., e1,e2,e3,o1,o2,p1,p2). Maximum allowed is 50 frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fper</code></td>
<td>
<p>A vector of uncertainties on each target frequency (1/ka).  Values should be from 0-1, representing uncertainty as a percent of each target frequency.  The order of the uncertainties must follow that of the target vector. By default, no uncertainty is assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rayleigh</code></td>
<td>
<p>Rayleigh frequency (cycles/m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyquist</code></td>
<td>
<p>Nyquist frequency (cycles/m).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sedmin</code></td>
<td>
<p>Minimum sedimentation rate for investigation (cm/ka).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sedmax</code></td>
<td>
<p>Maximum sedimentation rate for investigation (cm/ka).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numsed</code></td>
<td>
<p>Number of sedimentation rates to investigate in ASM optimization grid. Maximum allowed is 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linLog</code></td>
<td>
<p>Use linear or logarithmic scaling for sedimentation rate grid spacing? (0=linear, 1=log)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of Monte Carlo simulations for significance testing. Maximum allowed is 100,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Return output as a new data frame? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will caculate the Average Spectral Misfit between a data spectrum and astronomical 
target spectrum, following the approach outlined in Meyers and Sageman (2007), and the 
improvements of Meyers et al. (2012). 
</p>


<h3>Value</h3>

<p>A data frame containing:
Sedimentation rate (cm/ka), ASM (cycles/ka), Null hypothesis significance level (0-100 percent), Number of astronomical terms fit.
</p>


<h3>References</h3>

<p>S.R. Meyers and  B.B. Sageman, 2007,
<em>Quantification of Deep-Time Orbital Forcing by Average Spectral Misfit</em>: American Journal of Science, v. 307, p. 773-792.
</p>
<p>S.R. Meyers, B.B. Sageman and M.A. Arthur, 2012,
<em>Obliquity forcing of organic matter accumulation during Oceanic Anoxic Event 2</em>: Paleoceanography, 27, PA3212, doi:10.1029/2012PA002286.
</p>


<h3>See Also</h3>

 <p><code>eAsm</code>, <code>eAsmTrack</code>, <code>testPrecession</code>, <code>timeOpt</code>, and <code>timeOptSim</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## These frequencies are from modelA (type '?astrochron' for more information). 
## They are for an 8 meter window, centered at 22 meters height. Units are cycles/m . 
freq &lt;- c(0.1599833,0.5332776,1.5998329,2.6797201,3.2796575,3.8795948,5.5194235,6.5459830)
freq &lt;- data.frame(freq)

## Rayleigh frequency in cycles/m
rayleigh &lt;- 0.1245274

## Nyquist frequency in cycles/m
nyquist &lt;- 6.66597

## orbital target in 1/ky. Predicted periods for 94 Ma (see Meyers et al., 2012)
target &lt;- c(1/405.47,1/126.98,1/96.91,1/37.66,1/22.42,1/18.33)

## percent uncertainty in orbital target
fper=c(0.023,0.046,0.042,0.008,0.035,0.004)

asm(freq=freq,target=target,fper=fper,rayleigh=rayleigh,nyquist=nyquist,sedmin=0.5,sedmax=3,
    numsed=100,linLog=1,iter=100000,output=FALSE)
</code></pre>


</div>