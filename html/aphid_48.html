<div class="container">

<table style="width: 100%;"><tr>
<td>weight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sequence weighting.</h2>

<h3>Description</h3>

<p>Weighting schemes for DNA and amino acid sequences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">weight(x, ...)

## S3 method for class 'DNAbin'
weight(x, method = "Henikoff", k = 5, ...)

## S3 method for class 'AAbin'
weight(x, method = "Henikoff", k = 5, ...)

## S3 method for class 'list'
weight(x, method = "Henikoff", k = 5, residues = NULL, gap = "-", ...)

## S3 method for class 'dendrogram'
weight(x, method = "Gerstein", ...)

## Default S3 method:
weight(x, method = "Henikoff", k = 5, residues = NULL, gap = "-", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list or matrix of sequences
(usually a "DNAbin" or "AAbin" object).
Alternatively x can be an object of class <code>"dendrogram"</code>
for tree-base weighting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed between methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string indicating the weighting method to be used.
Currently the only methods available are a modified version of the
maximum entropy weighting scheme proposed by
Henikoff and Henikoff (1994) (<code>method = "Henikoff"</code>)
and the tree-based weighting scheme of Gerstein et al (1994)
(<code>method = "Gerstein"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer representing the k-mer size to be used.
Defaults to 5. Note that higher
values of k may be slow to compute and use excessive memory due to
the large numbers of calculations required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residues</code></td>
<td>
<p>either NULL (default; emitted residues are automatically
detected from the sequences), a case sensitive character vector
specifying the residue alphabet, or one of the character strings
"RNA", "DNA", "AA", "AMINO". Note that the default option can be slow for
large lists of character vectors. Furthermore, the default setting
<code>residues = NULL</code> will not detect rare residues that are not present
in the sequences, and thus will not assign them emission probabilities
in the model. Specifying the residue alphabet is therefore
recommended unless x is a "DNAbin" or "AAbin" object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap</code></td>
<td>
<p>the character used to represent gaps in the alignment matrix
(if applicable). Ignored for <code>"DNAbin"</code> or <code>"AAbin"</code> objects.
Defaults to "-" otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a generic function.
If <code>method = "Henikoff"</code> the sequences are weighted
using a modified version of the maximum entropy method proposed by
Henikoff and Henikoff (1994). In this case the
maximum entropy weights are calculated from a k-mer presence absence
matrix instead of an alignment as originally described by
Henikoff and Henikoff (1994).
If <code>method = "Gerstein"</code> the agglomerative method of
Gerstein et al (1994) is used to weight sequences based
on their relatedness as derived from a phylogenetic tree.
In this case a dendrogram is first derived using the
<code>cluster</code> function in the
<code>kmer</code> package.
Methods are available for
<code>"dendrogram"</code> objects, <code>"DNAbin"</code> and <code>"AAbin"</code>
sequence objects (as lists or matrices) and sequences in standard
character format provided either as lists or matrices.
</p>
<p>For further details on sequence weighting schemes see Durbin et al
(1998) chapter 5.8.
</p>


<h3>Value</h3>

<p>a named vector of weights, the sum of which is equal to
the total number of sequences (average weight = 1).
</p>


<h3>Author(s)</h3>

<p>Shaun Wilkinson
</p>


<h3>References</h3>

<p>Durbin R, Eddy SR, Krogh A, Mitchison G (1998) Biological
sequence analysis: probabilistic models of proteins and nucleic acids.
Cambridge University Press, Cambridge, United Kingdom.
</p>
<p>Gerstein M, Sonnhammer ELL, Chothia C (1994) Volume changes in protein evolution.
<em>Journal of Molecular Biology</em>, <strong>236</strong>, 1067-1078.
</p>
<p>Henikoff S, Henikoff JG (1994) Position-based sequence weights.
<em>Journal of Molecular Biology</em>, <strong>243</strong>, 574-578.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## weight the sequences in the woodmouse dataset from the ape package
  library(ape)
  data(woodmouse)
  woodmouse.weights &lt;- weight(woodmouse)
  woodmouse.weights
</code></pre>


</div>