<div class="container">

<table style="width: 100%;"><tr>
<td>G.inverse</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtains the inverse of the genomic relationship matrix G</h2>

<h3>Description</h3>

<p>Generates the inverse of a genomic relationship matrix <code class="reqn">\boldsymbol{G}</code> that is provided.
This input matrix should be of the full form (<code class="reqn">n \times n</code>)
with individual names assigned to
<code>rownames</code> and <code>colnames</code>. Several checks for the stability of the matrix are
presented based on the reciprocal conditional number.
</p>
<p>In case of an ill-conditioned matrix,
options of blending, bending or aligning before inverting are available.
These options will be deprecated (discontinued)
in future versions of <code>ASRgenomics</code>
as they can be better implemented in the function <code>G.tuneup()</code>.
</p>
<p>Based on procedures published by Nazarian and Gezan <em>et al.</em> (2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">G.inverse(
  G = NULL,
  A = NULL,
  rcn.thr = 1e-12,
  blend = FALSE,
  pblend = 0.02,
  bend = FALSE,
  eig.tol = NULL,
  align = FALSE,
  digits = 8,
  sparseform = FALSE,
  message = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input of the symmetric genomic relationship matrix <code class="reqn">\boldsymbol{G}</code> in
full form (<code class="reqn">n \times n</code>), to obtain its inverse (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Input of the pedigree relationship matrix <code class="reqn">\boldsymbol{A}</code>
to perform blending or aligning in full form.
It should be of the same dimension as the <code class="reqn">\boldsymbol{G}</code> matrix
(<code class="reqn">n \times n</code>) (default = <code>NULL</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcn.thr</code></td>
<td>
<p>A threshold for identifying  the <code class="reqn">\boldsymbol{G}</code> matrix as an ill-conditioned matrix.
Based on the reciprocal conditional number (default = <code>1e-12</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blend</code></td>
<td>
<p>If <code>TRUE</code> a "blending" with identity matrix <code class="reqn">\boldsymbol{I}</code> or pedigree relationship matrix
<code class="reqn">\boldsymbol{A}</code> (if provided) is performed (default = <code>FALSE</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pblend</code></td>
<td>
<p>If blending is requested this is the proportion of the identity matrix <code class="reqn">\boldsymbol{I}</code> or
pedigree relationship matrix <code class="reqn">\boldsymbol{A}</code> to blend for (default = <code>0.02</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bend</code></td>
<td>
<p>If <code>TRUE</code> a "bending" is performed by making the matrix near positive definite (default = <code>FALSE</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig.tol</code></td>
<td>
<p>Defines relative positiveness (<em>i.e.</em>, non-zero) of eigenvalues compared to the largest one.
It determines which threshold of eigenvalues will be treated as zero (default = <code>NULL</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align</code></td>
<td>
<p>If <code>TRUE</code> the genomic relationship matrix <code class="reqn">\boldsymbol{G}</code> is aligned to the
pedigree relationship matrix <code class="reqn">\boldsymbol{A}</code> (default = <code>FALSE</code>) (to be deprecated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Set up the number of digits in used to round the output matrix (default = <code>8</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparseform</code></td>
<td>
<p>If <code>TRUE</code> it generates an inverse matrix in sparse form to be used directly in <span class="pkg">asreml</span> with
required attributes (default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>If <code>TRUE</code> diagnostic messages are printed on screen (default = <code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with three of the following elements:
</p>

<ul>
<li>
<p><code>Ginv</code>: the inverse of <code class="reqn">\boldsymbol{G}</code> matrix in full form (only if <code>sparseform = FALSE</code>).
</p>
</li>
<li>
<p><code>Ginv.sparse</code>: the inverse of <code class="reqn">\boldsymbol{G}</code> matrix in sparse form (only if <code>sparseform = TRUE</code>).
</p>
</li>
<li>
<p><code>status</code>: the status (<code>ill-conditioned</code> or <code>well-conditioned</code>) of
the inverse of <code class="reqn">\boldsymbol{G}</code> matrix.
</p>
</li>
<li>
<p><code>rcn</code>: the reciprocal conditional number of the inverse of <code class="reqn">\boldsymbol{G}</code> matrix.
</p>
</li>
</ul>
<h3>References</h3>

<p>Nazarian A., Gezan S.A. 2016. GenoMatrix: A software package for pedigree-based
and genomic prediction analyses on complex traits. Journal of Heredity 107:372-379.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example: An ill-conditioned matrix.

# Get G matrix.
G &lt;- G.matrix(M = geno.apple, method = "VanRaden")$G
G[1:5, 1:5]

# Get the inverse of G.
GINV &lt;- G.inverse(G = G, bend = FALSE, blend = FALSE, align = FALSE)
GINV$Ginv[1:5, 1:5]
GINV$status

</code></pre>


</div>