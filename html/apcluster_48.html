<div class="container">

<table style="width: 100%;"><tr>
<td>coerce-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coercion of cluster hierarchies</h2>

<h3>Description</h3>

<p>Functions for coercing clustering object to hclust and dendrogram objects
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'AggExResult'
as.hclust(x, base=0.05)
## S4 method for signature 'ExClust'
as.hclust(x, base=0.05, ...)
## S4 method for signature 'AggExResult'
as.dendrogram(object, base=0.05, useNames=TRUE)
## S4 method for signature 'ExClust'
as.dendrogram(object, base=0.05, useNames=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a clustering result object of class
<code>APResult</code>, <code>ExClust</code>,
or <code>AggExResult</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a clustering result object of class
<code>APResult</code>, <code>ExClust</code>,
or <code>AggExResult</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>fraction of height used for the very first join; defaults
to 0.05, i.e. the first join appears at 5% of the total height of the
dendrogram (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useNames</code></td>
<td>
<p>if <code>TRUE</code> (default), the labels of the dendrogram
are the sample/cluster names (if available); otherwise, the labels
are indices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>all other arguments are passed on to
<code>aggExCluster</code> (see details below).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If called for an <code>AggExResult</code> object,
<code>as.hclust</code> creates an <code>hclust</code> object.
The heights are transformed to the interval from <code>base</code> (height
of lowest join) to 1 (height of highest join).
If called for an <code>ExClust</code> or
<code>APResult</code> object, <code>aggExCluster</code> is
called internally to create a cluster hierarchy first. This is only
possible if the pairwise similarities are included in the <code>sim</code>
slot of <code>x</code> (see <code>aggExCluster</code> on how to ensure
this).
</p>
<p>If <code>x</code> is an <code>AggExResult</code> object obtained by
clustering an entire data set, <code>as.hclust</code> produces a complete
hierarchy. If, however, <code>x</code> is an <code>ExClust</code> (or
<code>APResult</code>) object or an
<code>AggExResult</code> obtained by running
<code>aggExCluster</code> on an <code>ExClust</code> or
<code>APResult</code> object, then <code>as.hclust</code> produces
a hierarchy of clusters, not of samples.
</p>
<p>If called for an <code>AggExResult</code> object,
<code>as.dendrogram</code> creates an
<code>dendrogram</code> object.
Analogously to <code>as.hclust</code>, the heights are transformed to the
interval ranging from <code>base</code> (height
of lowest join) to 1 (height of highest join). So, any information
about heights of merges is lost. If the original join heights are
relevant, call <code>plot</code> on the original
<code>AggExResult</code> object directly without coercing it
to a <code>dendrogram</code> object first.
If called for an <code>ExClust</code> or
<code>APResult</code> object, <code>aggExCluster</code> is
called first to create a cluster hierarchy. Again this is only
possible if the pairwise similarities are included in the <code>sim</code>
slot of <code>object</code>.
</p>
<p>If <code>object</code> is an <code>AggExResult</code> object obtained by
clustering an entire data set, <code>as.dendrogram</code> produces a complete
dendrogram. If <code>object</code> is an <code>ExClust</code> (or
<code>APResult</code>) object or an
<code>AggExResult</code> obtained by previously running
<code>aggExCluster</code> on an <code>ExClust</code> or
<code>APResult</code> object, then <code>as.dendrogram</code> produces
a complete dendrogram of all samples, too, but with the difference
that entire clusters of the previous <code>ExClust</code> or
<code>APResult</code> object are not further split up
hierarchically.
Consequently, if <code>x</code> is not a complete cluster hierarchy, but a
hierarchy of clusters, <code>as.dendrogram(as.hclust(x))</code> produces a
dendrogram of clusters, whereas <code>as.dendrogram(x)</code> in any case
produces a dendrogram of samples (with the special property mentioned
above).
</p>


<h3>Value</h3>

<p>see details above
</p>


<h3>Author(s)</h3>

<p>Ulrich Bodenhofer, Andreas Kothmeier, and Johannes Palme</p>


<h3>References</h3>

<p><a href="https://github.com/UBod/apcluster">https://github.com/UBod/apcluster</a>
</p>
<p>Bodenhofer, U., Kothmeier, A., and Hochreiter, S. (2011)
APCluster: an R package for affinity propagation clustering.
<em>Bioinformatics</em> <b>27</b>, 2463-2464.
DOI: <a href="https://doi.org/10.1093/bioinformatics/btr406">doi:10.1093/bioinformatics/btr406</a>.
</p>


<h3>See Also</h3>

<p><code>APResult</code>,
<code>AggExResult</code>, <code>ExClust</code>,
<code>heatmap-methods</code>, <code>apcluster</code>, 
<code>apclusterL</code>, <code>aggExCluster</code>, 
<code>cutree-methods</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create two Gaussian clouds
cl1 &lt;- cbind(rnorm(20, 0.2, 0.05), rnorm(20, 0.8, 0.06))
cl2 &lt;- cbind(rnorm(20, 0.7, 0.08), rnorm(20, 0.3, 0.05))
x &lt;- rbind(cl1, cl2)

## run affinity propagation
apres &lt;- apcluster(negDistMat(r=2), x, q=0.7, details=TRUE)

## perform agglomerative clustering of affinity propagation clusters
aggres1 &lt;- aggExCluster(x=apres)

## compute and plot dendrogram
dend1 &lt;- as.dendrogram(aggres1)
dend1
plot(dend1)

## compute and show dendrogram computed from hclust object
dend2 &lt;- as.dendrogram(as.hclust(aggres1))
dend2
plot(dend2)

## perform agglomerative clustering of whole data set
aggres2 &lt;- aggExCluster(negDistMat(r=2), x)

## compute and plot dendrogram
dend3 &lt;- as.dendrogram(aggres2)
dend3
plot(dend3)
</code></pre>


</div>