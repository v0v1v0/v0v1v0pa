<div class="container">

<table style="width: 100%;"><tr>
<td>single_trial_analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Single Trial Analysis</h2>

<h3>Description</h3>

<p>The results of the <code>check_design_met()</code> function are used in
<code>single_trial_analysis()</code> to fit single trial models. This function can
fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs
(RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable
Row-Column Designs (Row-Col) and Resolvable Row-Column Designs (res-Row-Col).
</p>
<p>Returns an object of class <code>smaAgri</code>, with a list of trial summary,
BLUEs, BLUPs, heritability, variance components, potential extreme
observations, residuals,
the models fitted and the data used.
This function will generate the required output to be used in the two-stage
analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">single_trial_analysis(
  results = NULL,
  progress = TRUE,
  engine = "asreml",
  remove_outliers = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>Object of class <code>checkAgri</code> resulting of executing
<code>check_design_met()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Should the progress of the modeling be printed.
If <code>TRUE</code>, for every trial a line is output indicating the traits fitted
for the particular trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>engine</code></td>
<td>
<p>A character string specifying the name of the mixed modeling
engine to use, either <code>lme4</code> or <code>asreml</code>. For spatial designs,
<code>SpATS</code> is always used, for other designs <code>asreml</code> as a default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_outliers</code></td>
<td>
<p>Should outliers be removed? <code>TRUE</code> by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>smaAgri</code>, with a list of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted_models</code></td>
<td>
<p>A list containing the fitted models. (Both models, the
one with Genotype as Random and the one with Genotype as Fixed)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resum_fitted_model</code></td>
<td>
<p>A data.frame containing a summary of the fitted
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>A data.frame containing extreme observations. If
<code>remove_outliers</code> is <code>TRUE</code>, this data.frame will contain the
observations removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blues_blups</code></td>
<td>
<p>A data.frame containing BLUPs/BLUEs for all the genotypes
in each trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std_residuals</code></td>
<td>
<p>A data.frame containing the standardized residuals for
the model with genotype as random component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame containing the data used. If <code>remove_outliers</code>
is <code>TRUE</code>, data will have missing values for the outliers detected.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
library(agridat)
library(agriutilities)
data(besag.met)
dat &lt;- besag.met
results &lt;- check_design_met(
  data = dat,
  genotype = "gen",
  trial = "county",
  traits = c("yield"),
  rep = "rep",
  block = "block",
  col = "col",
  row = "row"
)
out &lt;- single_trial_analysis(results, progress = FALSE)
print(out)

</code></pre>


</div>