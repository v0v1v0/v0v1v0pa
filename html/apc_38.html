<div class="container">

<table style="width: 100%;"><tr>
<td>apc.plot.data.within</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This plot shows time series of matrix within age, period or cohort.</h2>

<h3>Description</h3>

<p><code>apc.plot.data.within</code> produces plot showing time series of matrix
within age, period or cohort against one of the other two indices.
<code>apc.plot.data.within.all.six</code> produces all six plots in one panel plot.
</p>
<p>These plots are sometimes used to gauge how many of the age, period, cohort factors are needed:
If lines are parallel when dropping one index the corresponding factor may not be needed.
In practice these plots should possibly be used with care, see Italian bladder cancer example below.</p>


<h3>Usage</h3>

<pre><code class="language-R">apc.plot.data.within(apc.data.list,
					data.type="r",plot.type="awc",
					average=FALSE,
					thin=NULL,apc.index=NULL,
					ylab=NULL,type="o",log="",legend=TRUE,
					lty=1:5,col=1:6,bty="n",main=NULL,
					x="topleft",return=FALSE)
apc.plot.data.within.all.six(apc.data.list,
					data.type="r",
					average=FALSE,
					thin=NULL,apc.index=NULL,
					ylab=NULL,type="o",log="",legend=TRUE,
					lty=1:5,col=1:6,bty="n",main.outer=NULL,
					x="topleft")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>apc.data.list</code></td>
<td>
<p>List. See <code>apc.data.list</code> for a description of the format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.type</code></td>
<td>
<p>Optional. Character. "r"="response" / "d"="dose" / "m"="mortality"="rates"
if sums are computed for responses/dose/rates,
where rates are found through division response/dose. "r" is default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.type</code></td>
<td>
<p>Optional. "awp", "pwa" "awc", "cwa, "cwp", "pwc":
for example: "awp" gives time series in age within each period level:
for an AP data-array these are the column sums.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average</code></td>
<td>
<p>Optional.  Logical. If TRUE/FALSE reports averages/sums. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Optional. Numerical.  age/periods/cohorts are grouped in groups of size thin.
Default is computed from dimensions of data.  A warning is produced if dimension is not divisible by thin, so that one group is smaller than other groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apc.index</code></td>
<td>
<p>Optional. List. See <code>apc.get.index</code> for a description of the format.  If not provided this is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Optional <code>plot</code> argument.  Character.  Common label for y-axes. Default is "".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Optional <code>plot</code> argument. Character. "o" if overlaid points and lines. "l" if lines. "p" if points. Default is "o".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Optional <code>plot</code> argument. Character. "y" if y-scale is logarithmic, otherwise "". Default is ""</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Optional <code>plot</code> argument. Logical. Should legends be drawn? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Optional <code>plot</code> argument. Vector of line types.
The first element is for the first column, the second element for the second column, etc.,
even if lines are not plotted for all columns. Line types will be used cyclically
until all plots are drawn.  Default is 1:5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Optional <code>plot</code> argument. Vector of colors.
The first element is for the first column, the second element for the second column, etc.,
even if lines are not plotted for all columns. Colors will be used cyclically
until all plots are drawn.  Default is 1:6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bty</code></td>
<td>
<p>Optional <code>plot</code> argument. Character.
The type of box to be drawn around the legend.
The allowed values are "n" and "o".	Default is "n".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Optional. Character. Main title for single plot.  Default is NULL, in which case a title is generated internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main.outer</code></td>
<td>
<p>Optional. Character. Main title for panel of six plots, to be shown in outer margin.  Default is NULL, in which case a title is generated internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Optional <code>legend</code> argument. Default is "topleft".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return</code></td>
<td>
<p>Optional. If TRUE return matrix that is plotted. Default is FALSE</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>A warning is produced if dimension is not divisible by thin, so that one group is smaller than other groups.</p>


<h3>Author(s)</h3>

<p>Bent Nielsen &lt;bent.nielsen@nuffield.ox.ac.uk&gt; 17 Nov 2016 (25 Apr 2015)</p>


<h3>References</h3>

<p>Clayton, D. and Schifflers, E. (1987a)
Models for temperoral variation in cancer rates. I: age-period and age-cohort models. 
<em>Statistics in Medicine</em> 6, 449-467.
</p>
<p>Clayton, D. and Schifflers, E. (1987b) Models for temperoral variation in cancer rates. II: age-period-cohort models. <em>Statistics in Medicine</em> 6, 469-481.
</p>
<p>Martinez Miranda, M.D., Nielsen, B. and Nielsen, J.P. (2015) Inference and forecasting in the age-period-cohort model with unknown exposure with an application to mesothelioma mortality. <em>Journal of the Royal Statistical Society</em> A 178, 29-55. <em>Download</em>: <a href="https://doi.org/10.1111/rssa.12051">Article</a>, <a href="http://www.nuffield.ox.ac.uk/economics/papers/2013/Asbestos8mar13.pdf">Nuffield DP</a>. 
</p>


<h3>See Also</h3>

<p><code>data.Japanese.breast.cancer</code>,
<code>data.Italian.bladder.cancer</code> and
<code>data.asbestos</code> for information on the data used in the example.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#####################
#  	EXAMPLE with artificial data
#  	Generate a 3x4 matrix in "AP" data.format with the numbers 1..12
#	Then make a data list
#	Then plot data.
#  	Note: this deterministic matrix has neither age, period, or cohort factors,
#		 only linear trends.  Thus all 6 plots have parallel lines.	

m.data  	&lt;- matrix(data=seq(length.out=12),nrow=3,ncol=4)
m.data
data.list	&lt;- apc.data.list(m.data,"AP")
apc.plot.data.within(data.list,log="")

#	It also works with a single argument, but then a default log scale is used.

apc.plot.data.within(data.list)			

#####################
#	EXAMPLE with Japanese breast cancer data
#	Clayton and Shifflers (1987b) use APC design
#	Make a data list
#	Then plot data.
#	Note: No plot appears to have approximately parallel lines.

data.list	&lt;- data.Japanese.breast.cancer()	
apc.plot.data.within(data.list,"m",1,log="y")
												
#	It also works with a single argument, but then a default log scale is used.
# 	Note that warnings are given in relation to the data chosen thinning

apc.plot.data.within(data.list)

#####################
#	EXAMPLE with Italian bladder cancer data
#	Clayton and Shifflers (1987a) use AC design
#	Note: plot of within cohort against age appears to have approximately parallel lines.
#		  This is Figure 2 in Clayton and Shifflers (1987a)
#	Note: plot of within age against cohort appears to have approximately parallel lines.
#		  Indicates that interpretation should be done carefully.

data.list	&lt;- data.Italian.bladder.cancer()	
apc.plot.data.within(data.list,"m",1,log="y")

#####################
#	EXAMPLE with asbestos data
#	Miranda Martinex, Nielsen and Nielsen (2014).
#	This is Figure 1d 

data.list	&lt;- data.asbestos()	
apc.plot.data.within(data.list,type="l",lty=1)
</code></pre>


</div>