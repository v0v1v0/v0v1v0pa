<div class="container">

<table style="width: 100%;"><tr>
<td>gdmudr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interface of dbmdr, dbimdr, dgmdr, dpmdr in GRKPACK.</h2>

<h3>Description</h3>

<p>To calculate a spline estimate with multiple smoothing parameters for non-Gaussian data
</p>


<h3>Usage</h3>

<pre><code class="language-R">gdmudr(y, q, s, family, vmu = "v", varht = NULL, 
    init = 0, theta = NULL, tol1 = 0, tol2 = 0, prec1 = 1e-06, 
    maxit1 = 30, prec2 = 1e-06, maxit2 = 30) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a numerical vector representing the response, or a matrix of two columns for binomial data with the first column as the largest possible counts and the second column as the counts actually obsered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>a list, or an array, of square matrices of the same order as the length of y, which are the reproducing kernels evaluated at the design points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>the design matrix of the null space <code class="reqn">H_0</code> of size (length-of-y,<code class="reqn">dim(H_0)</code>), with elements equal to the bases of <code class="reqn">H_0</code> evaluated at design points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a string specifying the family of distribution. Families  supported  are  "binary", "binomial", "poisson" and "gamma" for Bernoulli, binomial, poisson, and gamma distributions respectively. Canonical links are used except for Gamma family where log link is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmu</code></td>
<td>

<p>a character string specifying a method for choosing the smoothing  parameter.  "v", "m" and "u" represent GCV, GML and UBR respectively. 
"u<code class="reqn">\sim</code>", only used for non-Gaussian family, specifies UBR with estimated variance. Default is "v".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>

<p>needed only when vmu="u", which gives the fixed variance in calculation of the UBR function. Default is 1.0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>an integer of 0 or 1 indicating if initial values are provided for theta. If init=1, initial values are provided using theta. Default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>If ‘init=1’, theta includes intial values for smoothing parameters. Default is NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol1</code></td>
<td>

<p>the tolerance for elements of w's. Default is 0.0 which sets to square of machine precision. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol2</code></td>
<td>

<p>tolerance for truncation used in ‘dsidr’. Default is 0.0 which sets to square of machine precision.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec1</code></td>
<td>

<p>precision requested for the minimum score value, where precision is the weaker of the absolute and relative precisions. Default is 1e-06.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit1</code></td>
<td>

<p>maximum number of iterations allowed for DMUDR subroutine. Default is 30.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec2</code></td>
<td>

<p>precision requested for stopping the iteration. Default is <code class="reqn">1e-06</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit2</code></td>
<td>

<p>maximum number of iterations allowed for the iteration in GRKPACK. Default is 30.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>an integer that provides error message. info=-1 indicates dimension error, 
info=-2 idicates <code class="reqn">F_{2}^{T} Q_{*}^{theta} F_{2} !&gt;= 0</code>, info=-3 indicates tuning parameters are out of scope, info=-4 indicates dmudr fails to converge within maxit1 steps, info=-5 indicates dmudr fails to find a reasonable descent direction, info=-6 indicates GRKPACK fails to converge within maxit2 steps, info=-7 indicates there are some w's equals to zero, 
info&gt;0 indicates the matrix S is rank deficient with <code class="reqn">info=rank(S)+1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>estimate of the function at design points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>

<p>estimates of c.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> d</code></td>
<td>

<p>estimates of d.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resi</code></td>
<td>

<p>vector of working residuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>

<p>estimate of dispersion parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>estimates of parameters <code class="reqn">log10(theta)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlaht</code></td>
<td>

<p>the estimate of <code class="reqn">log10(nobs*lambda)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>

<p>the minimum GCV/GML/UBR score at the estimated smoothing parameters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>equavilent degree of freedom.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>

<p>length-of-y, number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnull</code></td>
<td>

<p><code class="reqn">dim(H_0)</code>, number of bases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>

<p>length(rk), number of reproducing kernels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s,q,y,init,maxit2</code></td>
<td>

<p>changed from the inputs.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chunlei Ke <a href="mailto:chunlei_ke@yahoo.com">chunlei_ke@yahoo.com</a> and Yuedong Wang <a href="mailto:yuedong@pstat.ucsb.edu">yuedong@pstat.ucsb.edu</a></p>


<h3>References</h3>

<p>Wahba, G. (1990). Spline Models for Observational Data. SIAM, Vol. 59.
</p>
<p>Wang, Y. (1997). GRKPACK: Fitting Smoothing Spline ANOVA Models for Exponential Families. Communications in Statistics: Simulation and Computation, 24: 1037-1059.
</p>


<h3>See Also</h3>

<p><code>dsidr</code>, <code>dmudr</code>, <code>gdsidr</code>, <code>ssr</code>
</p>


</div>