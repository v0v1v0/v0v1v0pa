<div class="container">

<table style="width: 100%;"><tr>
<td>beta.div.comp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Decompose D in replacement and richness difference components</h2>

<h3>Description</h3>

<p>Podani-family and Baselga-family decompositions of the Jaccard and Sørensen 
dissimilarity coefficients and their quantitative forms (Ruzicka and percentage  
difference) into replacement and richness difference components, for species 
presence-absence or abundance data, as described in Legendre (2014).
</p>


<h3>Usage</h3>

<pre><code class="language-R">beta.div.comp(mat, coef = "J", quant = FALSE, save.abc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>Community composition data (<code>data.frame</code> or <code>matrix</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>Family of coefficients to be computed. </p>
<ul>
<li>
<p> "S" or 
"Sorensen": Podani family, Sørensen-based indices. </p>
</li>
<li>
<p> "J" or "Jaccard": 
Podani family, Jaccard-based indices. </p>
</li>
<li>
<p> "BS": Baselga family, 
Sørensen-based indices. </p>
</li>
<li>
<p> "BJ": Baselga family, Jaccard-based indices. 
</p>
</li>
<li>
<p> "N": Podani &amp; Schmera (2011) relativized nestedness index.</p>
</li>
</ul>
<p> The 
quantitative form of the Sørensen dissimilarity is the percentage difference index.
The quantitative form of the Jaccard dissimilarity is the Ruzicka index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>If <code>TRUE</code>, compute the quantitative forms of replacement, 
nestedness and D. If <code>FALSE</code>, compute the presence-absence forms of the
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.abc</code></td>
<td>
<p>If <code>TRUE</code>, save the matrices of parameters a, b and c 
used in presence-absence calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For species presence-absence data, the dissimilarity coefficients are 
Jaccard = (b+c)/(a+b+c) and Sørensen = (b+c)/(2*a+b+c) with the usual <code>a,b,c</code> 
notation. For species abundance data, the dissimilarity coefficients are the 
Ruzicka index = (B+C)/(A+B+C) and Odum's percentage difference = 
(B+C)/(2A+B+C) (aka Bray-Curtis in some packages), where 
</p>
<ul>
<li>
<p> A = sum of the intersections (or minima) of species 
abundances at two sites, </p>
</li>
<li>
<p> B = sum of abundances at site 1 minus A, 
</p>
</li>
<li>
<p> C = sum of abundances at site 2 minus A.</p>
</li>
</ul>
<p> The binary 
(<code>quant=FALSE</code>) and quantitative (<code>quant=TRUE</code>) forms of the S and
J indices return the same values when computed for presence-absence data.
</p>


<h3>Value</h3>

<p>A list containing the following results:
</p>

<ul>
<li> <p><code>repl</code>: Replacement matrix, class = dist. 
</p>
</li>
<li>
<p><code>rich</code>: Richness/abundance difference or nestedness matrix (class
<code>dist</code>). With options "BJ", "BS" and "N", <code>rich</code> contains
nestedness indices. With option "N", the repl[i,j] and rich[i,j] values do
not add up to D[i,j]. 
</p>
</li>
<li> <p><code>D</code>: Dissimilarity matrix (class<code>dist</code>). 
</p>
</li>
<li> <p><code>part</code>: Beta diversity partitioning vector:
</p>
 
<ol>
<li>
<p> BDtotal (total beta diversity) = sum(D.ij)/(n*(n-1)) (Legendre &amp; De 
Cáceres 2013). This is equal to sum(d.ij^2)/(n*(n-1)) where d.ij = sqrt(D.ij). The
dissimilarities are square-rooted because the Jaccard, Sørensen, Ruzicka and
percentage difference indices are not Euclidean. 
</p>
</li>
<li>
<p> Repl = Total replacement diversity. 
</p>
</li>
<li>
<p> RichDiff|Nes = Total richness difference diversity (or nestedness). 
</p>
</li>
<li>
<p> Repl/BDtotal = Total replacement diversity/Total beta diversity. 
</p>
</li>
<li>
<p> RichDiff/BDtotal = Total richness difference diversity (or nestedness)/Total 
beta diversity.</p>
</li>
</ol>
</li>
<li> <p><code>note</code>: Name of the dissimilarity coefficient. </p>
</li>
</ul>
<p>The Jaccard and Sørensen dissimilarity
coefficients and their quantitative forms, the Ruzicka and percentage difference
indices, all have upper bounds (Dmax) of 1. Hence, when all sites contain a
different set of species with no species in common, the maximum value that
BDtotal can take is 0.5. See Legendre &amp; De Caceres (2013, p. 958), section
Maximum value of BD. This differs form the values produced by function
beta.div(): with methods "hellinger", "chord" and "profiles", which have
maximum values of sqrt(2), BDtotal has a maximum value of 1 for these dissimilarities.
</p>


<h3>Author(s)</h3>

<p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>
</p>


<h3>References</h3>

<p>Baselga, A. (2010) Partitioning the turnover and nestedness components of beta
diversity. Global Ecology and Biogeography, 19, 134–143.
</p>
<p>Baselga, A. (2012) The relationship between species replacement, dissimilarity
derived from nestedness, and nestedness. Global Ecology and Biogeography, 21,
1223-1232.
</p>
<p>Baselga, A. (2013) Separating the two components of abundance-based
dissimilarity: balanced changes in abundance vs. abundance gradients. Methods
in Ecology and Evolution, 4, 552-557.
</p>
<p>Carvalho, J.C., Cardoso, P., Borges, P.A.V., Schmera, D. &amp; Podani, J. (2013)
Measuring fractions of beta diversity and their relationships to nestedness: a
theoretical and empirical comparison of novel approaches. Oikos, 122, 825-834.
</p>
<p>Legendre, P. 2014. Interpreting the replacement and richness difference
components of beta diversity. Global Ecology and Biogeography, 23, 1324-1334.
</p>
<p>Legendre, P. and M. De Cáceres. 2013. Beta diversity as the variance of
community data: dissimilarity coefficients and partitioning. Ecology Letters
16: 951-963.
</p>
<p>Podani, J., Ricotta, C. &amp; Schmera, D. (2013) A general framework for analyzing
beta diversity, nestedness and related community-level phenomena based on
abundance data. Ecological Complexity, 15, 52-61.
</p>
<p>Podani, J. &amp; Schmera, D. 2011. A new conceptual and methodological framework
for exploring and explaining pattern in presence-absence data. Oikos, 120,
1625-1638.
</p>


<h3>See Also</h3>

<p><code>LCBD.comp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(ade4, quietly = TRUE)){
data(doubs)
fish.sp = doubs$fish[-8,]   # Fish data; site 8 is removed because no fish were caught

# Compute and partition a matrix of Jaccard indices (presence-absence data)
out1 = beta.div.comp(fish.sp, coef="J", quant=FALSE)
out1$part

# Compute and partition a matrix of percentage difference indices
# (quantitative form of Sorensen index)
out2 = beta.div.comp(fish.sp, coef="S", quant=TRUE)
out2$part
# In paragraph Value, see the description of the 5 elements of vector part. 
# Is the fish beta diversity dominated by replacement or richness/abundance difference?
}

</code></pre>


</div>