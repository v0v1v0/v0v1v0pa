<div class="container">

<table style="width: 100%;"><tr>
<td>niche</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Method to Analyse a pair of tables : Environmental and Faunistic Data</h2>

<h3>Description</h3>

<p>performs a special multivariate analysis for ecological data. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">niche(dudiX, Y, scannf = TRUE, nf = 2)
## S3 method for class 'niche'
print(x, ...) 
## S3 method for class 'niche'
plot(x, xax = 1, yax = 2, ...)
niche.param(x)
## S3 method for class 'niche'
rtest(xtest,nrepet=99, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudiX</code></td>
<td>
<p>a duality diagram providing from a function <code>dudi.coa</code>, <code>dudi.pca</code>, ... using an array sites-variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a data frame sites-species according to <code>dudiX$tab</code> with no columns of zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p>a logical value indicating whether the eigenvalues bar plot should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>if scannf FALSE, an integer indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>niche</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax, yax</code></td>
<td>
<p>the numbers of the x-axis and the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtest</code></td>
<td>
<p>an object of class <code>niche</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>the number of permutations for the testing procedure</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of the class <code>niche</code> (sub-class of <code>dudi</code>) containing :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>an integer indicating the rank of the studied matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RV</code></td>
<td>
<p>a numeric value indicating the RV coefficient</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a numeric vector with the all eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>a data frame with the row weigths (crossed array)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a data frame with the crossed array (averaging species/sites)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>a data frame with the species coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>a data frame with the species normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>a data frame with the variable coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>a data frame with the variable normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ls</code></td>
<td>
<p>a data frame with the site coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as</code></td>
<td>
<p>a data frame with the axis upon niche axis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel Chessel<br>
Anne-Béatrice Dufour <a href="mailto:anne-beatrice.dufour@univ-lyon1.fr">anne-beatrice.dufour@univ-lyon1.fr</a><br>
Stéphane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Dolédec, S., Chessel, D. and Gimaret, C. (2000) Niche separation in community analysis: a new method. <em>Ecology</em>, <b>81</b>, 2914–1927.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(doubs)
dudi1 &lt;- dudi.pca(doubs$env, scale = TRUE, scan = FALSE, nf = 3)
nic1 &lt;- niche(dudi1, doubs$fish, scann = FALSE)

if(adegraphicsLoaded()) {
  g1 &lt;- s.traject(dudi1$li, plab.cex = 0, plot = FALSE)
  g2 &lt;- s.traject(nic1$ls, plab.cex = 0, plot = FALSE)
  g3 &lt;- s.corcircle(nic1$as, plot = FALSE)
  g4 &lt;- s.arrow(nic1$c1, plot = FALSE)
  G1 &lt;- ADEgS(list(g1, g2, g3, g4), layout = c(2, 2))
  
  glist &lt;- list()
  for(i in 1:ncol(doubs$fish))
    glist[[i]] &lt;- s.distri(nic1$ls, dfdistri = doubs$fish[, i], psub.text = names(doubs$fish)[i], 
      plot = FALSE, storeData = TRUE)
  G2 &lt;- ADEgS(glist, layout = c(5, 6))
  
  G3 &lt;- s.arrow(nic1$li, plab.cex = 0.7)  
    
} else {
  par(mfrow = c(2, 2))
  s.traject(dudi1$li, clab = 0)
  s.traject(nic1$ls, clab = 0)
  s.corcircle(nic1$as)
  s.arrow(nic1$c1)

  par(mfrow = c(5, 6))
  for (i in 1:27) s.distri(nic1$ls, as.data.frame(doubs$fish[,i]),
    csub = 2, sub = names(doubs$fish)[i])
    
  par(mfrow = c(1, 1))
  s.arrow(nic1$li, clab = 0.7)

}

data(trichometeo)
pca1 &lt;- dudi.pca(trichometeo$meteo, scan = FALSE)
nic1 &lt;- niche(pca1, log(trichometeo$fau + 1), scan = FALSE)
plot(nic1)
niche.param(nic1)
rtest(nic1,19)

data(rpjdl)
plot(niche(dudi.pca(rpjdl$mil, scan = FALSE), rpjdl$fau, scan = FALSE))
</code></pre>


</div>