<div class="container">

<table style="width: 100%;"><tr>
<td>aeddo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automated and Early Detection of Disease Outbreaks</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>This function performs automated an early detection of disease outbreaks,
(aeddo), on a time series data set. It utilizes hierarchical models in an
innovative manner to infer one-step ahead random effects. In turn, these
random effects are used directly to characterize an outbreak.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aeddo(
  data = data.frame(),
  formula = formula(),
  k = integer(),
  sig_level = 0.95,
  exclude_past_outbreaks = TRUE,
  init_theta = numeric(),
  lower = numeric(),
  upper = numeric(),
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A tibble containing the time series data, including columns 'y'
for observed values,'n' for population size, and other covariates of
interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A model formula for the fixed effects in the  hierarchical
model to fit to the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>An integer specifying the rolling window size employed for parameter
estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig_level</code></td>
<td>
<p>The quantile from the random effects distribution used for
defining the for outbreak detection threshold, a numeric value between 0 and
1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_past_outbreaks</code></td>
<td>
<p>logical value indicating whether past outbreak
related observations should be excluded from future parameter estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_theta</code></td>
<td>
<p>Initial values for model parameters in optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bounds for optimization parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bounds for optimization parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The optimization method to use, either "BFGS"  (default) or
"L-BFGS-B".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A tibble-like 'aedseo' object containing:
</p>

<ul>
<li>
<p> 'window_data': A list of tibble, each
representing the data for this windowed parameter estimation.
</p>
</li>
<li>
<p> 'reference_data': A list of tibble, each
representing the data for the reference time point.
</p>
</li>
<li>
<p> 'phi': The dispersion parameter.
</p>
</li>
<li>
<p> 'lambda': The estimated outbreak intensity.
</p>
</li>
<li>
<p> 'u': The one-step ahead random effect.
</p>
</li>
<li>
<p> 'u_probability': The probability of observing the one-step ahead
random effect.
</p>
</li>
<li>
<p> 'outbreak_alarm': Logical. Indicates if an outbreak is detected.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Create an example aedseo_tsd object
aeddo_data &lt;- data.frame(
  time = as.Date(c(
    "2023-01-01",
    "2023-01-02",
    "2023-01-03",
    "2023-01-04",
    "2023-01-05",
    "2023-01-06"
  )),
  y = c(100, 120, 180, 110, 130, 140),
  n = 1
)

# Supply a model formula
fixed_effects_formula &lt;- y ~ 1

# Choose a size for the rolling window
k &lt;- 2
# ... and quantile for the threshold
sig_level &lt;- 0.9

# Employ the algorithm
aeddo_results &lt;- aeddo(
  data = aeddo_data,
  formula = fixed_effects_formula,
  k = k,
  sig_level = sig_level,
  exclude_past_outbreaks = TRUE,
  init_theta = c(1, 0),
  lower = c(-Inf, 1e-6),
  upper = c(Inf, 1e2),
  method = "L-BFGS-B"
)
# Print the results
print(aeddo_results)
</code></pre>


</div>