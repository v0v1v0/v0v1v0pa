<div class="container">

<table style="width: 100%;"><tr>
<td>exp_stats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summarize experience study records</h2>

<h3>Description</h3>

<p>Create a summary data frame of termination experience for a
given target status.
</p>


<h3>Usage</h3>

<pre><code class="language-R">exp_stats(
  .data,
  target_status = attr(.data, "target_status"),
  expected,
  col_exposure = "exposure",
  col_status = "status",
  wt = NULL,
  credibility = FALSE,
  conf_level = 0.95,
  cred_r = 0.05,
  conf_int = FALSE
)

## S3 method for class 'exp_df'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame with exposure-level records, ideally of type
<code>exposed_df</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_status</code></td>
<td>
<p>A character vector of target status values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected</code></td>
<td>
<p>A character vector containing column names in <code>.data</code>
with expected values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_exposure</code></td>
<td>
<p>Name of the column in <code>.data</code> containing exposures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col_status</code></td>
<td>
<p>Name of the column in <code>.data</code> containing the policy status</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt</code></td>
<td>
<p>Optional. Length 1 character vector. Name of the column in
<code>.data</code> containing weights to use in the calculation of claims,
exposures, partial credibility, and confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>credibility</code></td>
<td>
<p>If <code>TRUE</code>, the output will include partial credibility
weights and credibility-weighted termination rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>Confidence level used for the Limited Fluctuation
credibility method and confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cred_r</code></td>
<td>
<p>Error tolerance under the Limited Fluctuation credibility
method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_int</code></td>
<td>
<p>If <code>TRUE</code>, the output will include confidence intervals
around the observed termination rates and any actual-to-expected ratios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>exp_df</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Groups to retain after <code>summary()</code> is called</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>.data</code> is grouped, the resulting data frame will contain
one row per group.
</p>
<p>If <code>target_status</code> isn't provided, <code>exp_stats()</code> will use the same
target status from <code>.data</code> if it has the class <code>exposed_df</code>.
Otherwise, all status values except the first level will be assumed.
This will produce a warning message.
</p>


<h3>Value</h3>

<p>A tibble with class <code>exp_df</code>, <code>tbl_df</code>, <code>tbl</code>,
and <code>data.frame</code>. The results include columns for any grouping variables,
claims, exposures, and observed termination rates (<code>q_obs</code>).
</p>

<ul>
<li>
<p> If any values are passed to <code>expected</code>, expected termination rates and
actual-to-expected ratios.
</p>
</li>
<li>
<p> If <code>credibility</code> is set to <code>TRUE</code>, additional columns are added
for partial credibility and credibility-weighted termination rates
(assuming values are passed to <code>expected</code>). Credibility-weighted termination
rates are prefixed by <code>adj_</code>.
</p>
</li>
<li>
<p> If <code>conf_int</code> is set to <code>TRUE</code>, additional columns are added for lower and
upper confidence interval limits around the observed termination rates and
any actual-to-expected ratios. Additionally, if <code>credibility</code> is <code>TRUE</code> and
expected values are passed to <code>expected</code>, the output will contain confidence
intervals around credibility-weighted termination rates. Confidence interval
columns include the name of the original output column suffixed by either
<code style="white-space: pre;">⁠_lower⁠</code> or <code style="white-space: pre;">⁠_upper⁠</code>.
</p>
</li>
<li>
<p> If a value is passed to <code>wt</code>, additional columns are created containing
the the sum of weights (<code>.weight</code>), the sum of squared weights
(<code>.weight_qs</code>), and the number of records (<code>.weight_n</code>).
</p>
</li>
</ul>
<h3>Expected values</h3>

<p>The <code>expected</code> argument is optional. If provided, this argument must
be a character vector with values corresponding to columns in <code>.data</code>
containing expected experience. More than one expected basis can be provided.
</p>


<h3>Credibility</h3>

<p>If <code>credibility</code> is set to <code>TRUE</code>, the output will contain a
<code>credibility</code> column equal to the partial credibility estimate under
the Limited Fluctuation credibility method (also known as Classical
Credibility) assuming a binomial distribution of claims.
</p>


<h3>Confidence intervals</h3>

<p>If <code>conf_int</code> is set to <code>TRUE</code>, the output will contain lower and upper
confidence interval limits for the observed termination rate and any
actual-to-expected ratios. The confidence level is dictated
by <code>conf_level</code>. If no weighting variable is passed to <code>wt</code>, confidence
intervals will be constructed assuming a binomial distribution of claims.
Otherwise, confidence intervals will be calculated assuming that the
aggregate claims distribution is normal with a mean equal to observed claims
and a variance equal to:
</p>
<p><code>Var(S) = E(N) * Var(X) + E(X)^2 * Var(N)</code>,
</p>
<p>Where <code>S</code> is the aggregate claim random variable, <code>X</code> is the weighting
variable assumed to follow a normal distribution, and <code>N</code> is a binomial
random variable for the number of claims.
</p>
<p>If <code>credibility</code> is <code>TRUE</code> and expected values are passed to <code>expected</code>,
the output will also contain confidence intervals for any
credibility-weighted termination rates.
</p>


<h3>
<code>summary()</code> Method</h3>

<p>Applying <code>summary()</code> to a <code>exp_df</code> object will re-summarize the
data while retaining any grouping variables passed to the "dots"
(<code>...</code>).
</p>


<h3>References</h3>

<p>Herzog, Thomas (1999). Introduction to Credibility Theory
</p>


<h3>Examples</h3>

<pre><code class="language-R">toy_census |&gt; expose("2022-12-31", target_status = "Surrender") |&gt;
    exp_stats()

exp_res &lt;- census_dat |&gt;
           expose("2019-12-31", target_status = "Surrender") |&gt;
           group_by(pol_yr, inc_guar) |&gt;
           exp_stats()

exp_res
summary(exp_res)
summary(exp_res, inc_guar)

</code></pre>


</div>