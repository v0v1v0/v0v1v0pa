<div class="container">

<table style="width: 100%;"><tr>
<td>kdfun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale second-order neighbourhood analysis of a spatial phylogenetic or functional community pattern from fully mapped data</h2>

<h3>Description</h3>

<p>Computes distance-dependent estimates of Shen et al. (2014) phylogenetic or functional mark correlation functions from a multivariate spatial point pattern 
in a simple (rectangular or circular) or complex sampling window. Computes optionally local confidence limits of the functions
under the null hypothesis of species equivalence (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kdfun(p, upto, by, dis, nsim=0, alpha = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>a <code>"spp"</code> object defining a spatial point pattern in a given sampling window (see <code>spp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upto </code></td>
<td>
<p>maximum radius of the sample circles (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by </code></td>
<td>
<p>interval length between successive sample circles radii (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis </code></td>
<td>
<p>a <code>"dist"</code> object defining Euclidean distances between species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim </code></td>
<td>
<p>number of Monte Carlo simulations to estimate local confidence limits of the null hypothesis of a random allocation of species distances (species equivalence; see Details).
By default <code>nsim = 0</code>, so that no confidence limits are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>if <code>nsim&gt;0</code>, significant level of the confidence limits. By default <code class="reqn">\alpha = 0.01</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>kdfun</code> computes Shen et al. (2014) <code class="reqn">Kd</code> and <em>gd</em>-functions. For a multivariate point pattern consisting of <code class="reqn">S</code> species with intensity <code class="reqn">\lambda</code>p, such functions can be estimated from the bivariate <code class="reqn">Kpq</code>-functions between each pair of different species <code class="reqn">p</code> and <code class="reqn">q</code>.
Function <code>kdfun</code> is thus a simple wrapper of <code>k12fun</code> (P?Pelissier &amp; Goreaud 2014):
</p>
<p><code class="reqn">Kd(r) = D * Kr(r) / HD * Ks(r) = D * sum(\lambda p * \lambda q * Kpq(r) * dpq) / HD * sum(\lambda p * \lambda q * Kpq(r))</code>.<br><code class="reqn">gd(r) = D * g(r) / HD * gs(r) = D * sum(\lambda p * \lambda q * gpq(r) * dpq) / HD * sum(\lambda p * \lambda q * gpq(r))</code>.<br><br></p>
<p>where <code class="reqn">Ks(r)</code> and <code class="reqn">gs(r)</code> are distance-dependent versions of Simpson's diversity index, <code class="reqn">D</code> (see <code>ksfun</code>), <code class="reqn">Kr(r)</code> and <code class="reqn">gr(r)</code> are distance-dependent versions of Rao's diversity coefficient (see <code>krfun</code>); 
<code class="reqn">dpq</code> is the distance between species <code class="reqn">p</code> and <code class="reqn">q</code> defined by matrix <code>dis</code>, typically a taxonomic, phylogenetic or functional distance. The advantage here is that as the edge effects vanish between <code class="reqn">Kr(r)</code> and <code class="reqn">Ks(r)</code>,
implementation is fast for a sampling window of any shape. <code class="reqn">Kd(r)</code> provides the expected phylogenetic or functional distance of two heterospecific individuals a distance less than <em>r</em> apart (Shen et al. 2014), while <code class="reqn">gd(r)</code> 
provides the same within an annuli between two consecutive distances of <em>r</em> and <em>r-by</em>.
</p>
<p>Theoretical values under the null hypothesis of species equivalence as well as local Monte Carlo confidence limits and p-values of departure from the null hypothesis (Besag &amp; Diggle 1977) are estimated at each distance <code class="reqn">r</code>, 
by randomizing the between-species distances, keeping the point locations and distribution of species labels unchanged. The theoretical expectations of <code class="reqn">gd(r)</code> and <code class="reqn">Kd(r)</code> are thus <code class="reqn">1</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"fads"</code> with essentially the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>a vector of regularly spaced out distances (<code>seq(by,upto,by)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gd </code></td>
<td>
<p>a data frame containing values of the function <code class="reqn">gd(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kd </code></td>
<td>
<p>a data frame containing values of the function <code class="reqn">Kd(r)</code>.<br></p>
</td>
</tr>
</table>
<p>Each component except <code>r</code> is a data frame with the following variables:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>obs </code></td>
<td>
<p>a vector of estimated values for the observed point pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theo </code></td>
<td>
<p>a vector of theoretical values expected under the null hypothesis of species equivalence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the upper local confidence limits of a random distribution of the null hypothesis at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inf </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the lower local confidence limits of a random distribution of the null hypothesis at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of local p-values of departure from the null hypothesis.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>There are printing and plotting methods for <code>"fads"</code> objects.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:Raphael.Pelissier@ird.fr">Raphael.Pelissier@ird.fr</a></p>


<h3>References</h3>

<p>Shen, G., Wiegand, T., Mi, X. &amp; He, F. (2014). Quantifying spatial phylogenetic structures of fully stem-mapped plant communities. <em>Methods in Ecology and Evolution</em>, 4, 1132-1141.
</p>
<p>P?Pelissier, R. &amp; Goreaud, F. ads package for R: A fast unbiased implementation of the K-function family for studying spatial point patterns in irregular-shaped sampling windows. <em>Journal of Statistical Software</em>, in press.
</p>


<h3>See Also</h3>

<p><code>plot.fads</code>,
<code>spp</code>,
<code>ksfun</code>,
<code>krfun</code>,
<code>divc</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(Paracou15)
  P15&lt;-Paracou15
  ## Not run: spatial point pattern in a rectangle sampling window of size 125 x 125
  swmr &lt;- spp(P15$trees, win = c(175, 175, 250, 250), marks = P15$species)
  ## Not run: testing the species equivalence hypothesis
  kdswmr &lt;- kdfun(swmr, dis = P15$spdist, 50, 2, 100)
  ## Not run: running more simulations is slow
  kdswmr &lt;- kdfun(swmr, dis = P15$spdist, 50, 2, 500)
  plot(kdswmr)

 ## Not run: spatial point pattern in a circle with radius 50 centred on (125,125)
  swmc &lt;- spp(P15$trees, win = c(125,125,50), marks = P15$species)
  kdswmc &lt;- kdfun(swmc, dis = P15$spdist, 50, 2, 100)
  ## Not run: running more simulations is slow
  kdswmc &lt;- kdfun(swmc, dis = P15$spdist, 50, 2, 500)
  plot(kdswmc)
  
 ## Not run: spatial point pattern in a complex sampling window
  swrt &lt;- spp(P15$trees, win = c(125,125,250,250), tri = P15$tri, marks = P15$species)
  kdswrt &lt;- kdfun(swrt, dis = P15$spdist, 50, 2, 100)
  ## Not run: running simulations is slow
  kdswrt &lt;- kdfun(swrt, dis = P15$spdist, 50, 2, 500)
  plot(kdswrt)
</code></pre>


</div>