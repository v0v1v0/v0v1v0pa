<div class="container">

<table style="width: 100%;"><tr>
<td>predict.wa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict from a weighted average model</h2>

<h3>Description</h3>

<p>Model predictions and cross-validation predictions for weighted
averaging transfer function models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'wa'
predict(object, newdata,
        CV = c("none", "LOO", "bootstrap", "nfold"),
        verbose = FALSE, n.boot = 100, nfold = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"wa"</code>, usually the result of a
call to <code>wa</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>An optional data frame in which to look for variables
with which to predict. If omitted, the fitted values are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>Should cross-validation be performed? Leave-one-out
(<code>"LOO"</code>), bootstrap (<code>"bootstrap"</code>) and <code class="reqn">k</code>-fold
(<code>"nfold"</code>) CV are currently available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should CV progress be printed to the console?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>The number of bootstrap samples or <code class="reqn">k</code>-fold steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>Number of subsets in <code class="reqn">k</code>-fold CV.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Not all CV methods produce the same output. <code>CV = "bootstrap"</code> and
<code>CV = "nfold"</code> produce sample specific errors.
</p>


<h3>Value</h3>

<p>An object of class <code>"predict.wa"</code>, a list with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A list with components <code>pred</code> and <code>rmsep</code>
containing the predicted values and the sample specific errors if
available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>performance</code></td>
<td>
<p>A list with model performance statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.pred</code></td>
<td>
<p>A list with components <code>pred</code> and <code>rmsep</code>
containing the predicted values for the training set samples and the
sample specific errors if available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV.method</code></td>
<td>
<p>The CV method used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson and Jari Oksanen (<code class="reqn">k</code>-fold CV)</p>


<h3>References</h3>

<p>Birks, H.J.B., Line, J.M., Juggins, S., Stevenson, A.C. and ter Braak,
C.J.F. (1990). Diatoms and pH reconstruction. <em>Philosophical
Transactions of the Royal Society of London; Series B</em>, <strong>327</strong>;
263â€“278.</p>


<h3>See Also</h3>

<p><code>wa</code>, <code>predict.mat</code>,
<code>performance</code>, <code>reconPlot</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Imbrie and Kipp
data(ImbrieKipp)
ImbrieKipp &lt;- ImbrieKipp / 100
data(SumSST)
ik.wa &lt;- wa(SumSST ~ ., data = ImbrieKipp, tol.dw = TRUE,
            min.tol = 2, small.tol = "min")
ik.wa

## load V12.122 core data
data(V12.122)
V12.122 &lt;- V12.122 / 100

## predict summer sea-surface temperature for V12.122 core
set.seed(2)
v12.pred &lt;- predict(ik.wa, V12.122, CV = "bootstrap", n.boot = 100)

## draw the fitted reconstruction
reconPlot(v12.pred, use.labels = TRUE, display = "bars")

## extract the model performance stats
performance(v12.pred)

</code></pre>


</div>