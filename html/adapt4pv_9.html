<div class="container">

<table style="width: 100%;"><tr>
<td>est_ps_hdps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>propensity score estimation in high dimension with automated covariates selection using hdPS</h2>

<h3>Description</h3>

<p>Estimate a propensity score to a given drug exposure by
(i) selecting among other drug covariates in <code>x</code> which ones to
include in the PS estimation model automatically using hdPS algorithm,
(ii) estimating a score using a classical logistic regression
with the afore selected covariates.
Internal function, not supposed to be used directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est_ps_hdps(idx_expo, x, y, keep_total = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>idx_expo</code></td>
<td>
<p>Index of the column in <code>x</code> that corresponds to the
drug covariate for which we aim at estimating the PS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input matrix, of dimension nobs x nvars. Each row is an observation
vector. Can be in sparse matrix format (inherit from class
<code>"sparseMatrix"</code> as in package <code>Matrix</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Binary response variable, numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_total</code></td>
<td>
<p>number of covariates to include in the PS estimation
model according to the hdps algorithm ordering. Default is 20.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compared to the situation of the classic use of hdps
(i) there is only one dimension (the co-exposition matrix)
(ii) no need to expand covariates since they are already binary.
In other words, in our situation hdps consists in the "prioritize covariates"
step from the original algorithm, using Bross formula.
We consider the correction on the interpretation on this formula made
by Richard Wyss (drug epi).
</p>


<h3>Value</h3>

<p>An object with S3 class <code>"ps", "hdps"</code>.
</p>
<table><tr style="vertical-align: top;">
<td><code>expo_name</code></td>
<td>
<p>Character, name of the drug exposure for which the PS was
estimated. Correspond to <code>colnames(x)[idx_expo]</code></p>
</td>
</tr></table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>indicator_expo</code></td>
<td>
<p>One-column Matrix object. Indicator of the drug
exposure for which the PS was estimated.
Defined by <code>x[, idx_expo]</code>.</p>
</td>
</tr></table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>score_variables</code></td>
<td>
<p>Character vector, names of covariates(s)
selected with the hdPS algorithm to include in the PS estimation model.
Could be empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>One-column Matrix object, the estimated score.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emeline Courtois <br> Maintainer: Emeline Courtois
<a href="mailto:emeline.courtois@inserm.fr">emeline.courtois@inserm.fr</a>
</p>


<h3>References</h3>

<p>Schneeweiss, S., Rassen, J. A., Glynn, R. J., Avorn, J., Mogun, H., Brookhart, M. A. (2009).
"High-dimensional propensity score adjustment in studies of treatment effects using health care claims data".
<em>Epidemiology</em>. 20, 512â€“522, <a href="https://doi.org/10.1097/EDE.0b013e3181a663cc">doi:10.1097/EDE.0b013e3181a663cc</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(15)
drugs &lt;- matrix(rbinom(100*20, 1, 0.2), nrow = 100, ncol = 20)
colnames(drugs) &lt;- paste0("drugs",1:ncol(drugs))
ae &lt;- rbinom(100, 1, 0.3)
pshdps2 &lt;- est_ps_hdps(idx_expo = 2, x = drugs, y = ae, keep_total = 10)
pshdps2$score_variables #selected variables to include in the PS model of drug_2

</code></pre>


</div>