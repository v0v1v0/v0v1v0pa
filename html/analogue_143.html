<div class="container">

<table style="width: 100%;"><tr>
<td>predict.mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for Modern Analogue Technique models</h2>

<h3>Description</h3>

<p>Predicted values based on a MAT model object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mat'
predict(object, newdata, k, weighted = FALSE,
        bootstrap = FALSE, n.boot = 1000,
        probs = c(0.01, 0.025, 0.05, 0.1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of <code>mat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>data frame; required only if predictions for some new
data are required. Mst have the same number of columns, in same
order, as <code>x</code> in <code>mat</code>. See example below or
<code>join</code> for how to do this. If <code>newdata</code> not
provided, the fitted values are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of analogues to use. If missing, <code>k</code> is chosen
automatically as the <code>k</code> that achieves lowest RMSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical; should the analysis use the weighted mean of
environmental data of analogues as predicted values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>logical; should bootstrap derived estimates and
sample specific errors be calculated-ignored if <code>newdata</code> is
missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>numeric; the number of bootstrap samples to take.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>numeric; vector of probabilities with values in [0,1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to of from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns one or more of three sets of results depending
on the supplied arguments:
</p>

<dl>
<dt>Fitted values:</dt>
<dd>
<p>the fitted values of the <code>mat</code>
model are returned if <code>newdata</code> is missing.</p>
</dd>
<dt>Predicted values:</dt>
<dd>
<p>the predicted values for some new samples
are returned if <code>newdata</code> is supplied. Summary model
statistics and estimated values for the training set are also
returned.</p>
</dd>
<dt>Bootstrap predictions and standard errors:</dt>
<dd>
<p>if <code>newdata</code>
is supplied and <code>bootstrap = TRUE</code>, the predicted values for
<code>newdata</code> plus bootstrap estimates and standard errors for the
new samples and the training set are returned.</p>
</dd>
</dl>
<p>The latter is simply a wrapper for <code>bootstrap(model, newdata,
    ...)</code> - see <code>bootstrap.mat</code>.
</p>


<h3>Value</h3>

<p>A object of class <code>predict.mat</code> is returned if <code>newdata</code> is
supplied, otherwise an object of <code>fitted.mat</code> is
returned. If <code>bootstrap = FALSE</code> then not all components will be
returned.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>observed</code></td>
<td>
<p>vector of observed environmental values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a list containing the model or non-bootstrapped
estimates for the training set. With the following components:
</p>

<dl>
<dt><code>estimated</code></dt>
<dd>
<p>estimated values for <code>"y"</code>, the
environment.</p>
</dd>
<dt><code>residuals</code></dt>
<dd>
<p>model residuals.</p>
</dd>
<dt><code>r.squared</code></dt>
<dd>
<p>Model <code class="reqn">R^2</code> between observed and
estimated values  of <code>"y"</code>.</p>
</dd>
<dt><code>avg.bias</code></dt>
<dd>
<p>Average bias of the model residuals.</p>
</dd>
<dt><code>max.bias</code></dt>
<dd>
<p>Maximum bias of the model residuals.</p>
</dd>
<dt><code>rmsep</code></dt>
<dd>
<p>Model error (RMSEP).</p>
</dd>
<dt><code>k</code></dt>
<dd>
<p>numeric; indicating the size of model used in
estimates and predictions.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>a list containing the bootstrap estimates for the
training set. With the following components:
</p>

<dl>
<dt><code>estimated</code></dt>
<dd>
<p>Bootstrap estimates for <code>"y"</code>.</p>
</dd>
<dt><code>residuals</code></dt>
<dd>
<p>Bootstrap residuals for <code>"y"</code>.</p>
</dd>
<dt><code>r.squared</code></dt>
<dd>
<p>Bootstrap derived <code class="reqn">R^2</code> between observed
and estimated values of <code>"y"</code>.</p>
</dd>
<dt><code>avg.bias</code></dt>
<dd>
<p>Average bias of the bootstrap derived model
residuals.</p>
</dd>
<dt><code>max.bias</code></dt>
<dd>
<p>Maximum bias of the bootstrap derived model
residuals.</p>
</dd>
<dt><code>rmsep</code></dt>
<dd>
<p>Bootstrap derived RMSEP for the model.</p>
</dd>
<dt><code>s1</code></dt>
<dd>
<p>Bootstrap derived S1 error component for the
model.</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Bootstrap derived S2 error component for the
model.</p>
</dd> 
<dt><code>k</code></dt>
<dd>
<p>numeric; indicating the size of model used in
estimates and predictions.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.errors</code></td>
<td>
<p>a list containing the bootstrap-derived sample
specific errors for the training set. With the following components:
</p>

<dl>
<dt><code>rmsep</code></dt>
<dd>
<p>Bootstrap derived RMSEP for the training set
samples.</p>
</dd> 
<dt><code>s1</code></dt>
<dd>
<p>Bootstrap derived S1 error component for training
set samples.</p>
</dd>
<dt><code>s2</code></dt>
<dd>
<p>Bootstrap derived S2 error component for training
set samples.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical; whether the weighted mean was used instead of
the mean of the environment for <em>k</em>-closest analogues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto</code></td>
<td>
<p>logical; whether <code>"k"</code> was choosen automatically or
user-selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>numeric; the number of bootstrap samples taken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictions</code></td>
<td>
<p>a list containing the model and
bootstrap-derived estimates for the new data, with the following
components:
</p>

<dl>
<dt><code>observed</code></dt>
<dd>
<p>the observed values for the new samples —
only if <code>newenv</code> is provided.</p>
</dd>
<dt><code>model</code></dt>
<dd>
<p>a list containing the model or
non-bootstrapped estimates for the new samples. A list with the
same components as <code>model</code>, above.
</p>
</dd>
<dt><code>bootstrap</code></dt>
<dd>
<p>a list containing the bootstrap estimates
for the new samples, with some or all of the same components as
<code>bootstrap</code>, above.</p>
</dd>
<dt><code>sample.errors</code></dt>
<dd>
<p>a list containing the bootstrap-derived
sample specific errors for the new samples, with some or all of
the same components as <code>sample.errors</code>, above.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the dissimilarity measure used to fit the underlying MAT
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>probability quantiles of the pairwise dissimilarities
computed from the training set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minDC</code></td>
<td>
<p>smallest distances between each sample in <code>newdata</code>
and the training set samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dij</code></td>
<td>
<p>dissimilarities between <code>newdata</code> and training set
samples.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>References</h3>

<p>Birks, H.J.B., Line, J.M., Juggins, S., Stevenson, A.C. and ter Braak,
C.J.F. (1990). Diatoms and pH reconstruction. <em>Philosophical
Transactions of the Royal Society of London; Series B</em>, <strong>327</strong>;
263–278.
</p>


<h3>See Also</h3>

<p><code>mat</code>, <code>bootstrap.mat</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Imbrie and Kipp example
## load the example data
data(ImbrieKipp)
data(SumSST)
data(V12.122)

## merge training and test set on columns
dat &lt;- join(ImbrieKipp, V12.122, verbose = TRUE)

## extract the merged data sets and convert to proportions
ImbrieKipp &lt;- dat[[1]] / 100
V12.122 &lt;- dat[[2]] / 100

## fit the MAT model using the chord distance measure
(ik.mat &lt;- mat(ImbrieKipp, SumSST, method = "chord"))

## predict for V12.122 data
predict(ik.mat, V12.122)

</code></pre>


</div>