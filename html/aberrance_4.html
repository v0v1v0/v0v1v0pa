<div class="container">

<table style="width: 100%;"><tr>
<td>detect_as</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect answer similarity</h2>

<h3>Description</h3>

<p>Detect answer similarity for all possible pairs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_as(
  method,
  psi,
  xi = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The answer similarity statistic(s) to compute. Options for
score-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_S"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_S"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_S"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li>
</ul>
<p>Options for score and distractor-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_SD"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_SD"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_SD"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li>
</ul>
<p>Options for response-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_R"</code> for the unconditional <code class="reqn">\omega</code> statistic (Romero et al.,
2015).
</p>
</li>
<li> <p><code>"GBT_R"</code> for the unconditional <code class="reqn">GBT</code> statistic (van der Linden &amp;
Sotaridona, 2006).
</p>
</li>
<li> <p><code>"M4_R"</code> for the <code class="reqn">M4</code> statistic (Maynes, 2014).
</p>
</li>
</ul>
<p>Options for score and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_ST"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_ST"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li>
</ul>
<p>Options for score, distractor, and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_SDT"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_SDT"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li>
</ul>
<p>Options for response and response time-based statistics are:
</p>

<ul>
<li> <p><code>"OMG_RT"</code> for the unconditional <code class="reqn">\omega</code> statistic (Gorney &amp;
Wollack, 2024).
</p>
</li>
<li> <p><code>"GBT_RT"</code> for the unconditional <code class="reqn">GBT</code> statistic (Gorney &amp; Wollack,
2024).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>A matrix of person parameters. If <code>NULL</code> (default), person
parameters are estimated using maximum likelihood estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, d, r, y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, <code>r</code> the item responses, and <code>y</code> the item log response times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A matrix of answer similarity statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
pairs, the second dimension to methods, and the third dimension to
significance levels.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Gorney, K., &amp; Wollack, J. A. (2024). Using response times in answer
similarity analysis. <em>Journal of Educational and Behavioral Statistics</em>.
Advance online publication.
</p>
<p>Maynes, D. (2014). Detection of non-independent test taking by similarity
analysis. In N. M. Kingston &amp; A. K. Clark (Eds.), <em>Test fraud: Statistical
detection and methodology</em> (pp. 53–80). Routledge.
</p>
<p>Romero, M., Riascos, Á., &amp; Jara, D. (2015). On the optimality of
answer-copying indices: Theory and practice. <em>Journal of Educational and
Behavioral Statistics</em>, <em>40</em>(5), 435–453.
</p>
<p>van der Linden, W. J., &amp; Sotaridona, L. (2006). Detecting answer copying when
the regular response process follows a known response model. <em>Journal of
Educational and Behavioral Statistics</em>, <em>31</em>(3), 283–304.
</p>


<h3>See Also</h3>

<p><code>detect_ac()</code> to detect answer copying.
</p>
<p><code>detect_pk()</code> to detect preknowledge.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 50         # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = similar pair, 0 = non-similar pair)
pair &lt;- t(combn(N, 2))
ind &lt;- ifelse((pair[, 1] %in% cv) &amp; (pair[, 2] %in% cv), 1, 0)
names(ind) &lt;- paste(pair[, 1], pair[, 2], sep = "-")

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 3PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 3PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S", "OMG_ST", "GBT_ST"),
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S"),
  psi = psi,
  x = x
)

# Setup for Examples 3 and 4 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 50         # number of persons
n &lt;- 40         # number of items

# Randomly select 10% sources and 10% copiers
s &lt;- sample(1:N, size = N * 0.10)
c &lt;- sample(setdiff(1:N, s), size = N * 0.10)

# Create vector of indicators (1 = similar pair, 0 = non-similar pair)
pair &lt;- t(combn(N, 2))
ind &lt;- ifelse(1:nrow(pair) %in% apply(
  rbind(cbind(s, c), cbind(c, s)), 1, function(p)
  which(pair[, 1] == p[1] &amp; pair[, 2] == p[2])), 1, 0)
names(ind) &lt;- paste(pair[, 1], pair[, 2], sep = "-")

# Example 3: Item Scores and Distractors ------------------------------------

# Generate person parameters for the nested logit model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, eta = 0.00),
  Sigma = matrix(c(1.00, 0.80, 0.80, 1.00), ncol = 2)
)

# Generate item parameters for the nested logit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30),
  lambda1 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda2 = rnorm(n, mean = 0.00, sd = 1.00),
  lambda3 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta1 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta2 = rnorm(n, mean = 0.00, sd = 1.00),
  zeta3 = rnorm(n, mean = 0.00, sd = 1.00)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
d &lt;- dat$d

# Modify contaminated data by replacing 40% of the copier scores and
# distractors with source scores and distractors
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  x[c[v], ci] &lt;- x[s[v], ci]
  d[c[v], ci] &lt;- d[s[v], ci]
}

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_S", "GBT_S", "OMG_SD", "GBT_SD"),
  psi = psi,
  x = x,
  d = d
)

# Example 4: Item Responses -------------------------------------------------

# Generate person parameters for the nominal response model
xi &lt;- cbind(eta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the nominal response model
psi &lt;- cbind(
  lambda1 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda2 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda3 = rnorm(n, mean = -0.50, sd = 0.50),
  lambda4 = rnorm(n, mean = 1.50, sd = 0.50),
  zeta1 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta2 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta3 = rnorm(n, mean = -0.50, sd = 0.50),
  zeta4 = rnorm(n, mean = 1.50, sd = 0.50)
)

# Simulate uncontaminated data
r &lt;- sim(psi, xi)$r

# Modify contaminated data by replacing 40% of the copier responses with
# source responses
for (v in 1:length(c)) {
  ci &lt;- sample(1:n, size = n * 0.40)
  r[c[v], ci] &lt;- r[s[v], ci]
}

# Detect answer similarity
out &lt;- detect_as(
  method = c("OMG_R", "GBT_R"),
  psi = psi,
  r = r
)
</code></pre>


</div>