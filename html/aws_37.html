<div class="container">

<table style="width: 100%;"><tr>
<td>awstestprop</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Propagation condition for adaptive weights smoothing
</h2>

<h3>Description</h3>

<p>The function enables testing of the propagation condition in order to select
appropriate values for the parameter <code>lambda</code> in function <code>aws</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">awstestprop(dy, hmax, theta = 1, family = "Gaussian", lkern = "Triangle",
            aws = TRUE, memory = FALSE, shape = 2, homogeneous=TRUE, varadapt=FALSE,
            ladjust = 1, spmin=0.25, seed = 1, minlevel=1e-6, maxz=25, diffz=.5,
            maxni=FALSE, verbose=FALSE)
pawstestprop(dy, hmax, theta = 1, family = "Gaussian", lkern = "Triangle",
             aws = TRUE, patchsize=1, shape = 2,
             ladjust = 1, spmin = 0.25, seed = 1, minlevel = 1e-6,
             maxz = 25, diffz = .5, maxni = FALSE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p> Dimension of grid used in 1D, 2D or 3D. May also be specified as an array of values.
In this case data are generated with parameters <code>dy-mean(dy)+theta</code> and the propagation condition
is testet as if <code>theta</code> is the true parameter. This can be used to study properties for a
slighty misspecified structural assumption.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmax</code></td>
<td>

<p>Maximum bandwidth.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Parameter determining the distribution in case of
<code>family %in% c("Poisson","Bernoulli")</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p><code>family</code> specifies the probability distribution. Default is <code>family="Gaussian"</code>, also implemented
are "Bernoulli", "Poisson", "Exponential", "Volatility", "Variance" and "NCchi". <code>family="Volatility"</code> specifies a Gaussian distribution with
expectation 0 and unknown variance. <code>family="Volatility"</code> specifies that <code>p*y/theta</code> is distributed as <code class="reqn">\chi^2</code> with <code>p=shape</code>
degrees of freedom. <code>family="NCchi"</code> uses a noncentral Chi distribution with <code>p=shape</code> degrees of freedom and noncentrality parameter <code>theta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lkern</code></td>
<td>

<p>character: location kernel, either "Triangle", "Plateau", "Quadratic", "Cubic" or "Gaussian"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aws</code></td>
<td>

<p>logical: if TRUE structural adaptation (AWS) is used. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patchsize</code></td>
<td>

<p>patchsize in case of paws. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memory</code></td>
<td>

<p>logical: if TRUE stagewise aggregation is used as an additional
adaptation scheme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>

<p>Allows to specify an additional shape parameter for certain family models. Currently only used for family="Variance", that is <code class="reqn">\chi</code>-Square distributed observations
with <code>shape</code> degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homogeneous</code></td>
<td>

<p>if <code>homgeneous==FALSE</code> and <code>family==Gaussian</code> then create heterogeneous variances according to
a chi-squared distribution with number of degrees of freedom given by <code>sphere</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varadapt</code></td>
<td>

<p>if <code>varadapt==TRUE</code> use inverse of variance reduction instead of sum of weights in definition of statistical penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ladjust</code></td>
<td>

<p>Factor to increase the default value of lambda </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spmin</code></td>
<td>
<p>Determines the form (size of the plateau) in the adaptation kernel.
Not to be changed by the user.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed value for random generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minlevel</code></td>
<td>
<p>Minimum exceedence probability to use in contour plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxz</code></td>
<td>
<p>Maximum of z-scale in plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diffz</code></td>
<td>
<p>Gridlength in z</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxni</code></td>
<td>
<p>If TRUE use <code class="reqn">max_{l&lt;=k}(N_i^{(l)}</code> instead of <code class="reqn">(N_i^{(k)}</code> in the definition of the statistical penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE provide additional information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates exceedence probabilities
</p>
<p>Results for intermediate steps are provided as contour plots. For a good choice of lambda
(ladjust) the contours up to probabilities of <code>1e-5</code> should be vertical.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>Sequence of bandwidths used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p><code>seq(0,30,.5)</code>, the quantiles exceedence probabilities refer to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the matrix of exceedence probabilities, columns corresponding to <code>h</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probna</code></td>
<td>
<p>the matrix of exceedence probabilities for corresponding nonadaptive estimates, columns corresponding to <code>h</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joerg Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a>
</p>


<h3>References</h3>

<p>S. Becker, P. Mathe, Electron. J. Statist. (2013), 2702-2736, doi:10.1214/13-EJS860

</p>


<h3>See Also</h3>

<p><code>aws</code>
</p>


</div>