<div class="container">

<table style="width: 100%;"><tr>
<td>vbmfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variational Bayesian Mixture of Factor Analyzers (VB-MoFA)</h2>

<h3>Description</h3>

<p>An implementation of the Variational Bayesian Mixutre of Factor
Analysers (Ghahramani and Beal 2000). This code is an
R port of the MATLAB code which was written by M.J.Beal and released alongside
their paper.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vbmfa(Y, qmax = NULL, maxtries = 3, verbose = FALSE, varimax = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>An <em>n</em> by <em>p</em> (normalised) data matrix (i.e. the result of
a call to the function <code>preprocess</code>), where <em>n</em> is the number of observations and
<em>p</em> is the number of dimensions of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qmax</code></td>
<td>
<p>Maximum factor dimensionality (default <em>p</em>-1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtries</code></td>
<td>
<p>The maximum number of times the algorithm will attempt to split each component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether or not verbose output should be printed during the
model fitting process (defaults to false).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varimax</code></td>
<td>
<p>Boolean indicating whether the output factor loading matrices should be constrained
using varimax rotation or not.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements:
</p>

<ul>
<li>
<p><code>model</code>: A list specifying the final MFA model. This contains: </p>

<ul>
<li>
<p><code>B</code>: A <em>p</em> by <em>p</em> by <em>q</em> array containing the factor loading matrices for each component.
</p>
</li>
<li>
<p><code>D</code>: A <em>p</em> by <em>p</em> by <em>g</em> array of error variance matrices.
</p>
</li>
<li>
<p><code>mu</code>:  A <em>p</em> by <em>g</em> array containing the mean of each cluster.
</p>
</li>
<li>
<p><code>pivec</code>: A 1 by <em>g</em> vector containing the mixing
proportions for each FA in the mixture.
</p>
</li>
<li>
<p><code>numFactors</code>: A 1 by <em>g</em> vector containing the number of factors for each FA.</p>
</li>
</ul>
</li>
<li>
<p><code>clustering</code>: A list specifying the clustering produced by the final model. This contains: </p>

<ul>
<li>
<p><code>responsibilities</code>: A <em>n</em> by <em>g</em> matrix containing the probability
that each point belongs to each FA in the mixture.
</p>
</li>
<li>
<p><code>allocations</code>: A <em>n</em> by 1 matrix containing which
FA in the mixture each point is assigned to based on the responsibilities.</p>
</li>
</ul>
</li>
<li>
<p><code>diagnostics</code>: A list containing various pieces of information related to the fitting process of the algorithm. This contains: </p>

<ul>
<li>
<p><code>bic</code>: The BIC of the final model.
</p>
</li>
<li>
<p><code>logL</code>: The log-likelihood of the final model.
</p>
</li>
<li>
<p><code>Fhist</code>:The values of <em>F</em> at each iteration of the algorithm. <em>F</em> is defined in (Ghahramani and Beal 2000).
</p>
</li>
<li>
<p><code>times</code>: The time taken for each loop in the algorithm.
</p>
</li>
<li>
<p><code>totalTime</code>: The total time taken to fit the final model.</p>
</li>
</ul>
</li>
</ul>
<h3>References</h3>

<p>Ghahramani Z, Beal MJ (2000).
“Variational inference for Bayesian Mixtures of Factor Analysers.”
In <em>Advances in neural information processing systems</em>, 449–455.
</p>


<h3>See Also</h3>

<p><code>preprocess</code> for centering and scaling data prior to using <code>vbmfa</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">RNGversion('4.0.3'); set.seed(3)
Yout &lt;- preprocess(MFA_testdata)
MFA.fit &lt;- vbmfa(Yout$Yout, maxtries = 2)

</code></pre>


</div>