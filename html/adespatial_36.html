<div class="container">

<table style="width: 100%;"><tr>
<td>msr.4thcorner</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran spectral randomization for fourth-corner analysis</h2>

<h3>Description</h3>

<p>This function allows to test fourth-corner statistics using constrained null
models (for traits and/or environmental variables). If the argument
<code>phyloORorthobasis</code> is specified, random traits are
phylogenetically-constrained to preserve the global autocorrelation (Moran's
I) and the phylogenetic structures at multiple scales. If not, standard
permutations are used. If the argument <code>listwORorthobasis</code> is specified,
random environmental variables are spatially-constrained to preserve the
global autocorrelation (Moran's I) and the spatial structures at multiple
scales. If not, standard permutations are used. Multiscale property is
defined by the power spectrum (i.e. decomposition of the variance of the
original variables) on a basis of orthonormal eigenvectors (Moran's
Eigenvector Maps, MEM).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class ''4thcorner''
msr(
  x,
  listwORorthobasis,
  phyloORorthobasis,
  nrepet = x$npermut,
  method = c("pair", "triplet", "singleton"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object generated by the <code>fourthcorner</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listwORorthobasis</code></td>
<td>
<p>an object of the class <code>listw</code> (spatial
weights) created by the functions of the <span class="pkg">spdep</span> package or an object
of class <code>orthobasis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phyloORorthobasis</code></td>
<td>
<p>an object of the class <code>phylo</code> (phylogeny)
created by the functions of the <span class="pkg">ape</span> package or an object of class
<code>orthobasis</code> generated by functions of <span class="pkg">adephylo</span>
(<code>me.phylo</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an <code>integer</code> indicating the number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an character specifying which algorithm should be used to
produce spatial replicates (see <code>msr.default</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments of the <code>msr.default</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>4thcorner</code> randomized replicates.
</p>


<h3>Author(s)</h3>

<p>Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Braga, J., Thuiller, W., ter Braak, C.J.F. and Dray, S. (2018)
Integrating spatial and phylogenetic information in the fourth-corner
analysis to test trait-environment relationships. Ecology, 99:2667-2674.
</p>


<h3>See Also</h3>

<p><code>msr.default</code>, <code>me.phylo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require("ade4", quietly = TRUE) &amp; require("adephylo", quietly = TRUE)
&amp; require("spdep", quietly = TRUE) &amp; require("ape", quietly = TRUE)){
data(mafragh, package = "ade4")
fr1 &lt;- fourthcorner(mafragh$env, mafragh$flo, mafragh$traits$tabQuantitative, nrepet = 49)
phy &lt;- read.tree(text = mafragh$tre)
lw &lt;- nb2listw(mafragh$nb)
fr1.msr &lt;- msr(fr1, listwORorthobasis = lw, phyloORorthobasis = phy)

fr1
fr1.msr
}

</code></pre>


</div>