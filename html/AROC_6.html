<div class="container">

<table style="width: 100%;"><tr>
<td>AROC.sp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Semiparametric frequentist inference of the covariate-adjusted ROC curve (AROC).
</h2>

<h3>Description</h3>

<p>Estimates the covariate-adjusted ROC curve (AROC) using the semiparametric approach proposed by Janes and Pepe (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">AROC.sp(formula.healthy, group, tag.healthy, data, 
	est.surv.h = c("normal", "empirical"), p = seq(0, 1, l = 101), B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula.healthy</code></td>
<td>
<p>A <code>formula</code> object specifying the location regression model to be fitted in healthy population (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A character string with the name of the variable that distinguishes healthy from diseased individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag.healthy</code></td>
<td>
<p>The value codifying the healthy individuals in the variable <code>group</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame representing the data and containing all needed variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.surv.h</code></td>
<td>
<p>A character string. It indicates how the conditional distribution function of the diagnostic test in healthy population is estimated. Options are "normal" and "empirical" (see Details). The default is "normal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Set of false positive fractions (FPF) at which to estimate the covariate-adjusted ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer value specifying the number of bootstrap resamples for the construction of the confidence intervals. By default 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates the covariate-adjusted ROC curve (AROC) defined as
</p>
<p style="text-align: center;"><code class="reqn">AROC\left(t\right) = Pr\{1 - F_{\bar{D}}(Y_D | \mathbf{X}_{D}) \leq t\},</code>
</p>

<p>where <code class="reqn">F_{\bar{D}}(\cdot|\mathbf{X}_{\bar{D}})</code> denotes the conditional distribution function for <code class="reqn">Y_{\bar{D}}</code> conditional on the vector of covariates <code class="reqn">\mathbf{X}_{\bar{D}}</code>. In particular, the method implemented in this function estimates the outer probability empirically (see Janes and Pepe, 2008) and <code class="reqn">F_{\bar{D}}(\cdot|\mathbf{X}_{\bar{D}})</code> is estimated assuming a semiparametric location regression model for <code class="reqn">Y_{\bar{D}}</code>, i.e., 
</p>
<p style="text-align: center;"><code class="reqn">Y_{\bar{D}} = \mathbf{X}_{\bar{D}}^{T}\mathbf{\beta}_{\bar{D}} + \sigma_{\bar{D}}\varepsilon_{\bar{D}},</code>
</p>

<p>such that, for a random sample <code class="reqn">\{(\mathbf{x}_{\bar{D}i})\}_{i=1}^{n_{\bar{D}}}</code> from the healthy population, we have
</p>
<p style="text-align: center;"><code class="reqn">F_{\bar{D}}(y | \mathbf{X}_{\bar{D}}=\mathbf{x}_{\bar{D}i}) = F_{\bar{D}}\left(\frac{y-\mathbf{x}_{\bar{D}i}^{T}\mathbf{\beta}_{\bar{D}}}{\sigma_{\bar{D}}}\right),</code>
</p>

<p>where <code class="reqn">F_{\bar{D}}</code> is the distribution function of <code class="reqn">\varepsilon_{\bar{D}}</code>. In line with the assumptions made about the distribution of <code class="reqn">\varepsilon_{\bar{D}}</code>, estimators will be referred to as: (a) "normal", where Gaussian error is assumed, i.e., <code class="reqn">F_{\bar{D}}(y) = \Phi(y)</code>; and, (b) "empirical", where no assumption is made about the distribution (in this case, the distribution function <code class="reqn">F_{\bar{D}}</code> is empirically estimated on the basis of standardised residuals).
</p>


<h3>Value</h3>

<p>As a result, the function provides a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Set of false positive fractions (FPF) at which the pooled ROC curve has been estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROC</code></td>
<td>
<p>Estimated covariate-adjusted ROC curve (AROC), and 95% pointwise confidence intervals (if required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>Estimated area under the covariate-adjusted ROC curve (AAUC), and 95% pointwise confidence intervals (if required).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.h</code></td>
<td>
<p>Object of class <code>lm</code> with the fitted regression model in the healthy population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.surv.h</code></td>
<td>
<p>The value of the argument <code>est.surv.h</code> used in the call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Janes, H., and Pepe, M.S. (2009). Adjusting for covariate effects on classification accuracy using the covariate-adjusted receiver operating characteristic curve. Biometrika, 96(2), 371 - 382.
</p>


<h3>See Also</h3>

<p><code>AROC.bnp</code>, <code>AROC.bsp</code>, <code>AROC.sp</code>, <code>AROC.kernel</code>, <code>pooledROC.BB</code> or <code>pooledROC.emp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(AROC)
data(psa)
# Select the last measurement
newpsa &lt;- psa[!duplicated(psa$id, fromLast = TRUE),]

# Log-transform the biomarker
newpsa$l_marker1 &lt;- log(newpsa$marker1)

m3 &lt;- AROC.sp(formula.healthy = l_marker1 ~ age,
group = "status", tag.healthy = 0, data = newpsa,
p = seq(0,1,l=101), B = 500)

summary(m3)

plot(m3)


</code></pre>


</div>