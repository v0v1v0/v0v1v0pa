<div class="container">

<table style="width: 100%;"><tr>
<td>alluvial_ts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Alluvial diagram for multiple time series data</h2>

<h3>Description</h3>

<p>This is a variant of alluvial diagram suitable for multiple
(cross-sectional) time series. It also works with continuous variables equivalent to time
</p>


<h3>Usage</h3>

<pre><code class="language-R">alluvial_ts(dat, wave = NA, ygap = 1, col = NA, alpha = NA,
  plotdir = "up", rankup = FALSE, lab.cex = 1, lab.col = "black",
  xmargin = 0.1, axis.col = "black", title = NA, title.cex = 1,
  axis.cex = 1, grid = FALSE, grid.col = "grey80", grid.lwd = 1,
  leg.mode = TRUE, leg.x = 0.1, leg.y = 0.9, leg.cex = 1,
  leg.col = "black", leg.lty = NA, leg.lwd = NA, leg.max = NA,
  xlab = NA, ylab = NA, xlab.pos = 2, ylab.pos = 1, lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data.frame of time-series (or suitable equivalent continuously disaggregated data), with 3 columns (in order: category, time-variable, value) with &lt;= 1 row for each category-time combination</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wave</code></td>
<td>
<p>numeric, curve wavyness defined in terms of x axis data range - i.e. bezier point offset. Experiment to get this right</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ygap</code></td>
<td>
<p>numeric, vertical distance between polygons - a multiple of 10% of the mean data value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour, value or vector of length matching the number of unique categories. Individual colours of vector are mapped to categories in alpha-numeric order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric, [0,1] polygon fill transparency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotdir</code></td>
<td>
<p>character, string ('up', 'down' or 'centred') giving the vertical alignment of polygon stacks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rankup</code></td>
<td>
<p>logical, rank polygons on time axes upward by magnitude (largest to smallest) or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.cex</code></td>
<td>
<p>numeric, category label font size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab.col</code></td>
<td>
<p>colour, of category label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmargin</code></td>
<td>
<p>numeric [0,1], proportional space for category labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.col</code></td>
<td>
<p>colour, of axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>character, plot title</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title.cex</code></td>
<td>
<p>numeric, plot title font size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.cex</code></td>
<td>
<p>numeric, font size of x-axis break labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>logical, plot vertical axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.col</code></td>
<td>
<p>colour, of grid axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.lwd</code></td>
<td>
<p>numeric, line width of grid axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.mode</code></td>
<td>
<p>logical, draw y-axis scale legend inside largest data point (TRUE default) or alternatively with custom position/value (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.x, leg.y</code></td>
<td>
<p>numeric [0,1], x/y positions of legend if leg.mode = FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.cex</code></td>
<td>
<p>numeric, legend text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.col</code></td>
<td>
<p>colour, of legend lines and text</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.lty</code></td>
<td>
<p>numeric, code for legend line type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.lwd</code></td>
<td>
<p>numeric, legend line width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg.max</code></td>
<td>
<p>numeric, legend scale line width</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>character, x-axis / y-axis titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab.pos, ylab.pos</code></td>
<td>
<p>numeric, perpendicular offset for axis titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>numeric, value or vector of length matching the number of unique categories for polygon stroke line width. Individual values of vector are mapped to categories in alpha-numeric order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to pass to polygon()</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">if( require(reshape2) )
{
data(Refugees)
reshape2::dcast(Refugees, country ~ year, value.var = 'refugees')
d &lt;- Refugees

set.seed(39) # for nice colours
cols &lt;- hsv(h = sample(1:10/10), s = sample(3:12)/15, v = sample(3:12)/15)

alluvial_ts(d)
alluvial_ts(d, wave = .2, ygap = 5, lwd = 3)
alluvial_ts(d, wave = .3, ygap = 5, col = cols)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, rankup = TRUE)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, plotdir = 'down')
alluvial_ts(d, wave = .3, ygap = 5, col = cols, plotdir = 'centred', grid=TRUE,
            grid.lwd = 5)
alluvial_ts(d, wave =  0, ygap = 0, col = cols, alpha = .9, border = 'white',
            grid = TRUE, grid.lwd = 5)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, xmargin = 0.4)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, xmargin = 0.3, lab.cex = .7)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, xmargin = 0.3, lab.cex=.7,
            leg.cex=.7, leg.col = 'white')
alluvial_ts(d, wave = .3, ygap = 5, col = cols, leg.mode = FALSE, leg.x = .1,
            leg.y = .7, leg.max = 3e6)
alluvial_ts(d, wave = .3, ygap = 5, col = cols, plotdir = 'centred', alpha=.9,
            grid = TRUE, grid.lwd = 5, xmargin = 0.2, lab.cex = .7, xlab = '',
            ylab = '', border = NA, axis.cex = .8, leg.cex = .7,
            leg.col='white', 
         title = "UNHCR-recognised refugees\nTop 10 countries (2003-13)\n")

# non time-series example - Virginia deaths dataset
d &lt;- reshape2::melt(data.frame(age=row.names(VADeaths), VADeaths), id.vars='age')[,c(2,1,3)]
names(d) = c('pop_group','age_group','deaths')
alluvial_ts(d)
}
</code></pre>


</div>