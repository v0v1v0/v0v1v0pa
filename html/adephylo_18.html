<div class="container">

<table style="width: 100%;"><tr>
<td>orthogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthonormal decomposition of variance</h2>

<h3>Description</h3>

<p>This function performs the orthonormal decomposition of variance of a 
quantitative variable on an orthonormal basis. It also returns the results of
five non parametric tests associated to the variance decomposition.  It thus
provides tools (graphical displays and test) for analysing phylogenetic,
pattern in one quantitative trait. This implementation replace the
(deprecated) version from the <code>ade4</code> package.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">orthogram(
  x,
  tre = NULL,
  orthobas = NULL,
  prox = NULL,
  nrepet = 999,
  posinega = 0,
  tol = 1e-07,
  cdot = 1.5,
  cfont.main = 1.5,
  lwd = 2,
  nclass,
  high.scores = 0,
  alter = c("greater", "less", "two-sided")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector corresponding to the quantitative variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tre</code></td>
<td>
<p>a tree of class <code>phylo</code>, 
phylo4 or phylo4d.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orthobas</code></td>
<td>
<p>an object of class <code>'orthobasis'</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prox</code></td>
<td>
<p>a matrix of phylogenetic proximities as returned by 
<code>proxTips</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an integer giving the number of permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posinega</code></td>
<td>
<p>a parameter for the ratio test. If posinega &gt; 0, the function
computes the ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a tolerance threshold for orthonormality condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdot</code></td>
<td>
<p>a character size for points on the cumulative decomposition 
display</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfont.main</code></td>
<td>
<p>a character size for titles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>a character size for dash lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>a single number giving the number of cells for the histogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high.scores</code></td>
<td>
<p>a single number giving the number of vectors to return. If
&gt; 0, the function returns labels of vectors that explains the larger part 
of variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alter</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must 
be one of "greater" (default), "less" or "two-sided"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Several orthonormal bases can be used. By default, basis is constructed from 
a partition of tips according to tree topology (as returned by 
<code>treePart</code>); for this, the argument <code>tre</code> must be provided. 
Alternatively, one can provide an orthonormal basis as returned by 
<code>orthobasis.phylo</code>/<code>me.phylo</code> (argument 
<code>orthobas</code>), or provide a proximity matrix from which an orthobasis 
based on Moran's eigenvectors will be constructed (argument <code>prox</code>).
</p>
<p>The function computes the variance decomposition of a quantitative vector x 
on an orthonormal basis B. The variable is normalized given the uniform 
weight to eliminate problem of scales.  It plots the squared correlations 
<code class="reqn">R^{2}</code> between x and vectors of B (variance decomposition) and the 
cumulated squared correlations <code class="reqn">SR^{2}</code> (cumulative decomposition).
The function also provides five non parametric tests to test the existence of
autocorrelation. The tests derive from the five following statistics :
</p>
<p>- R2Max=<code class="reqn">\max(R^{2})</code>. It takes high value when a high part of 
the variability is explained by one score.<br> - 
SkR2k=<code class="reqn">\sum_{i=1}^{n-1}(iR^{2}_i)</code>. It compares 
the part of variance explained by internal nodes to the one explained by end 
nodes.<br> - Dmax=<code class="reqn">\max_{m=1,...,n-1}(\sum_{j=1}^{m}R^{2}_j - 
</code><code class="reqn"> 
\frac{m}{n-1})</code>. It examines
the accumulation of variance for a sequence of scores.<br> - 
SCE=<code class="reqn">\sum_{m=1}^{n-1} (\sum_{j=1}^{m}R^{2}_j - 
</code><code class="reqn"> 
\frac{m}{n-1})^{2}</code>. It 
examines also the accumulation of variance for a sequence of scores.<br> - 
ratio: depends of the parameter posinega. If posinega &gt; 0, the statistic 
ratio exists and equals <code class="reqn">\sum_{i=1}^{posinega}R^{2}_i</code>. It compares the part of variance explained by internal
nodes to the one explained by end nodes when we can define how many vectors
correspond to internal nodes.
</p>


<h3>Value</h3>

<p>If (high.scores = 0), returns an object of class <code>'krandtest'</code> 
(randomization tests) corresponding to the five non parametric tests. <br><br> If (high.scores &gt; 0), returns a list containg : </p>
<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>: an object of
class <code>'krandtest'</code> (randomization tests)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores.order</code></td>
<td>
<p>: a 
vector which terms give labels of vectors that explain the larger part of 
variance</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function replaces the former version from the ade4 package, which 
is deprecated. Note that if ade4 is not loaded BEFORE adephylo, then the 
version from ade4 will erase that of adephylo, which will still be
available from adephylo::orthogram. In practice, though, this should never
happen, since ade4 is loaded as a dependence by adephylo.
</p>


<h3>Author(s)</h3>

<p>Original code: Sebastien Ollier and Daniel Chessel.<br></p>
<p>Current maintainer: Stephane Dray &lt;stephane.dray@univ-lyon1.fr&gt;
</p>


<h3>References</h3>

<p>Ollier, S., Chessel, D. and Couteron, P. (2005) Orthonormal 
Transform to Decompose the Variance of a Life-History Trait across a 
Phylogenetic Tree. <em>Biometrics</em>, <b>62</b>, 471â€“477.
</p>


<h3>See Also</h3>

<p><code>orthobasis.phylo</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

if(require(ape) &amp;&amp; require(phylobase)){

## a phylogenetic example
data(ungulates)
tre &lt;- read.tree(text=ungulates$tre)
plot(tre)

## look at two traits
afbw &lt;- log(ungulates$tab[,1])
neonatw &lt;- log((ungulates$tab[,2]+ungulates$tab[,3])/2)
names(afbw) &lt;- tre$tip.label
names(neonatw) &lt;- tre$tip.label
plot(afbw, neonatw) # relationship between traits
lm1 &lt;- lm(neonatw~afbw)
resid &lt;- residuals(lm1)
abline(lm1)

## plot the two traits and the residuals of lm1
x &lt;- phylo4d(tre, cbind.data.frame(afbw, neonatw, residuals=resid))
table.phylo4d(x) # residuals are surely not independant

## default orthogram for residuals of lm1
orthogram(resid, tre)

## using another orthonormal basis (derived from Abouheif's proximity)
myOrthoBasis &lt;- orthobasis.phylo(tre, method="oriAbouheif") # Abouheif's proximities
orthogram(resid, ortho=myOrthoBasis) # significant phylog. signal

## Abouheif's test
W &lt;- proxTips(tre, method="oriAbouheif") # proximity matrix
abouheif.moran(resid, W)
}


</code></pre>


</div>