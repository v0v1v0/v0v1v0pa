<div class="container">

<table style="width: 100%;"><tr>
<td>ssm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>State Space Model
</h2>

<h3>Description</h3>

<p>Fits a simple univariate state space model to data. The parameters
are estimated (the state regression parameter may be fixed).  State 
predictions, filters, and smoothers
and corresponding error variances are evaluated at the estimates.  The sample
size must be at least 20.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssm(y, A, phi, alpha, sigw, sigv, fixphi = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>

<p>measurement value (fixed constant)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>initial value of phi, may be fixed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>initial value for alpha
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigw</code></td>
<td>

<p>initial value for sigma[w]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigv</code></td>
<td>

<p>initial value for sigma[v]
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixphi</code></td>
<td>

<p>if TRUE, the phi parameter is fixed
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The script works for a specific univariate state space model,
</p>
<p style="text-align: center;"><code class="reqn">x_t = \alpha + \phi x_{t-1} + w_t \quad {\rm and} \quad y_t = A x_t + v_t.</code>
</p>

<p>The initial state conditions use a default calculation and cannot be specified.
The parameter estimates are printed and the script returns the state predictors and
smoothers.  The regression parameter <code class="reqn">\phi</code> may be fixed.
</p>


<h3>Value</h3>

<p>At the MLEs, these are returned invisibly:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Xp </code></td>
<td>
<p>time series - state prediction, <code class="reqn">x_t^{t-1}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pp </code></td>
<td>
<p>corresponding MSPEs, <code class="reqn">P_t^{t-1}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xf </code></td>
<td>
<p>time series - state filter, <code class="reqn">x_t^t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pf </code></td>
<td>
<p>corresponding MSEs, <code class="reqn">P_t^t</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xs </code></td>
<td>
<p>time series - state smoother, <code class="reqn">x_t^n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ps </code></td>
<td>
<p>corresponding MSEs, <code class="reqn">P_t^n</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

u = ssm(gtemp_land, A=1, alpha=.01, phi=1, sigw=.05, sigv=.15)
tsplot(gtemp_land, type='o', col=4)
lines(u$Xs, col=6, lwd=2)

## End(Not run)
</code></pre>


</div>