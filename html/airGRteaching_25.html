<div class="container">

<table style="width: 100%;"><tr>
<td>SimGR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Running one of the GR hydrological models</h2>

<h3>Description</h3>

<p>Function for running the GR hydrological models</p>


<h3>Usage</h3>

<pre><code class="language-R">SimGR(PrepGR, CalGR = NULL, Param, EffCrit = c("NSE", "KGE", "KGE2", "RMSE"),
  WupPer = NULL, SimPer,
  transfo = c("", "sqrt", "log", "inv", "sort"), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PrepGR</code></td>
<td>
<p>[object of class <em>PrepGR</em>] see <code>PrepGR</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CalGR</code></td>
<td>
<p>(deprecated) use the <code>Param</code> argument instead</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param</code></td>
<td>
<p>[object of class <em>CalGR</em> or numeric] see <code>CalGR</code>. The length of the vector of parameters depends on the model used, see below for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EffCrit</code></td>
<td>
<p>[character] name of the efficiency criterion (must be one of <code>"NSE"</code>, <code>"KGE"</code>, <code>"KGE2"</code> or <code>"RMSE"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WupPer</code></td>
<td>
<p>(optional) [character] vector of 2 values to define the beginning and end of the warm-up period [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]; [0L] to disable the warm-up period. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SimPer</code></td>
<td>
<p>[character] vector of 2 values to define the beginning and end of the simulation period  [<code>"YYYY-mm-dd"</code> or <code>"YYYY-mm-dd HH:MM:SS"</code>]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transfo</code></td>
<td>
<p>(optional) [character] name of the transformation applied to discharge for calculating the error criterion (must be one of <code>""</code>, <code>"sqrt"</code>, <code>"log"</code>, <code>"inv"</code> or <code>"sort"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(optional) [boolean] logical value indicating if the function is run in verbose mode or not</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The user can customize the parameters with the <code>Param</code> argument.
The user can also use the parameters resulting from a calibration. In this case, it is necessary to use the <code>CalGR</code> function.
<br><br><code>WupPer = NULL</code> indicates that, if available, a period of one year immediately present before the CalPer period is used. <code>WupPer = 0L</code> allows to disable the warm up of the model.
</p>


<h3>Value</h3>

<p>[list] object of class <code>SimGR</code> containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>OptionsSimul</code></td>
<td>
<p>[list] object of class <code>RunOptions</code> (see: <code>CreateRunOptions</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OptionsCrit</code></td>
<td>
<p>[list] object of class <code>InputsCrit</code> (see: <code>CreateInputsCrit</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OutputsModel</code></td>
<td>
<p>[list] object of class <code>OutputsModel</code> (see: <code>RunModel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qobs</code></td>
<td>
<p>[numeric]  series of observed discharges [mm/time step]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TypeModel</code></td>
<td>
<p>[character] name of the function of the hydrological model used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CalCrit</code></td>
<td>
<p>[character] name of the function that computes the error criterion during the calibration step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EffCrit</code></td>
<td>
<p>[list] name of the function that computes the error criterion during the simulation step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PeriodModel</code></td>
<td>
<p>[list] <code>$WarmUp</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the warm-up period; <code>$Run</code>: vector of 2 <code>POSIXct</code> values defining the beginning and end of the calibration period</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Olivier Delaigue, Guillaume Thirel</p>


<h3>See Also</h3>

<p>airGRteaching
<code>plot</code> and  <code>dyplot</code>
functions to display static and dynamic plots
<br><br>
airGR
<code>CreateRunOptions</code>, <code>CreateInputsCrit</code>, <code>RunModel</code>, <code>ErrorCrit_RMSE</code>, <code>ErrorCrit_NSE</code>, <code>ErrorCrit_KGE</code>, <code>ErrorCrit_KGE2</code>
functions
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGRteaching)

## data.frame of observed data
data(L0123001, package = "airGR")
BasinObs2 &lt;- BasinObs[, c("DatesR", "P", "E", "Qmm", "T")]

## Preparation of observed data for modelling
PREP &lt;- PrepGR(ObsDF = BasinObs2, HydroModel = "GR4J", CemaNeige = FALSE)

## Calibration step
CAL &lt;- CalGR(PrepGR = PREP, CalCrit = "KGE2",
             WupPer = NULL, CalPer = c("1990-01-01", "1993-12-31"))

## Simulation step using the result of the automatic calibration method to set the model parameters
SIM &lt;- SimGR(PrepGR = PREP, Param = CAL, EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))

## Simulation step using model parameter set by the user
SIM &lt;- SimGR(PrepGR = PREP, Param = c(270.426, 0.984, 108.853, 2.149), EffCrit = "KGE2",
             WupPer = NULL, SimPer = c("1994-01-01", "1998-12-31"))


## Structure of SimGR object
str(SIM)

## Plot diagnostics
plot(SIM)

## Static plot of observed and simulated time series
plot(SIM, which = "ts")
plot(SIM, which = c("Precip", "Flows"))

## Dynamic plot of observed and simulated time series
dyplot(SIM)
</code></pre>


</div>