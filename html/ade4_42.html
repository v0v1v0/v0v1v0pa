<div class="container">

<table style="width: 100%;"><tr>
<td>bca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Between-Class Analysis</h2>

<h3>Description</h3>

<p>Performs a particular case of a Principal Component Analysis with
respect to Instrumental Variables (pcaiv), in which there is only a
single factor as explanatory variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'dudi'
bca(x, fac, scannf = TRUE, nf = 2, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a duality diagram, object of class <code>dudi</code> from
one of the functions <code>dudi.coa</code>, <code>dudi.pca</code>,...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>a factor partitioning the rows of <code>dudi$tab</code> in classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p>a logical value indicating whether the eigenvalues barplot should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>if scannf FALSE, a numeric value indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of class <code>dudi</code>, subclass 'between' containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a data frame class-variables containing the means per class
for each variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw</code></td>
<td>
<p>a numeric vector of the column weigths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>a numeric vector of the class weigths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a numeric vector with all the eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the rank of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>an integer value indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>a data frame with the column normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>a data frame with the class normed scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>a data frame  with the column coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>a data frame with the class coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matching call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>the bewteen-class inertia percentage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ls</code></td>
<td>
<p>a data frame with the row coordinates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as</code></td>
<td>
<p>a data frame containing the projection of inertia axes onto between axes</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>To avoid conflict names with the <code>base:::within</code> function, the
function <code>within</code> is now deprecated and removed. To be
consistent, the <code>between</code> function is also deprecated and
is replaced by the method <code>bca.dudi</code> of the new generic <code>bca</code> function. 
</p>


<h3>Author(s)</h3>

<p>Daniel Chessel <br>
Anne-Béatrice Dufour <a href="mailto:anne-beatrice.dufour@univ-lyon1.fr">anne-beatrice.dufour@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Dolédec, S. and Chessel, D. (1987) Rythmes saisonniers et composantes stationnelles 
en milieu aquatique I- Description d'un plan d'observations complet par 
projection de variables. <em>Acta Oecologica, Oecologia Generalis</em>, <b>8</b>, 3, 403–426.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(meaudret)
pca1 &lt;- dudi.pca(meaudret$env, scan = FALSE, nf = 4)
pca2 &lt;- dudi.pca(meaudret$spe, scal = FALSE, scan = FALSE, nf = 4)
bet1 &lt;- bca(pca1, meaudret$design$site, scan = FALSE, nf = 2)
bet2 &lt;- bca(pca2, meaudret$design$site, scan = FALSE, nf = 2)
  
if(adegraphicsLoaded()) {
  g1 &lt;- s.class(pca1$li, meaudret$design$site, psub.text = "Principal Component Analysis (env)",
    plot = FALSE)
  g2 &lt;- s.class(pca2$li, meaudret$design$site, psub.text = "Principal Component Analysis (spe)",
    plot = FALSE)
  g3 &lt;- s.class(bet1$ls, meaudret$design$site, psub.text = "Between sites PCA (env)", plot = FALSE)
  g4 &lt;- s.class(bet2$ls, meaudret$design$site, psub.text = "Between sites PCA (spe)", plot = FALSE)
  G &lt;- ADEgS(list(g1, g2, g3, g4), layout = c(2, 2))
  
} else {
  par(mfrow = c(2, 2))
  s.class(pca1$li, meaudret$design$site, sub = "Principal Component Analysis (env)", csub = 1.75)
  s.class(pca2$li, meaudret$design$site, sub = "Principal Component Analysis (spe)", csub = 1.75)
  s.class(bet1$ls, meaudret$design$site, sub = "Between sites PCA (env)", csub = 1.75)
  s.class(bet2$ls, meaudret$design$site, sub = "Between sites PCA (spe)", csub = 1.75)
  par(mfrow = c(1, 1))
}

coib &lt;- coinertia(bet1, bet2, scann = FALSE)
plot(coib)
</code></pre>


</div>