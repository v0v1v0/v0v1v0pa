<div class="container">

<table style="width: 100%;"><tr>
<td>loocv.between</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Leave-one-out cross-validation for a <code>bca</code>
</h2>

<h3>Description</h3>

<p>Leave-one-out cross-validation for <code>bca</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'between'
loocv(x, nax = 0, progress = FALSE, parallel = FALSE, ...)
## S3 method for class 'bcaloocv'
print(x, ...)
## S3 method for class 'bcaloocv'
plot(x, xax = 1, yax = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>dudi of the <code>bca</code> on which cross-validation should be done
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nax</code></td>
<td>

<p>list of axes for mean overlap index computation (0 = all axes)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>logical, TRUE = display a progress bar during computations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>

<p>logical, TRUE = process cross-validation in parallel computing 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax, yax</code></td>
<td>

<p>the numbers of the x-axis and the y-axis
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns a list containing the cross-validated coordinates of the rows (the rows of the original analysis, not the rows of the <code>bca</code>). The <code>dudi</code> on which the <code>bca</code> was computed is redone after removing each row of the data table, one at a time. A <code>bca</code> is done on this new <code>dudi</code> and the coordinates of the missing row are computed by projection as supplementary element in the corresponding <code>bca</code>. This is most useful in the case p &gt;&gt; n (many variables and few samples), where <code>bca</code> graphs can show spurious groups (see Refs.)
</p>
<p>For parallel computing (parallel argument = TRUE), the new <code>dudi</code>, <code>bca</code> and cross-validation computations are processed in parallel on all the available nodes of the computer processor(s).
</p>


<h3>Value</h3>

<p>A list with:
</p>
<p>- <code>XValCoord</code>: 
the cross-validated row coordinates 
</p>
<p>- <code>PRESS</code>: 
the Predicted Residual Error Sum for each row
</p>
<p>- <code>PRESSTot</code>: 
the sum of <code>PRESS</code> for each <code>bca</code> axis 
</p>
<p>- <code>Oij_bga</code>: 
the mean overlap index for BGA
</p>
<p>- <code>Oij_XVal</code>: 
the mean overlap index for cross-validation
</p>
<p>- <code>DeltaOij</code>: 
the spuriousness index

</p>


<h3>Author(s)</h3>

<p>Jean Thioulouse
</p>


<h3>References</h3>

<p>Thioulouse J, Renaud S, Dufour AB, Dray S. Overcoming the Spurious Groups Problem in Between-Group PCA. Evolutionary Biology (2021). (Accepted).
</p>
<p>Cardini A, Polly D. Cross-validated Between Group PCA Scatterplots: A Solution to Spurious Group Separation ? Evolutionary Biology (2020) 47:85â€“95. <a href="https://doi.org/10.1007/s11692-020-09494-x">doi:10.1007/s11692-020-09494-x</a>
</p>
<p>Cardini A, O'Higgins P, Rohlf J. Seeing Distinct Groups Where There are None: Spurious Patterns from Between-Group PCA. Evolutionary Biology (2019) 46:303-316. <a href="https://doi.org/10.1007/s11692-019-09487-5">doi:10.1007/s11692-019-09487-5</a>
</p>
<p>Bookstein F. Pathologies of Between-Groups Principal Components Analysis in Geometric Morphometrics. Evolutionary Biology (2019) 46:271-302. <a href="https://doi.org/10.1007/s11692-019-09484-8">doi:10.1007/s11692-019-09484-8</a>
</p>


<h3>See Also</h3>

<p>loocv.dudi
loocv.discrimin
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Data = meaudret
data(meaudret)
pca1 &lt;- dudi.pca(meaudret$env, scannf = FALSE, nf = 3)
bca1 &lt;- bca(pca1, meaudret$design$site, scannf = FALSE, nf = 3)
pst1 &lt;- paste0("Meaudret BGA randtest: p=",
randtest(bca1)$pvalue, " ratio=", round(bca1$ratio, 2))
xbca1 &lt;- loocv(bca1, progress = TRUE)

if(adegraphicsLoaded()){
    sc1 &lt;- s.class(bca1$ls, meaudret$design$site, col = TRUE,
    psub.text = pst1, ellipseSize=0, chullSize=1, plot = FALSE)
    sc2 &lt;- s.class(xbca1$XValCoord, meaudret$design$site,
    col = TRUE, psub.text = "Meaudret cross-validation",
    ellipseSize=0, chullSize=1, plot = FALSE)
    ADEgS(list(sc1, sc2))
} else {
	par(mfrow=c(2,2))
	s.chull(dfxy = bca1$ls, fac = meaudret$design$site, cpoint = 1, 
    	col = hcl.colors(5, "Dark 2"), sub = pst1)
    s.class(bca1$ls, meaudret$design$site, col = hcl.colors(5, "Dark 2"),
    	cellipse = 0, add.plot = TRUE)
	s.chull(dfxy = xbca1$XValCoord, fac = meaudret$design$site, cpoint = 1, 
    	col = hcl.colors(5, "Dark 2"), sub = "Meaudret cross-validation")
    s.class(xbca1$XValCoord, meaudret$design$site, col = hcl.colors(5, "Dark 2"),
    	cellipse = 0, add.plot = TRUE)
}
## Not run: 
# Data = rnorm()
set.seed(9)
fac1 &lt;- as.factor(rep(1:3, each = 10))
tab &lt;- as.data.frame(matrix(rnorm(10800), nrow = 30))
pca2 &lt;- dudi.pca(tab, scannf = FALSE)
bca2 &lt;- bca(pca2, fac1, scannf = FALSE)
pst2 &lt;- paste0("rnorm spurious groups: p=",
randtest(bca2)$pvalue, " ratio=", round(bca2$ratio, 2))
xbca2 &lt;- loocv(bca2, progress = TRUE)
if(adegraphicsLoaded()){
	sc3 &lt;- s.class(bca2$ls, fac1, col = TRUE,
		psub.text = pst2, ellipseSize=0, chullSize=1,
		xlim = c(-8, 8), ylim = c(-8, 8), plot = FALSE)
	sc4 &lt;- s.class(xbca2$XValCoord, fac1, col = TRUE,
		psub.text = "rnorm cross-validation", ellipseSize=0,
		chullSize=1, xlim = c(-8, 8), ylim = c(-8, 8), plot = FALSE)
	ADEgS(list(sc3, sc4))
} else {
	par(mfrow=c(2,2))
	s.chull(bca2$ls, fac1, optchull = 1, cpoint = 1, xlim = c(-8, 8), ylim = c(-8, 8),
    	col = hcl.colors(3, "Dark 2"), sub = pst2)
    s.class(bca2$ls, fac1, xlim = c(-8, 8), ylim = c(-8, 8),
    	col = hcl.colors(3, "Dark 2"), cellipse = 0, add.plot = TRUE)
	s.chull(xbca2$XValCoord, fac1, optchull = 1, cpoint = 1, xlim = c(-8, 8),
		ylim = c(-8, 8), col = hcl.colors(3, "Dark 2"), sub = "rnorm cross-validation")
    s.class(xbca2$XValCoord, fac1, xlim = c(-8, 8), ylim = c(-8, 8),
    	col = hcl.colors(3, "Dark 2"), cellipse = 0, add.plot = TRUE)
}

## End(Not run)
</code></pre>


</div>