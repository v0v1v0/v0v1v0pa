<div class="container">

<table style="width: 100%;"><tr>
<td>RunModel_CemaNeige</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run with the CemaNeige snow module</h2>

<h3>Description</h3>

<p>Function which performs a single run for the CemaNeige snow module at the daily or hourly time step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunModel_CemaNeige(InputsModel, RunOptions, Param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>InputsModel</code></td>
<td>
<p>[object of class <em>InputsModel</em>] see <code>CreateInputsModel</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RunOptions</code></td>
<td>
<p>[object of class <em>RunOptions</em>] see <code>CreateRunOptions</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param</code></td>
<td>
<p>[numeric] vector of 2 (or 4 parameters if <code>IsHyst = TRUE</code>, see <code>CreateRunOptions</code> for details)
</p>

<table>
<tr>
<td style="text-align: left;">
    CemaNeige X1 </td>
<td style="text-align: left;"> weighting coefficient for snow pack thermal state [-]                   </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X2 </td>
<td style="text-align: left;"> degree-day melt coefficient [mm/°C/time step]                           </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X3 </td>
<td style="text-align: left;"> (optional) accumulation threshold [mm] (needed if <code>IsHyst = TRUE</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X4 </td>
<td style="text-align: left;"> (optional) percentage (between 0 and 1) of annual snowfall defining the melt threshold [-] (needed if <code>IsHyst = TRUE</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The choice of the CemaNeige version (i.e. with or without hysteresis) is explained in <code>CreateRunOptions</code>. <br>
For further details on the model, see the references section. <br>
For further details on the argument structures and initialisation options, see <code>CreateRunOptions</code>.
</p>


<h3>Value</h3>

<p>[list] containing the function outputs organised as follows:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>$DatesR </em>                                </td>
<td style="text-align: left;"> [POSIXlt] series of dates                                            </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers</em>                        </td>
<td style="text-align: left;"> [list] CemaNeige outputs (1 element per layer)                       </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Pliq        </em> </td>
<td style="text-align: left;"> [numeric] series of liquid precip. [mm/time step]                    </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Psol        </em> </td>
<td style="text-align: left;"> [numeric] series of solid precip. [mm/time step]                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$SnowPack    </em> </td>
<td style="text-align: left;"> [numeric] series of snow pack (snow water equivalent) [mm]           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$ThermalState</em> </td>
<td style="text-align: left;"> [numeric] series of snow pack thermal state [°C]                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Gratio      </em> </td>
<td style="text-align: left;"> [numeric] series of Gratio [0-1]                                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$PotMelt     </em> </td>
<td style="text-align: left;"> [numeric] series of potential snow melt [mm/time step]               </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Melt        </em> </td>
<td style="text-align: left;"> [numeric] series of actual snow melt [mm/time step]                  </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$PliqAndMelt </em> </td>
<td style="text-align: left;"> [numeric] series of liquid precip. + actual snow melt [mm/time step] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Temp        </em> </td>
<td style="text-align: left;"> [numeric] series of air temperature [°C]                             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Gthreshold  </em> </td>
<td style="text-align: left;"> [numeric] series of melt threshold [mm]                              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Glocalmax   </em> </td>
<td style="text-align: left;"> [numeric] series of local melt threshold for hysteresis [mm]         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StateEnd</em> </td>
<td style="text-align: left;"> [numeric] states at the end of the run: CemaNeige states [mm &amp; °C]. See <code>CreateIniStates</code> for more details </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Refer to the provided references or to the package source code for further details on these model outputs.
</p>


<h3>Author(s)</h3>

<p>Laurent Coron, Audrey Valéry, Vazken Andréassian, Olivier Delaigue, Guillaume Thirel
</p>


<h3>References</h3>

<p>Riboust, P., Thirel, G., Le Moine, N. and Ribstein, P. (2019).
Revisiting a simple degree-day model for integrating satellite data: Implementation of SWE-SCA hystereses.
Journal of Hydrology and Hydromechanics, 67(1), 70–81, <a href="https://doi.org/10.2478/johh-2018-0004">doi:10.2478/johh-2018-0004</a>.
<br><br>
Valéry, A., Andréassian, V. and Perrin, C. (2014).
"As simple as possible but not simpler": What is useful in a temperature-based snow-accounting routine?
Part 1 - Comparison of six snow accounting routines on 380 catchments.
Journal of Hydrology, 517(0), 1166-1175, <a href="https://doi.org/10.1016/j.jhydrol.2014.04.059">doi:10.1016/j.jhydrol.2014.04.059</a>.
<br><br>
Valéry, A., Andréassian, V. and Perrin, C. (2014).
"As simple as possible but not simpler": What is useful in a temperature-based snow-accounting routine?
Part 2 - Sensitivity analysis of the Cemaneige snow accounting routine on 380 catchments.
Journal of Hydrology, 517(0), 1176-1187, <a href="https://doi.org/10.1016/j.jhydrol.2014.04.058">doi:10.1016/j.jhydrol.2014.04.058</a>.
</p>


<h3>See Also</h3>

<p><code>RunModel_CemaNeigeGR4J</code>, <code>CreateInputsModel</code>, <code>CreateRunOptions</code>,
<code>CreateIniStates</code>, <code>CreateCalibOptions</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## load of catchment data
data(L0123002)

## preparation of the InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_CemaNeige, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P,TempMean = BasinObs$T,
                                 ZInputs = BasinInfo$HypsoData[51], HypsoData=BasinInfo$HypsoData,
                                 NLayers = 5)

## run period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))


## --- original version of CemaNeige

## preparation of the RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_CemaNeige, InputsModel = InputsModel,
                               IndPeriod_Run = Ind_Run)

## simulation
Param &lt;- c(CNX1 = 0.962, CNX2 = 2.249)
OutputsModel &lt;- RunModel_CemaNeige(InputsModel = InputsModel,
                                   RunOptions = RunOptions, Param = Param)

## results preview
plot(OutputsModel)


## --- version of CemaNeige with the Linear Hysteresis

## preparation of the RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_CemaNeige, InputsModel = InputsModel,
                               IndPeriod_Run = Ind_Run, IsHyst = TRUE)

## simulation
Param &lt;- c(CNX1 = 0.962, CNX2 = 2.249, CNX3 = 100, CNX4 = 0.4)
OutputsModel &lt;- RunModel_CemaNeige(InputsModel = InputsModel,
                                   RunOptions = RunOptions, Param = Param)

## results preview
plot(OutputsModel)
</code></pre>


</div>