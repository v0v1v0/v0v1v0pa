<div class="container">

<table style="width: 100%;"><tr>
<td>train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Continue training of a Neural Network</h2>

<h3>Description</h3>

<p>Continue training of a neural network object returned by <code>neuralnetwork()</code> 
or <code>autoencoder()</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">train(
  object,
  X,
  y = NULL,
  n.epochs = 100,
  batch.size = 32,
  drop.last = TRUE,
  val.prop = 0.1,
  random.seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>ANN</code> produced by <code>neuralnetwork()</code> 
or <code>autoencoder()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix with explanatory variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>matrix with dependent variables. Not required if object is an autoencoder</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.epochs</code></td>
<td>
<p>the number of epochs to train. This parameter largely determines
the training time (one epoch is a single iteration through the training data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch.size</code></td>
<td>
<p>the number of observations to use in each batch. Batch learning
is computationally faster than stochastic gradient descent. However, large
batches might not result in optimal learning, see Efficient Backprop by Le Cun 
for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.last</code></td>
<td>
<p>logical. Only applicable if the size of the training set is not 
perfectly devisible by the batch size. Determines if the last chosen observations
should be discarded (in the current epoch) or should constitute a smaller batch. 
Note that a smaller batch leads to a noisier approximation of the gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val.prop</code></td>
<td>
<p>proportion of training data to use for tracking the loss on a 
validation set during training. Useful for assessing the training process and
identifying possible overfitting. Set to zero for only tracking the loss on the 
training data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.seed</code></td>
<td>
<p>optional seed for the random number generator</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A new validation set is randomly chosen. This can result in irregular jumps
in the plot given by <code>plot.ANN()</code>.
</p>


<h3>Value</h3>

<p>An <code>ANN</code> object. Use function <code>plot(&lt;object&gt;)</code> to assess
loss on training and optionally validation data during training process. Use
function <code>predict(&lt;object&gt;, &lt;newdata&gt;)</code> for prediction.
</p>


<h3>References</h3>

<p>LeCun, Yann A., et al. "Efficient backprop." Neural networks:
Tricks of the trade. Springer Berlin Heidelberg, 2012. 9-48.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Train a neural network on the iris dataset
X &lt;- iris[,1:4]
y &lt;- iris$Species
NN &lt;- neuralnetwork(X, y, hidden.layers = 10, sgd.momentum = 0.9, 
                    learn.rates = 0.01, val.prop = 0.3, n.epochs = 100)

# Plot training and validation loss during training
plot(NN)

# Continue training for 1000 epochs
train(NN, X, y, n.epochs = 200, val.prop = 0.3)

# Again plot the loss - note the jump in the validation loss at the 100th epoch
# This is due to the random selection of a new validation set
plot(NN)
</code></pre>


</div>