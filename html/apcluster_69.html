<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Heatmap</h2>

<h3>Description</h3>

<p>Functions for Plotting of Heatmap
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'ExClust,missing'
heatmap(x, y, ...)
## S4 method for signature 'ExClust,matrix'
heatmap(x, y, ...)
## S4 method for signature 'ExClust,Matrix'
heatmap(x, y, ...)
## S4 method for signature 'ExClust,sparseMatrix'
heatmap(x, y, ...)
## S4 method for signature 'AggExResult,missing'
heatmap(x, y, ...)
## S4 method for signature 'AggExResult,matrix'
heatmap(x, y, Rowv=TRUE, Colv=TRUE,
    sideColors=NULL, col=heat.colors(12),
    base=0.05,  add.expr, margins=c(5, 5, 2),
    cexRow=max(min(35 / nrow(y), 1), 0.1),
    cexCol=max(min(35 / ncol(y), 1), 0.1), main=NULL, dendScale=1,
    barScale=1, legend=c("none", "col"), ...)
## S4 method for signature 'matrix,missing'
heatmap(x, y, ...)
## S4 method for signature 'missing,matrix'
heatmap(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a clustering result object of class
<code>APResult</code>, <code>ExClust</code>,
or <code>AggExResult</code>; for compatibility, <code>x</code>
may also be a similarity matrix (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a similarity matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sideColors</code></td>
<td>
<p>character vector of colors to be used for plotting color
bars that visualize clusters of the finest clustering level in
<code>x</code>. This is done in a fashion similar to using
<code>RowSideColors</code> or <code>ColSideColors</code> in the standard
<code>heatmap</code> function. However, color bars
are plotted either on both sides or not at all. The
<code>sideColors</code> argument determines the coloring of both
horizontal and vertical bars.
If <code>sideColors</code> is shorter than the number of clusters in the finest
clustering level, <code>sideColors</code> is recycled. In any case, a
minimum number of two colors (two elements of sideColors) is
required. If <code>NA</code>, no color bars are plotted.
If <code>NULL</code> (default), color bars are only plotted if
the finest cluster level does not only consist of single samples.
In this case, the <code>rainbow</code> function is used to
compute the vector of colors which is shuffled such that dissimilar
colors are placed next to each other in the color bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>color ramp used for the heatmap image; see
<code>image</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rowv</code></td>
<td>
<p>determines whether or not a row dendrogram should be
plotted. If <code>FALSE</code> or <code>NA</code>, no row dendrogram is
plotted. In any other
case, a row dendrogram is plotted unless the number of clusters in
the finest clustering level is less than 2. Note that, in the
latter case, the actual values in <code>Rowv</code> are ignored, so this
argument cannot be used to supply a previously computed dendrogram
or re-ordering of elements as in the standard
<code>heatmap</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Colv</code></td>
<td>
<p>determines whether or not a column dendrogram should be
plotted. Fully analogous to <code>Rowv</code>, except that column
dendrograms are never plotted if the similarity  matrix <code>y</code>
is non-quadratic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>fraction of height used for the very first join in
dendrograms; see <code>coerce-methods</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.expr,margins,cexRow,cexCol,main</code></td>
<td>
<p>largely analogous to the standard
<code>heatmap</code> function; to omit row/column
labeling, set <code>cexRow</code>/<code>cexCol</code> to <code>0</code>.
The default for <code>margins</code> is a vector of length 3, where the
third element is the right-hand side margin for the color legend
(see <code>legend</code> argument). It remains unused (and can also be
omitted) if no color legend is plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendScale</code></td>
<td>
<p>factor scaling the width of vertical and height of
horizontal dendrograms; values have to be larger than 0 and no
larger than 2. The default is 1 which corresponds to the same size
as the dendrograms plot by the standard
<code>heatmap</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barScale</code></td>
<td>
<p>factor scaling the width of color bars; values have to
be larger than 0 and no larger than 4. The default is 1 which
corresponds to half the width of the color bars plot by the standard
<code>heatmap</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>if <code>"col"</code>, then a color legend similar to 
<code>filled.contour</code> is added on
the right-hand side of the heatmap plot; if <code>"none"</code> (default),
no such legend is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>see details below</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>heatmap</code> functions provide plotting of heatmaps from several
different types of input object. The implementation is similar to the standard
graphics function <code>heatmap</code>. 
Plotting heatmaps via the <code>plot</code> command as available in previous 
versions of this package is still available for backward 
compatibility.
</p>
<p>If <code>heatmap</code> is called for objects of classes
<code>APResult</code> or <code>ExClust</code>,
a heatmap of the similarity matrix in slot <code>sim</code> of the parameter
<code>x</code> is created with clusters grouped together and highlighted in
different colors. The order of clusters is determined by running 
<code>aggExCluster</code> on the clustering result <code>x</code>. This
variant of <code>heatmap</code> returns an  invisible
<code>AggExResult</code> object.
</p>
<p>If <code>heatmap</code> is called for an <code>AggExResult</code>
object that contains all levels of clustering, the heatmap is
displayed with the corresponding clustering dendrogram. If the
<code>AggExResult</code> object is the result of running
<code>aggExCluster</code> on a prior clustering result, the same heatmap
plot is produced as if <code>heatmap</code> had been called on this
prior clustering result, however, returning the cluster hierarchy's
<code>dendrogram</code>. In the latter case, color bars are plotted
to visualize the prior clustering result (see description of
argument <code>sideColors</code> above).
</p>
<p>All variants described above only work if the input object <code>x</code>
contains a slot <code>sim</code> with the similarity matrix (which is only
the case if the preceding clustering method has been called with
<code>includeSim=TRUE</code>). In case the slot <code>sim</code> of <code>x</code> does not
contain the similarity matrix, the similarity matrix must be supplied
as second argument <code>y</code>.
</p>
<p>All variants described above internally use <code>heatmap</code> with signature
<code>AggExResult,matrix</code>, so all arguments list above can be used for
all variants, as they are passed through using the <code>...</code>
argument. All other arguments, analogously to the standard 
<code>heatmap</code> function, are passed on to the
standard function <code>image</code>. This is
particularly useful for using alternative color schemes via the
<code>col</code> argument.
</p>
<p>The two variants with one of the two arguments being a matrix and one
being missing are just wrappers around the standard
<code>heatmap</code> function with the aim to provide
compatibility with this standard case.
</p>


<h3>Value</h3>

<p>see details above
</p>


<h3>Note</h3>

<p>Similarity matrices can be supplied in dense or sparse
format. Note, however, that sparse matrices are converted to full
dense matrices before plotting heatmaps which may lead to memory and/or
performance bottlenecks for larger data sets.</p>


<h3>Author(s)</h3>

<p>Ulrich Bodenhofer, Andreas Kothmeier, and Johannes Palme</p>


<h3>References</h3>

<p><a href="https://github.com/UBod/apcluster">https://github.com/UBod/apcluster</a>
</p>
<p>Bodenhofer, U., Kothmeier, A., and Hochreiter, S. (2011)
APCluster: an R package for affinity propagation clustering.
<em>Bioinformatics</em> <b>27</b>, 2463-2464.
DOI: <a href="https://doi.org/10.1093/bioinformatics/btr406">doi:10.1093/bioinformatics/btr406</a>.</p>


<h3>See Also</h3>

<p><code>APResult</code>,
<code>AggExResult</code>, <code>ExClust</code>,
<code>apcluster</code>, <code>apclusterL</code>, 
<code>aggExCluster</code>, <code>cutree-methods</code>,
<code>plot-methods</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create two Gaussian clouds
cl1 &lt;- cbind(rnorm(50, 0.2, 0.05), rnorm(50, 0.8, 0.06))
cl2 &lt;- cbind(rnorm(50, 0.7, 0.08), rnorm(50, 0.3, 0.05))
x &lt;- rbind(cl1, cl2)

## run affinity propagation using negative squared Euclidean
apres &lt;- apcluster(negDistMat(r=2), x, p=-0.1)

## plot heatmap clustering run
heatmap(apres)

## rerun affinity propagation
## reuse similarity matrix from previous run
apres2 &lt;- apcluster(s=apres@sim, q=0.6)

## plot heatmap of second run
heatmap(apres2, apres@sim)

## with alternate heatmap coloring, alternating color bars, and no dendrograms
heatmap(apres2, apres@sim, Rowv=NA, Colv=NA,
        sideColors=c("darkgreen", "yellowgreen"), col=terrain.colors(12))

## perform agglomerative clustering of affinity propagation clusters
aggres1 &lt;- aggExCluster(apres@sim, apres2)

## plot heatmap
heatmap(cutree(aggres1, 2), apres@sim)

## perform agglomerative clustering of whole data set
aggres2 &lt;- aggExCluster(negDistMat(r=2), x)

## show heatmap along with dendrogram
heatmap(aggres2)
</code></pre>


</div>