<div class="container">

<table style="width: 100%;"><tr>
<td>mtm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multitaper method spectral analysis</h2>

<h3>Description</h3>

<p>Multitaper method (MTM) spectral analysis (Thomson, 1982)
</p>


<h3>Usage</h3>

<pre><code class="language-R">mtm(dat,tbw=3,ntap=NULL,padfac=5,demean=T,detrend=F,siglevel=0.9,ar1=T,output=0,
     CLpwr=T,xmin,xmax,pl=1,sigID=T,genplot=T,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Stratigraphic series for MTM spectral analysis. First column should be location (e.g., depth), second column should be data value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbw</code></td>
<td>
<p>MTM time-bandwidth product.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntap</code></td>
<td>
<p>Number of DPSS tapers to use. By default, this is set to (2*tbw)-1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>padfac</code></td>
<td>
<p>Pad with zeros to (padfac*npts) points, where npts is the original number of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean</code></td>
<td>
<p>Remove mean from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend</code></td>
<td>
<p>Remove linear trend from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglevel</code></td>
<td>
<p>Significance level for peak identification. (0-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar1</code></td>
<td>
<p>Estimate conventional AR(1) noise spectrum and confidence levels? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLpwr</code></td>
<td>
<p>Plot AR(1) noise confidence levels on power spectrum? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>What should be returned as a data frame? (0=nothing; 1= power spectrum + harmonic CL + AR1 CL + AR1 fit + 90%-99% AR1 power levels (ar1 must be set to TRUE to output AR model results); 2=significant peak frequencies; 3=significant peak frequencies + harmonic CL; 4=internal variables from spec.mtm). Option 4 is intended for expert users, and should generally be avoided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>Smallest frequency for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>Largest frequency for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>Power spectrum plotting: (1) linear frequency-log spectral power, (2) linear frequency-linear spectral power (3) log frequency-log spectral power, (4) log frequency-linear spectral power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigID</code></td>
<td>
<p>Identify significant frequencies on power and probabilty plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power spectrum normalization approach applied here divides the Fourier coefficients by the 
number of points (npts) in the stratigraphic series, which is equivalent to dividing the power 
by (npts*npts). The (npts*npts) normalization has the convenient property whereby
– for an unpadded series – the sum of the power in the positive frequencies is equivalent 
to half of variance; the other half of the variance is in the negative frequencies.
</p>
<p>If ar1=T, candidiate astronomical cycles are identified via isolation of those frequencies 
that achieve the required (e.g., 90 percent) "red noise" confidence level and MTM harmonic F-test 
confidence level. Allowance is made for the smoothing inherent in the MTM power spectral estimate 
as compared to the MTM harmonic spectrum. That is, an F-test peak is reported if it achieves the 
required MTM harmonic confidence level, while also achieving the required red noise confidence level 
within +/- half the power spectrum bandwidth resolution. One additional criterion is included to 
further reduce the false positive rate, a requirement that significant F-tests must occur on a local 
power spectrum high, which is parameterized as occurring above the local red noise background estimate.
See Meyers (2012) for futher information.
</p>
<p>Note that the 'spec.mtm' function in package 'multitaper' (Rahim et al., 2014) is used for MTM spectrum estimation.
</p>


<h3>References</h3>

<p>S.R. Meyers, 2012,
<em>Seeing Red in Cyclic Stratigraphy: Spectral Noise Estimation for Astrochronology</em>: Paleoceanography, 27, PA3228, doi:10.1029/2012PA002307.
</p>
<p>Rahim, K.J. and Burr W.S. and Thomson, D.J., 2014, <em>Applications of Multitaper Spectral Analysis to Nonstationary Data</em>. PhD thesis, Queen's University. R package version 1.0-17, https://CRAN.R-project.org/package=multitaper.
</p>
<p>Thomson, D. J., 1982, <em>Spectrum estimation and harmonic analysis</em>, Proc. IEEE, 70, 1055-1096, doi:10.1109/PROC.1982.12433.
</p>


<h3>See Also</h3>

 <p><code>eha</code>, <code>lowspec</code>, <code>mtmAR</code>, <code>mtmML96</code>, <code>periodogram</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># generate example series with periods of 400 ka, 100 ka, 40 ka and 20 ka
ex = cycles(freqs=c(1/400,1/100,1/40,1/20),start=1,end=1000,dt=5)

# add AR1 noise
noise = ar1(npts=200,dt=5,sd=.5)
ex[2] = ex[2] + noise[2]

# MTM spectral analysis, with conventional AR1 noise test
pl(1,title="mtm")
mtm(ex,ar1=TRUE)

# compare to ML96 analysis
pl(1, title="mtmML96")
mtmML96(ex)

# compare to analysis with LOWSPEC
pl(1, title="lowspec")
lowspec(ex)

# compare to amplitudes from eha
pl(1,title="eha")
eha(ex,tbw=3,win=1000,pad=1000)
</code></pre>


</div>