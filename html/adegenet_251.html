<div class="container">

<table style="width: 100%;"><tr>
<td>global.rtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Global and local tests</h2>

<h3>Description</h3>

<p>These two Monte Carlo tests are used to assess the existence of global
and local spatial structures. They can be used as an aid to interprete
global and local components of spatial Principal Component Analysis
(sPCA).<br></p>
<p>They rely on the decomposition of a data matrix X into global and local
components using multiple regression on Moran's Eigenvector Maps (MEMs).
They require a data matrix (X) and a list of weights derived from a
connection network. X is regressed onto global MEMs (U+) in the global
test and on local ones (U-) in the local test. One mean <code class="reqn">R^2</code>
is obtained for each MEM, the k highest being summed to form the test
statistic.
</p>
<p>The reference distribution of these statistics are obtained by
randomly permuting the rows of X.
</p>


<h3>Usage</h3>

<pre><code class="language-R">global.rtest(X, listw, k = 1, nperm = 499)
local.rtest(X, listw, k = 1, nperm = 499)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data matrix, with variables in columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>a list of weights of class <code>listw</code>. Can be obtained
easily using the function <code>chooseCN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>integer: the number of highest <code class="reqn">R^2</code> summed to form the test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>integer: the number of randomisations to be performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This test is purely R code. A C or C++ version will be developped soon.
</p>


<h3>Value</h3>

<p>An object of class <code>randtest</code>.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:t.jombart@imperial.ac.uk">t.jombart@imperial.ac.uk</a></p>


<h3>References</h3>

<p>Jombart, T., Devillard, S., Dufour, A.-B. and Pontier, D.
Revealing cryptic spatial patterns in genetic variability by a new
multivariate method. <em>Heredity</em>, <b>101</b>, 92â€“103.
</p>


<h3>See Also</h3>

 <p><code>chooseCN</code>, <code>spca</code>, <code>monmonier</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
 data(sim2pop)
if(require(spdep)){
cn &lt;- chooseCN(sim2pop@other$xy,ask=FALSE,type=1,plot=FALSE,res="listw")

# global test
Gtest &lt;- global.rtest(sim2pop@tab,cn)
Gtest

# local test
Ltest &lt;- local.rtest(sim2pop@tab,cn)
Ltest
}

## End(Not run)
</code></pre>


</div>