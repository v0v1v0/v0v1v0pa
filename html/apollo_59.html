<div class="container">

<table style="width: 100%;"><tr>
<td>apollo_mixEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Uses EM for models with continuous random coefficients</h2>

<h3>Description</h3>

<p>Uses the EM algorithm for estimating a model with continuous random coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">apollo_mixEM(
  apollo_beta,
  apollo_fixed,
  apollo_probabilities,
  apollo_inputs,
  mixEM_settings = NA,
  estimate_settings = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>apollo_beta</code></td>
<td>
<p>Named numeric vector. Names and values for parameters. These need to be provided in the following order. With K random parameters, K means for the underlying Normals, followed by the elements of the lower triangle of the Cholesky matrix, by row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apollo_fixed</code></td>
<td>
<p>Character vector. Names (as defined in <code>apollo_beta</code>) of parameters whose value should not change during estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apollo_probabilities</code></td>
<td>
<p>Function. Returns probabilities of the model to be estimated. Must receive three arguments:
</p>

<ul>
<li> <p><strong><code>apollo_beta</code></strong>: Named numeric vector. Names and values of model parameters.
</p>
</li>
<li> <p><strong><code>apollo_inputs</code></strong>: List containing options of the model. See apollo_validateInputs.
</p>
</li>
<li> <p><strong><code>functionality</code></strong>: Character. Can be either <strong><code>"components"</code></strong>, <strong><code>"conditionals"</code></strong>, <strong><code>"estimate"</code></strong> (default), <strong><code>"gradient"</code></strong>, <strong><code>"output"</code></strong>, <strong><code>"prediction"</code></strong>, <strong><code>"preprocess"</code></strong>, <strong><code>"raw"</code></strong>, <strong><code>"report"</code></strong>, <strong><code>"shares_LL"</code></strong>, <strong><code>"validate"</code></strong> or <strong><code>"zero_LL"</code></strong>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apollo_inputs</code></td>
<td>
<p>List grouping most common inputs. Created by function apollo_validateInputs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mixEM_settings</code></td>
<td>
<p>List. Contains settings for this function. User input is required for all settings except those with a default or marked as optional. 
</p>

<ul>
<li> <p><strong>EMmaxIterations</strong>: Numeric. Maximum number of iterations of the EM algorithm before 
stopping. Default is 100. 
</p>
</li>
<li> <p><strong>postEM</strong>: Numeric scalar. Determines the tasks performed by this function 
after the EM algorithm has converged. Can take values <code>0</code>, <code>1</code> 
or <code>2</code> only. If value is <code>0</code>, only the EM algorithm will be 
performed, and the results will be a model object without a covariance 
matrix (i.e. estimates only). If value is <code>1</code>, after the EM 
algorithm, the covariance matrix of the model will be calculated as well, 
and the result will be a model object with a covariance matrix. If value 
is <code>2</code>, after the EM algorithm, the estimated parameter values will 
be used as starting value for a maximum likelihood estimation process, 
which will render a model object with a covariance matrix. Performing 
maximum likelihood estimation after the EM algorithm is useful, as there 
may be room for further improvement. Default is <code>2</code>.
</p>
</li>
<li> <p><strong>silent</strong>: Boolean. If TRUE, no information is printed to the console during 
estimation. Default is FALSE.
</p>
</li>
<li> <p><strong>stoppingCriterion</strong>: Numeric. Convergence criterion. The EM process will stop when 
improvements in the log-likelihood fall below this value. 
Default is 10^-5.
</p>
</li>
<li> <p><strong>transforms</strong>: List. Optional argument, with one entry per parameter, showing the inverse transform to return from beta to the underlying Normal. E.g. if the first parameter is specified as negative logormal inside apollo_randCoeff, then the entry in transforms should be transforms[[1]]=function(x) log(-x)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_settings</code></td>
<td>
<p>List. Options controlling the estimation process within each EM iteration. See apollo_estimate for details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses the EM algorithm for estimating a model with continuous random coefficients. It is only suitable for models where all parameters are random, with a full covariance matrix.
All random parameters need to be based on underlying Normals with a full covariance matrix, but any transform thereof can be used.
</p>


<h3>Value</h3>

<p>model object
</p>


</div>