<div class="container">

<table style="width: 100%;"><tr>
<td>arc_token</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Manage authorization tokens</h2>

<h3>Description</h3>

<p>These functions are used to set, fetch, and check authorization tokens.
</p>


<h3>Usage</h3>

<pre><code class="language-R">arc_token(token = "ARCGIS_TOKEN")

set_arc_token(token, ...)

unset_arc_token(token = NULL)

obj_check_token(token, call = rlang::caller_env())

check_token_has_user(token, call = rlang::caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>for <code>arc_token()</code>, the name of a token to fetch. For <code>set_arc_token()</code>,
it is an <code>httr2_token</code> that will be set. For <code>unset_arc_token()</code>, a character
vector of token names to be unset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>named arguments to set <code>httr2_token</code>. Must be valid names and must be an <code>httr2_token</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The execution environment of a currently running
function, e.g. <code>call = caller_env()</code>. The corresponding function
call is retrieved and mentioned in error messages as the source
of the error.
</p>
<p>You only need to supply <code>call</code> when throwing a condition from a
helper function which wouldn't be relevant to mention in the
message.
</p>
<p>Can also be <code>NULL</code> or a defused function call to
respectively not display any call or hard-code a code to display.
</p>
<p>For more information about error calls, see Including function calls in error messages.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is possible to have multiple authorization tokens in one session. These
functions assist you in managing them.
</p>
<p><code>arc_token()</code> is used to fetch tokens by name. The default token is <code>ARCGIS_TOKEN</code>.
However, they can be any valid character scalar. <code>set_arc_token()</code> will create
store a token with the name <code>ARCGIS_TOKEN</code>. However, you can alternatively
set the tokens by name using a key-value pair. The key is what you would pass
to <code>arc_token()</code> to fetch the <code>httr2_token</code> object. To remove a token that has
been set, use <code>unset_arc_token()</code>.
</p>
<p><code>obj_check_token()</code> is a developer oriented function that can be used to check
if an object is indeed an <code>httr2_token</code>. To check if a token has expired,
<code>validate_or_refresh_token()</code> will do so.
</p>
<p><code>check_token_has_user()</code> is a developer oriented function that checks to see
if a token has a <code>username</code> field associated with it.
</p>
<p>For developers:
</p>
<p><code>set_arc_token()</code> uses a package level environment to store the tokens. The
tokens are fetched from the environment using <code>arc_token()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create fake tokens
token_a &lt;- httr2::oauth_token("1234", arcgis_host = arc_host())
token_b &lt;- httr2::oauth_token("abcd", arcgis_host = arc_host())

# set token to the default location
set_arc_token(token_a)

# fetch token from the default location
arc_token()

# set token by name
set_arc_token(org_a = token_a, org_b = token_b)

# fetch token by name
arc_token("org_a")
arc_token("org_b")

# unset tokens
unset_arc_token()
unset_arc_token(c("org_a", "org_b"))
</code></pre>


</div>