<div class="container">

<table style="width: 100%;"><tr>
<td>gfitpca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness of fit with principal component analysis
</h2>

<h3>Description</h3>

<p>Perform a priori goodness of fit using the two first components 
obtained with PCA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gfitpca(target, sumstat, index, cprob=0.1, xlim=NULL, ylim=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>

<p>a data frame or vector of the observed summary statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumstat</code></td>
<td>

<p>a matrix or data frame of the simulated summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>

<p>a vector of models names. It must be character and have the same
length as the number of row in <code>sumstat</code> to indicate which row
belong to which model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cprob</code></td>
<td>

<p><code>cprob</code> is the proportion of points outside the displayed 
envelope. Default to 0.1 which corresponds to a 90% envelope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>

<p>optional, numeric vectors of length 2, giving the x and y coordinates
ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other parameters passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function performs PCA using the a priori simulated summary
statistics. It displays envelopes containing 1-<code>hprob</code> percent of
the simulations.
The projection of the observed summary statistics is displayed in
order to check if they are contained or not in the envelopes.
If the projection lies outside the envelope of a given model, it is
an indication of poor fit.
</p>


<h3>Author(s)</h3>

<p>Louisiane Lemaire and Michael Blum
</p>


<h3>See Also</h3>

<p><code>abc</code>, <code>plot.gfit</code>, <code>summary.gfit</code>, 
<code>gfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## human demographic history
require(abc.data)
data(human)
## five R objects are loaded. See ?human and vignette("abc") for details.

## Perform a priori goodness of fit for 3 different demographic models
## The envelopes containing 90% of the simulations are displayed.
## For the European data, a reasonable fit is only provided by the 
## bottleneck model.
## The number of simulations is reduced to improve speed (do not do that
## with your own data)
index&lt;-c(1:5000,50001:55000,100001:105000)
gfitpca(target=stat.voight["italian",], sumstat=stat.3pops.sim[index,],
index=models[index], cprob=0.1)
</code></pre>


</div>