<div class="container">

<table style="width: 100%;"><tr>
<td>BRB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Utilization Distribution of an Animal Based on Biased Random Bridges
</h2>

<h3>Description</h3>

<p>This function estimates the utilization distribution of one/several
animals using a biased random bridge approach (Benhamou and Cornelis
2010, Benhamou 2011).  This function also allows the decomposition of
the utilization distribution into (i) an intensity distribution
reflecting the average time spent by the animal in the habitat
patches, and (ii) a recursion distribution reflecting the number of
visits of the animal in the habitat patches (Benhamou and
Riotte-Lambert, 2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BRB(ltr, D, Tmax, Lmin, hmin, type=c("UD","ID", "RD"), radius = NULL,
    maxt = NULL, filtershort = TRUE, habitat = NULL, activity = NULL,
    grid = 200, b=FALSE, same4all=FALSE, extent=0.5, tau = NULL,
    boundary=NULL) 

BRB.D(ltr, Tmax = NULL, Lmin = NULL, habitat = NULL, activity = NULL)

BRB.likD(ltr, Dr=c(0.1,100),
         Tmax = NULL, Lmin = NULL,
         habitat = NULL, activity = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ltr</code></td>
<td>

<p>an object of class <code>ltraj</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>

<p>a number corresponding to the diffusion parameter (in squared
"units" per second, where "units" denote the units of the relocation
coordinates) used for the estimation.  Alternatively this parameter
may be an object of class <code>DBRB</code> returned by the function
<code>BRB.D</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dr</code></td>
<td>

<p>a vector of length two giving the lower and upper limits of the
diffusion coefficient, within which the maximum likelihood could be
found.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tmax</code></td>
<td>

<p>the maximum duration (in seconds) allowed for a step built by successive
relocations.  All steps characterized by a duration dt greater than
<code>Tmax</code> are not taken into account in the calculations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lmin</code></td>
<td>

<p>the minimum distance (in units of the coordinates) between successive 
relocations, defining intensive use or resting (See details).  The
distance should be specified in units of the relocation coordinates
(i.e. in metres if they are specified in metres).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmin</code></td>
<td>

<p>The minimum smoothing parameter (in units of the relocations
coordinates), applied to all recorded relocations. See details for a
description of this parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>The type of distribution expected by the user: <code>"UD"</code> returns
the utilization distribution using the approach described by
Benhamou and Cornelis (2010).  <code>"ID"</code> returns the intensity
distribution described in Benhamou and Riotte-Lambert (2012), i.e. a
distribution reflecting the average time spent in habitat patches.
<code>"RD"</code> returns the recursion distribution described in Benhamou
and Riotte-Lambert (2012), i.e. a distribution reflecting the number
of visits in habitat patches.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>

<p>If <code>type = "ID"</code> or <code>"RD"</code>, the radius of the patches (in
units of the relocation coordinates) used in the calculation of the
residence time or the number of visits.  If <code>NULL</code>, the radius
is set to <code>3*hmin</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxt</code></td>
<td>

<p>If <code>type = "ID"</code> or <code>"RD"</code>, maximum time threshold (in
seconds) that the animal is allowed to spend outside the patch
before that we consider that the animal actually left the patch (see
<code>?residenceTime</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filtershort</code></td>
<td>

<p>logical indicating the behaviour of the function
when the length of a step is lower than <code>Lmin</code> (see details).
It must be set to TRUE if track segments shorter than
Lmin are assumed to correspond to resting periods, which thereby
will be filtered out systematically, or to FALSE to take these short
track segments into account when not associated to resting (animals
active without moving more than Lmin). They then will be given a
null diffusion coefficient.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>habitat</code></td>
<td>

<p>optionally, an object of class <code>SpatialPixelsDataFrame</code> with
one column describing the habitat type on the area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activity</code></td>
<td>

<p>optionally, a character indicating the name of the variable in the
infolocs component of <code>ltr</code> indicating the proportion of time
between relocation i and relocation i+1 during which the animal was
active (Users of adehabitatLT prior to version 0.3 should read the
section Warning below).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>

<p>a number giving the size of the grid on which the UD should
be estimated.  Alternatively, this parameter may be an object
of class <code>SpatialPixels</code>, or a list of objects of class
<code>SpatialPixels</code> with as many elements as there are bursts in
<code>ltr</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>logical specifying how relocation and movement variances are
combined.  If <code>TRUE</code>, the relocation variance progressively
merges with the movement component; if <code>FALSE</code>, the relocation
variance has a constant weight (see Benhamou, 2011).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same4all</code></td>
<td>

<p>logical.  if <code>TRUE</code>, the same grid is used for the estimation
of all bursts.  If <code>FALSE</code>, one grid is used per burst.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extent</code></td>
<td>

<p>a value indicating the extent of the grid used for the
estimation (the extent of the grid on the abscissa is equal
to <code>(min(xy[,1]) + extent * diff(range(xy[,1])))</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>interpolation time (tau, in seconds).  Defaults to <code>tmin/10</code>,
where <code>tmin</code> is the minimum duration of a step in <code>ltr</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>

<p>If, not <code>NULL</code>, an object inheriting the class
<code>SpatialLines</code> defining a barrier that cannot be crossed by the
animals. There are constraints on the shape of the barrier that
depend on the smoothing parameter (***see details***)
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>BRB</code> uses the biased random bridge approach 
to estimate the Utilization Distribution of an animal with serial
autocorrelation of the relocations.  This approach is similar to the
Brownian bridge approach (see <code>?kernelbb</code>), with several
noticeable improvements.  Actually, the Brownian bridge approach
supposes that the animal movement is random and purely diffusive
between two successive relocations: it is supposed that the animal
moves in a purely random fashion from the starting relocation and
reaches the next relocation randomly. The BRB approach goes further by
adding an advection component (i.e., a "drift") to the purely
diffusive movement: is is supposed that the animal movement is
governed by a drift component (a general tendency to move in the
direction of the next relocation) and a diffusion component (tendency
to move in other directions than the direction of the drift).
</p>
<p>The BRB approach is based on the biased random walk model.  This model
is the following: at a given time t, the speed of the animal is drawn
from a probability density function (pdf) and the angle between the
step and the east direction is drawn from a circular pdf with given
mean angle and concentration parameters.  A biased random walk occurs
when this angular distribution is not uniform (i.e. there is a
preferred direction of movement).  Now, consider two successive
relocations r1 = (x1, y1) and r2 = (x2, y2) collected respectively at times t1
and t2.  The aim of the Biased Random Bridges approach is to estimate
the pdf that the animal is located at a given place r = (x,y) at time
ti (with t1 &lt; ti &lt; t2), given that it is located at r1,r2 at times
t1,t2, and given that the animal moves according a biased random walk
with an advection component determined by r1 and r2.
</p>
<p>Benhamou (2011) proposed an approximation for this pdf, noting
that it can be approximated by a circular bivariate normal
distribution with mean location corresponding to  (x1 + pi*(x2-x1), y1
+ pi*(y2-y1)), where pi = (ti-t1)/(t2-t1).  The variance-covariance
matrix of this distribution is diagonal, with both diagonal elements
corresponding to the diffusion coefficient D.  This coefficient D can
be estimated using the plug-in method, using the function
<code>BRB.D</code> (for details, see Benhamou, 2011).  Note that the
diffusion parameter <code>D</code> can be estimated for each habitat type is
a habitat map is available.  Note that the function <code>BRB.likD</code>
can be used alternatively to estimate the diffusion coefficient using
the maximum likelihood method.
</p>
<p>An important aspect of the BRB approach is that the drift component is
allowed to change in direction and strength from one step to the
other, but should remain constant during each of them.  For this
reason, it is required to set an upper time threshold <code>Tmax</code>.
Steps characterized by a longer duration are not taken into account
into the estimation of the pdf. This upper threshold should be based
on biological grounds.
</p>
<p>As for the Brownian bridge approach, this conditional pdf based on
biased random walks takes an infinite value at times ti = t1 and ti =
t2 (because, at these times, the relocation of the animal is known
exactly).  Benhamou proposed to circumvent this drawback by
considering that the true relocation of the animal at times t1 and t2
is not known exactly.  He noted: "a GPS fix should be
considered a punctual sample of the possible locations at which the
animal may be observed at that time, given its current motivational
state and history. Even if the recording noise is low, the relocation
variance should therefore be large enough to encompass potential
locations occurring in the same habitat patch as the recorded
location". He proposed two ways to include this "relocation
uncertainty" component in the pdf: (i) either the relocation variance
progressively merges with the movement component, (ii) or the
relocation variance has a constant weight. This is controlled by the
parameter <code>b</code> of the function. In both cases, the minimum
uncertainty over the relocation of an animal is observed for ti = t1
or t2.  This minimum standard deviation corresponds to the parameter
<code>hmin</code>. According to Benhamou and Cornelis, "<code>hmin</code> must be
at least equal to the standard deviation of the localization errors
and also must integrate uncertainty of the habitat map when UDs are
computed for habitat preference analyses. Beyond these technical
constraints, <code>hmin</code> also should incorporate a random component
inherent to animal behavior because any recorded location, even if
accurately recorded and plotted on a reliable map, is just a punctual
sample of possible locations at which the animal may be found at that
time, given its current motivational state and history. Consequently,
hmin should be large enough to encompass potential locations occurring
in the same habitat patch as the recorded location".
</p>
<p>Practically, the BRB approach can be carried out with the help of the
movement-based kernel density estimation (MKDE) developed by Benhamou
and Cornelis (2010).  This method consists in dividing each step i
into Ti/tau intervals, where Ti is the duration of the step (in
seconds) and <code>tau</code> is the interpolation time (in seconds).  A
kernel density estimation is then used to estimate the required pdf,
with a smoothing parameter varying with each interpolated location ri
and corresponding to: hi^2 = hmin^2 + 4pi(1-pi)(hmax^2 -
hmin^2)Ti/Tmax.  In this equation, <code>hmax^2</code> corresponds to
<code>hmin^2+ D*Tmax/2</code> if <code>b</code> is FALSE and to <code>D*Tmax/2</code>
otherwise.  Note that this smoothing parameter may be a 
function of the habitat type where the interpolated relocation occurs
if the diffusion parameters are available for each habitat types.
</p>
<p>The special case where a given step covers a distance lower than
<code>Lmin</code> merits further details.  When the parameter
<code>filtershort = TRUE</code>, it is always assumed that the animal was
resting at this time, and this step is filtered out before the
estimation.  When the parameter <code>filtershort = FALSE</code>, this
assumption is not made.  In this case, the behaviour of the function
depends on the availability of a variable measuring the activity of
the animal (when the name of the variable containing the ai in the
<code>infolocs</code> component is passed as the parameter <code>activity</code>;
see <code>?infolocs</code> for additionnal information on this component).
If the animal was active during the step, the smoothing parameter hi
is set to <code>hmin</code> for this step. This procedure allows to give
more weight to the immediate surroundings of this relocation
(indicating an intensive use of these immediate surroundings).  If the
animal was inactive, then the animal was resting and the step is
filtered out before the estimation.  Note however that activity value
may sometimes be relatively high while the animal is resting, e.g. if
disturbed by flies, possibly requiring manual correction of activity
values based on the distance moved between relocations).
</p>
<p>If no activity variable is available and <code>filtershort = FALSE</code>,
it is always suppose that the animal was active between the two
relocations, the step is not filtered out and the
smoothing parameter hi is set to <code>hmin</code> for this step.
</p>
<p>The parameter <code>boundary</code> allows to define a barrier that cannot
be crossed by the animals.  When this parameter is
set, the method described by Benhamou and Cornelis (2010) for
correcting boundary biases is used.  The boundary can possibly be
defined by several nonconnected lines, each one being built by several
connected segments. Note that there are constraints on these segments
(not all kinds of boundary can be defined): (i) each segment length
should at least be equal to <code>3*h</code> (the size of "internal lane"
according to the terminology of Benhamou and Cornelis), (ii) the angle
between two line segments should be greater that <code>pi/2</code> or lower
that <code>-pi/2</code>.  The UD of all the pixels located within a
band defined by the boundary and with a width equal to <code>6*h</code>
("external lane") is set to zero.
</p>
<p>Benhamou and Riotte-Lambert (2012) showed that the space use at any
given location, as estimated by this approach, can be seen as the
product between the mean residence time per visit times the number of
visits of the location.  They proposed an approach allowing the
decomposition of the UD into two components: (i) the intensity
distribution reflecting this average residence time and (ii) a
recursion distribution reflecting the number of visits.  This function
allows to estimate these two components, by setting the argument
<code>type</code> to <code>"ID"</code> and <code>"RD"</code> respectively.  
</p>
<p>Note that all the methods available to deal with objects of class
<code>estUDm</code> are available to deal with the results of the function
<code>BRB</code> (see <code>?kernelUD</code>).
</p>


<h3>Value</h3>

<p><code>BRB</code> returns an object of class <code>estUDm</code> when the UD is
estimated for several animals, and <code>estUD</code> when only one animal
is studied.
</p>
<p><code>BRB.D</code> and <code>BRB.likD</code> returns a list of class <code>DBRB</code>,
with one component per burst containing a data frame with the
diffusion parameters.
</p>


<h3>Warning</h3>

<p>Users of the version 0.2 of adehabitatHR should be careful that there
was a slight inconsistency in the package design: whereas all the
parameters characterizing the steps in an object of class
<code>"ltraj"</code> (e.g. <code>dist, dx, dy</code>) describe the step between
relocations i and i+1, it was expected for <code>BRB</code> that the
activity described the proportion of activity time between relocation
i-1 and i.  This inconsistency has now been corrected since version
0.3.
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>, based on a C
translation of the Pascal source code of the program provided by Simon
Benhamou.
</p>


<h3>References</h3>

<p>Benhamou, S. (2011) Dynamic approach to space and habitat use
based on biased random bridges <em>PLOS One</em>, <b>6</b>, 1–8.
</p>
<p>Benhamou, S. and Cornelis, D. (2010) Incorporating Movement Behavior
and Barriers to Improve Biological Relevance of Kernel Home Range
Space Use Estimates. <em>Journal of Wildlife Management</em>, <b>74</b>,
1353–1360.
</p>
<p>Benhamou, S. and Riotte-Lambert, L. (2012) Beyond the Utilization
Distribution: Identifying home range areas that are intensively
exploited or repeatedly visited. <em>Ecological Modelling</em>,
<b>227</b>,  112–116.
</p>


<h3>See Also</h3>

<p><code>kernelbb</code> for the Brownian bridge kernel estimation,
<code>kernelUD</code> and <code>estUD-class</code> for additional
information about objects of class <code>estUDm</code> and <code>estUD</code>,
<code>infolocs</code> for additional information about the
<code>infolocs</code> component, <code>as.ltraj</code> for additional
information about the class <code>ltraj</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Example dataset used by Benhamou (2011)
data(buffalo)

## The trajectory:
buffalo$traj

## The habitat map:
buffalo$habitat

## Show the dataset
plot(buffalo$traj, spixdf = buffalo$habitat)

## Estimate the diffusion component for each habitat type
## Using the plug-in method
vv &lt;- BRB.D(buffalo$traj, Tmax = 180*60, Lmin = 50,
            habitat = buffalo$habitat, activ = "act")

vv

## Note that the values are given here as m^2/s, whereas
## they are given as m^2/min in Benhamou (2011). The
## values in m^2 per min are:
vv[[1]][,2]*60

## Approximately the same values, with slight differences due to
## differences in the way the program of Benhamou (2011) and the present
## one deal with the relocations occurring on the boundary between two
## different habitat types
## Note that an alternative estimation of the Diffusion coefficient
## could be found using maximum likelihood
vv2 &lt;- BRB.likD(buffalo$traj, Tmax = 180*60, Lmin = 50,
                habitat = buffalo$habitat, activ = "act")
vv2
vv[[1]][,2]*60


## Estimation of the UD with the same parameters as those chosen by
## Benhamou (2011)
ud &lt;- BRB(buffalo$traj, D = vv, Tmax = 180*60, tau = 300, Lmin = 50, hmin=100,
          habitat = buffalo$habitat, activity = "act", grid = 50, b=0,
          same4all=FALSE, extent=0.5)
ud

## Show the UD.
image(ud)

## Not run: 
## Example of the decomposition of the UD into a recursion distribution
## and a intensity distribution (Benhamou and Riotte-Lambert 2012).
##
## 1. Intensity Distribution using the same parameters as Benhamou and
## Riotte-Lambert (2012)

id &lt;- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "ID",
          hmin=100, radius = 300, maxt = 2*3600, activity="act", filtershort=FALSE,
          grid = 200, extent=0.1)

rd &lt;- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, type = "RD",
          hmin=100, radius = 300, maxt = 2*3600, activity="act", filtershort=FALSE,
          grid = 200, extent=0.1)

ud &lt;- BRB(buffalo$traj, D = 440/60, Tmax = 3*3600, Lmin = 50, 
          hmin=100, radius = 300, maxt = 2*3600, activity="act", filtershort=FALSE,
          grid = 200, extent=0.1)

par(mfrow = c(2,2), mar=c(0,0,2,0))
image(getvolumeUD(id))
title("ID")
image(getvolumeUD(rd))
title("RD")
image(getvolumeUD(ud))
title("UD")

## End(Not run)




</code></pre>


</div>