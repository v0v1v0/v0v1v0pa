<div class="container">

<table style="width: 100%;"><tr>
<td>issj.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate open distance sampling data for the Island Scrub Jays
</h2>

<h3>Description</h3>

<p>Function to simulate open distance sampling data for the Island Scrub Jays, based on Sollmann et al (2015).
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">issj.sim(B, db, lam, sigma, phi, gamma, npoints, nyrs, nbsize = -1.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>Radius of the circle sampled; a site is a circle of radius B around a point.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db</code></td>
<td>

<p>Distance categories; a vector of cut points from 0 to B inclusive.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>

<p>Expected abundance per site, a vector of length <code>nsites</code> or an <code>nsites x 1</code> matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Scale parameter of the half-normal detection function at each site,  a vector of length <code>nsites</code> or an <code>nsites x 1</code> matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>Survival probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>Recruitment rate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>

<p>Number of sites where point counts are conducted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyrs</code></td>
<td>

<p>Number of years
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbsize</code></td>
<td>

<p>Size parameter for the negative binomial distribution used to generate individual counts per site for year 1.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>NcList </code></td>
<td>
<p>A list with one element per year, with distances of all animals from the point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detList </code></td>
<td>
<p>A list with one element per year, a <code>npoints x nbands</code> matrix with the number of animals detected in each distance category for each point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>The (true) number of animals at each point for each year, a <code>nsites x nyears</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cell </code></td>
<td>
<p>The site IDs where point counts are conducted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p><code>npoints x nyears</code> matrix of total detections</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dclass </code></td>
<td>
<p>a vector with the distance class for each animal detected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site </code></td>
<td>
<p>a corresponding vector with the site for each animal detected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsite </code></td>
<td>
<p>the number of sites in the study area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam, phi, gamma, sigma </code></td>
<td>
<p>the values of the corresponding arguments</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, based on Sollmann et al (2015)
</p>


<h3>References</h3>

<p>Sollmann, R., Gardner, B., Chandler, R.B., Royle, J.A., Sillett, T.S. (2015) An open population hierarchical distance sampling model. <em>Ecology</em> 96, 325-331.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.7.1.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A toy example with just 20 sites
set.seed(2015)
tmp &lt;- issj.sim(B = 300,
    db = c(0,50, 100, 150, 200, 250, 300),
    lam = c(3.01, 7.42, 20.51, 1.60, 0.42, 3.42, 8.24, 0.66, 0.32, 0.39, 0.46, 0.52,
      0.63, 0.36, 4.93, 0.47, 2.07, 0.42, 0.48, 0.47),
    sigma = c(110, 91, 70, 114, 135, 101, 88, 130, 133, 134, 134, 135, 131, 135, 100,
      135, 110, 135, 134, 135),
    phi = 0.6, gamma = 0.35,
    npoints = 15, nyrs = 4)
str(tmp)
# Compare the number detected with the true numbers present
with(tmp, cbind(y, N[cell, ]))
</code></pre>


</div>