<div class="container">

<table style="width: 100%;"><tr>
<td>r_environment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an environment</h2>

<h3>Description</h3>

<p>Configure the R environment to be used for training or web service
deployments. When you submit a run or deploy a model, Azure ML builds a
Docker image and creates a conda environment with your specifications from
your <code>Environment</code> object within that Docker container.
</p>
<p>If the <code>custom_docker_image</code> parameter
is not set, Azure ML will build a predefined base image (CPU or GPU
depending on the <code>use_gpu</code> flag) and install any R packages specified in the
<code>cran_packages</code>, <code>github_packages</code>, or <code>custom_url_packages</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">r_environment(
  name,
  version = NULL,
  environment_variables = NULL,
  r_version = NULL,
  rscript_path = NULL,
  snapshot_date = NULL,
  cran_packages = NULL,
  github_packages = NULL,
  custom_url_packages = NULL,
  bioconductor_packages = NULL,
  custom_docker_image = NULL,
  image_registry_details = NULL,
  use_gpu = FALSE,
  shm_size = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>A string of the name of the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>version</code></td>
<td>
<p>A string of the version of the environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>environment_variables</code></td>
<td>
<p>A named list of environment variables names
and values. These environment variables are set on the process where the user
script is being executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_version</code></td>
<td>
<p>The version of R to be installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rscript_path</code></td>
<td>
<p>The Rscript path to use if an environment build is not required.
The path specified gets used to call the user script.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snapshot_date</code></td>
<td>
<p>Date of MRAN snapshot to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cran_packages</code></td>
<td>
<p>A list of <code>cran_package</code> objects to be installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>github_packages</code></td>
<td>
<p>A list of <code>github_package</code> objects to be installed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_url_packages</code></td>
<td>
<p>A character vector of packages to be installed
from local directory or custom URL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bioconductor_packages</code></td>
<td>
<p>A character vector of packages to be installed
from Bioconductor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_docker_image</code></td>
<td>
<p>A string of the name of the Docker image from
which the image to use for training or deployment will be built. If not set,
a predefined Docker image will be used. To use an image from a private Docker
repository, you will also have to specify the <code>image_registry_details</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>image_registry_details</code></td>
<td>
<p>A <code>ContainerRegistry</code> object of the details of
the Docker image registry for the custom Docker image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_gpu</code></td>
<td>
<p>Indicates whether the environment should support GPUs.
If <code>TRUE</code>, a predefined GPU-based Docker image will be used in the environment.
If <code>FALSE</code>, a predefined CPU-based image will be used. Predefined Docker images
(CPU or GPU) will only be used if the <code>custom_docker_image</code> parameter is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shm_size</code></td>
<td>
<p>A string for the size of the Docker container's shared
memory block. For more information, see
<a href="https://docs.docker.com/engine/reference/run/">Docker run reference</a>
If not set, a default value of <code>'2g'</code> is used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>Environment</code> object.
</p>


<h3>Details</h3>

<p>Once built, the Docker image appears in the Azure Container Registry
associated with your workspace, by default. The repository name has the form
<em>azureml/azureml_&lt;uuid&gt;</em>. The unique identifier (<em>uuid</em>) part corresponds to
a hash computed from the environment configuration. This allows the service
to determine whether an image corresponding to the given environment already
exists for reuse.
</p>
<p>If you make changes to an existing environment, such as adding an R package,
a new version of the environment is created when you either submit a run,
deploy a model, or manually register the environment. The versioning allows
you to view changes to the environment over time.
</p>


<h3>Predefined Docker images</h3>

<p>When submitting a training job or deploying a model, Azure ML runs your
training script or scoring script within a Docker container. If no custom
Docker image is specified with the <code>custom_docker_image</code> parameter, Azure
ML will build a predefined CPU or GPU Docker image. The predefine images extend
the Ubuntu 16.04 <a href="https://github.com/Azure/AzureML-Containers">Azure ML base images</a>
and include the following dependencies:
</p>

<table>
<tr>
<td style="text-align: right;">
<strong>Dependencies</strong> </td>
<td style="text-align: right;"> <strong>Version</strong> </td>
<td style="text-align: right;"> <strong>Remarks</strong>
</td>
</tr>
<tr>
<td style="text-align: right;">
azuremlsdk </td>
<td style="text-align: right;"> latest </td>
<td style="text-align: right;"> (from GitHub)</td>
</tr>
<tr>
<td style="text-align: right;">
R </td>
<td style="text-align: right;"> 3.6.0 </td>
<td style="text-align: right;"> -</td>
</tr>
<tr>
<td style="text-align: right;">
Commonly used R packages </td>
<td style="text-align: right;"> - </td>
<td style="text-align: right;"> 80+ of the most popular R packages for
data science, including the IRKernel, dplyr, shiny, ggplot2, tidyr, caret,
and nnet. For the full list of packages included, see
<a href="https://github.com/Azure/azureml-sdk-for-r/blob/master/misc/r-packages-docker.md">here</a>.</td>
</tr>
<tr>
<td style="text-align: right;">
Python </td>
<td style="text-align: right;"> 3.7.0 </td>
<td style="text-align: right;"> -</td>
</tr>
<tr>
<td style="text-align: right;">
azureml-defaults </td>
<td style="text-align: right;"> latest </td>
<td style="text-align: right;"> <code>azureml-defaults</code> contains the
<code>azureml-core</code> and <code>applicationinsights</code> packages of the Python SDK that
are required for tasks such as logging metrics, uploading artifacts, and
deploying models. (from pip)</td>
</tr>
<tr>
<td style="text-align: right;">
rpy2 </td>
<td style="text-align: right;"> latest </td>
<td style="text-align: right;"> (from conda)</td>
</tr>
<tr>
<td style="text-align: right;">
CUDA (GPU image only) </td>
<td style="text-align: right;"> 10.0 </td>
<td style="text-align: right;"> CuDNN (version 7) is also included
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>estimator()</code>, <code>inference_config()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The following example defines an environment that will build the default
# base CPU image.
## Not run: 
r_env &lt;- r_environment(name = 'myr_env',
                       version = '1')

## End(Not run)
</code></pre>


</div>