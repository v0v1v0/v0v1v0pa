<div class="container">

<table style="width: 100%;"><tr>
<td>accuracy_sifter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Accuracy calculation as defined in Engelhardt et al. (2011)</h2>

<h3>Description</h3>

<p>Uses SIFTER's 2011 definition of accuracy, where a protein is tagged as
accurately predicted if the highest ranked prediction matches it.
</p>


<h3>Usage</h3>

<pre><code class="language-R">accuracy_sifter(pred, lab, tol = 1e-10, highlight = "", ...)

## S3 method for class 'aphylo_estimates'
accuracy_sifter(pred, lab, tol = 1e-10, highlight = "", ...)

## Default S3 method:
accuracy_sifter(pred, lab, tol = 1e-10, highlight = "", nine_na = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>A matrix of predictions, or an aphylo_estimates object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab</code></td>
<td>
<p>A matrix of labels (0,1,NA, or 9 if <code>nine_na = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Numeric scalar. Predictions within <code>tol</code> of the max score
will be tagged as the prediction made by the model (see deails).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight</code></td>
<td>
<p>Pattern passed to sprintf used to highlight
predicted functions that match the observed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the method. In the case of <code>aphylo_estimates</code>,
the arguments are passed to <code>predict.aphylo_estimates()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nine_na</code></td>
<td>
<p>Treat 9 as NA.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The analysis is done at the protein level. For each protein, the function
compares the YES annotations of that proteins with the predicted by the model.
The algorithm selects the predicted annotations as those that are within
<code>tol</code> of the maximum score.
</p>
<p>This algorithm doesn't take into account NOT annotations (0s), which are
excluded from the analysis.
</p>
<p>When <code>highlight = ""</code>, no highlight is done.
</p>


<h3>Value</h3>

<p>A data frame with <code>Ntip()</code> rows and four variables. The variables are:
</p>

<ul>
<li>
<p> Gene: Label of the gene
</p>
</li>
<li>
<p> Predicted: The assigned gene function.
</p>
</li>
<li>
<p> Observed: The true set of gene functions.
</p>
</li>
<li>
<p> Accuracy: The measurement of accuracy according to Engelhardt et al. (2011).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(81231)
atree &lt;- raphylo(50, psi = c(0,0), P = 3)
ans &lt;- aphylo_mcmc(atree ~ mu_d + mu_s + Pi)

accuracy_sifter(ans)

</code></pre>


</div>