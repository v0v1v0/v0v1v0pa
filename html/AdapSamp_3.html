<div class="container">

<table style="width: 100%;"><tr>
<td>rCCARS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Concave-Convex Adaptive Rejection Sampling Algorithm</h2>

<h3>Description</h3>

<p>rCCARS generates a sequence of random numbers by the concave-convex adaptive rejection sampling algorithm from target distributions with bounded domain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rCCARS(n, cvformula, ccformula, min, max, sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Desired sample size;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvformula, ccformula</code></td>
<td>
<p>Convex and concave decompositions for -ln(p(x)) where p(x) is the kernal of target density;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min, max</code></td>
<td>
<p>Domain except positive and negative infinity;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp</code></td>
<td>
<p>Supporting set</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Strictly speaking, the concave-convex adaptive rejection sampling algorithm can generate samples from target distributions who have bounded domains. For distributions with unbounded domain, rCCARS can also be used for sampling approximately. For example, if we want draw a sequence from N(0,1) by the concave-convex adaptive rejection sampling algorithm. We know that X~N(0,1) has a so small probability in two tails that we can ingore the parts at both ends. Pr(X&gt;20)=P(X&lt;-20)=2.753624e-89, therefore we can get random numbers approximately from N(0,1) with the bound [-20,20]. Also, you can make this bound large enough to reduce sampling error.
</p>


<h3>Author(s)</h3>

<p>Dong Zhang &lt;<a href="dzhang0716@126.com">dzhang0716@126.com</a>&gt;
</p>


<h3>References</h3>

<p>Teh Y W. Concave-Convex Adaptive Rejection Sampling[J]. Journal of Computational &amp; Graphical Statistics, 2011, 20(3):670-691.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1: Generalized inverse bounded gaussian distribution with lambda=-1 and a=b=2
x&lt;-rCCARS(100,"x+x^-1","2*log(x)",0.001,100,1)
hist(x,breaks=20,probability =TRUE);lines(density(x,bw=0.1),col="red",lwd=2,lty=2)
f &lt;- function(x) {x^(-2)*exp(-x-x^(-1))/0.2797318}
lines(seq(0,5,0.01),f(seq(0,5,0.01)),lwd=2,lty=3,col="blue")

#The following examples are also available;
#But it may take a few minutes to run them.

# Example 2: Expontional bounded distribution
# x&lt;-rCCARS(1000,"x^4","-8*x^2+16",-3,4,c(-2,1))
# hist(x,breaks=30,probability=TRUE);lines(density(x,bw=0.05),col="blue",lwd=2,lty=2)
# f &lt;- function(x) exp(-(x^2-4)^2)/ 0.8974381
# lines(seq(-3,4,0.01),f(seq(-3,4,0.01)),col="red",lty=3,lwd=2)

# Example 3: Makeham bounded distribution
# x&lt;-rCCARS(1000,"x+1/log(2)*(2^x-1)","-log(1+2^x)",0,5,c(1,2,3))
# hist(x,breaks=30,probability=TRUE);lines(density(x,bw=0.05),col="blue",lwd=2,lty=2)
# f &lt;- function(x){(1+2^x)*exp(-x-1/log(2)*(2^x-1))}
# lines(seq(0,5,0.01),f(seq(0,5,0.01)),col="red",lty=3,lwd=2,type="l")

</code></pre>


</div>