<div class="container">

<table style="width: 100%;"><tr>
<td>goodness.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adequacy of models
</h2>

<h3>Description</h3>

<p>This function provides some useful statistics to assess the quality of fit of probabilistic models, including the statistics Cramér-von Mises and Anderson-Darling. These statistics are often used to compare models not fitted. You can also calculate other goodness of fit such as AIC, CAIC, BIC, HQIC and Kolmogorov-Smirnov test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">goodness.fit(pdf, cdf, starts, data, method = "PSO", domain = c(0,Inf),
             mle = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pdf</code></td>
<td>

<p>Probability density function;
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdf</code></td>
<td>

<p>Cumulative distribution function;
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starts</code></td>
<td>

<p>Initial parameters to maximize the likelihood function;
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Data vector;
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method used for minimization of the function <code>-log(likelihood)</code>. The methods supported are: <code>PSO</code> (default), <code>BFGS</code>, <code>Nelder-Mead</code>, <code>SANN</code>, <code>CG</code>. Can also be transmitted only the first letter of the methodology, i.e., <code>P</code>, <code>B</code>, <code>N</code>, <code>S</code> or <code>C</code> respectively;
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>

<p>Domain of probability density function. By default the domain of probability density function is the open interval 0 to infinity.This option must be an vector with two values;  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>

<p>Vector with the estimation maximum likelihood. This option should be used if you already have knowledge of the maximum likelihood estimates. The default is <code>NULL</code>, ie, the function will try to obtain the estimates of maximum likelihoods;   
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>If <code>method = "PSO"</code> or <code>method = "P"</code>, inform the arguments of the <code>pso</code> function. Get details about these arguments into <code>pso</code>. Basically the arguments that should be provided are the vectors <code>lim_inf</code> and <code>lim_sup</code>. The other parameters of the <code>pso</code> function can be informed in the desired configuration. However, may be omitted if the default configuration is sufficient.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>goodness.fit</code> returns statistics KS (Kolmogorov-Smirnov), A (Anderson-Darling), W (Cramér-von Misses). Are also calculated other measures of goodness of fit. These functions are: AIC (Akaike Information Criterion), CAIC (Consistent Akaikes Information Criterion), BIC (Bayesian Information Criterion) and HQIC (Hannan-Quinn information criterion).
</p>
<p>The Kolmogorov-Smirnov test may return <code>NA</code> with a certain frequency. The return <code>NA</code> informs that the statistical <code>KS</code> is not reliable for the data set used. More details about this issue can be obtained from <code>ks.test</code>.
</p>
<p>By default, the function calculates the maximum likelihood estimates. The errors of the estimates are also calculated. In cases that the function can not obtain the maximum likelihood estimates, the change of the values initial, in some cases, resolve the problem. You can also enter with the maximum likelihood estimation if there is already prior knowledge. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>Statistic Cramér-von Misses;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Statistic Anderson Darling;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KS</code></td>
<td>
<p>Kolmogorov Smirnov test;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mle</code></td>
<td>
<p>Maximum likelihood estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CAIC</code></td>
<td>
<p>Consistent Akaikes Information Criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Bayesian Information Criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HQIC</code></td>
<td>
<p>Hannan-Quinn information criterion;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Erro</code></td>
<td>
<p>Standard errors of the maximum likelihood estimates;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Value</code></td>
<td>
<p>Minimum value of the function -log(likelihood);</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Convergence</code></td>
<td>
<p>0 indicates successful completion and 1 indicates that the iteration limit maxit had been reached. More details at <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is not necessary to define the likelihood function or log-likelihood. You only need to define the probability density function and distribution function. 
</p>


<h3>Author(s)</h3>

<p>Pedro Rafael Diniz Marinho <a href="mailto:pedro.rafael.marinho@gmail.com">pedro.rafael.marinho@gmail.com</a>
</p>


<h3>References</h3>

<p>Chen, G., Balakrishnan, N. (1995). A general purpose approximate goodness-of-fit test. Journal of Quality Technology, 27, 154-161.
</p>
<p>Hannan, E. J. and Quinn, B. G. (1979). The Determination of the Order of an Autoregression. Journal of the Royal Statistical Society, Series B, 41, 190-195.
</p>
<p>Nocedal, J. and Wright, S. J. (1999) Numerical Optimization. Springer.
</p>
<p>Sakamoto, Y., Ishiguro, M. and Kitagawa G. (1986). Akaike Information Criterion Statistics. D. Reidel Publishing Company.
</p>


<h3>See Also</h3>

<p>For details about the optimization methodologies may view the functions <code>pso</code> and <code>optim</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Example 1:

data(carbone)

# Exponentiated Weibull - Probability density function.
pdf_expweibull &lt;- function(par,x){
  beta = par[1]
  c = par[2]
  a = par[3]
  a * beta * c * exp(-(beta*x)^c) * (beta*x)^(c-1) * (1 - exp(-(beta*x)^c))^(a-1)
}

# Exponentiated Weibull - Cumulative distribution function.
cdf_expweibull &lt;- function(par,x){
  beta = par[1]
  c = par[2]
  a = par[3]
  (1 - exp(-(beta*x)^c))^a
}

set.seed(0)
result_1 = goodness.fit(pdf = pdf_expweibull, cdf = cdf_expweibull, 
                        starts = c(1,1,1), data = carbone, method = "PSO",
                        domain = c(0,Inf),mle = NULL, lim_inf = c(0,0,0),
                        lim_sup = c(2,2,2), S = 250, prop=0.1, N=50)
             
x = seq(0, 6, length.out = 500)
hist(carbone, probability = TRUE)
lines(x, pdf_expweibull(x, par = result_1$mle), col = "blue")

# Example 2:

pdf_weibull &lt;- function(par,x){
  a = par[1]
  b = par[2]
  dweibull(x, shape = a, scale = b)
}

cdf_weibull &lt;- function(par,x){
  a = par[1]
  b = par[2]
  pweibull(x, shape = a, scale = b)
}

set.seed(0)
random_data2 = rweibull(250,2,2)
result_2 = goodness.fit(pdf = pdf_weibull, cdf = cdf_weibull, starts = c(1,1), data = random_data2,
             method = "PSO", domain = c(0,Inf), mle = NULL, lim_inf = c(0,0), lim_sup = c(10,10),
             N = 100, S = 250)

x = seq(0,ceiling(max(random_data2)), length.out = 500)
hist(random_data2, probability = TRUE)
lines(x, pdf_weibull(par = result_2$mle, x), col = "blue")

# TO RUN THE CODE BELOW, UNCOMMENT THE CODES.

# Example 3:

# Kumaraswamy Beta - Probability density function.
#pdf_kwbeta &lt;- function(par,x){
#  beta = par[1]
#  a = par[2]
#  alpha = par[3]
#  b = par[4]
#  (a*b*x^(alpha-1)*(1-x)^(beta-1)*(pbeta(x,alpha,beta))^(a-1)*
#  (1-pbeta(x,alpha,beta)^a)^(b-1))/beta(alpha,beta) 
#}

# Kumaraswamy Beta - Cumulative distribution function.
#cdf_kwbeta &lt;- function(par,x){
#  beta = par[1]
#  a = par[2]
#  alpha = par[3]
#  b = par[4]
#  1 - (1 - pbeta(x,alpha,beta)^a)^b
#}

#set.seed(0)
#random_data3 = rbeta(150,2,2.2)

#system.time(goodness.fit(pdf = pdf_kwbeta, cdf = cdf_kwbeta, starts = c(1,1,1,1),
#              data = random_data3, method = "PSO", domain = c(0,1), lim_inf = c(0,0,0,0),
#              lim_sup = c(10,10,10,10), S = 200, prop = 0.1, N = 40))


</code></pre>


</div>