<div class="container">

<table style="width: 100%;"><tr>
<td>sim_path</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate the path of a time-inhomogeneous (semi-)Markov process until a maximal time</h2>

<h3>Description</h3>

<p>Simulate the path of a time-inhomogeneous (semi-)Markov process until a maximal time
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_path(i, rates, dists, t = 0, u = 0, tn = Inf, abs = numeric(0), bs = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>The initial state, integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rates</code></td>
<td>
<p>The total transition rates out of states, a function with arguments state (integer), time (numeric), and duration (numeric) returning a rate (numeric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dists</code></td>
<td>
<p>The distribution of marks, a function with arguments state (integer), time (numeric), and duration (numeric) returning a probability vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The initial time, numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>The initial duration (since the last transition), numeric. By default equal to zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tn</code></td>
<td>
<p>The maximal time, numeric. By default equal to inifinity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs</code></td>
<td>
<p>Vector indicating which states are absorbing. By default the last state is absorbing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>Vector of upper bounds on the total transition rates. By default the bounds are determined using optimize, which might only identify a local maximum.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list concerning jump times and states, with the first time being the initial time t and state and the last time being tn (if not absorbed)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
jump_rate &lt;- function(i, t, u){if(i == 1){3*t} else if(i == 2){5*t} else{0}}
mark_dist &lt;- function(i, s, v){if(i == 1){c(0, 1/3, 2/3)} else if(i == 2){c(1/5, 0, 4/5)} else{0}}
sim &lt;- sim_path(sample(1:2, 1), t = 0, tn = 2, rates = jump_rate, dists = mark_dist)
sim
</code></pre>


</div>