<div class="container">

<table style="width: 100%;"><tr>
<td>showCloneHighlight</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Highlight specific clones on an APackOfTheClones ggplot</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
</p>
<p>This is an analogue for <code>scRepertoire::highlightClones</code> that can highlight
certain clonotypes on an APackOfTheClones clonal expansion plot. For most
combinations of the arguments, there will be a ggplot fill legend on the
right side that correspond to each (existing) clonotype.
</p>


<h3>Usage</h3>

<pre><code class="language-R">showCloneHighlight(
  apotc_ggplot,
  clonotype,
  color_each = TRUE,
  default_color = "#808080",
  scale_bg = 1,
  fill_legend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>apotc_ggplot</code></td>
<td>
<p>A ggplot object that is the output of <code>APOTCPlot()</code> or
<code>vizAPOTC()</code> of an APackOfTheClones plot to be highlighted on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clonotype</code></td>
<td>
<p>character vector of the sequence(s) to highlight. Note
that it must be of the clonecall of the code that created the plot. A
warning will be shown if any of the sequences are not present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_each</code></td>
<td>
<p>Either a logical of length 1, or a character(s). It is
<code>TRUE</code> by default, which assigns a unique default ggplot color to each
highlighted clone. If <code>FALSE</code>, each highlighted clone will retain its
current color and no legend based on color is shown. A possible application
here is to simply gauge the distribution of any shared clone.
It can also indicate the uniform color of each highlighted clone: if it is
a character of length 1, all highlighted clones will be of that color.
Else it must be a character vector of the same length as
<code>clonotype</code>, with each color corresponding to the clone. Here is a suitable
place to use any palette function from the many other CRAN palette packages
such as <code>"viridis"</code> or <code>"RColorBrewer"</code>. Note that currently, the user must
ensure <code>clonotype</code> contains only unique characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>default_color</code></td>
<td>
<p>A character of length 1 or <code>NULL</code> indicating the color
of non-highlighted clones. If <code>NULL</code>, all un-highlighted sequences will
retain their original color in <code>sc.data</code>. Else, if it is a character, it
should be a valid color that all un-highlighted clones are. Defaults to the
hex code for gray.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale_bg</code></td>
<td>
<p>A positive numeric. Scales the brightness value of each color
of the non-highlighted clones by itself as a scaling factor. Defaults to 1
which will not alter the current brightness. Note that if
<code>color_each = FALSE</code> and <code>default_color = NULL</code>, this is equivalent to not
highlighting any clones - in this case, it may be useful to alter <code>scale_bg</code>
slightly so that the non-highlighted clones are darkened/brightened.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_legend</code></td>
<td>
<p>logical indicating whether a ggplot legend of the "fill"
of each clonotype should be displayed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under the hood, this function simply mutates the plotting data.frame under
<code style="white-space: pre;">⁠$data⁠</code> in the ggplot object, and operates on a column named <code>color</code>.
</p>
<p>Note that if <code>color_each = FALSE</code> and <code>default_color = NULL</code>, this is
equivalent to simply not highlighting anything and a warning will be shown.
</p>


<h3>Value</h3>

<p>A ggplot object with the data modified to the highlighted colors
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
data("combined_pbmc")

# piping the plot can be nice to read syntactically -
# By default, assigns unique colors to highlights and everything else is gray
vizAPOTC(combined_pbmc, clonecall = "aa", verbose = FALSE) %&gt;%
    showCloneHighlight("CASLSGSARQLTF_CASSSTVAGEQYF")

# one useful application is to highlight shared clones - beware that the
# clonotype sequences may get extremely long in the legend
shared_aa_clones &lt;- names(getSharedClones(combined_pbmc, clonecall = "aa"))
vizAPOTC(combined_pbmc, clonecall = "aa", verbose = FALSE) %&gt;%
    showCloneHighlight(shared_aa_clones)

</code></pre>


</div>