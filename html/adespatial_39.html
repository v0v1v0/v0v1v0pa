<div class="container">

<table style="width: 100%;"><tr>
<td>msr.varipart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran spectral randomization for variation partitioning</h2>

<h3>Description</h3>

<p>The functions allows to evaluate the significance and estimate parts in
variation partitioning using Moran Spectral Randomization (MSR) as a
spatially-constrained null model to account for spatial autocorrelation in
table X. Hence, this function provides a variation partioning adujsted for
spurious correlation due to spatial autocorrelation in both the response and
one explanatory matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'varipart'
msr(
  x,
  listwORorthobasis,
  nrepet = x$test$rep[1],
  method = c("pair", "triplet", "singleton"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object generated by the <code>varipart</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listwORorthobasis</code></td>
<td>
<p>an object of the class <code>listw</code> (spatial weights)
created by the functions of the <span class="pkg">spdep</span> package or an object of class
<code>orthobasis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an <code>integer</code> indicating the number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an character specifying which algorithm should be used to
produce spatial replicates (see <code>msr.default</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments of the <code>msr.default</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function corrects the biases due to spatial autocorrelation by
using MSR procedure to produce environmental predictors that preserve the
spatial autocorrelation and the correlation structures of the original
environmental variables while being generated independently of species
distribution.
</p>


<h3>Value</h3>

<p>An object of class <code>varipart</code> randomized replicates.
</p>


<h3>Author(s)</h3>

<p>(s) Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a> and Sylvie
Clappe <a href="mailto:sylvie.clappe@univ-lyon1.fr">sylvie.clappe@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Clappe, S., Dray S. and P.R. Peres-Neto (2018) Beyond
neutrality: disentangling the effects of species sorting and spurious
correlations in community analysis. Ecology 99:1737-1747.
</p>
<p>Wagner, H. H., and S. Dray (2015). Generating spatially constrained null models
for irregularly spaced data using Moran spectral randomization methods.
Methods in Ecology and Evolution 6:1169-1178.
</p>


<h3>See Also</h3>

<p><code>msr.default</code>, <code>varipart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ade4)
library(spdep)
data(mafragh)
## Performing standard variation partitioning
dudiY &lt;- dudi.pca(mafragh$flo, scannf = FALSE, scale = FALSE)
mafragh.lw &lt;- nb2listw(mafragh$nb)
me &lt;- mem(mafragh.lw, MEM.autocor = "positive")
vprda &lt;- varipart(dudiY, mafragh$env, me, type = "parametric")

## Adjust estimation and compute p-value by msr methods
vprda.msr &lt;- msr(vprda, mafragh.lw, nrepet=99)
vprda.msr
</code></pre>


</div>