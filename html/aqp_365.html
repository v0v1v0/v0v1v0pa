<div class="container">

<table style="width: 100%;"><tr>
<td>warpHorizons</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Inflate / Deflate Horizon Thickness</h2>

<h3>Description</h3>

<p>This function applies a warping factor to the horizons of a single-profile <code>SoilProfileCollection</code> object. Warping values &gt;1 will inflate horizon thickness, values &lt;1 will deflate horizon thickness.
</p>


<h3>Usage</h3>

<pre><code class="language-R">warpHorizons(x, fact, updateProfileID = TRUE, suffix = "-w")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>SoilProfileCollection</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fact</code></td>
<td>
<p>numeric or character; warping factor specified as a single numeric value, vector of numeric values (length = nrow(x)), or column name of a horizon level attribute containing numeric values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>updateProfileID</code></td>
<td>
<p>logical; modify profile IDs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffix</code></td>
<td>
<p>character; suffix added to profile IDs when <code>updateProfileID = TRUE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a modified version of <code>x</code>, <code>SoilProfileCollection</code> object
</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette and S.W. Salley
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# create an example profile
s &lt;- quickSPC('p1:AA|Bt1Bt1Bt1|Bt2Bt2B|Bt3|Cr|RRRRR')

# warp each horizon
# values &gt; 1: inflation
# values &lt; 1: deflation (erosion / compaction)
s.w &lt;- warpHorizons(s, fact = c(1.3, 0.7, 0.8, 1, 1, 1))

# combine original + warped
x &lt;- combine(s, s.w)

# compute profile bottom depths
.bottoms &lt;- x[, , .LAST, .BOTTOM]

# change in total depth after warping
# used to vertically offset the warped profile
.yoff &lt;- c(0, .bottoms[1] - .bottoms[2])

# depths for line segments connecting horizon tops
.y1 &lt;- x[1, , .TOP]
.y2 &lt;- x[2, , .TOP] + .yoff[2]

# sketches
# can't automatically add a depth axis
par(mar = c(0.5, 0, 0, 2))
plotSPC(
  x, 
  name.style = 'center-center', 
  cex.names = 0.8, 
  width = 0.2, 
  max.depth = 150, 
  depth.axis = list(line = -3), 
  y.offset = .yoff
)

# illustrate warping with arrows
arrows(x0 = 1 + 0.25, y0 = .y1, x1 = 2 - 0.25, y1 = .y2, len = 0.1, col = 2)

# manually add depth axis
axis(side = 4, line = -3.5, las = 1, at = seq(from = 0, to = 150, by = 25))


# apply to multiple profiles
# text-based template
.template &lt;- c(
'P1:AAA|BwBwBwBw|CCCCCCC|CdCdCdCd',
'P2:ApAp|AA|E|BhsBhs|Bw1Bw1|CCCCC',
'P3: A|Bt1Bt1Bt1|Bt2Bt2Bt2|Bt3|Cr|RRRRR'
)

# each horizon label is '10' depth-units (default)
s &lt;- quickSPC(.template)

# random warping factor, by horizon
s$f &lt;- runif(n = nrow(s), min = 0.8, max = 1.2)

# warp horizons by profile, result is a list of SPCs
s.w &lt;- profileApply(s, FUN = warpHorizons, fact = 'f')

# flatten list -&gt; SoilProfileCollection
s.w &lt;- combine(s.w)

# combine with original SPC
x &lt;- combine(s, s.w)

# sketches 
par(mar = c(0.5, 0, 0, 2.5))
plotSPC(
  x,
  name.style = 'center-center',
  cex.names = 0.8,
  width = 0.3,
  max.depth = 165,
  depth.axis = list(line = -2)
)


</code></pre>


</div>