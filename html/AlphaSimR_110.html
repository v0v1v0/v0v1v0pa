<div class="container">

<table style="width: 100%;"><tr>
<td>setPhenoProgTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set progeny test as phenotype</h2>

<h3>Description</h3>

<p>Models a progeny test of individuals in 'pop'. Returns 'pop' with a phenotype
representing the average performance of their progeny. The phenotype is generated
by mating individuals in 'pop' to randomly chosen individuals in testPop a
number of times equal to 'nMatePerInd'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setPhenoProgTest(
  pop,
  testPop,
  nMatePerInd = 1L,
  use = "pheno",
  h2 = NULL,
  H2 = NULL,
  varE = NULL,
  corE = NULL,
  reps = 1,
  fixEff = 1L,
  p = NULL,
  onlyPheno = FALSE,
  simParam = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>an object of <code>Pop-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testPop</code></td>
<td>
<p>an object of <code>Pop-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMatePerInd</code></td>
<td>
<p>number of times an individual in 'pop' is mated to an
individual in testPop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>true genetic value (<code>gv</code>) or phenotypes (<code>pheno</code>, default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>a vector of desired narrow-sense heritabilities for
each trait. See details in <code>setPheno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>a vector of desired broad-sense heritabilities for
each trait. See details in <code>setPheno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varE</code></td>
<td>
<p>error (co)variances for traits.
See details in <code>setPheno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corE</code></td>
<td>
<p>an optional matrix for correlations between errors.
See details in <code>setPheno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>number of replications for phenotype.
See details in <code>setPheno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixEff</code></td>
<td>
<p>fixed effect to assign to the population. Used
by genomic selection models only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p-value for the environmental covariate
used by GxE traits. If NULL, a value is
sampled at random.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyPheno</code></td>
<td>
<p>should only the phenotype be returned, see return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParam</code></td>
<td>
<p>an object of <code>SimParam</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The reps parameter is for convenient representation of replicated data.
It was intended for representation of replicated yield trials in plant
breeding programs. In this case, varE is set to the plot error and
reps is set to the number plots per entry. The resulting phenotype
would reflect the mean of all replications.
</p>


<h3>Value</h3>

<p>Returns an object of <code>Pop-class</code> or
a matrix if onlyPheno=TRUE
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create founder haplotypes
founderPop = quickHaplo(nInd=10, nChr=1, segSites=10, inbred=TRUE)

#Set simulation parameters
SP = SimParam$new(founderPop)

SP$addTraitA(10)

#Create two populations of 5 individuals
pop1 = newPop(founderPop[1:5], simParam=SP)
pop2 = newPop(founderPop[6:10], simParam=SP)

#Set phenotype according to a progeny test
pop3 = setPhenoProgTest(pop1, pop2, use="gv", simParam=SP)

</code></pre>


</div>