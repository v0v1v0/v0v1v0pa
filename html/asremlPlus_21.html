<div class="container">

<table style="width: 100%;"><tr>
<td>asremlPlus-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Augments 'ASReml-R' in Fitting Mixed Models and Packages
Generally in Exploring Prediction Differences
</h2>

<h3>Description</h3>

<p>Assists in automating the selection of terms to include in mixed models when  
  'asreml' is used to fit the models. Procedures are available for choosing models that 
  conform to the hierarchy or marginality principle, for fitting and choosing between 
  two-dimensional spatial models using correlation, natural cubic smoothing spline and 
  P-spline models. A history of the fitting of a sequence of models is kept in a data frame. 
  Also used to compute functions and contrasts of, to investigate differences between and 
  to plot predictions obtained using any model fitting function. The content  falls into 
  the following natural groupings: (i) Data, (ii) Model modification functions, (iii) Model 
  selection and description functions, (iv) Model diagnostics and simulation functions, 
  (v) Prediction production and presentation functions, (vi) Response transformation 
  functions, (vii) Object manipulation functions, and (viii) Miscellaneous functions 
  (for further details see 'asremlPlus-package' in help). The 'asreml' package provides a 
  computationally efficient algorithm for fitting a wide range of linear mixed models using 
  Residual Maximum Likelihood. It is a commercial package and a license for it can be 
  purchased from 'VSNi' &lt;https://vsni.co.uk/&gt; as 'asreml-R', who will supply a zip file 
  for local installation/updating (see &lt;https://asreml.kb.vsni.co.uk/&gt;). It is not needed 
  for functions that are methods for 'alldiffs'  and 'data.frame' objects. The package 
  'asremPlus' can also be installed from &lt;http://chris.brien.name/rpackages/&gt;.
</p>
<p><b>Version:</b> 4.4.38
</p>
<p><b>Date:</b> 2024-08-19
</p>


<h3>Index</h3>

<p>Note that many of the function below are S3 methods so that the suffix can be omitted. Of course, whether or not the suffix is omitted, the object supplied to the first argument must be of the class specified by the suffix.  For example <code>getFormulae.asreml</code> is a <code>getFormulae</code> method for an <code>asreml.object</code> and so  <code>.asreml</code> can be omitted and the object supplied to the first argument must be of class <code>asreml</code>.
</p>

<table>
<tr>
<td style="text-align: left;">
(i) Data </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>Oats.dat</code> 
      </td>
<td style="text-align: left;">  Data for an experiment to investigate nitrogen response of </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> 3 oats varieties. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>Wheat.dat</code> 
      </td>
<td style="text-align: left;">  Data for an experiment to investigate 25 varieties of </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;">  wheat. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>WaterRunoff.dat</code>
      </td>
<td style="text-align: left;"> Data for an experiment to investigate the quality of </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> water runoff over time</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(ii) Model modification </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>addSpatialModel.asrtests</code>
      </td>
<td style="text-align: left;"> Adds, to a supplied model, a spatial model that accounts for </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> local spatial variation.      </td>
</tr>
<tr>
<td style="text-align: left;">
<code>addSpatialModelOnIC.asrtests</code>
      </td>
<td style="text-align: left;"> Uses information criteria to decide whether to add a spatial </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> model to account for local spatial variation. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>changeTerms.asrtests</code>
      </td>
<td style="text-align: left;"> Adds and drops terms from one or both of the fixed or random </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> model, replaces the residual (rcov) model with a new model </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> and changes bounds or initial values of terms.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>iterate.asrtests</code> 
      </td>
<td style="text-align: left;"> Subject the fitted asreml.obj stored in an asrtests.object </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;">  to further iterations of the fitting process. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>newfit.asreml</code> 
      </td>
<td style="text-align: left;"> Refits an <code>asreml</code> model with changed arguments by extracting, </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> modifying and evaluating its <code>call</code>  - an alternate to </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> update.asreml. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>reparamSigDevn.asrtests</code>
       </td>
<td style="text-align: left;"> Reparamterizes each random (deviations) term </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> involving 'devn.fac' to a fixed term and ensures </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> that the same term, with 'trend.num' replacing </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> 'devn.fac', is included if any other term with </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> 'trend.num' is included in 'terms'. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>rmboundary.asrtests</code> 
       </td>
<td style="text-align: left;"> Removes any boundary or singular variance components </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> from the fit stored in 'asreml.obj' and records their </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> removal in an <code>asrtests.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>setvarianceterms.call</code> 
       </td>
<td style="text-align: left;"> Allows the setting of bounds and initial values </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> for terms in the 'random' and 'residual' arguments of an </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> 'asreml' call. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(iii) Model selection and description </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>addto.test.summary</code>
       </td>
<td style="text-align: left;"> Adds a row to a <code>test.summary</code> <code>data.frame</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>changeModelOnIC.asrtests</code>
       </td>
<td style="text-align: left;"> Uses information criteria to decide whether to change an </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> already fitted model. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>chooseModel.asrtests</code>
       </td>
<td style="text-align: left;"> Determines and records the set of significant terms using an </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> <code>asrtests.object</code>, taking into account the hierarchy </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> or marginality relations of the terms..</td>
</tr>
<tr>
<td style="text-align: left;">
<code>chooseModel.data.frame</code>
       </td>
<td style="text-align: left;"> Determines the set of significant terms from results stored </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> in a <code>data.frame</code>, taking into account the marginality  </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> relations of terms and recording the tests used in a </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> <code>data.frame</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>chooseSpatialModelOnIC.asrtests</code>
       </td>
<td style="text-align: left;"> Uses information criteria to choose the best fitting </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> spatial model for accounting for local spatial variation. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>getTestPvalue.asrtests</code>
       </td>
<td style="text-align: left;"> Gets the p-value for a test recorded in the test.summary </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> data.frame of an <code>asrtests.object</code>.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>infoCriteria.asreml</code>
       </td>
<td style="text-align: left;"> Computes AIC and BIC for models. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>infoCriteria.list</code>
       </td>
<td style="text-align: left;"> Computes AIC and BIC for models. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>R2adj.asreml</code>
       </td>
<td style="text-align: left;"> Calculates the adjusted coefficient of determination for a </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> specified combination of fixed and random terms.     </td>
</tr>
<tr>
<td style="text-align: left;">
<code>recalcWaldTab.asrtests</code>
       </td>
<td style="text-align: left;"> Recalculates the denDF, F.inc and P values for a table </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> of Wald test statistics obtained using 'wald.asreml'. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>REMLRT.asreml</code> 
       </td>
<td style="text-align: left;"> Performs a REML ratio test. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>bootREMLRT.asreml</code> 
       </td>
<td style="text-align: left;"> Performs a REML ratio test using the parametric </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> bootstrap. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>testranfix.asrtests</code>
       </td>
<td style="text-align: left;"> Tests for a single fixed or random term in model </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> fitted using 'asreml' and records the result in an </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;">  <code>asrtests.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>testresidual.asrtests</code>
       </td>
<td style="text-align: left;"> Fits a new residual formula using 'asreml', tests </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> whether the change is significant and records the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> result in an <code>asrtests.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>testswapran.asrtests</code>
       </td>
<td style="text-align: left;"> Tests, using a REMLRT, the significance of the difference </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> between the current random model and one in which oldterms </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> are dropped and newterms are added. The result is recorded </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> in an <code>asrtests.object</code>.</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(iv) Model diagnostics and simulation</td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>plotVariofaces</code>
       </td>
<td style="text-align: left;"> Plots empirical variogram faces, including envelopes, </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> from supplied residuals as described by Stefanova, Smith </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> &amp; Cullis (2009). </td>
</tr>
<tr>
<td style="text-align: left;">
<code>variofaces.asreml</code>
       </td>
<td style="text-align: left;"> Calculates and plots empirical variogram faces, including </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> envelopes, as described by Stefanova, Smith &amp; Cullis (2009). </td>
</tr>
<tr>
<td style="text-align: left;">
<code>estimateV.asreml</code>
       </td>
<td style="text-align: left;"> Forms the estimated variance, random or residual matrix for </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> the observations from the variance parameter estimates. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>simulate.asreml</code>
       </td>
<td style="text-align: left;"> Produce sets of simulated data from a multivariate normal </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> distribution and save quantities related to the simulated data. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(v) Prediction production and presentation </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>addBacktransforms.alldiffs</code>
       </td>
<td style="text-align: left;"> Adds or recalculates the backtransforms component of an </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> <code>alldiffs.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>allDifferences.data.frame</code>
       </td>
<td style="text-align: left;"> Using supplied predictions and standard errors of pairwise </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> differences or the variance matrix of predictions, forms </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> all pairwise differences between the set of predictions, and </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> p-values for the differences. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>exploreLSDs</code>
       </td>
<td style="text-align: left;"> Explores the computed LSD values for pairwise differences </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> between predictions.    </td>
</tr>
<tr>
<td style="text-align: left;">
<code>linTransform.alldiffs</code> 
       </td>
<td style="text-align: left;"> Calculates a linear transformation of the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> predictions stored in an <code>alldiffs.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>pairdiffsTransform.alldiffs</code> 
       </td>
<td style="text-align: left;"> Calculates the differences between nominated pairs of </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> predictions stored in an <code>alldiffs.object</code> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>pickLSDstatistics</code>
       </td>
<td style="text-align: left;"> Pick LSDstatistics whose values minimize the number of </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> errors in pairwise comparisons of predictions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotLSDerrors.data.frame</code>
       </td>
<td style="text-align: left;"> Plots a map of the supplied errors that occur in using the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> computed LSD values for pairwise differences between </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> predictions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotLSDerrors.alldiffs</code>
       </td>
<td style="text-align: left;"> Plots a map of the errors that occur in using the computed </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> LSD values for pairwise differences between predictions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotLSDs.data.frame</code>
       </td>
<td style="text-align: left;"> Plots a heat map of computed LSD values for pairwise </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> differences between predictions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotLSDs.alldiffs</code>
       </td>
<td style="text-align: left;"> Plots a heat map of computed LSD values for pairwise </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> differences between predictions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotPredictions.data.frame</code>
       </td>
<td style="text-align: left;"> Plots the predictions for a term, possibly with </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> error bars. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotPvalues.alldiffs</code>
       </td>
<td style="text-align: left;"> Plots the p-values in the p.differences components </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> of an <code>alldiffs.object</code> as a heat map. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>plotPvalues.data.frame</code>
       </td>
<td style="text-align: left;"> Plots the p-values in data.frame as a heat map.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>predictPlus.asreml</code>
       </td>
<td style="text-align: left;"> Forms the predictions and associated statistics for </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> a term, using an asreml object and a wald.tab and </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> taking into account that a numeric vector </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> and a factor having parallel values may occur in the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> model. It stores the results in an object of class </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> 'alldifffs' and may print the results. It can be </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> when there are not parallel values.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>predictPresent.asreml</code>
       </td>
<td style="text-align: left;"> Forms the predictions for each of one or more terms </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> and presents them in tables and/or graphs. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>ratioTransform.alldiffs</code> 
       </td>
<td style="text-align: left;"> Calculates the ratios of nominated pairs of predictions </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> stored in an <code>alldiffs.object</code>.   </td>
</tr>
<tr>
<td style="text-align: left;">
<code>recalcLSD.alldiffs</code> 
       </td>
<td style="text-align: left;"> Adds or recalculates the <code>LSD.frame</code> that is a </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> component of an <code>alldiffs.object</code>.           </td>
</tr>
<tr>
<td style="text-align: left;">
<code>redoErrorIntervals.alldiffs</code> 
       </td>
<td style="text-align: left;"> Adds or replaces the error intervals stored in the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> prediction component of an <code>alldiffs.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>renewClassify.alldiffs</code>
       </td>
<td style="text-align: left;"> Renews the components in an <code>alldiffs.object</code> </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> according to a new classify. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sort.alldiffs</code>
       </td>
<td style="text-align: left;"> Sorts the components in an <code>alldiffs.object</code> </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> according to the predicted values associated with a factor. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>subset.alldiffs</code>
       </td>
<td style="text-align: left;"> Subsets the components in an <code>alldiffs.object</code> according </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> to the supplied condition. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sort.predictions.frame</code>
       </td>
<td style="text-align: left;"> Sorts a <code>predictions.frame</code> according to the </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> predicted values. associated with a factor.</td>
</tr>
<tr>
<td style="text-align: left;">

(vi) Response transformation </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>angular</code>
       </td>
<td style="text-align: left;"> Applies the angular transformation to proportions. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>angular.mod</code>
       </td>
<td style="text-align: left;"> Applies the modified angular transformation to a </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> vector of counts. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>powerTransform</code>
       </td>
<td style="text-align: left;"> Performs a combination of a linear and a power </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> transformation on a variable. The transformed </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> variable is stored in the 'data.frame data'. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(vii) Object manipulation </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>as.alldiffs</code>
      </td>
<td style="text-align: left;"> Forms an <code>alldiffs.object</code> from the supplied </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> predictions, along with those statistics, associated with </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> the predictions and their pairwise differences, that have </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> been supplied. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>asrtests</code>
      </td>
<td style="text-align: left;"> Pseudonym for <code>as.asrtests</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>as.asrtests</code>
      </td>
<td style="text-align: left;"> Forms an <code>asrtests.object</code> that stores </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> (i) a fitted asreml object, </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> (ii) a pseudo-anova table for the fixed terms and </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> (iii) a history of changes and hypothesis testing </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> used in obtaining the model. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>as.predictions.frame</code>
      </td>
<td style="text-align: left;"> Forms a <code>predictions.frame</code> from a data.frame, ensuring </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> that the correct columns are present. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>convAsremlobj.asreml</code>
      </td>
<td style="text-align: left;"> Recreates an <code>asreml</code> object so that it is compatible with the </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> currently loaded <code>asreml</code> version. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>convEffectNames2DataFrame.asreml</code>
      </td>
<td style="text-align: left;"> Converts the effects names for a term stored in the component of an </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> <code>asreml</code> object into a <code>data.frame</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>facCombine.alldiffs</code>
      </td>
<td style="text-align: left;"> Combines several factors into one in the components of </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> an <code>alldiffs.object</code>.  </td>
</tr>
<tr>
<td style="text-align: left;">
<code>facRecast.alldiffs</code>
      </td>
<td style="text-align: left;"> Reorders and/or revises the factor levels using the order of </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> old levels in <code>levels.order</code> and the new labels for the </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> levels given in <code>newlabels</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>facRename.alldiffs</code>
      </td>
<td style="text-align: left;"> Renames <code>factor</code>s in the <code>prediction</code> component </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> of an <code>alldiffs.object</code>.    </td>
</tr>
<tr>
<td style="text-align: left;">
<code>getFormulae.asreml</code>
      </td>
<td style="text-align: left;"> Gets the formulae from an asreml object. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>is.alldiffs</code>
      </td>
<td style="text-align: left;"> A single-line function that tests whether an object is </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> of class alldiffs.   </td>
</tr>
<tr>
<td style="text-align: left;">
<code>is.asrtests</code>
      </td>
<td style="text-align: left;"> A single-line function that tests whether an object is </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> of class asrtests.   </td>
</tr>
<tr>
<td style="text-align: left;">
<code>is.predictions.frame</code>
      </td>
<td style="text-align: left;"> A single-line function that tests whether an object is </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> of classes <code>predictions.frame</code> and <code>data.frame</code>.   </td>
</tr>
<tr>
<td style="text-align: left;">
<code>makeTPPSplineMats.data.frame</code>
      </td>
<td style="text-align: left;"> Make the spline basis matrices and data needed to fit </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> Tensor Product P-Splines. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.alldiffs</code>
      </td>
<td style="text-align: left;"> Prints the values in an <code>alldiffs.object</code> in a nice format. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.asrtests</code>
      </td>
<td style="text-align: left;"> Prints the values in an <code>asrtests.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.LSDdata</code>
      </td>
<td style="text-align: left;"> Prints the components of a list containing data on the </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> LSDs for all pairwise differences of predictions.      </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.predictions.frame</code>
      </td>
<td style="text-align: left;"> Prints the values in a <code>predictions.frame</code>, with or without </td>
</tr>
<tr>
<td style="text-align: left;"> 
      </td>
<td style="text-align: left;"> title and heading. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.test.summary</code>
      </td>
<td style="text-align: left;"> Prints a data.frame containing a test.summary. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>print.wald.tab</code>
      </td>
<td style="text-align: left;"> Prints a data.frame containing a Wald or pseudoanova table. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>printFormulae.asreml</code>
      </td>
<td style="text-align: left;"> Prints the formulae from an asreml object. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>sort.alldiffs</code>
      </td>
<td style="text-align: left;"> Sorts the components of an <code>alldiffs.object</code> according to </td>
</tr>
<tr>
<td style="text-align: left;">
      </td>
<td style="text-align: left;"> the predicted values associated with a factor. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>subset.alldiffs</code>
       </td>
<td style="text-align: left;"> Subsets the components in an <code>alldiffs.object</code> according </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> to the supplied condition. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>subset.list</code>
       </td>
<td style="text-align: left;"> Forms a <code>list</code> that contains a subset of the components of </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> the supplied <code>list</code>.     </td>
</tr>
<tr>
<td style="text-align: left;">
<code>validAlldiffs</code>
       </td>
<td style="text-align: left;"> Checks that an object is a valid <code>alldiffs.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>validAsrtests</code>
       </td>
<td style="text-align: left;"> Checks that an object is a valid <code>asrtests.object</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>validPredictionsFrame</code>
       </td>
<td style="text-align: left;"> Checks that an object is a valid <code>predictions.frame</code>. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
<tr>
<td style="text-align: left;">
(viii) Miscellaneous </td>
</tr>
<tr>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">

<code>getASRemlVersionLoaded</code>
       </td>
<td style="text-align: left;"> Finds the version of asreml that is loaded and </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> returns the initial characters in version. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>isCompoundSymmetric</code>
       </td>
<td style="text-align: left;"> Tests whether an object of class matrix is </td>
</tr>
<tr>
<td style="text-align: left;"> 
       </td>
<td style="text-align: left;"> compound symmetric </td>
</tr>
<tr>
<td style="text-align: left;">
<code>loadASRemlVersion</code>
       </td>
<td style="text-align: left;"> Ensures that a specific version of asreml is loaded.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>num.recode</code>
       </td>
<td style="text-align: left;"> Recodes the unique values of a vector using the values  </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> in a new vector. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>permute.square</code>  
       </td>
<td style="text-align: left;">          Permutes the rows and columns of a square matrix. </td>
</tr>
<tr>
<td style="text-align: left;">
<code>permute.to.zero.lowertri</code>
       </td>
<td style="text-align: left;"> Permutes a square matrix until all the lower </td>
</tr>
<tr>
<td style="text-align: left;">
       </td>
<td style="text-align: left;"> triangular elements are zero. </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The functions whose names end in 'alldiffs" utilize an <code>alldiffs.object</code> that stores:
(i) a <code>predictions.frame</code>, being a data frame containing predicted values, variables indexing them and their standard errors and estimability status; 
the lower and upper limits of error intervals will be included when these are requested,
(ii) optionally, square matrices containing all pairwise differences, the standard errors and p-values of the differences, 
and a <code>data.frame</code> containing LSD values and their summary statistics, 
(iii) optionally, the variance matrix of the predictions, and 
(iv) if the response was transformed for analysis, a data frame with backtransforms of the predicted values.
</p>
<p>The functions whose names end in 'asrtests', which are most of the model functions, utilize an <code>asrtests.object</code> that stores:  
(i) the currently fitted model in <code>asreml.obj</code>, 
(ii) the table of test statistics for the fixed effects in <code>wald.tab</code>, and 
(iii) a data frame that contains a history of the changes made to the model in <code>test.summary</code>. 
</p>


<h3>Author(s)</h3>

<p>Chris Brien [aut, cre] (&lt;https://orcid.org/0000-0003-0581-1817&gt;)
</p>
<p>Maintainer: Chris Brien &lt;chris.brien@adelaide.edu.au&gt;
</p>


<h3>References</h3>

<p>Butler, D. G., Cullis, B. R., Gilmour, A. R., Gogel, B. J. and 
Thompson, R. (2023). <em>ASReml-R Reference Manual Version 4.2.</em>  
VSN International Ltd, <a href="https://asreml.kb.vsni.co.uk/">https://asreml.kb.vsni.co.uk/</a></p>


<h3>See Also</h3>

<p><code>asreml</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Analyse wheat dat using asreml and asremlPlus (see the WheatSpatial Vignette for details)
## Set up for analysis
library(dae)
library(asreml)
library(asremlPlus)
## use ?Wheat.dat for data set details
data(Wheat.dat)

# Add row and column covariates for the spatial modelling
tmp.dat &lt;- within(Wheat.dat, 
                  {
                    cColumn &lt;- dae::as.numfac(Column)
                    cColumn &lt;- cColumn  - mean(unique(cColumn))
                    cRow &lt;- dae::as.numfac(Row)
                    cRow &lt;- cRow - mean(unique(cRow))
                  })

# Fit an initial model - Row and column random
current.asr &lt;- do.call(asreml, 
                       list(yield ~ Rep + WithinColPairs + Variety, 
                            random = ~ Row + Column,
                            residual = ~ Row:Column,
                            data = tmp.dat))

# Intialize a model sequence by loading the current fit into an asrtests object
current.asrt &lt;- as.asrtests(current.asr, NULL, NULL, IClikelihood = "full", 
                            label = "Initial model")

# Check for and remove any boundary terms and print a summary of the fit in the asrtests object 
current.asrt &lt;- rmboundary(current.asrt)
print(current.asrt)


## Compare a series of information criteria to select a linear mixed model for the data

# Check the need for the term for within Column pairs (a post hoc factor)
current.asrt &lt;- changeModelOnIC(current.asrt, dropFixed = "WithinColPairs", 
                                label = "Try dropping withinColPairs", IClikelihood = "full")
print(current.asrt)

# Fit an ar1 model for local spatial variation
spatial.ar1.asrt &lt;- addSpatialModelOnIC(current.asrt, spatial.model = "corr", 
                                        row.covar = "cRow", col.covar = "cColumn", 
                                        row.factor = "Row", col.factor = "Column", 
                                        IClikelihood = "full")
spatial.ar1.asrt &lt;- rmboundary(spatial.ar1.asrt)
infoCriteria(list(nonspatial = current.asrt$asreml.obj, 
                  ar1 = spatial.ar1.asrt$asreml.obj))
print(spatial.ar1.asrt)

# Choose a model for local spatial variation from several potential models
suppressWarnings(
  spatial.asrts &lt;- chooseSpatialModelOnIC(current.asrt, 
                                          row.covar = "cRow", col.covar = "cColumn",
                                          row.factor = "Row", col.factor = "Column",
                                          dropRandom = "Row + Column",
                                          rotateX = TRUE, ngridangles = NULL, 
                                          asreml.option = "grp", return.asrts = "all"))
# Output the results
print(spatial.asrts$spatial.IC)
print(R2adj(spatial.asrts$asrts$TPNCSS$asreml.obj, include.which.random = ~ .))
print(spatial.asrts$best.spatial.mod)
print(spatial.asrts$asrts$TPNCSS)
printFormulae(spatial.asrts$asrts$TPNCSS$asreml.obj)

## Diagnosting checking using residual plots and variofaces

# Get current fitted asreml object and update to include standardized residuals
current.asr &lt;- spatial.asrts$asrts$TPNCSS$asreml.obj
current.asr &lt;- update(current.asr, aom=TRUE)
Wheat.dat$res &lt;- residuals(current.asr, type = "stdCond")
Wheat.dat$fit &lt;- fitted(current.asr)

# Do residuals-versus-fitted values plot
with(Wheat.dat, plot(fit, res))

# Plot variofaces
variofaces(current.asr, V=NULL, units="addtores", 
           maxiter=50, update = FALSE, 
           ncores = parallel::detectCores())

# Plot normal quantile plot
ggplot(data = Wheat.dat, mapping = aes(sample = res)) +
  stat_qq_band(bandType = "ts") + stat_qq_line() + stat_qq_point() +
  labs(x = "Theoretical Quantiles", y = "Sample Quantiles",
       title = "Normal probability plot") +
  theme(plot.title = element_text(size = 12, face = "bold")) + theme_bw()

## Prediction production and presentation

# Get Variety predictions and all pairwise prediction differences and p-values
Var.diffs &lt;- predictPlus(classify = "Variety", 
                         asreml.obj=current.asr, 
                         error.intervals="halfLeast",
                         wald.tab=current.asrt$wald.tab, 
                         sortFactor = "Variety",
                         tables = "predictions")

# Plot the Variety predictions, with halfLSD intervals, and the p-values
plotPredictions(Var.diffs$predictions, 
                classify = "Variety", y = "predicted.value", 
                error.intervals = "half")
plotPvalues(Var.diffs)

## End(Not run)</code></pre>


</div>