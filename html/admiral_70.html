<div class="container">

<table style="width: 100%;"><tr>
<td>derive_param_doseint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adds a Parameter for Dose Intensity</h2>

<h3>Description</h3>

<p>Adds a record for the dose intensity for each by group
(e.g., subject and visit) where the source parameters are available.
</p>
<p><strong>Note:</strong> This is a wrapper function for the more generic <code>derive_param_computed()</code>.
</p>
<p>The analysis value of the new parameter is derived as
Total Dose / Planned Dose * 100
</p>


<h3>Usage</h3>

<pre><code class="language-R">derive_param_doseint(
  dataset,
  by_vars,
  set_values_to = exprs(PARAMCD = "TNDOSINT"),
  tadm_code = "TNDOSE",
  tpadm_code = "TSNDOSE",
  zero_doses = "Inf",
  filter = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Input dataset
</p>
<p>The variables specified by the <code>by_vars</code> argument are expected to be in the dataset.
<code>PARAMCD</code>, and <code>AVAL</code> are expected as well.
</p>
<p>The variable specified by <code>by_vars</code> and <code>PARAMCD</code> must be a unique key of
the input dataset after restricting it by the filter condition (<code>filter</code>
parameter) and to the parameters specified by <code>tadm_code</code> and <code>padm_code</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_vars</code></td>
<td>
<p>Grouping variables
</p>
<p>Only variables specified in <code>by_vars</code> will be populated
in the newly created records.
</p>
<p><em>Permitted Values</em>: list of variables created by <code>exprs()</code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set_values_to</code></td>
<td>
<p>Variables to be set
</p>
<p>The specified variables are set to the specified values for the new
observations. For example <code>exprs(PARAMCD = "MAP")</code> defines the parameter code
for the new parameter.
</p>
<p><em>Permitted Values</em>: List of variable-value pairs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tadm_code</code></td>
<td>
<p>Total Doses Administered parameter code
</p>
<p>The observations where <code>PARAMCD</code> equals the specified value are considered
as the total dose administered.  The <code>AVAL</code> associated with this <code>PARAMCD</code>
will be the numerator of the dose intensity calculation.
</p>
<p>Permitted Values: character value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tpadm_code</code></td>
<td>
<p>Total Doses Planned parameter code
</p>
<p>The observations where <code>PARAMCD</code> equals the specified value are considered
as the total planned dose.  The <code>AVAL</code> associated with this <code>PARAMCD</code>
will be the denominator of the dose intensity calculation.
</p>
<p>Permitted Values: character value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero_doses</code></td>
<td>
<p>Flag indicating logic for handling 0 planned or
administered doses for a <code>by_vars</code> group
</p>
<p>Default: <code>Inf</code>
</p>
<p>Permitted Values: <code>Inf</code>, <code>100</code>
</p>
<p>No record is returned if either the planned (<code>tpadm_code</code>) or administered
(<code>tadm_code</code>) <code>AVAL</code> are <code>NA</code>.  No record is returned is a record does not
exist for both <code>tadm_code</code> and <code>tpadm_code</code> for the specified <code>by_var</code>.
</p>
<p>If <code>zero_doses</code> = <code>Inf</code>:
</p>

<ol>
<li>
<p> If the planned dose (<code>tpadm_code</code>) is 0 and administered dose
(<code>tadm_code</code>) is 0, <code>NaN</code> is returned.
</p>
</li>
<li>
<p> If the planned dose (<code>tpadm_code</code>) is 0 and the administered dose
(<code>tadm_code</code>) is &gt; 0, <code>Inf</code> is returned.
</p>
</li>
</ol>
<p>If <code>zero_doses</code> = <code>100</code> :
</p>

<ol>
<li>
<p> If the planned dose (<code>tpadm_code</code>) is 0 and administered dose
(<code>tadm_code</code>) is 0, 0 is returned.
</p>
</li>
<li>
<p> If the planned dose (<code>tpadm_code</code>) is 0 and the administered dose
(<code>tadm_code</code>) is &gt; 0, 100 is returned.
</p>
</li>
</ol>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>Filter condition
</p>
<p>The specified condition is applied to the input dataset before deriving the
new parameter, i.e., only observations fulfilling the condition are taken
into account.
</p>
<p><em>Permitted Values:</em> a condition</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The input dataset with the new parameter rows added. Note, a variable will only
be populated in the new parameter rows if it is specified in <code>by_vars</code>.
</p>


<h3>See Also</h3>

<p>BDS-Findings Functions for adding Parameters/Records: 
<code>default_qtc_paramcd()</code>,
<code>derive_expected_records()</code>,
<code>derive_extreme_event()</code>,
<code>derive_extreme_records()</code>,
<code>derive_locf_records()</code>,
<code>derive_param_bmi()</code>,
<code>derive_param_bsa()</code>,
<code>derive_param_computed()</code>,
<code>derive_param_exist_flag()</code>,
<code>derive_param_exposure()</code>,
<code>derive_param_framingham()</code>,
<code>derive_param_map()</code>,
<code>derive_param_qtc()</code>,
<code>derive_param_rr()</code>,
<code>derive_param_wbc_abs()</code>,
<code>derive_summary_records()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)
library(lubridate, warn.conflicts = FALSE)

adex &lt;- tribble(
  ~USUBJID, ~PARAMCD, ~VISIT, ~ANL01FL, ~ASTDT, ~AENDT, ~AVAL,
  "P001", "TNDOSE", "V1", "Y", ymd("2020-01-01"), ymd("2020-01-30"), 59,
  "P001", "TSNDOSE", "V1", "Y", ymd("2020-01-01"), ymd("2020-02-01"), 96,
  "P001", "TNDOSE", "V2", "Y", ymd("2020-02-01"), ymd("2020-03-15"), 88,
  "P001", "TSNDOSE", "V2", "Y", ymd("2020-02-05"), ymd("2020-03-01"), 88,
  "P002", "TNDOSE", "V1", "Y", ymd("2021-01-01"), ymd("2021-01-30"), 0,
  "P002", "TSNDOSE", "V1", "Y", ymd("2021-01-01"), ymd("2021-02-01"), 0,
  "P002", "TNDOSE", "V2", "Y", ymd("2021-02-01"), ymd("2021-03-15"), 52,
  "P002", "TSNDOSE", "V2", "Y", ymd("2021-02-05"), ymd("2021-03-01"), 0
)

derive_param_doseint(
  adex,
  by_vars = exprs(USUBJID, VISIT),
  set_values_to = exprs(PARAMCD = "TNDOSINT"),
  tadm_code = "TNDOSE",
  tpadm_code = "TSNDOSE"
)

derive_param_doseint(
  adex,
  by_vars = exprs(USUBJID, VISIT),
  set_values_to = exprs(PARAMCD = "TDOSINT2"),
  tadm_code = "TNDOSE",
  tpadm_code = "TSNDOSE",
  zero_doses = "100"
)
</code></pre>


</div>