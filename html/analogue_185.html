<div class="container">

<table style="width: 100%;"><tr>
<td>reconPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratigraphic plots of palaeoenvironmental reconstructions</h2>

<h3>Description</h3>

<p>Draws a palaeoenvironmental reconstruction of predicted environmental
values for sub-fossil assemblages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
reconPlot(x, ...)

## Default S3 method:
reconPlot(x, depths, errors,
          display.error = c("none", "bars", "lines"),
          rev.x = TRUE,
          col.error = "grey", lty.error = "dashed",
          type = "l",
          xlim, ylim,
          xlab = "", ylab = "", main = "",
          ...)

## S3 method for class 'predict.mat'
reconPlot(x, depths, use.labels = FALSE,
          predictions = c("model", "bootstrap"),
          display.error = c("none", "bars", "lines"),
          sample.specific = TRUE, ...)

## S3 method for class 'predict.wa'
reconPlot(x, depths, use.labels = FALSE,
          display.error = c("none", "bars", "lines"),
          sample.specific = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An R object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depths</code></td>
<td>
<p>numeric; a vector of depths for which predicted values
exist or will be generated. Can be missing, in which case,
<strong>if</strong> <code>use.labels = TRUE</code>, the function will attempt to
derive suitable values for you. See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>numeric; a vector of errors for plotting error bars or
lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display.error</code></td>
<td>
<p>character; hown should error bars be drawn on the
plot? One of <code>"none"</code>, <code>"bars"</code>, or <code>"lines"</code>. If
<code>"bars"</code>, error bars are drawn for each sample. If
<code>"lines"</code>, lines are drawn enclosing the region prediction +/-
RMSEP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rev.x</code></td>
<td>
<p>logical; should the depth/age axis be reversed (drawn
from high to low)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.error, lty.error</code></td>
<td>
<p>the colour and type of line drawn. See
<code>par</code> and arguments <code>"col"</code> and <code>"lty"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of line drawn. See <code>par</code> and argument
<code>"type"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>character; the x- and y-axis labels respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>character; main title for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>numeric, length 2; the x- and y-limits for the
plotted axes. If not provided, the function will calculate
appropriate values to cover the range of plotted values and any
error bars (if requested via <code>"error.bars"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.labels</code></td>
<td>
<p>logical; should <code>reconPlot</code> attempt to derive
values for argument <code>depths</code> from the names of the predicted
values? Only use if <code>depths</code> is missing. See Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictions</code></td>
<td>
<p>character; one of <code>"model"</code> or
<code>"bootstrap"</code>. Which type of predicted values should be
plotted? The model predictions (<code>"model"</code>) or the
bootstrap-derived predictions (<code>"bootstrap"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.specific</code></td>
<td>
<p>logical; should sample specific errors be used?
Only for <code>predictions = "bootstrap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other graphics functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Conventionally, these plots are drawn on a depth or an age
scale. Argument <code>depths</code> is used to provide the depth or age
axis, against which the predicted values are plotted.
</p>
<p>If <code>depths</code> is not provided, then the function will try to
derive the appropriate values from the labels of the predictions if
<code>use.labels = TRUE</code>. You must provide <code>depths</code> or set
<code>use.labels = TRUE</code> otherwise an error will result. The derived
labels will be coerced to numerics. If your labels are not coercible,
then you'll either get nonsense on the plot or an error from R. If so,
provide suitable values for <code>depths</code>.
</p>


<h3>Value</h3>

<p>A plot on the currently active device.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson </p>


<h3>See Also</h3>

<p><code>mat</code>, and <code>predict.mat</code> for MAT
transfer functions and <code>wa</code> and <code>predict.wa</code>
for WA models.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Imbrie and Kipp example
## load the example data
data(ImbrieKipp)
data(SumSST)
data(V12.122)

## merge training and test set on columns
dat &lt;- join(ImbrieKipp, V12.122, verbose = TRUE)

## extract the merged data sets and convert to proportions
ImbrieKipp &lt;- dat[[1]] / 100
V12.122 &lt;- dat[[2]] / 100

## Fit a MAT model
(ik.mat &lt;- mat(ImbrieKipp, SumSST, method = "chord"))

## Reconstruct pH for the RLGH core
v12.pH &lt;- predict(ik.mat, V12.122)

## draw the reconstruction
reconPlot(v12.pH, use.labels = TRUE, display.error = "bars",
          xlab = "Depth", ylab = "Summer Seas-surface Temperature")
</code></pre>


</div>