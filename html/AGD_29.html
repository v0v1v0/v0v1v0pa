<div class="container">

<table style="width: 100%;"><tr>
<td>wp.twin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Superposes two worm plots</h2>

<h3>Description</h3>

<p>Superposes two worm plots from GAMLSS fitted objects. This is a diagnostic
tool for comparing two solutions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wp.twin(
  obj1,
  obj2 = NULL,
  xvar = NULL,
  xvar.column = 2,
  n.inter = 16,
  show.given = FALSE,
  ylim.worm = 0.5,
  line = FALSE,
  cex = 1,
  col1 = "black",
  col2 = "orange",
  warnings = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj1</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj2</code></td>
<td>
<p>an optional second GAMLSS fitted object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar</code></td>
<td>
<p>the explanatory variable against which the worm plots will be
plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvar.column</code></td>
<td>
<p>the number referring to the column of <code>obj1$mu.x</code> and
<code>obj2$mu.x</code>.  If <code>xvar=NULL</code> then the explanatory variable is set
to <code>xvar=obj1$mu.x[,xvar.column]</code> respectively
<code>xvar=obj2$mu.x[,xvar.column]</code>.  The default is <code>xvar.column=2</code>,
which selects the variable following the intercept (which is typically age in
most applications).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.inter</code></td>
<td>
<p>the number of intervals in which the explanatory variable
<code>xvar</code> will be cut. The default is 16.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.given</code></td>
<td>
<p>whether to show the x-variable intervals in the top of the
graph, default is <code>show.given=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim.worm</code></td>
<td>
<p>for multiple plots, this values is the y-variable limit,
default value is <code>ylim.worm=0.5</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>whether to plot the polynomial line in the worm plot, default
value is <code>line=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>the cex plotting parameter with default <code>cex=1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col1</code></td>
<td>
<p>the color for the points of <code>obj1</code>. The default
<code>col="black"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col2</code></td>
<td>
<p>the color for the points of <code>obj2</code>. The default
<code>col="orange"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>a logical indicating whether warnings should be produced. The
default <code>warnings=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for extra arguments, <code>overlap</code>, <code>xlim.worm</code> or
<code>pch</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a customized version of the <code>wp()</code> function found in
the <code>gamlss</code> package. Function <code>wp.twin()</code> allows overplotting of
two worm plots, each in its own color.  The points of <code>obj1</code> are plotted
first, the points of <code>obj2</code> are superposed.  This twin worm plot provide
a visual assessment of the differences between the solutions.  Extra
arguments can be specified (e.g. <code>xvar</code>) that are passed down to the
<code>wp()</code> function of <code>gamlss</code> if specified.  The worm plot is a
detrended normal QQ-plot that highlight departures from normality.
</p>
<p>Argument <code>xvar</code> takes priority over <code>xvar.column</code>. The <code>xvar</code>
variable is cut into <code>n.iter</code> intervals with an equal number
observations and detrended normal QQ (i.e. worm) plots for each interval are
plotted.  This is a way of highlighting failures of the model within
different ranges of the explanatory variable.
</p>
<p>If <code>line=TRUE</code> and <code>n.inter&gt;1</code>, the fitted coefficients from
fitting cubic polynomials to the residuals (within each x-variable interval)
can be obtain by e.g.  <code>coeffs&lt;-wp.twin(model1,xvar=x,n.iner=9)</code>.  van
Buuren <em>et al.</em> (2001) used these residuals to identify regions
(intervals) of the explanatory variable within which the model does not fit
adequately the data (called "model violation")
</p>


<h3>Value</h3>

<p>For multiple plots the <code>xvar</code> intervals and the coefficients of
the fitted cubic polynomials to the residuals (within each <code>xvar</code>
interval) are returned.
</p>


<h3>Author(s)</h3>

<p>Stef van Buuren, using R code of Mikis Stasinopoulos and Bob Rigby
</p>


<h3>References</h3>

<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models
for location scale and shape (GAMLSS) in R. <em>Journal of Statistical
Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007,
<a href="https://www.jstatsoft.org/v23/i07">https://www.jstatsoft.org/v23/i07</a>.
</p>
<p>van Buuren and Fredriks M. (2001) Worm plot: simple diagnostic device for
modelling growth reference curves.  <em>Statistics in Medicine</em>, <b>20</b>,
1259–1277. 
</p>
<p>van Buuren and Fredriks M. (2007) Worm plot to diagnose fit in quantile
regression.  <em>Statistical Modelling</em>, <b>7</b>, 4, 363–376.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
library(gamlss)
data(abdom)
a &lt;- gamlss(y~cs(x,df=1),sigma.fo=~cs(x,0),family=LO,data=abdom)
b &lt;- gamlss(y~cs(x,df=3),sigma.fo=~cs(x,1),family=LO,data=abdom)
coeff1 &lt;- wp.twin(a,b,line=TRUE)

## End(Not run)
</code></pre>


</div>