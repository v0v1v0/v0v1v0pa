<div class="container">

<table style="width: 100%;"><tr>
<td>selectWithinFam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select individuals within families</h2>

<h3>Description</h3>

<p>Selects a subset of nInd individuals from each
full-sib family within a population. Will return all individuals
from a full-sib family if it has less than or equal to nInd individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectWithinFam(
  pop,
  nInd,
  trait = 1,
  use = "pheno",
  sex = "B",
  famType = "B",
  selectTop = TRUE,
  returnPop = TRUE,
  candidates = NULL,
  simParam = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>and object of <code>Pop-class</code>,
<code>HybridPop-class</code> or <code>MultiPop-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nInd</code></td>
<td>
<p>the number of individuals to select within a family</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>the trait for selection. Either a number indicating
a single trait or a function returning a vector of length nInd.
The function must work on a vector or matrix of <code>use</code> values as
<code>trait(pop@use, ...)</code> - depending on what <code>use</code> is.
See the examples and <code>selIndex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p>the selection criterion. Either a character
(genetic values "gv", estimated breeding values "ebv", breeding values "bv",
phenotypes "pheno", or randomly "rand") or
a function returning a vector of length nInd.
The function must work on <code>pop</code> as <code>use(pop, trait, ...)</code> or
as <code>trait(pop@use, ...)</code> depending on what <code>trait</code> is.
See the examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sex</code></td>
<td>
<p>which sex to select. Use "B" for both, "F" for
females and "M" for males. If the simulation is not using sexes,
the argument is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>famType</code></td>
<td>
<p>which type of family to select. Use "B" for
full-sib families, "F" for half-sib families on female side and "M"
for half-sib families on the male side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectTop</code></td>
<td>
<p>selects highest values if true.
Selects lowest values if false.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnPop</code></td>
<td>
<p>should results be returned as a
<code>Pop-class</code>. If FALSE, only the index of selected
individuals is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>candidates</code></td>
<td>
<p>an optional vector of eligible selection candidates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParam</code></td>
<td>
<p>an object of <code>SimParam</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments if using a function for
<code>trait</code> and <code>use</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of <code>Pop-class</code>,
<code>HybridPop-class</code> or <code>MultiPop-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create founder haplotypes
founderPop = quickHaplo(nInd=10, nChr=1, segSites=10)

#Set simulation parameters
SP = SimParam$new(founderPop)

SP$addTraitA(10)
SP$setVarE(h2=0.5)

#Create population
pop = newPop(founderPop, simParam=SP)

#Create 3 biparental families with 10 progeny
pop2 = randCross(pop, nCrosses=3, nProgeny=10, simParam=SP)

#Select best individual per family
pop3 = selectWithinFam(pop2, 1, simParam=SP)

</code></pre>


</div>