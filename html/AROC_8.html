<div class="container">

<table style="width: 100%;"><tr>
<td>compute.threshold.AROC.bsp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
AROC-based threshold values.
</h2>

<h3>Description</h3>

<p>Estimates AROC-based threshold values using the semiparametric Bayesian normal linear regression model discussed in Inacio de Carvalho and Rodriguez-Alvarez (2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute.threshold.AROC.bsp(object, newdata, FPF = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>AROC</code> as produced by <code>AROC.bsp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Data frame with the covariate values at which threshold values are required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPF</code></td>
<td>
<p>Numeric vector with the FPF at which to calculate the AROC-based threshold values. Atomic values are also valid.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of the covariate-adjusted ROC curve (AROC) using the semiparametric Bayesian normal linear regression model discussed in Inacio de Carvalho and Rodriguez-Alvarez (2018) involves the estimation of the conditional distribution function for the diagnostic test outcome in the healthy population
</p>
<p style="text-align: center;"><code class="reqn">F_{\bar{D}}(y|\mathbf{X}_{\bar{D}}) = Pr\{Y_{\bar{D}} \leq y | \mathbf{X}_{\bar{D}}\}.</code>
</p>

<p>This function makes use of this estimate in order to calculate AROC-based threshold values. In particular, for a covariate value <code class="reqn">\mathbf{x}</code> and a FPF = t, the AROC-based threshold value at the <code class="reqn">s</code>-th posterior sample (<code class="reqn">s = 1,\ldots,S</code>) is calculated as follows
</p>
<p style="text-align: center;"><code class="reqn">c^{(s)}_{\mathbf{x}} = \hat{F}^{-1(s)}_{\bar{D}}(1-t|\mathbf{X}_{\bar{D}} = \mathbf{x}).</code>
</p>

<p>from which the posterior mean can be computed
</p>
<p style="text-align: center;"><code class="reqn">\hat{c}_{\mathbf{x}} = \frac{1}{S}\sum_{s = 1}^{S}c^{(s)}_{\mathbf{x}}.</code>
</p>



<h3>Value</h3>

<p>As a result, the function provides a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>thresholds.est</code></td>
<td>
<p>A matrix with the posterior mean of the AROC-based threshold values. The matrix has as many columns as different covariate vector values, and as many rows as different FPFs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds.ql</code></td>
<td>
<p>A matrix with the posterior 2.5% quantile of the AROC-based threshold values. The matrix has as many columns as different covariate vector values, and as many rows as different FPFs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds.qh</code></td>
<td>
<p>A matrix with the posterior 97.5% quantile of the AROC-based threshold values. The matrix has as many columns as different covariate vector values, and as many rows as different FPFs.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Inacio de Carvalho, V., and Rodriguez-Alvarez, M. X. (2018). Bayesian nonparametric inference for the covariate-adjusted ROC curve. arXiv preprint arXiv:1806.00473.
</p>


<h3>See Also</h3>

<p><code>AROC.bsp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(AROC)
data(psa)
# Select the last measurement
newpsa &lt;- psa[!duplicated(psa$id, fromLast = TRUE),]

# Log-transform the biomarker
newpsa$l_marker1 &lt;- log(newpsa$marker1)

m1 &lt;- AROC.bsp(formula.healthy = l_marker1 ~ age,
group = "status", tag.healthy = 0, data = newpsa, scale = TRUE,
p = seq(0,1,l=101), compute.lpml = TRUE, compute.WAIC = TRUE,
a = 2, b = 0.5, nsim = 5000, nburn = 1500)

# Compute the threshold values
FPF = c(0.1, 0.3)
newdata &lt;- data.frame(age = seq(52, 80, l = 50))

th_bsp &lt;- compute.threshold.AROC.bsp(m1, newdata, FPF)
names(th_bsp)


</code></pre>


</div>