<div class="container">

<table style="width: 100%;"><tr>
<td>suprow.pta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Projections of Supplementary Rows for a Partial Triadic Analysis of K-tables
</h2>

<h3>Description</h3>

<p>This function performs a projection of supplementary rows (i.e. supplementary individuals) for a Partial Triadic Analysis (<code>pta</code>) of K-tables.
Computations are valid ONLY if the <code>pta</code> has been done on a K-Tables obtained by the <code>withinpca</code> function, followed by calls to the <code>ktab.within</code> and <code>t</code> functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pta'
suprow(x, Xsup, facSup, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>pta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xsup</code></td>
<td>
<p>a table with the supplementary rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facSup</code></td>
<td>
<p>a factor partitioning the rows of <code>Xsup</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the coordinates of the supplementary rows for a K-tables.
The table of supplementary rows is standardized according to the 'Bouroche' standardization used in the Within Analysis of the original <code>pta</code>.
In a first step, the table of supplementary rows is standardized (centred and normed) with the mean and variance of the original table of active individuals (i.e. the K-tables used in <code>pta</code>). Then, according to the <code>withinpca</code> procedure, a second transformation is applied.
</p>
<p>For "partial", supplementary rows are standardized in each sub-table (corresponding to each level of the factor) by the mean and variance of each corresponding sub-sample in the table of active individuals. Hence, supplementary rows have null mean and unit variance in each sub-table.
</p>
<p>For "total", supplementary rows are centred in each sub-table with the mean of each coresponding sub-sample in the table of active individuals and then normed with the global variance ot the table of active individuals. Hence, supplementary rows have a null mean in each sub-table and a global variance equal to one. 
</p>


<h3>Value</h3>

<p>Returns a list with the transformed table <code>Xsup</code> in <code>tabsup</code> and the coordinates of the supplementary rows in <code>lisup</code>.
</p>


<h3>Author(s)</h3>

<p>Benjamin Alric  <a href="mailto:benjamin.alric@irstea.fr">benjamin.alric@irstea.fr</a> <br>
Jean Thioulouse <a href="mailto:jean.thioulouse@univ-lyon1.fr">jean.thioulouse@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Bouroche, J. M. (1975) <em>Analyse des données ternaires: la double analyse en composantes principales</em>. 
Thèse de 3ème cycle, Université de Paris VI.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(meau)
# Active rows
actenv &lt;- meau$env[meau$design$site != "S6", -c(5)]
actfac &lt;- meau$design$season[meau$design$site != "S6"]
# Suplementary rows
supenv &lt;- meau$env[meau$design$site == "S6", -c(5)]
supfac &lt;- meau$design$season[meau$design$site == "S6"]
# Total = active + suplementary rows
totenv &lt;- meau$env[, -c(5)]
totfac &lt;- meau$design$season
# PTA with 6 sampling sites
wittot &lt;- withinpca(df = totenv, fac = totfac, scannf = FALSE, scaling = "partial")
kta1tot &lt;- ktab.within(wittot, colnames = rep(c("S1", "S2", "S3", "S4", "S5", "S6"), 4))
kta2tot &lt;- t(kta1tot)
pta1tot &lt;- pta(kta2tot, scann = FALSE)
# PTA with 5 sampling sites and site 6 added as supplementary element
wit1 &lt;- withinpca(df = actenv, fac = actfac, scannf = FALSE, scaling = "partial")
kta1 &lt;- ktab.within(wit1, colnames = rep(c("S1", "S2", "S3", "S4", "S5"), 4))
kta2 &lt;- t(kta1)
pta1 &lt;- pta(kta2, scann = FALSE)
supenv.pta &lt;- suprow(x = pta1, Xsup = supenv, facSup = supfac)
if (adegraphicsLoaded()) {
# g1t = active + suplementary rows
	g1t &lt;- s.label(pta1tot$Tli, labels = rownames(totenv), 
	  plabels = list(box = list(draw = FALSE), optim = TRUE), xlim = c(-6, 5), ylim = c(-5, 5), 
	  psub = list(text="Total", position="topleft"), plot = FALSE)
# g1 = Active rows
	g1 &lt;- s.label(pta1$Tli, labels = rownames(actenv), 
	  plabels = list(box = list(draw = FALSE), optim =TRUE), xlim = c(-6, 5), ylim = c(-5, 5), 
	  psub = list(text="Active", position="topleft"), pgrid = list(text=list(cex = 0)), 
	  plot = FALSE)
# g2 = Supplementary rows
	g2 &lt;- s.label(supenv.pta$lisup, plabels = list(box = list(draw = FALSE), optim = TRUE), 
	  ppoints = list(col = "red"), psub = list(text="Supplementary", position="topright"), 
	  pgrid = list(text=list(cex = 0)), plot = FALSE)
# g3 = superposition of active and suplementary rows
	g3 &lt;- g1 + g2
# Comparison of the total analysis and the analysis with supplementary rows
	ADEgS(list(g1t,g3))
} else {
	par(mfrow=c(2,2))
# g1t = active + suplementary rows
	g1t &lt;- s.label(pta1tot$Tli, label = rownames(totenv), xlim = c(-6, 5), ylim = c(-5, 5), 
	  sub="Total")
# g1 = Active rows
	g1 &lt;- s.label(pta1$Tli, label = rownames(actenv), clabel = 1, xlim = c(-6, 5),
	  ylim = c(-5, 5), sub="Active+Supplementary")
# g2 = Supplementary rows
	g2 &lt;- s.label(supenv.pta$lisup, clabel = 1.5, xlim = c(-6, 5), ylim = c(-5, 5), 
	  add.plot = TRUE)  
}
</code></pre>


</div>