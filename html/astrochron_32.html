<div class="container">

<table style="width: 100%;"><tr>
<td>eha</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evolutive Harmonic Analysis &amp; Evolutive Power Spectral Analysis</h2>

<h3>Description</h3>

<p>Evolutive Harmonic Analysis &amp; Evolutive Power Spectral Analysis using the Thomson multitaper method (Thomson, 1982)
</p>


<h3>Usage</h3>

<pre><code class="language-R">eha(dat,tbw=2,pad,fmin,fmax,step,win,demean=T,detrend=T,siglevel=0.90,
    sigID=F,ydir=1,output=0,pl=1,palette=6,centerZero=T,ncolors=100,xlab,ylab,
    genplot=2,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Stratigraphic series to analyze. First column should be location (e.g., depth), second column should be data value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbw</code></td>
<td>
<p>MTM time-bandwidth product (&lt;=10)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad</code></td>
<td>
<p>Pad with zeros to how many points? Must not factor into a prime number &gt;23. Maximum number of points is 200,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmin</code></td>
<td>
<p>Smallest frequency for analysis and plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmax</code></td>
<td>
<p>Largest frequency for analysis and plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>Step size for EHA window, in units of space or time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>Window size for EHA, in units of space or time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean</code></td>
<td>
<p>Remove mean from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend</code></td>
<td>
<p>Remove linear trend from data series? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>siglevel</code></td>
<td>
<p>Significance level for peak identification/filtering (0-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigID</code></td>
<td>
<p>Identify signficant frequencies on power, amplitude, and probabilty plots. Only applies when one spectrum is calculated. (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydir</code></td>
<td>
<p>Direction for y-axis in EHA plots (depth,height,time). -1 = values increase downwards (slower plotting), 1 = values increase upwards</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Return output as new data frame? 0=no; 1=all results; 2=power; 3=amplitude; 4=probability; 5=significant frequencies (only for one spectrum); 6=significant frequencies and their probabilities (only for one spectrum)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>Plot logarithm of spectral power (1) or linear spectral power (2)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>What color palette would you like to use? (1) rainbow, (2) grayscale, (3) blue, (4) red, (5) blue-white-red (if values are negative and positive, white is centered on zero), (6) viridis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centerZero</code></td>
<td>
<p>Center color scale on zero (use an equal number of postive and negative color divisions)? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolors</code></td>
<td>
<p>Number of colors steps to use in palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for x-axis. Default = "Frequency"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for y-axis. Default = "Location"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Plotting options. 0= no plots; 1= power, amplitude, f-test, probability; 2=data series, power, amplitude, probability; 3= data series, power, normalized amplitude (maximum in each window normalized to unity), normalized amplitude filtered at specified siglevel; 4= data series, normalized power (maximum in each window normalized to unity), normalized amplitude (maximum in each window normalized to unity), normalized amplitude filtered at specified siglevel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power spectrum normalization approach applied here divides the Fourier coefficients by the 
number of points (npts) in the stratigraphic series, which is equivalent to dividing the power 
by (npts*npts). The (npts*npts) normalization has the convenient property whereby
– for an unpadded series – the sum of the power in the positive frequencies is equivalent 
to half of variance; the other half of the variance is in the negative frequencies.
</p>
<p>Note that the 'spec.mtm' function in package 'multitaper' (Rahim et al., 2014) is used for MTM spectrum estimation.
</p>


<h3>References</h3>

<p>Thomson, D. J., 1982, <em>Spectrum estimation and harmonic analysis</em>, Proc. IEEE, 70, 1055-1096, doi:10.1109/PROC.1982.12433.
</p>


<h3>See Also</h3>

 <p><code>extract</code>, <code>lowspec</code>, <code>mtmAR</code>, <code>mtmML96</code>, <code>periodogram</code>, <code>trackFreq</code> and <code>traceFreq</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">## as an example, evaluate the modelA
data(modelA)

## interpolate to even sampling interval of 0.075 m
ex1=linterp(modelA, dt=0.075)
  
## perform EHA with a time-bandwidth parameter of 2, using an 7.95 meter window, 0.15 m step, 
## and pad to 1000 points
## set labels for plots (optional)
eha(ex1,tbw=2,win=7.95,step=0.15,pad=1000,xlab="Frequency (cycles/m)",ylab="Height (m)")

## for comparison generate spectrum for entire record, using time-bandwidth parameter of 3, and 
## pad to 5000 points
## start by making a new plot
pl(1)
eha(ex1,tbw=3,win=38,pad=5000,xlab="Frequency (cycles/m)")
</code></pre>


</div>