<div class="container">

<table style="width: 100%;"><tr>
<td>msst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Singular Spectrum Trendlines</h2>

<h3>Description</h3>

<p>Computes trendlines for multivariate time series data using
multivariate singular spectrum analysis. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">msst(y, l = "automatic", m = "automatic", vertical = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>mtsframe object containing raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>window length; the string <code>"automatic"</code> sets
the default option <br><code>l = ceiling((y$n + 1) / y$D)</code> for
<code>vertical</code> and <code>ceiling(y$D * (y$n + 1) / (y$D + 1))</code> in the 
case of horizontal binding.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector with the number of leading eigentriples on each dimension. An automatic
criterion based on the cumulative periodogram of the residuals is
provided by default by using the string <code>"automatic"</code>, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>logical; if <code>TRUE</code> the trajectory matrices are
stacked vertically, otherwise the bind is horizontal.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Multivariate singular spectrum analysis is used to decompose time
series data (<code>y</code>) into principal components, and a cumulative
periodogram-based criterion automatically learns about what elementary
reconstructed components (<code>erc</code>) contribute to the signal; see de
Carvalho and Martos (2018) for details. The trendline results from
adding elementary reconstructed components selected by the cumulative
periodogram of the residuals. The <code>plot</code> method depicts the
trendlines, and the <code>print</code> method reports the trendlines along
with the components selected by the cumulative periodogram-based
criterion.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trendline</code></td>
<td>
<p>mtsframe object with trendline estimation from targeted grouping based on a cumulative periodogram criterion (or according to the number of components specified in vector <code>m</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l</code></td>
<td>
<p>window length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector with number of components selected on each dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>flag indicating if the trajectory matrices where stacked vertically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>mtsframe object with the residuals from targeted grouping based on a cumulative periodogram criterion (or according to the number of components specified in vector <code>m</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svd</code></td>
<td>
<p>the Singular Value Decomposition of the trajectory matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>erc</code></td>
<td>
<p>list with elementary reconstructed components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observations</code></td>
<td>
<p>mtsframe object with the observations <code>y</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gabriel Martos and Miguel de Carvalho</p>


<h3>References</h3>

<p>de Carvalho, M. and Martos, G. (2020). Brexit: Tracking and
disentangling the sentiment towards leaving the EU. <em>International Journal
of Forecasting</em>, <b>36</b>, 1128â€“1137.
</p>


<h3>See Also</h3>

<p>See <code>msstc</code> for a similar routine yielding trendlines for
multivariate time series of compositional data.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## SIMULATED EXAMPLE
t &lt;- seq(0.05, 5, by = 0.05)
t2 &lt;- seq(0.05, 6, by = 0.05)
p = length(t2)-length(t) # Forecasting horizon parameter:
n = length(t)
Y &lt;- cbind(t^3 - 9 * t^2 + 23 * t + rnorm(n, 0, 1), 
           10 * sin(3 * t) / t + rnorm(n, 0, 1))
y &lt;- mtsframe(dates = t, Y)

fit.vertical &lt;- msst(y)

pred.vertical &lt;- predict(fit.vertical, p = p)
print(pred.vertical$forecast)

## BREXIT DATA EXAMPLE
## (de Carvalho and Martos, 2018; Fig. 1)
data(brexit)
attach(brexit)
y &lt;- mtsframe(date, brexit[, 1:3] / 100)
fit &lt;- msst(y)

## Window length and components automatically selected
fit$l; fit$m

## Plot trendlines (de Carvalho and Martos, 2018; Fig. 1)
plot(fit, options = list(type = "trendlines"), xlab="time",
     col=c("blue", "red", "black"), lwd = 2, lty = c(1, 2, 3))


## Plot cumulative periodograms (with 95% confidence bands)
par(mfrow = c(1, 3))
plot(fit, options = list(type = "cpgrams",
                         series.names = c('Leave','Stay','Undecided')) )

## Scree-plot
par(mfrow = c(1, 1))
plot(fit, options = list(type = "screeplot", ncomp.scree = 1:10),
     type = "b", pch = 20, lwd = 2, main='Scree plot')

## Plot elementary reconstructed components 
plot(fit, options = list(type = "components", ncomp = 1:2))

</code></pre>


</div>