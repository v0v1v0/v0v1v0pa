<div class="container">

<table style="width: 100%;"><tr>
<td>adapt_univ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit an adaptive lasso with adaptive weights derived from univariate coefficients</h2>

<h3>Description</h3>

<p>Compute odd-ratios between each covariate of <code>x</code> and <code>y</code> then derived
adaptive weights to incorporate in an adaptive lasso.
BIC or cross-validation could either be used for the adaptive lasso for variable selection.
Two options for implementing cross-validation for the adaptive lasso are possible through the <code>type_cv</code> parameter (see bellow).
Can deal with very large sparse data matrices.
Intended for binary reponse only (option <code>family = "binomial"</code> is forced).
The cross-validation criterion used is deviance.
Depends on the <code>glmnet</code> and <code>relax.glmnet</code> function from the package
<code>glmnet</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">adapt_univ(
  x,
  y,
  gamma = 1,
  criterion = "bic",
  maxp = 50,
  path = TRUE,
  nfolds = 5,
  foldid = NULL,
  type_cv = "proper",
  betaPos = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input matrix, of dimension nobs x nvars. Each row is an observation
vector. Can be in sparse matrix format (inherit from class
<code>"sparseMatrix"</code> as in package <code>Matrix</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Binary response variable, numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Tunning parameter to defined the penalty weights. See details below.
Default is set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Character, indicates which criterion is used with the
adaptive lasso for variable selection. Could be either "bic" or "cv".
Default is "bic"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxp</code></td>
<td>
<p>Used only if <code>criterion</code> = "bic", ignored if <code>criterion</code> = "cv".
A limit on how many relaxed coefficients are allowed. Default is 50, in <code>glmnet</code>
option default is 'n-3', where 'n' is the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Used only if <code>criterion</code> = "bic", ignored if <code>criterion</code> = "cv".
Since <code>glmnet</code> does not do stepsize optimization, the Newton
algorithm can get stuck and not converge, especially with relaxed fits.
With <code>path=TRUE</code>, each relaxed fit on a particular set of variables
is computed pathwise using the original sequence of lambda values
(with a zero attached to the end). Default is <code>path=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Used only if <code>criterion</code> = "cv", ignored if <code>criterion</code> = "bic".
Number of folds - default is 5. Although <code>nfolds</code> can be
as large as the sample size (leave-one-out CV), it is not recommended for
large datasets. Smallest value allowable is <code>nfolds=3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>Used only if <code>criterion</code> = "cv", ignored if <code>criterion</code> = "bic".
An optional vector of values between 1 and <code>nfolds</code>
identifying what fold each observation is in. If supplied, <code>nfolds</code> can
be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_cv</code></td>
<td>
<p>Used only if <code>criterion</code> = "cv", ignored if <code>criterion</code> = "bic".
Character, indicates which implementation of cross-validation is performed for the adaptive lasso:  a "naive" one,
where adaptive weights obtained on the full data are used, and a "proper" one, where adaptive weights are calculated for each training sets.
Could be either "naive" or "proper".
Default is "proper".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaPos</code></td>
<td>
<p>Should the covariates selected by the procedure be
positively associated with the outcome ? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>glmnet</code> from package
<code>glmnet</code> other than <code>family</code>, <code>maxp</code>, <code>standardize</code>, <code>intercept</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The adaptive weight for a given covariate i is defined by
</p>
<p style="text-align: center;"><code class="reqn">w_i = 1/|\beta^{univ}_i|^\gamma</code>
</p>
<p> where
<code class="reqn">\beta^{univ}_i = log(OR_i)</code>, with
<code class="reqn">OR_i</code> is the odd-ratio associated to covariate <code class="reqn">i</code>
with the outcome.
</p>


<h3>Value</h3>

<p>An object with S3 class <code>"adaptive"</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>aws</code></td>
<td>
<p>Numeric vector of penalty weights derived from odds-ratios.
Length equal to nvars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>Character, same as input. Could be either "bic" or "cv".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Numeric vector of regression coefficients in the adaptive lasso.
If <code>criterion</code> = "cv" the regression coefficients are PENALIZED, if
<code>criterion</code> = "bic" the regression coefficients are UNPENALIZED.
Length equal to nvars. Could be NA if adaptive weights are all equal to infinity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected_variables</code></td>
<td>
<p>Character vector, names of variable(s) selected
with this adaptive approach.
If <code>betaPos = TRUE</code>, this set is the covariates with a positive regression
coefficient in <code>beta</code>.
Else this set is the covariates with a non null regression coefficient in <code>beta</code>.
If <code>criterion</code> = "bic", covariates are ordering according to magnitude of their regression
coefficients absolute value in the adaptive lasso.
If <code>criterion</code> = "bic", covariates are ordering according to the p-values (two-sided if <code>betaPos = FALSE</code> ,
one-sided if <code>betaPos = TRUE</code>) in the classical multiple logistic regression
model that minimzes the BIC in the adaptive lasso.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emeline Courtois <br> Maintainer: Emeline Courtois
<a href="mailto:emeline.courtois@inserm.fr">emeline.courtois@inserm.fr</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(15)
drugs &lt;- matrix(rbinom(100*20, 1, 0.2), nrow = 100, ncol = 20)
colnames(drugs) &lt;- paste0("drugs",1:ncol(drugs))
ae &lt;- rbinom(100, 1, 0.3)
au &lt;- adapt_univ(x = drugs, y = ae, criterion ="cv", nfolds = 3)

</code></pre>


</div>