<div class="container">

<table style="width: 100%;"><tr>
<td>intraMLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Binomial Maximum Likelihood Estimator
</h2>

<h3>Description</h3>

<p>The default process in the Vasicek model follows a binomial distribution, conditional on the realization of the systematic factor. Hence, the intra asset correlation can be estimated by maximizing the Vasicek-binomial log likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intraMLE(d, n, B =0, DB=c(0,0), JC = FALSE, CI, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>a number, indicating the desired asymptotic confidence interval of the estimate. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>a number, indicating the desired bootstrap confidence interval of the estimate, if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string, indicating  the type of bootstrap intervals. For more details see <code>boot.ci</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the Vasicek model the default process can be expressed as independent binomial trials, conditional on the realization of the systematic factor. Therefore Gordy and Heitfield (2010) introduced an estimator of the intra asset correlation based on the log-likelihood maximization. For theoretical background see Gordy and Heitfield (2010). 
</p>
<p>The log-likelihood will be maximized for values between 0 and 1. The asymptotic confidence interval will be estimated using maximum likelihood theory. If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated by using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chang J, Hall P (2015).
“Double-bootstrap methods that use a single double-bootstrap simulation.”
<em>Biometrika</em>, <b>102</b>(1), 203–214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Gordy MB, Heitfield E (2010).
“Small-sample estimation of models of portfolio credit risk.”
In <em>Recent Advances in Financial Engineering: Proceedings of the KIER-TMU International Workshop on Financial Engineering, 2009: Otemachi, Sankei Plaza, Tokyo, 3-4 August 2009</em>, 43–63.
</p>


<h3>See Also</h3>

<p><code>intraAMM</code>, <code>intraFMM</code>, <code>intraJDP2</code>,
<code>intraCMM</code>, <code>intraJDP1</code>, <code>intraAMLE</code>,
<code>intraMode</code>,<code>intraBeta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(11)
d=defaultTimeseries(1000,0.3,20,0.01)
n=rep(1000,20)

IntraCorr=intraMLE(d,n)

#Estimation with confidence intervals
IntraCorr=intraMLE(d,n, CI=0.95 )






#Jackknife correction
IntraCorr=intraMLE(d,n, JC=TRUE)

#Bootstrap correction with bootstrap confidence intervals
IntraCorr=intraMLE(d,n, B=1000, CI_Boot=0.95 )

#Bootstrap correction with bootstrap confidence intervals and plot
IntraCorr=intraMLE(d,n, B=1000, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraMLE(D1,N1, DB=c(10,50))



</code></pre>


</div>