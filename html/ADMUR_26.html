<div class="container">

<table style="width: 100%;"><tr>
<td>sinewavePDF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PDF of a truncated sinusoidal curve</h2>

<h3>Description</h3>

<p>Probability density function for a truncated sinusoidal curve.
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">sinewavePDF(x, min, max, f, p, r)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Numeric vector of years
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min, max</code></td>
<td>

<p>Lower and upper \(x\) limits of the distribution
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>Numeric frequency (cycles per unit \(x\)).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>Numeric between \(0\) and \(2\pi\), giving the cycle position (in radians) at \(x = 0\).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>Numeric between 0 and 1, determining how flat the distribution is.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The usual function to describe a sine wave is \(f(x) = A\sin(2\pi f x + p)\), where \(A\) is the amplitude, \(f\) is the frequency (cycles per year), and \(p\) is the cycle position (in radians) at \(x = 0\), and therefore oscillates above and below the x-axis.
</p>
<p>However, a sinusoidal PDF must by definition always be non-negative, which can conceptually be considered as a sine wave stacked on top of a uniform distribution with a height \(A + k\), where \(k &gt;= 0\).
Since the PDF is \(f(x)\) divided by the area below the curve, A and k simplify to a single parameter \(r\) that determines the relative proportions of the uniform and sinusoidal components, such that:
</p>
<p>when \(r = 0\) the amplitude of the sine wave component is zero, and the overall PDF is just a uniform distribution between min and max.
</p>
<p>when \(r = 1\) the uniform component is zero, and the minima of the sine wave touches zero. This does not necessarily mean the PDF minimum equals zero, since a minimum point of the sine wave may not occur with PDF domain (truncated between min and max).
</p>
<p>Therefore the formula for the PDF is:
</p>
\[\frac{1 + \sin(2\pi f x + p) - \ln(r)}{(x_{max} - x_{min})(1 - \ln(r)) + (\frac{1}{2\pi f})[\cos(2\pi f x_{min} - p) - \cos(2\pi f x_{max} - p)]}\] 
<p>where \(x =\) years, and \(x_{min}\) and \(x_{max}\) determine the truncated date range.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	# A sinewave with a period of 700 years
	x &lt;- seq(1500,4500, length.out=1000)
	y &lt;- sinewavePDF(x, min=2000, max=4000, f=1/700, p=0, r=0.2)
	plot(x,y,type='l')
	</code></pre>


</div>