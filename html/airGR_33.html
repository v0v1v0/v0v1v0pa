<div class="container">

<table style="width: 100%;"><tr>
<td>RunModel_CemaNeigeGR5H</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run with the CemaNeigeGR5H hydrological model</h2>

<h3>Description</h3>

<p>Function which performs a single run for the CemaNeige-GR5H hourly lumped model over the test period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunModel_CemaNeigeGR5H(InputsModel, RunOptions, Param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>InputsModel</code></td>
<td>
<p>[object of class <em>InputsModel</em>] see <code>CreateInputsModel</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RunOptions</code></td>
<td>
<p>[object of class <em>RunOptions</em>] see <code>CreateRunOptions</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param</code></td>
<td>
<p>[numeric] vector of 7 (or 9 parameters if <code>IsHyst = TRUE</code>, see <code>CreateRunOptions</code> for details)
</p>

<table>
<tr>
<td style="text-align: left;">
    GR5H X1      </td>
<td style="text-align: left;"> production store capacity [mm]                                          </td>
</tr>
<tr>
<td style="text-align: left;">
    GR5H X2      </td>
<td style="text-align: left;"> intercatchment exchange coefficient [mm/h]                              </td>
</tr>
<tr>
<td style="text-align: left;">
    GR5H X3      </td>
<td style="text-align: left;"> routing store capacity [mm]                                             </td>
</tr>
<tr>
<td style="text-align: left;">
    GR5H X4      </td>
<td style="text-align: left;"> unit hydrograph time constant [h]                                       </td>
</tr>
<tr>
<td style="text-align: left;">
    GR5H X5      </td>
<td style="text-align: left;"> intercatchment exchange threshold [-]                                   </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X1 </td>
<td style="text-align: left;"> weighting coefficient for snow pack thermal state [-]                   </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X2 </td>
<td style="text-align: left;"> degree-hour melt coefficient [mm/°C/h]                                  </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X3 </td>
<td style="text-align: left;"> (optional) accumulation threshold [mm] (needed if <code>IsHyst = TRUE</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
    CemaNeige X4 </td>
<td style="text-align: left;"> (optional) percentage (between 0 and 1) of annual snowfall defining the melt threshold [-] (needed if <code>IsHyst = TRUE</code>) </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The choice of the CemaNeige version is explained in <code>CreateRunOptions</code>. <br>
For further details on the model, see the references section. <br>
For further details on the argument structures and initialisation options, see <code>CreateRunOptions</code>.
<br><br>
See <code>RunModel_GR5H</code> to look at the diagram of the hydrological model or <code>RunModel_GR5J</code> when no interception store is used.
</p>


<h3>Value</h3>

<p>[list] containing the function outputs organised as follows:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>$DatesR  </em> </td>
<td style="text-align: left;"> [POSIXlt] series of dates                                                                             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PotEvap </em> </td>
<td style="text-align: left;"> [numeric] series of input potential evapotranspiration (E) [mm/h]                                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Precip  </em> </td>
<td style="text-align: left;"> [numeric] series of input total precipitation (P) [mm/h]                                              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Interc  </em> </td>
<td style="text-align: left;"> [numeric] series of interception store level (I) [mm]                                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Prod    </em> </td>
<td style="text-align: left;"> [numeric] series of production store level (S) [mm]                                                   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Pn      </em> </td>
<td style="text-align: left;"> [numeric] series of net rainfall (Pn) [mm/h]                                                          </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Ps      </em> </td>
<td style="text-align: left;"> [numeric] series of the part of Pn filling the production store (Ps) [mm/h]                           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AE      </em> </td>
<td style="text-align: left;"> [numeric] series of actual evapotranspiration (Ei+Es) [mm/h]                                          </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$EI      </em> </td>
<td style="text-align: left;"> [numeric] series of evapotranspiration from rainfall neutralisation or interception store (Ei) [mm/h] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$ES      </em> </td>
<td style="text-align: left;"> [numeric] series of evapotranspiration from production store (Es) [mm/h]                              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Perc    </em> </td>
<td style="text-align: left;"> [numeric] series of percolation (Perc) [mm/h]                                                         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PR      </em> </td>
<td style="text-align: left;"> [numeric] series of Pr=Pn-Ps+Perc (Pr) [mm/h]                                                         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Q9      </em> </td>
<td style="text-align: left;"> [numeric] series of UH outflow going into branch 9 (Q9) [mm/h]                                        </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Q1      </em> </td>
<td style="text-align: left;"> [numeric] series of UH outflow going into branch 1 (Q1) [mm/h]                                        </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Rout    </em> </td>
<td style="text-align: left;"> [numeric] series of routing store level (R1) [mm]                                                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Exch    </em> </td>
<td style="text-align: left;"> [numeric] series of potential semi-exchange between catchments [mm/h]                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch1  </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments for branch 1 [mm/h]                            </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch2  </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments for branch 2 [mm/h]                            </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch   </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments (AExch1+AExch2) [mm/h]                         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$QR      </em> </td>
<td style="text-align: left;"> [numeric] series of routing store outflow (Qr) [mm/h]                                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$QD      </em> </td>
<td style="text-align: left;"> [numeric] series of direct flow from UH after exchange (Qd) [mm/h]                                    </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Qsim    </em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge (Q) [mm/h]                                                    </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers</em> </td>
<td style="text-align: left;"> [list] CemaNeige outputs (1 element per layer)                                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Pliq         </em> </td>
<td style="text-align: left;"> [numeric] series of liquid precip. [mm/h]                              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Psol         </em> </td>
<td style="text-align: left;"> [numeric] series of solid precip. [mm/h]                               </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$SnowPack     </em> </td>
<td style="text-align: left;"> [numeric] series of snow pack (snow water equivalent) [mm]             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$ThermalState </em> </td>
<td style="text-align: left;"> [numeric] series of snow pack thermal state [°C]                       </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Gratio       </em> </td>
<td style="text-align: left;"> [numeric] series of Gratio [0-1]                                       </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$PotMelt      </em> </td>
<td style="text-align: left;"> [numeric] series of potential snow melt [mm/h]                         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Melt         </em> </td>
<td style="text-align: left;"> [numeric] series of actual snow melt [mm/h]                            </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$PliqAndMelt  </em> </td>
<td style="text-align: left;"> [numeric] series of liquid precip. + actual snow melt [mm/h]           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Temp         </em> </td>
<td style="text-align: left;"> [numeric] series of air temperature [°C]                               </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Gthreshold   </em> </td>
<td style="text-align: left;"> [numeric] series of melt threshold [mm]                                </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$CemaNeigeLayers[[iLayer]]$Glocalmax    </em> </td>
<td style="text-align: left;"> [numeric] series of local melt threshold for hysteresis [mm]           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$WarmUpQsim</em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge (Q) on the warm-up period [mm/h] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$Param     </em> </td>
<td style="text-align: left;"> [numeric] parameter set parameter set used by the model                  </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StateEnd</em> </td>
<td style="text-align: left;"> [numeric] states at the end of the run: store &amp; unit hydrographs levels [mm], CemaNeige states [mm &amp; °C]. See <code>CreateIniStates</code> for more details </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Refer to the provided references or to the package source code for further details on these model outputs.
</p>


<h3>Author(s)</h3>

<p>Laurent Coron, Guillaume Thirel, Olivier Delaigue, Audrey Valéry, Vazken Andréassian
</p>


<h3>References</h3>

<p>Ficchi, A. (2017).
An adaptive hydrological model for multiple time-steps:
Diagnostics and improvements based on fluxes consistency.
PhD thesis, UPMC - Irstea Antony, Paris, France.
<br><br>
Ficchi, A., Perrin, C. and Andréassian, V. (2019).
Hydrological modelling at multiple sub-daily time steps: model improvement via flux-matching.
Journal of Hydrology, 575, 1308-1327, <a href="https://doi.org/10.1016/j.jhydrol.2019.05.084">doi:10.1016/j.jhydrol.2019.05.084</a>.
<br><br>
Perrin, C., Michel, C. and Andréassian, V. (2003).
Improvement of a parsimonious model for streamflow simulation.
Journal of Hydrology, 279(1-4), 275-289, <a href="https://doi.org/10.1016/S0022-1694%2803%2900225-7">doi:10.1016/S0022-1694(03)00225-7</a>.
<br><br>
Riboust, P., Thirel, G., Le Moine, N. and Ribstein, P. (2019).
Revisiting a simple degree-day model for integrating satellite data: Implementation of SWE-SCA hystereses.
Journal of Hydrology and Hydromechanics, 67(1), 70–81, <a href="https://doi.org/10.2478/johh-2018-0004">doi:10.2478/johh-2018-0004</a>.
<br><br>
Valéry, A., Andréassian, V. and Perrin, C. (2014).
"As simple as possible but not simpler": What is useful in a temperature-based snow-accounting routine?
Part 1 - Comparison of six snow accounting routines on 380 catchments.
Journal of Hydrology, 517(0), 1166-1175, <a href="https://doi.org/10.1016/j.jhydrol.2014.04.059">doi:10.1016/j.jhydrol.2014.04.059</a>.
<br><br>
Valéry, A., Andréassian, V. and Perrin, C. (2014).
"As simple as possible but not simpler": What is useful in a temperature-based snow-accounting routine?
Part 2 - Sensitivity analysis of the Cemaneige snow accounting routine on 380 catchments.
Journal of Hydrology, 517(0), 1176-1187, <a href="https://doi.org/10.1016/j.jhydrol.2014.04.058">doi:10.1016/j.jhydrol.2014.04.058</a>.
</p>


<h3>See Also</h3>

<p><code>RunModel_CemaNeige</code>, <code>RunModel_CemaNeigeGR4H</code>, <code>RunModel_GR5H</code>, <code>Imax</code>,
<code>CreateInputsModel</code>, <code>CreateRunOptions</code>, <code>CreateIniStates</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(airGR)

## loading catchment data
data(U2345030)


## preparation of the InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_CemaNeigeGR5H, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E, TempMean = BasinObs$T,
                                 ZInputs = BasinInfo$ZInputs,
                                 HypsoData = BasinInfo$HypsoData, NLayers = 5)

## run period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d %H")=="2004-03-01 00"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d %H")=="2008-12-31 23"))


## --- original version of CemaNeige

## Imax computation
Imax &lt;- Imax(InputsModel = InputsModel, IndPeriod_Run = Ind_Run,
             TestedValues = seq(from = 0, to = 3, by = 0.2))

## preparation of the RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_CemaNeigeGR5H, InputsModel = InputsModel,
                               Imax = Imax, IndPeriod_Run = Ind_Run)

## simulation
Param &lt;- c(X1 = 218.537, X2 = -0.009, X3 = 174.862, X4 = 6.674, X5 = 0.000,
           CNX1 = 0.002, CNX2 = 3.787)
OutputsModel &lt;- RunModel_CemaNeigeGR5H(InputsModel = InputsModel,
                                       RunOptions = RunOptions, Param = Param)

## results preview
plot(OutputsModel, Qobs = BasinObs$Qmm[Ind_Run])

## efficiency criterion: Nash-Sutcliffe Efficiency
InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                RunOptions = RunOptions, Obs = BasinObs$Qmm[Ind_Run])
OutputsCrit &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit, OutputsModel = OutputsModel)

## End(Not run)
</code></pre>


</div>