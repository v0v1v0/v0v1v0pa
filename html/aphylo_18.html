<div class="container">

<table style="width: 100%;"><tr>
<td>aphylo_from_data_frame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create an <code>aphylo</code> object with partial annotations</h2>

<h3>Description</h3>

<p>Create an <code>aphylo</code> object with partial annotations
</p>


<h3>Usage</h3>

<pre><code class="language-R">aphylo_from_data_frame(tree, annotations, types = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotations</code></td>
<td>
<p>A data.frame with annotations. The first column should
be the gene id (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>types</code></td>
<td>
<p>A data.frame with types. Just like the annotations, the first
column should be the gene id.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each row in the the <code>annotations</code> data frame passed to this function
must have a unique row per gene, and one column per function (GO term). The id
of each gene must match the labels in the <code>tree</code> object. Missing genes are
annotated with <code>NA</code> (9).
</p>
<p>In the case of <code>types</code>, while tips can also be annotated with a type, which
should be either 0, duplication, or 1, speciation, only internal nodes
are required. Tip types are ignored.
</p>


<h3>Value</h3>

<p>An object of class aphylo.
</p>


<h3>See Also</h3>

<p>Other Data management functions: 
<code>aphylo-class</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generating a test dataset
set.seed(1371)
x &lt;- raphylo(20)

# Extracting the tree and annotations
tree &lt;- x$tree

anno &lt;- with(x, rbind(tip.annotation, node.annotation))
anno &lt;- data.frame(id = with(tree, c(tip.label, node.label)), anno)

types &lt;- data.frame(id = tree$node.label, x$node.type)

# Creating a aphylo tree without node types
aphylo_from_data_frame(tree, anno)

# Now including types
aphylo_from_data_frame(tree, anno, types)

# Dropping some data
aphylo_from_data_frame(tree, anno[sample.int(nrow(anno), 10),])

</code></pre>


</div>