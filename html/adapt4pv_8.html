<div class="container">

<table style="width: 100%;"><tr>
<td>est_ps_bic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>propensity score estimation in high dimension with automated covariates selection using lasso-bic</h2>

<h3>Description</h3>

<p>Estimate a propensity score to a given drug exposure by
(i) selecting among other drug covariates in <code>x</code> which ones to
include in the PS estimation model automatically using lasso-bic
approach,
(ii) estimating a score using a classical logistic regression
with the afore selected covariates.
Internal function, not supposed to be used directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">est_ps_bic(idx_expo, x, penalty = rep(1, nvars - 1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>idx_expo</code></td>
<td>
<p>Index of the column in <code>x</code> that corresponds to the
drug covariate for which we aim at estimating the PS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Input matrix, of dimension nobs x nvars. Each row is an observation
vector. Can be in sparse matrix format (inherit from class
<code>"sparseMatrix"</code> as in package <code>Matrix</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>TEST OPTION penalty weights in the variable selection to
include in the PS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>glmnet</code> from package
<code>glmnet</code> other than <code>penalty.factor</code>,
<code>family</code>, <code>maxp</code> and <code>path</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>betaPos</code> option of <code>lasso_bic</code> function is set to
<code>FALSE</code> and <code>maxp</code> is set to 20.
For optimal storage, the returned elements <code>indicator_expo</code> and
<code>score</code> are Matrix with ncol = 1.
</p>


<h3>Value</h3>

<p>An object with S3 class <code>"ps", "bic"</code>.
</p>
<table><tr style="vertical-align: top;">
<td><code>expo_name</code></td>
<td>
<p>Character, name of the drug exposure for which the PS was
estimated. Correspond to <code>colnames(x)[idx_expo]</code></p>
</td>
</tr></table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>indicator_expo</code></td>
<td>
<p>One-column Matrix object.
Indicator of the drug exposure for which the PS was estimated.
Defined by <code>x[, idx_expo]</code>.</p>
</td>
</tr></table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>score_variables</code></td>
<td>
<p>Character vector, names of covariates(s) selected
with the lasso-bic approach to include in the PS estimation model.
Could be empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>One-column Matrix object, the estimated score.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emeline Courtois <br> Maintainer: Emeline Courtois
<a href="mailto:emeline.courtois@inserm.fr">emeline.courtois@inserm.fr</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(15)
drugs &lt;- matrix(rbinom(100*20, 1, 0.2), nrow = 100, ncol = 20)
colnames(drugs) &lt;- paste0("drugs",1:ncol(drugs))
ae &lt;- rbinom(100, 1, 0.3)
psb2 &lt;- est_ps_bic(idx_expo = 2, x = drugs)
psb2$score_variables #selected variables to include in the PS model of drug_2

</code></pre>


</div>