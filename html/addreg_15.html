<div class="container">

<table style="width: 100%;"><tr>
<td>nnnegbin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ECME Algorithm for Additive Negative Binomial 1 Model
</h2>

<h3>Description</h3>

<p>Finds the maximum likelihood estimate of an additive negative binomial (NB1) model
using an ECME algorithm,
where each of the mean coefficients is restricted to be non-negative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nnnegbin(y, x, standard, offset, start, control = addreg.control(),
         accelerate = c("em", "squarem", "pem", "qn"),
         control.method = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>non-negative integer response vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>non-negative covariate matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>

<p>standardising vector, where each element is a positive constant that
(multiplicatively) standardises the fitted value of the corresponding
element of the response vector. The default is a vector of ones.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>non-negative additive offset vector. The default is a vector of zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>vector of starting values for the parameter estimates. The last element is
the starting value of the <code>scale</code>, and must be <code>&gt; 1</code>. The remaining
elements are for the additive mean parameters, and must be
greater than <code>control$bound.tol</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>an <code>addreg.control</code> object, which controls the fitting process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accelerate</code></td>
<td>

<p>a character string that determines the acceleration
algorithm to be used, (partially) matching one of <code>"em"</code> (no acceleration – the default), 
<code>"squarem"</code>, <code>"pem"</code> or <code>"qn"</code>. See <code>turboem</code>
for further details. Note that <code>"decme"</code> is not permitted.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.method</code></td>
<td>

<p>a list of control parameters for the acceleration algorithm. See <code>turboem</code>
for details of the parameters that apply to each algorithm. If not specified, the defaults are used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a workhorse function for <code>addreg</code>, and runs the ECME algorithm to find the 
constrained non-negative MLE associated with an additive NB1 model.
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the constrained non-negative maximum likelihood estimate of the mean parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>the maximum likelihood estimate of the scale parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals at the MLE, that is <code>y - fitted.values</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the number of parameters in the model (named “<code>rank</code>" for compatibility —
we assume that models have full rank)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>included for compatibility — will always be <code>negbin1(identity)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>included for compatibility — same as <code>fitted.values</code> (as this is
an identity-link model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>up to a constant, minus twice the maximised log-likelihood (with respect to
a saturated NB1 model with the same <code>scale</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>a version of Akaike's <em>An Information Criterion</em>,
minus twice the maximised log-likelihood plus twice the 
number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.c</code></td>
<td>
<p>a small-sample corrected
version of Akaike's <em>An Information Criterion</em>
(Hurvich, Simonoff and Tsai, 1998).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.deviance</code></td>
<td>
<p>the deviance for the null model, comparable with <code>deviance</code>.
The null model will include the offset and an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations of the EM algorithm used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>included for compatibility — a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.weights</code></td>
<td>
<p>included for compatibility — a vector of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>
<p>the <code>standard</code> vector passed to this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom for the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the <code>y</code> vector used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical. Did the ECME algorithm converge 
(according to <code>conv.test</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary</code></td>
<td>
<p>logical. Is the MLE on the boundary of the parameter
space — i.e. are any of the <code>coefficients &lt; control$bound.tol</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the maximised log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn.design</code></td>
<td>
<p>the non-negative <code>x</code> matrix used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mark W. Donoghoe <a href="mailto:markdonoghoe@gmail.com">markdonoghoe@gmail.com</a>.
</p>


<h3>References</h3>

<p>Donoghoe, M. W. and I. C. Marschner (2016). Estimation of adjusted rate
differences using additive negative binomial regression. <em>Statistics
in Medicine</em> 35(18): 3166–3178.
</p>
<p>Hurvich, C. M., J. S. Simonoff and C.-L. Tsai (1998). Smoothing parameter 
selection in non-parametric regression using an improved Akaike 
information criterion.
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 60(2): 271–293.
</p>


</div>