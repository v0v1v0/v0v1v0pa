<div class="container">

<table style="width: 100%;"><tr>
<td>crrscKM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stratified Proportional Subdistribution Hazards Model For Clustered Competing Risks Data With Covariate-Independent Censoring</h2>

<h3>Description</h3>

<p>Stratified proportional subdistribution hazards model for clustered competing risks data.
The survival probability of the censoring distribution is obtained using the Kaplan-Meier estimates.
The estimates of the cumulative baseline hazard along with their standard errors are provided at the
pre-specified time points.
Furthermore, the adjusted cumulative incidence rates along with their standard errors are calculated at pre-specified time points. The standard errors of the
the difference in adjusted cumulative incidence rates between the groups are also provided.
Finally, the estimated adjusted cumulative incidence rates given vector <code>Z0</code> along with their standard errors are provided at
pre-specified time points. Tied data are handled by adding a tiny random shift from a normal distribution with mean 0 and standard deviation
1e-09.
</p>


<h3>Usage</h3>

<pre><code class="language-R">crrscKM(
  times,
  causes,
  covariates,
  treatment = NULL,
  clusters = 1:length(times),
  cencode = 0,
  failcode = 1,
  stratified.model = TRUE,
  est.t = FALSE,
  pre.t = sort(times[causes == failcode]),
  Z0 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>Failure/censored times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>causes</code></td>
<td>
<p>Failure code for each failure type (1 or 2) and 0 for censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>Matrix of covariates. Dummy variables must be created for categorical covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Treatment variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>Cluster variable. Independent data is assumed if this is not provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cencode</code></td>
<td>
<p>Code for censoring. By default it is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failcode</code></td>
<td>
<p>Code for the failure type of interest. By default it is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratified.model</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. By default, it is <code>TRUE</code> for stratified model. The stratification variable is <code>treatment</code>.
If this is <code>FALSE</code> and <code>est.t=TRUE</code>, then the <code>treatment</code> variable still needs to be provided and will be used as a covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.t</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. By default this is <code>FALSE</code>. If it is <code>TRUE</code> then estimates of cumulative baseline hazard, adjusted cumulative incidence and predicted cumulative incidence are provided along with their standard errors at pre-specified time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre.t</code></td>
<td>
<p>Pre-specified time points.
By default these are all main event times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z0</code></td>
<td>
<p>Covariate vector for prediction. By default this vector is a zero vector.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following components. If <code>est.t=FALSE</code> then only upto
$nstrata are provided.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$coef</code></td>
<td>
<p>Parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$p.value</code></td>
<td>
<p>p-value of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$var</code></td>
<td>
<p>Covariance matrix of parameter estimates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$infor</code></td>
<td>
<p>Information matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$loglikelihood</code></td>
<td>
<p>Maximum log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$n</code></td>
<td>
<p>Total number of observations used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$nevents</code></td>
<td>
<p>Total number of events and censored observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$nclusters</code></td>
<td>
<p>Total number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$nstrata</code></td>
<td>
<p>Total number of treatment groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$CumBaseHaz.t</code></td>
<td>
<p>Cumulative basline hazard estimates and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$Fpredict.t</code></td>
<td>
<p>Predicted cumulative incidence and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$AdjustedF.t</code></td>
<td>
<p>Adjusted cumulative incidence and their standard errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$Adjusted.se.diff</code></td>
<td>
<p>Standard error of the difference of adjusted cumulative incidence between the treatment groups</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#Simulated data
alpha = 0.5
d = simulate_CR_data(n=4,m=50,alpha=alpha,beta1=c(0.7,-0.7,-0.5)*1/alpha,
beta2=c(0.5,-0.5,1),betaC=c(0,0,0)*1/alpha,lambdaC=0.59)

#Stratified Model with est.t=TRUE
model1 &lt;- crrscKM(times=d[,1],causes=d[,2],covariates=d[,4:5],
treatment=d[,3],clusters=d[,6],stratified.model=TRUE,est.t=TRUE,
pre.t=sort(d$time[d$cause==1]),Z0=c(0.5,0.5))

#Unstratified Model with est.t=TRUE
model2 &lt;- crrscKM(times=d[,1],causes=d[,2],covariates=d[,4:5],
treatment=d[,3],clusters=d[,6],stratified.model=FALSE,est.t=TRUE,
pre.t=sort(d$time[d$cause==1]),Z0=c(0.5,0.5))

#Stratified Model with est.t=FALSE
model3 &lt;- crrscKM(times=d[,1],causes=d[,2],covariates=d[,4:5],
treatment=d[,3],clusters=d[,6],stratified.model=TRUE,est.t=FALSE,
pre.t=sort(d$time[d$cause==1]),Z0=c(0.5,0.5))

#Unstratified Model with est.t=FALSE.
#Create dummy variables first
dummy &lt;- model.matrix(~ factor(d[,3]))[,-1]
model4 &lt;- crrscKM(times=d[,1],causes=d[,2],covariates=cbind(d[,4:5],dummy),
clusters=d[,6],stratified.model=FALSE,est.t=FALSE,
pre.t=sort(d$time[d$cause==1]),Z0=c(0.5,0.5))

#Only continuous covariates are available.
model5 &lt;- crrscKM(times=d[,1],causes=d[,2],covariates=d[,4:5],
clusters=d[,6],stratified.model=FALSE,est.t=FALSE,
pre.t=sort(d$time[d$cause==1]),Z0=c(0.5,0.5))
</code></pre>


</div>