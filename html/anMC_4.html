<div class="container">

<table style="width: 100%;"><tr>
<td>conservativeEstimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Computationally efficient conservative estimate</h2>

<h3>Description</h3>

<p>Computes conservative estimates with two step GANMC procedure for a Gaussian vector. The probability is approximated with a biased low dimensional estimator and the bias is corrected with a MC estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conservativeEstimate(
  alpha = 0.95,
  pred,
  design,
  threshold,
  pn = NULL,
  type = "&gt;",
  verb = 1,
  lightReturn = T,
  algo = "GANMC"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>probability of conservative estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>list containing mean vector (pred$mean) and covariance matrix (pred$cov).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>a matrix of size <code>length(pred$mean)</code>x(input space dimension) that contains the design where <code>pred$mean</code> was computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>threshold, real number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pn</code></td>
<td>
<p>coverage probability function, vector of the same length as pred$mean (if not specified it is computed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of excursion: "&gt;" for excursion above threshold or "&lt;" for below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>
<p>level of verbosity, integer from 1–7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lightReturn</code></td>
<td>
<p>boolean for light return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algo</code></td>
<td>
<p>choice of algorithm for computing probabilities ("GANMC", "GMC").</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the conservative estimate (<code>set</code>), the Vorob'ev level (<code>lvs</code>). If <code>lightReturn=FALSE</code>, it also returns the actual probability of the set (<code>proba</code>) and the variance of this estimate (<code>vars</code>).
</p>


<h3>References</h3>

<p>Azzimonti, D. and Ginsbourger, D. (2018). Estimating orthant probabilities of high dimensional Gaussian vectors with an application to set estimation. Journal of Computational and Graphical Statistics, 27(2), 255-267. Preprint at <a href="https://hal.science/hal-01289126">hal-01289126</a>
</p>
<p>Azzimonti, D. (2016). Contributions to Bayesian set estimation relying on random field priors. PhD thesis, University of Bern.
</p>
<p>Bolin, D. and Lindgren, F. (2015). Excursion and contour uncertainty regions for latent Gaussian models. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 77(1):85–106.
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (!requireNamespace("DiceKriging", quietly = TRUE)) {
stop("DiceKriging needed for this example to work. Please install it.",
     call. = FALSE)
}
# Compute conservative estimate of excursion set of testfun below threshold
# Initialize
testfun&lt;-function(x){return(((3*x^2+7*x-3)*exp(-1*(x)^2)*cos(5*pi*x^2)-1.2*x^2))}
mDet&lt;- 1500

# Uniform design points
set.seed(42)
doe&lt;-runif(n = 8)
res&lt;-testfun(doe)
threshold&lt;-0
# create km
smallKm &lt;- DiceKriging::km(design = matrix(doe,ncol=1),
response = res,covtype = "matern5_2",coef.trend = -1,coef.cov = c(0.05),coef.var = 1.1)
# prediction at newdata
newdata&lt;-data.frame(matrix(seq(0,1,,mDet),ncol=1)); colnames(newdata)&lt;-colnames(smallKm@X)
pred&lt;-DiceKriging::predict.km(object = smallKm,newdata = newdata,type = "UK",cov.compute = TRUE)

## Not run: 
# Plot (optional)
plot(seq(0,1,,mDet),pred$mean,type='l')
points(doe,res,pch=10)
abline(h = threshold)
lines(seq(0,1,,mDet),pred$mean+pred$sd,lty=2,col=1)
lines(seq(0,1,,mDet),pred$mean-pred$sd,lty=2,col=1)

## End(Not run)
# Compute the coverage function
pn&lt;-pnorm((threshold-pred$mean)/pred$sd)

## Not run: 
pred$cov &lt;- pred$cov + 1e-7*diag(nrow = nrow(pred$cov),ncol = ncol(pred$cov))
CE&lt;-conservativeEstimate(alpha = 0.95,pred = pred,design = as.matrix(newdata),
threshold = threshold,type = "&lt;",verb=1, pn=pn,algo = "ANMC")
points(newdata[CE$set,],rep(-0.1,mDet)[CE$set],col=4,pch="-",cex=2)

## End(Not run)
</code></pre>


</div>