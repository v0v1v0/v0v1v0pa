<div class="container">

<table style="width: 100%;"><tr>
<td>corGrafen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Grafen's (1989) Correlation Structure</h2>

<h3>Description</h3>

<p>Grafen's (1989) covariance structure. Branch lengths are computed using
Grafen's method (see <code>compute.brlen</code>). The covariance
matrice is then the traditional variance-covariance matrix for a
phylogeny.
</p>


<h3>Usage</h3>

<pre><code class="language-R">corGrafen(value, phy, form=~1, fixed = FALSE)
## S3 method for class 'corGrafen'
coef(object, unconstrained = TRUE, ...)
## S3 method for class 'corGrafen'
corMatrix(object,
                  covariate = getCovariate(object), corr = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>The <code class="reqn">\rho</code> parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>An object of class <code>phylo</code> representing the phylogeny
(branch lengths are ignored) to consider</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An (initialized) object of class <code>corGrafen</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>a logical value. If 'TRUE' the function returns the
correlation matrix, otherwise it returns the variance/covariance
matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>an optional logical value indicating whether the
coefficients should be allowed to vary in the optimization, or kept
fixed at their initial value. Defaults to 'FALSE', in which case the
coefficients are allowed to vary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>a one sided formula of the form ~ t, or ~ t | g, specifying the taxa covariate t and, optionally, a grouping factor g. A covariate for this correlation structure must be character valued, with entries matching the tip labels in the phylogenetic tree. When a grouping factor is present in form, the correlation structure is assumed to apply only to observations within the same grouping level; observations with different grouping levels are assumed to be uncorrelated. Defaults to ~ 1, which corresponds to using the order of the observations in the data as a covariate, and no groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>an optional covariate vector (matrix), or list of covariate vectors (matrices), at which values the correlation matrix, or list of correlation matrices, are to be evaluated. Defaults to getCovariate(object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unconstrained</code></td>
<td>
<p>a logical value. If 'TRUE' the coefficients are
returned in unconstrained form (the same used in the optimization
algorithm). If 'FALSE' the coefficients are returned in "natural",
possibly constrained, form. Defaults to 'TRUE'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>some methods for these generics require additional
arguments. None are used in these methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>corGrafen</code> or the rho coefficient from an
object of this class or the correlation matrix of an initialized
object of this class.
</p>


<h3>Author(s)</h3>

<p>Julien Dutheil <a href="mailto:dutheil@evolbio.mpg.de">dutheil@evolbio.mpg.de</a></p>


<h3>References</h3>

<p>Grafen, A. (1989) The phylogenetic regression. <em>Philosophical
Transactions of the Royal society of London. Series B. Biological
Sciences</em>, <b>326</b>, 119â€“157.
</p>


<h3>See Also</h3>

<p><code>corClasses</code>, <code>compute.brlen</code>, <code>vcv.phylo</code>.
</p>


</div>