<div class="container">

<table style="width: 100%;"><tr>
<td>VSE_PS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Variable selection for confounders
</h2>

<h3>Description</h3>

<p>This function implements the penalized quadratic loss function to select the informative confounders.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VSE_PS(V,y,method="lasso",cv="TRUE",alpha=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>a user-specified matrix in the quadratic loss function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector determined by SIMEX_EST
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>it specifies a choice of the penalty function with options <code>"lasso"</code> (Tibshirani 1996), <code>"scad"</code> (Fan and Li 2001) and <code>"mcp"</code> (Zhang 2010). The default is set as <code>method="lasso"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>the usage for choosing the tuning parameter. <code>cv="TRUE"</code> suggests the use of the cross-validation method, and <code>cv="FALSE"</code> allows the use of the BIC. The default is set as <code>cv="TRUE"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the constant appearing in the Elastic Net penalty (Zou and Hastie 2005). The default value is 1.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is used to do variable selection for informative confounders by various choices of penalty functions.
</p>


<h3>Value</h3>

<p>a vector of estimators in the treatment model, where components with zero values represent confounders that are unimportant and need to excluded; components with nonzero values identify important confounders that enter the treatment model.
</p>


<h3>Author(s)</h3>

<p>Chen, L.-P. and Yi, G. Y.
</p>


<h3>References</h3>


<ol>
<li>
<p> Fan, J. and Li, R. (2001). Variable selection via nonconcave penalized likelihood and its oracle
properties. <em>Journal of the American Statistical Association</em>, 96, 1348-1360.
</p>
</li>
<li>
<p> Tibshirani, R. (1996). Regression shrinkage and selection via the lasso. <em>Journal of the Royal Statistical Society, Series B</em>, 58, 267-288.
</p>
</li>
<li>
<p> Yi, G. Y. and Chen, L.-P. (2023). Estimation of the average treatment effect with variable selection and measurement error simultaneously addressed for potential confounders. <em>Statistical Methods in Medical Research</em>, 32, 691-711.
</p>
</li>
<li>
<p> Zhang, C.-H. (2010). Nearly unbiased variable selection under minimax concave penalty. <em>The Annals of Statistics</em>, 38, 894-942.
</p>
</li>
<li>
<p>  Zou, H., and Hastie, T. (2005). Regularization and variable selection via the elastic net. <em>Journal of the Royal Statistical Society, Series B</em>, 67, 301-320.
</p>
</li>
</ol>
<h3>See Also</h3>

<p><code>SIMEX_EST</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(MASS)
n = 800
p_x = 10      # dimension of parameters
p_z = 10
p = p_x + p_z
gamma_X = c(rep(1,2),rep(0,p_x-2))
gamma_Z = c(rep(1,2),rep(0,p_z-2))
gamma = c(gamma_X, gamma_Z)

mu_X = rep(0,p_x)
mu_Z = rep(0,p_z)

Sigma_X = diag(1,p_x,p_x)
Sigma_Z = diag(1,p_z,p_z)
Sigma_e = diag(0.2,p_x)
X = mvrnorm(n, mu_X, Sigma_X, tol = 1e-6, empirical = FALSE, EISPACK = FALSE)
Z = mvrnorm(n, mu_Z, Sigma_Z, tol = 1e-6, empirical = FALSE, EISPACK = FALSE)
data = DG(X,Z,gamma_X,gamma_Z,Sigma_e,outcome="continuous")


y = as.vector(SIMEX_EST(data,PS="logistic",Psi = seq(0,2,length=10),p_x=length(gamma_X),
              K=5, Sigma_e=diag(0.2,p_x)))
V = diag(1,length(y),length(y))

VSE_PS(V,y,method="lasso",cv="TRUE")
VSE_PS(V,y,method="scad",cv="TRUE")
VSE_PS(V,y,method="mcp",cv="TRUE")

</code></pre>


</div>