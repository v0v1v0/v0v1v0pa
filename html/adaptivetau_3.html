<div class="container">

<table style="width: 100%;"><tr>
<td>ssa.exact</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Exact stochastic simulation algorithm
</h2>

<h3>Description</h3>

<p>Simulates the trajectory of a continuous-time Markov process (aka. the
Gillespie simulation algorithm).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssa.exact(init.values, transitions, rateFunc, params, tf,
          reportTransitions = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>init.values</code></td>
<td>

<p>Vector of initial values for all variables.  This should be a simple
one-dimensional vector of real numbers.  <em>IMPORTANT:</em> variables
must never take negative values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transitions</code></td>
<td>

<p>Two-dimensional matrix of integers specifying how each state
variable (rows) should be changed for a given transition (columns).
Generally this will be a sparse matrix of primarily 1s and -1s.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rateFunc</code></td>
<td>

<p>R-function that returns instantaneous transition rates for each
transition in the form a real-valued one-dimensional vector with
length equal to the number of transitions.  The order of these
rates must match the order in which transitions were specified in
the <code>transitions</code> parameter above.  This function must accept
the following arguments:
</p>

<ul>
<li>
<p> vector of current values for all state variables (in order
used in the <code>init.values</code> argument above)
</p>
</li>
<li>
<p> parameters as supplied in argument to ssa.adaptivetau
</p>
</li>
<li>
<p> single real number giving the current time (all simulations
start at t=0)
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>

<p>any R variable to be passed as-is to rateFunc, presumably specifying
useful parameters.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tf</code></td>
<td>

<p>final time of simulation.  Due to the approximate nature of the
tau-leaping algorithm, the simulation may overshoot this time somewhat.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reportTransitions</code></td>
<td>
<p>default FALSE; whether to include a
matrix of executed transitions per time interval in the output
(alongside with the states at each time point).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is supplied as a bonus with the adaptivetau package,
since the C++ function that underlies this (exact) stochastic
simulation algorithm is used in the (approximate) adaptive tau
stochastic simulation as well.
</p>
<p>The initial values, transition matrix, and transition rates must all
be designed such that variables are always non-negative.  The
algorithm relies on this invariant.
</p>
<p>Consider calling <code>enableJIT(1)</code> before running
ssa.exact.  In most circumstances, this should yield some speedup by
byte-code compiling the rate function.
</p>


<h3>Value</h3>

<p>Two-dimensional matrix with rows for every timepoint at which the
rateFunc was evaluated and columns giving the value for every state
variable at that time.  The first column specifies the time.
</p>
<p>If the ‘reportTransitions’ option is used, then a list is
returned with two elements.  The first element is the
‘dynamics’ matrix described above.  The second is a
two-dimensional matrix called ‘transitions’ with a row for each
timepoint and columns giving the number of times each transition was
executed between the current time and the previous time.
</p>


<h3>Author(s)</h3>

<p>Philip Johnson
</p>


<h3>See Also</h3>


<p>This function is a bonus the comes along with the approximate (but
faster) <code>ssa.adaptivetau</code>.  For systems with sparse
transition matrices, see helper function <code>ssa.maketrans</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Lotka-Volterra example
lvrates &lt;- function(x, params, t) {
  with(params, {
    return(c(preygrowth*x["prey"],      ## prey growth rate
             x["prey"]*x["pred"]*eat,   ## prey death / predator growth rate
             x["pred"]*preddeath))      ## predator death rate
  })
}
params=list(preygrowth=10, eat=0.01, preddeath=10);
r=ssa.exact(c(prey = 1000, pred = 500),
            matrix(c(1,0, -2,1, 0,-1), nrow=2), lvrates, params, tf=2)
matplot(r[,"time"], r[,c("prey","pred")], type='l', xlab='Time', ylab='Counts')
legend("topleft", legend=c("prey", "predator"), lty=1:2, col=1:2)
</code></pre>


</div>