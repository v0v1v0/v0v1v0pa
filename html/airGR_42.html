<div class="container">

<table style="width: 100%;"><tr>
<td>RunModel_GR6J</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run with the GR6J hydrological model</h2>

<h3>Description</h3>

<p>Function which performs a single run for the GR6J daily lumped model over the test period.
</p>


<h3>Usage</h3>

<pre><code class="language-R">RunModel_GR6J(InputsModel, RunOptions, Param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>InputsModel</code></td>
<td>
<p>[object of class <em>InputsModel</em>] see <code>CreateInputsModel</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RunOptions</code></td>
<td>
<p>[object of class <em>RunOptions</em>] see <code>CreateRunOptions</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Param</code></td>
<td>
<p>[numeric] vector of 6 parameters
</p>

<table>
<tr>
<td style="text-align: left;">
    GR6J X1 </td>
<td style="text-align: left;"> production store capacity [mm]               </td>
</tr>
<tr>
<td style="text-align: left;">
    GR6J X2 </td>
<td style="text-align: left;"> intercatchment exchange coefficient [mm/d]   </td>
</tr>
<tr>
<td style="text-align: left;">
    GR6J X3 </td>
<td style="text-align: left;"> routing store capacity [mm]                  </td>
</tr>
<tr>
<td style="text-align: left;">
    GR6J X4 </td>
<td style="text-align: left;"> unit hydrograph time constant [d]            </td>
</tr>
<tr>
<td style="text-align: left;">
    GR6J X5 </td>
<td style="text-align: left;"> intercatchment exchange threshold [-]        </td>
</tr>
<tr>
<td style="text-align: left;">
    GR6J X6 </td>
<td style="text-align: left;"> exponential store depletion coefficient [mm] </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For further details on the model, see the references section. <br>
For further details on the argument structures and initialisation options, see <code>CreateRunOptions</code>.
<br><br><img src="../help/figures/diagramGR6J-EN.png" width="60%" alt="Figure: diagramGR6J-EN.png"></p>


<h3>Value</h3>

<p>[list] containing the function outputs organised as follows:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>$DatesR  </em> </td>
<td style="text-align: left;"> [POSIXlt] series of dates                                                     </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PotEvap </em> </td>
<td style="text-align: left;"> [numeric] series of input potential evapotranspiration (E) [mm/d]             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Precip  </em> </td>
<td style="text-align: left;"> [numeric] series of input total precipitation (P) [mm/d]                      </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Prod    </em> </td>
<td style="text-align: left;"> [numeric] series of production store level (S) [mm]                           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Pn      </em> </td>
<td style="text-align: left;"> [numeric] series of net rainfall (Pn) [mm/d]                                  </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Ps      </em> </td>
<td style="text-align: left;"> [numeric] series of the part of Pn filling the production store (Ps) [mm/d]   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AE      </em> </td>
<td style="text-align: left;"> [numeric] series of actual evapotranspiration [mm/d]                          </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Perc    </em> </td>
<td style="text-align: left;"> [numeric] series of percolation (Perc) [mm/d]                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$PR      </em> </td>
<td style="text-align: left;"> [numeric] series of Pr=Pn-Ps+Perc (Pr) [mm/d]                                 </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Q9      </em> </td>
<td style="text-align: left;"> [numeric] series of UH1 outflow (Q9) [mm/d]                                   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Q1      </em> </td>
<td style="text-align: left;"> [numeric] series of UH2 outflow (Q1) [mm/d]                                   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Rout    </em> </td>
<td style="text-align: left;"> [numeric] series of routing store level (R1) [mm]                             </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Exch    </em> </td>
<td style="text-align: left;"> [numeric] series of potential semi-exchange between catchments [mm/d]         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch1  </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments for branch 1 [mm/d]    </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch2  </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments for branch 2 [mm/d]    </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$AExch   </em> </td>
<td style="text-align: left;"> [numeric] series of actual exchange between catchments (AExch1+AExch2) [mm/d] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$QR      </em> </td>
<td style="text-align: left;"> [numeric] series of routing store outflow (Qr) [mm/d]                         </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$QRExp   </em> </td>
<td style="text-align: left;"> [numeric] series of exponential store outflow (QrExp) [mm/d]                  </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Exp     </em> </td>
<td style="text-align: left;"> [numeric] series of exponential store level (negative) (R2) [mm]              </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$QD      </em> </td>
<td style="text-align: left;"> [numeric] series of direct flow from UH2 after exchange (Qd) [mm/d]           </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$Qsim    </em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge (Q) [mm/d]                            </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$WarmUpQsim</em> </td>
<td style="text-align: left;"> [numeric] series of simulated discharge (Q) on the warm-up period [mm/d] </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>RunOptions$Param     </em> </td>
<td style="text-align: left;"> [numeric] parameter set parameter set used by the model                  </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StateEnd</em> </td>
<td style="text-align: left;"> [numeric] states at the end of the run (res. levels, UH1 levels, UH2 levels) [mm]. See <code>CreateIniStates</code> for more details </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<p>Refer to the provided references or to the package source code for further details on these model outputs.
</p>


<h3>Author(s)</h3>

<p>Laurent Coron, Claude Michel, Charles Perrin, Raji Pushpalatha, Nicolas Le Moine, Olivier Delaigue, Guillaume Thirel
</p>


<h3>References</h3>

<p>Pushpalatha, R., Perrin, C., Le Moine, N., Mathevet, T. and Andr√©assian, V. (2011).
A downward structural sensitivity analysis of hydrological models to improve low-flow simulation.
Journal of Hydrology, 411(1-2), 66-76, <a href="https://doi.org/10.1016/j.jhydrol.2011.09.034">doi:10.1016/j.jhydrol.2011.09.034</a>.
</p>


<h3>See Also</h3>

<p><code>RunModel_GR4J</code>, <code>RunModel_GR5J</code>, <code>RunModel_CemaNeigeGR6J</code>,
<code>CreateInputsModel</code>, <code>CreateRunOptions</code>, <code>CreateIniStates</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## loading catchment data
data(L0123001)

## preparation of the InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_GR6J, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E)

## run period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))

## preparation of the RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_GR6J,
                               InputsModel = InputsModel, IndPeriod_Run = Ind_Run)

## simulation
Param &lt;- c(X1 = 242.257, X2 = 0.637, X3 = 53.517, X4 = 2.218, X5 = 0.424, X6 = 4.759)
OutputsModel &lt;- RunModel_GR6J(InputsModel = InputsModel,
                             RunOptions = RunOptions, Param = Param)

## results preview
plot(OutputsModel, Qobs = BasinObs$Qmm[Ind_Run])

## efficiency criterion: Nash-Sutcliffe Efficiency
InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                RunOptions = RunOptions, Obs = BasinObs$Qmm[Ind_Run])
OutputsCrit &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit, OutputsModel = OutputsModel)
</code></pre>


</div>