<div class="container">

<table style="width: 100%;"><tr>
<td>SupplyChain-Functions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Supply Chain Merger Simulation</h2>

<h3>Description</h3>

<p>Calibrates consumer demand using (Nested) Logit
and then simulates the price effect of a merger between two firms
under the assumption that all firms in the market are playing a
differentiated products Bertrand pricing game.
</p>
<p>Let k denote the number of products produced by all
firms playing the Bertrand pricing game below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vertical.barg(
  supplyDown = c("bertrand", "2nd"),
  sharesDown,
  pricesDown,
  marginsDown,
  ownerPreDown,
  ownerPostDown,
  nests = rep(NA, length(pricesDown)),
  diversions = diversions,
  mcDeltaDown = rep(0, length(pricesDown)),
  pricesUp,
  marginsUp,
  ownerPreUp,
  ownerPostUp,
  mcDeltaUp = rep(0, length(pricesUp)),
  normIndex = ifelse(isTRUE(all.equal(sum(sharesDown), 1, check.names = FALSE)), 1, NA),
  subset = rep(TRUE, length(pricesDown)),
  insideSize = NA_real_,
  priceOutside = 0,
  priceStartDown = pricesDown,
  priceStartUp = pricesUp,
  isMax = FALSE,
  constrain = c("global", "pair", "wholesaler", "retailer"),
  control.slopes,
  control.equ,
  labels = paste0("Prod", 1:length(pricesUp)),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>supplyDown</code></td>
<td>
<p>A length 1 character vector that specifies whether the downstream
game that firms are playing is a Nash-Bertrand Pricing game ("bertrand”) or a 2nd score 
auction ("2nd"). Default is "bertrand".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sharesDown</code></td>
<td>
<p>A length k vector of product (quantity) shares. Values must be
between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pricesDown</code></td>
<td>
<p>A length k vector of downstream product prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginsDown</code></td>
<td>
<p>A length k vector of downstream product margins in levels (e.g. dollars), some of which may
equal NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ownerPreDown</code></td>
<td>
<p>A vector of length k whose values
indicate which downstream firm produced a product pre-merger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ownerPostDown</code></td>
<td>
<p>A vector of length k whose values
indicate which downstream firm produced a product post-merger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nests</code></td>
<td>
<p>A length k factor of product nests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diversions</code></td>
<td>
<p>A k x k matrix of diversion ratios with diagonal
elements equal to -1. Default is missing, in which case diversion
according to share is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcDeltaDown</code></td>
<td>
<p>A vector of length k where each element equals the
proportional change in a downstream firm's product-level marginal costs due to
the merger. Default is 0, which assumes that the merger does not
affect any products' marginal cost.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pricesUp</code></td>
<td>
<p>A length k vector of upstream product prices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginsUp</code></td>
<td>
<p>A length k vector of upstream product margins in levels (e.g. dollars), some of which may
equal NA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ownerPreUp</code></td>
<td>
<p>A vector of length k whose values
indicate which upstream firm produced a product pre-merger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ownerPostUp</code></td>
<td>
<p>A vector of length k whose values
indicate which upstream firm produced a product after the merger.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcDeltaUp</code></td>
<td>
<p>A vector of length k where each element equals the
proportional change in a upstream firm's product-level marginal costs due to
the merger. Default is 0, which assumes that the merger does not
affect any products' marginal cost.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normIndex</code></td>
<td>
<p>An integer equalling the index (position) of the
inside product whose mean valuation will be normalized to 1. Default
is 1, unless ‘shares’ sum to less than 1, in which case the default is
NA and an outside good is assumed to exist.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A vector of length k where each element equals TRUE if
the product indexed by that element should be included in the
post-merger simulation and FALSE if it should be excluded.Default is a
length k vector of TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>insideSize</code></td>
<td>
<p>An integer equal to total pre-merger units sold.
If shares sum to one, this also equals the size of the market.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceOutside</code></td>
<td>
<p>A length 1 vector indicating the price of the
outside good. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceStartDown</code></td>
<td>
<p>A length k vector of starting values used to solve for
downstream equilibrium prices. Default is the ‘pricesDown’ vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priceStartUp</code></td>
<td>
<p>A length k vector of starting values used to solve for
upstream equilibrium price. Default is the ‘pricesUp’ vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isMax</code></td>
<td>
<p>If TRUE, checks to see whether computed price equilibrium
locally maximizes firm profits and returns a warning if not. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrain</code></td>
<td>
<p>Specify calibration strategy for estimating bargaining power parameter. 
"global" (default) assumes bargaining parameter is the same across all participants,"pair" assumes 
that all wholesaler/retailer pairs have a distinct parameter,"wholesaler" assumes that each wholesaler's
parameter is identical across negotiations, "retailer" assumes that each 
retailer's parameter is identical across negotiations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.slopes</code></td>
<td>
<p>A list of  <code>optim</code>
control parameters passed to the calibration routine
optimizer (typically the <code>calcSlopes</code> method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control.equ</code></td>
<td>
<p>A list of  <code>BBsolve</code> control parameters
passed to the non-linear equation solver (typically the <code>calcPrices</code> method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>A k-length vector of labels. Default is "Prod#", where
‘#’ is a number between 1 and the length of ‘prices’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options to feed to the <code>BBsolve</code>
optimizer used to solve for equilibrium prices.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using product prices, quantity shares and all of the
product margins from at least one firm, <code>logit</code> is able to
recover the price coefficient and product mean valuations in a
Logit demand model. <code>logit</code> then uses these
calibrated parameters to simulate a merger between two firms.
</p>


<h3>Value</h3>

<p>When 'supplyDown' equals "bertand", <code>vertical.barg</code> returns an instance of class
<code>VertBargBertLogit</code>. When 'supplyDown' equals "2nd", <code>vertical.barg</code> returns an instance of class
<code>VertBarg2ndLogit</code>
</p>


<h3>Author(s)</h3>

<p>Charles Taragin <a href="mailto:ctaragin+antitrustr@gmail.com">ctaragin+antitrustr@gmail.com</a>
</p>


<h3>References</h3>

<p>Sheu, G. and Taragin, C. (2021), Simulating mergers in a vertical supply chain with bargaining. The RAND Journal of Economics, 52: 596-632.doi: <a href="https://doi.org/10.1111/1756-2171.12385">10.1111/1756-2171.12385</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Vertical supply with 2 upstream firms,
## 2 downstream firms, each offering 
## a single product.

shareDown &lt;- c( 0.1293482, 0.1422541, 0.4631014, 0.2152962)
marginDown &lt;- c( 0.2067533, 0.2572215, 0.3082511, 0.3539681)
priceDown &lt;- c( 63.08158, 50.70465, 95.82960, 83.45267)
ownerPreDown &lt;- paste0("D",rep(c(1,2),each=2))
marginUp &lt;- c(0.5810900, 0.5331135, 0.5810900, 0.5331135)
priceUp &lt;- c( 40.11427, 27.73734, 40.11427, 27.73734)
ownerPreUp &lt;- paste0("U",rep(c(1,2),2))
priceOutSide &lt;- 10


## Simulate an upstream horizontal merger
ownerPostDown &lt;- ownerPreDown
ownerPostUp &lt;- rep("U1",length(ownerPreUp))


simres_up &lt;- vertical.barg(sharesDown =shareDown,
pricesDown = priceDown,
marginsDown = marginDown,
ownerPreDown = ownerPreDown,
ownerPostDown = ownerPreDown,
pricesUp = priceUp,
marginsUp = marginUp,
ownerPreUp = ownerPreUp,
ownerPostUp = ownerPostUp,
priceOutside = priceOutSide)


print(simres_up)
summary(simres_up)

## Simulate a downstream horizontal merger
ownerPostUp &lt;- ownerPreUp
ownerPostDown &lt;- ownerPreDown
ownerPostDown &lt;- rep("D1",length(ownerPreDown))

simres_down &lt;- vertical.barg(sharesDown =shareDown,
pricesDown = priceDown,
marginsDown = marginDown,
ownerPreDown = ownerPreDown,
ownerPostDown = ownerPostDown,
pricesUp = priceUp,
marginsUp = marginUp,
ownerPreUp = ownerPreUp,
ownerPostUp = ownerPreUp,
priceOutside = priceOutSide)


print(simres_down)
summary(simres_down)


## Simulate a vertical merger
ownerPostUp &lt;- ownerPreUp
ownerPostDown &lt;- ownerPreDown
ownerPostDown[ownerPostDown == "D1"] &lt;- "U1"

simres_vert &lt;- vertical.barg(sharesDown =shareDown,
pricesDown = priceDown,
marginsDown = marginDown,
ownerPreDown = ownerPreDown,
ownerPostDown = ownerPostDown,
pricesUp = priceUp,
marginsUp = marginUp,
ownerPreUp = ownerPreUp,
ownerPostUp = ownerPreUp,
priceOutside = priceOutSide)


print(simres_vert)
summary(simres_vert)
</code></pre>


</div>