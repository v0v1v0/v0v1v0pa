<div class="container">

<table style="width: 100%;"><tr>
<td>iplot_pheno</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phenological Plot</h2>

<h3>Description</h3>

<p>Generates a boxplot based on phenological parameters (start_dates and end_dates) that are calculated by the estimation of the main parameters of the pollen season
</p>


<h3>Usage</h3>

<pre><code class="language-R">iplot_pheno(data, method = "percentage", n.types = 15, th.day = 100,
  perc = 95, def.season = "natural", reduction = FALSE,
  red.level = 0.9, derivative = 5, man = 11, th.ma = 5,
  n.clinical = 5, window.clinical = 7, window.grains = 5,
  th.pollen = 10, th.sum = 100, type = "none",
  interpolation = TRUE, int.method = "lineal", type.plot = "static",
  export.plot = FALSE, export.format = "pdf", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where calculation of the pollen season must be applied in order to generate the phenological plot based on the start_dates and end_dates. This <code>data.frame</code> must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <code>calculate_ps</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.types</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of the most abundant pollen types that must be represented in the pollen calendar. A more detailed information about the selection of the considered pollen types may be consulted in <strong>Details</strong>. The <code>n.types</code> argument will be <code>15</code> types by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.day</code></td>
<td>
<p>A <code>numeric</code> value in order to calculate the number of days when this level is exceeded for each year and each pollen type. This value will be obtained in the results of the function. The <code>th.day</code> argument will be <code>100</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_100</code>. This argument is valid only for <code>method = "percentage"</code>. This value represents the percentage of the total annual pollen included in the pollen season, removing <code>(100_perc)/2%</code> of the total pollen before and after of the pollen season. The <code>perc</code> argument will be <code>95</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>def.season</code></td>
<td>
<p>A <code>character</code> string specifying the method for selecting the best annual period to calculate the pollen season. The pollen seasons may occur within the natural year or otherwise may occur between two years which determines the best annual period considered. The implemented options that can be used are: <code>"natural"</code>, <code>"interannual"</code> or <code>"peak"</code>. The <code>def.season</code> argument will be <code>"natural"</code> by default. A more detailed information about the different methods for selecting the best annual period to calculate the pollen season may be consulted in <code>calculate_ps</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>A <code>logical</code> value. This argument is valid only for the <code>"logistic"</code> method. If <code>FALSE</code> the reduction of the pollen data is not applicable. If <code>TRUE</code> a reduction of the peaks above a certain level (<code>red.level</code> argument) will be carried out before the definition of the pollen season. The <code>reduction</code> argument will be <code>FALSE</code> by default. A more detailed information about the reduction process may be consulted in <code>calculate_ps</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>red.level</code></td>
<td>
<p>A <code>numeric</code> value ranging <code>0_1</code> specifying the percentile used as level to reduce the peaks of the pollen series before the definition of the pollen season. This argument is valid only for the <code>"logistic"</code> method. The <code>red.level</code> argument will be <code>0.90</code> by default, specifying the percentile 90.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivative</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value belonging to options of <code>4</code>, <code>5</code> or <code>6</code> specifying the derivative that will be applied to calculate the asymptotes which determines the pollen season using the <code>"logistic"</code> method. This argument is valid only for the <code>"logistic"</code> method. The <code>derivative</code> argument will be <code>5</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>man</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the order of the moving average applied to calculate the pollen season using the <code>"moving"</code> method. This argument is valid only for the <code>"moving"</code> method. The <code>man</code> argument will be <code>11</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.ma</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold used for the <code>"moving"</code> method for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"moving"</code> method. The <code>th.ma</code> argument will be <code>5</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the number of days which must exceed a given threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season. This argument is valid only for the <code>"clinical"</code> method. The <code>n.clinical</code> argument will be <code>5</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.clinical</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>window.clinical</code> argument will be <code>7</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.grains</code></td>
<td>
<p>A <code>numeric</code> (<code>integer</code>) value specifying the time window during which the conditions must be evaluated for defining the beginning and the end of the pollen season using the <code>"grains"</code> method. This argument is valid only for the <code>"grains"</code> method. The <code>window.grains</code> argument will be <code>5</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.pollen</code></td>
<td>
<p>A <code>numeric</code> value specifying the threshold that must be exceeded during a given number of days (<code>n.clinical</code> or <code>window.grains</code> arguments) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> or <code>"grains"</code> methods. This argument is valid only for the <code>"clinical"</code> or <code>"grains"</code> methods. The <code>th.pollen</code> argument will be <code>10</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.sum</code></td>
<td>
<p>A <code>numeric</code> value specifying the pollen threshold that must be exceeded by the sum of daily pollen during a given number of days (<code>n.clinical</code> argument) exceeding a given daily threshold (<code>th.pollen</code> argument) for defining the beginning and the end of the pollen season using the <code>"clinical"</code> method. This argument is valid only for the <code>"clinical"</code> method. The <code>th.sum</code> argument will be <code>100</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A <code>character</code> string specifying the parameters considered according to a specific pollen type for calculating the pollen season using the <code>"clinical"</code> method. The implemented pollen types that may be used are: <code>"birch"</code>, <code>"grasses"</code>, <code>"cypress"</code>, <code>"olive"</code> or <code>"ragweed"</code>. As result for selecting any of these pollen types the parameters <code>n.clinical</code>, <code>window.clinical</code>, <code>th.pollen</code> and <code>th.sum</code> will be automatically adjusted for the <code>"clinical"</code> method. If no pollen types are specified (<code>type = "none"</code>), these parameters will be considered by the user. This argument is valid only for the <code>"clinical"</code> method. The <code>type</code> argument will be <code>"none"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolation</code></td>
<td>
<p>A <code>logical</code> value. If <code>FALSE</code> the interpolation of the pollen data is not applicable. If <code>TRUE</code> an interpolation of the pollen series will be applied to complete the gaps with no data before the calculation of the pollen season. The <code>interpolation</code> argument will be <code>TRUE</code> by default. A more detailed information about the interpolation method may be consulted in <strong>Details</strong>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.method</code></td>
<td>
<p>A <code>character</code> string specifying the method selected to apply the interpolation method in order to complete the pollen series. The implemented methods that may be used are: <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. The <code>int.method</code> argument will be <code>"lineal"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.plot</code></td>
<td>
<p>A <code>character</code> string specifying the type of plot selected to show the phenological plot. The implemented types that may be used are: <code>"static"</code> generates a static <strong>ggplot</strong> object and <code>"dynamic"</code> generates a dynamic <strong>plotly</strong> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.plot</code></td>
<td>
<p>A <code>logical</code> value specifying if a phenological plot saved in the working directory will be required or not. If <code>FALSE</code> graphical results will only be displayed in the active graphics window. If <code>TRUE</code> graphical results will be displayed in the active graphics window and also a <em>pdf</em> or <em>png</em> file (according to the <code>export.format</code> argument) will be saved within the <em>plot_AeRobiology</em> directory automatically created in the working directory. This argument is applicable only for <code>"static"</code> plots. The <code>export.plot</code> will be <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.format</code></td>
<td>
<p>A <code>character</code> string specifying the format selected to save the phenological plot. The implemented formats that may be used are: <code>"pdf"</code> and <code>"png"</code>. This argument is applicable only for <code>"static"</code> plots. The <code>export.format</code> will be <code>"pdf"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other additional arguments may be used to customize the exportation of the plots using <em>pdf</em> or <em>png</em> files and therefore arguments from <code>pdf</code> and <code>png</code> functions (<span class="pkg">grDevices</span> package) may be implemented. For example, for <em>pdf</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>family</code>, <code>title</code>, <code>fonts</code>, <code>paper</code>, <code>bg</code>, <code>fg</code>, <code>pointsize...</code>; and for <em>png</em> files the user may custom the arguments: <code>width</code>, <code>height</code>, <code>units</code>, <code>pointsize</code>, <code>bg</code>, <code>res...</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows to calculate the pollen season using five different methods which are described in <code>calculate_ps</code> function. After calculating the start_date and end_date for each pollen type and each year a phenological plot will be generated using the boxplot approach where axis x represents the time (Day of the Year) and axis y includes the considered pollen types. The phenological plot will be generated only for the specified number of the most abundant pollen types using the <code>n.types</code> argument by the user. The implemented methods for defining the pollen season includes the most commonly used methodologies (<em>Nilsson and Persson, 1981</em>; <em>Andersen, 1991</em>; <em>Galan et al., 2001</em>; <em>Ribeiro et al., 2007</em>; <em>Cunha et al., 2015</em>, <em>Pfaar et al., 2017</em>) and a new implemented method (see <code>calculate_ps</code> function).<br>
Pollen time series frequently have different gaps with no data and this fact could be a problem for the calculation of specific methods for defining the pollen season even providing incorrect results. In this sense by default a linear interpolation will be carried out to complete these gaps before to define the pollen season (<code>interpolation = TRUE</code>). Additionally, the users may select other interpolation methods using the <code>int.method</code> argument, as <code>"lineal"</code>, <code>"movingmean"</code>, <code>"spline"</code> or <code>"tseries"</code>. For more information to see the <code>interpollen</code> function.
</p>


<h3>Value</h3>

<p>This function returns different results:<br>
If <code>export.plot = FALSE</code> graphical results will only be displayed in the active graphics window as <strong>ggplot</strong> graph. Additional characteristics may be incorporated to the plot by <code>ggplot</code> syntax (see <span class="pkg">ggplot2</span> package).<br>
If <code>export.plot = TRUE</code> and <code>export.format = pdf</code> a <em>pdf</em> file of the phenological plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation as <em>pdf</em> file (see <span class="pkg">grDevices</span> package).<br>
If <code>export.plot = TRUE</code> and <code>export.format = png</code> a <em>png</em> file of the phenological plot will be saved within the <em>plot_AeRobiology</em> directory created in the working directory. This option is applicable only for <code>"static"</code> plots. Additional characteristics may be incorporated to the exportation <em>png</em> file (see <span class="pkg">grDevices</span> package).<br>
If <code>type.plot = dynamic</code> graphical results will be displayed in the active Viewer window as <strong>plotly</strong> graph. Additional characteristics may be incorporated to the plot <code>plotly</code> syntax (see <span class="pkg">plotly</span> package).
</p>


<h3>References</h3>

<p>Andersen, T.B., 1991. A model to predict the beginning of the pollen season. <em>Grana</em>, 30(1), pp.269_275.
</p>
<p>Cunha, M., Ribeiro, H., Costa, P. and Abreu, I., 2015. A comparative study of vineyard phenology and pollen metrics extracted from airborne pollen time series. <em>Aerobiologia</em>, 31(1), pp.45_56.
</p>
<p>Galan, C., Garcia_Mozo, H., Carinanos, P., Alcazar, P. and Dominguez_Vilches, E., 2001. The role of temperature in the onset of the <em>Olea europaea</em> L. pollen season in southwestern Spain. <em>International Journal of Biometeorology</em>, 45(1), pp.8_12.
</p>
<p>Nilsson, S. and Persson, S., 1981. Tree pollen spectra in the Stockholm region (Sweden), 1973_1980. <em>Grana</em>, 20(3), pp.179_182.
</p>
<p>Pfaar, O., Bastl, K., Berger, U., Buters, J., Calderon, M.A., Clot, B., Darsow, U., Demoly, P., Durham, S.R., Galan, C., Gehrig, R., Gerth van Wijk, R., Jacobsen, L., Klimek, L., Sofiev, M., Thibaudon, M. and Bergmann, K.C., 2017. Defining pollen exposure times for clinical trials of allergen immunotherapy for pollen_induced rhinoconjunctivitis_an EAACI position paper. <em>Allergy</em>, 72(5), pp.713_722.
</p>
<p>Ribeiro, H., Cunha, M. and Abreu, I., 2007. Definition of main pollen season using logistic model. <em>Annals of Agricultural and Environmental Medicine</em>, 14(2), pp.259_264.
</p>


<h3>See Also</h3>

<p><code>calculate_ps</code>, <code>interpollen</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("munich_pollen")
iplot_pheno (munich_pollen, interpolation = FALSE)
</code></pre>


</div>