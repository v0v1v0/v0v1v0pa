<div class="container">

<table style="width: 100%;"><tr>
<td>plot_multivariate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiavariate plot (surface)</h2>

<h3>Description</h3>

<p>Multiavariate plot (surface)
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_multivariate(
  fun,
  params,
  domain,
  sets,
  nlevels = 20,
  args = list(),
  plotfun = graphics::image,
  plot = TRUE,
  postplot = function(params, res) {
     points(params, cex = 2, pch = 3, col = "red")

    },
  mfrow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A function that receives 2 or more parameters and returns a single
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Numeric vector with the default parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>domain</code></td>
<td>
<p>(optional) Named list with as many elements as parameters. Specifies the
domain of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sets</code></td>
<td>
<p>(optional) Character matrix of size <code style="white-space: pre;">⁠2 x # of combinations⁠</code>.
contains the names of the pairs to plot. If nothing passed, the function will
generate all possible combinations as <code>combn(names(params), 2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlevels</code></td>
<td>
<p>Integer. Number of levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>List of named arguments to be passed to <code>fun</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotfun</code></td>
<td>
<p>Function that will be used to plot <code style="white-space: pre;">⁠x,y,z⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. When <code>FALSE</code> skips plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postplot</code></td>
<td>
<p>Function to be called after <code>plotfun</code>. Should recieve a vector
with the current parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mfrow</code></td>
<td>
<p>Passed to graphics::par.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>plotfun</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of length <code>length(sets)</code>, each with the following:
</p>

<ul>
<li>
<p> x,y,z vectors of coordinates.
</p>
</li>
<li>
<p> xlab,ylab vectors with the corresponding labels.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example: A model with less parameters
set.seed(1231)
x &lt;- raphylo(20)
ans &lt;- aphylo_mcmc(
  x ~ psi + mu_d + mu_s,
  control = list(nsteps = 1e3, burnin = 0)
  )

# Creating the multivariate plot (using by default image)
plot_multivariate(
  function(...) {
    ans$fun(unlist(list(...)), priors = ans$priors, dat = ans$dat, verb_ans = FALSE)
  },
  sets = matrix(c("mu_d0", "mu_d1", "psi0", "psi1"), ncol=2),
  params = ans$par
)
</code></pre>


</div>