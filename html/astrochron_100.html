<div class="container">

<table style="width: 100%;"><tr>
<td>surrogateCor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate correlation coefficient and significance for serially correlated data</h2>

<h3>Description</h3>

<p>Estimate correlation coefficient and significance for serially correlated data. This 
algorithm permits the analysis of data sets with different sampling grids, as 
discussed in Baddouh et al. (2016). The sampling grid from the data set with fewer 
points (in the common interval) is used for resampling. Resampling is conducted 
using piecewise-linear interpolation. 
</p>
<p>If either dat1 or dat2 have only one column, the resampling is skipped. 
</p>
<p>The significance of the correlation is determined using the method of Ebisuzaki W. (1997).
</p>


<h3>Usage</h3>

<pre><code class="language-R">surrogateCor(dat1,dat2,firstDiff=F,cormethod=1,nsim=1000,output=2,genplot=T,check=T,
             verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat1</code></td>
<td>
<p>Data series with one or two columns. If two columns, first should be location (e.g., depth), second column should be data value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat2</code></td>
<td>
<p>Data series with one or two columns. If two columns, first should be location (e.g., depth), second column should be data value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstDiff</code></td>
<td>
<p>Calculate correlation using first differences? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cormethod</code></td>
<td>
<p>Method used for calculation of correlation coefficient (1=Pearson, 2=Spearman rank, 3=Kendall)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of phase-randomized surrogate series to generate. If nsim &lt;=1, simulation is deactivated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Return which of the following?: 1= correlation coefficients for each simulation;  2= correlation coefficient for data series; 3= data values used in correlation estimate (resampled)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Conduct compliance checks before processing? (T or F) In general this should be activated; the option is included for Monte Carlo simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Paraphrased from Baddouh et al. (2016):
To provide a quantitative evaluation of the correlation between two data sets that do
not share a common sampling grid, we introduce a statistical approach that employs sample 
interpolation, and significance testing with phase-randomized surrogate data (Ebisuzaki, 1997). 
The sparser sampling grid is used to avoid over-interpolation. Correlation is evaluated 
using Pearson, Spearman Rank, or Kendall rank coefficients. The statistical significance of the 
resulting correlation coefficients are estimated via Monte Carlo simulations 
using phase-randomized surrogates; the surrogates are subject to the same interpolation 
process, and compensate for potential serial correlation of data (Ebisuzaki, 1997).  
</p>
<p>The first-difference series of each variable can also evaluated, to assess correlation in 
the magnitude of change between sequential stratigraphic samples rather than absolute 
magnitude.  
</p>


<h3>References</h3>

<p>M. Baddouh, S.R. Meyers, A.R. Carroll, B.L. Beard, C.M. Johnson , 2016,
<em>Lacustrine 87-Sr/86-Sr as a tracer to reconstruct Milankovitch forcing of the Eocene hydrologic cycle</em>: Earth and Planetary Science Letters.
</p>
<p>W. Ebisuzaki, 1997,
<em>A Method to Estimate the Statistical Significance of a Correlation When the Data Are Serially Correlated</em>: Journal of Climate, v. 10, p. 2147-2153.
</p>


<h3>See Also</h3>

 <p><code>surrogates</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"># generate two stochastic AR1 series
ex1 &lt;- ar1(npts=100,dt=5)
ex2 &lt;- ar1(npts=100,dt=6)

# calculate pearson correlation coefficient and p-value 
surrogateCor(ex1,ex2)
</code></pre>


</div>