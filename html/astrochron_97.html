<div class="container">

<table style="width: 100%;"><tr>
<td>stepHeat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ar/Ar Geochronology: Generate an Ar/Ar age spectrum and calculate step-heating plateau age.</h2>

<h3>Description</h3>

<p>The stepHeat function will evaluate data from stepwise heating experiments, producing an Ar/Ar age spectrum, 
a weighted mean age with uncertainty, and other helpful statistics/plots (with interactive graphics for data culling). 
The function includes the option to generate results using the approach of IsoPlot 3.70 (Ludwig, 2008) or ArArCALC (Koppers, 2002).</p>


<h3>Usage</h3>

<pre><code class="language-R">stepHeat(dat,unc=1,lambda=5.463e-10,J=NULL,Jsd=NULL,CI=2,cull=-1,del=NULL,output=F,
         idPts=T,size=NULL,unit=1,setAr=95,color="black",genplot=T,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>dat must be a data frame with seven columns, as follows: (1) %Ar39 released, (2) date, (3) date uncertainty (one or two sigma), (4) K/Ca, (5) %Ar40*, (6) F, and (7) F uncertainty (one or two sigma). NOTE: F is the ratio Ar40*/Ar39K (see Koppers, 2002).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unc</code></td>
<td>
<p>What is the uncertainty on your input dates? (1) one sigma, or (2) two sigma. DEFAULT is one sigma. This also applies to the F uncertainty, and the J-value uncertainty (if specified) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Total decay constant of K40, in units of 1/year. The default value is 5.463e-10/year (Min et al., 2000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>Neutron fluence parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jsd</code></td>
<td>
<p>Uncertainty for J-value (neutron fluence parameter; as one or two sigma)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Which convention would you like to use for the 95% confidence intervals? (1) ISOPLOT (Ludwig, 2008), (2) ArArCALC (Koppers, 2002)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cull</code></td>
<td>
<p>Would you like select dates with a graphical interface? (0=no, 1=select points to retain, -1=select points to remove)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del</code></td>
<td>
<p>A vector of indices indicating dates to remove from weighted mean calculation. If specified, this takes precedence over cull.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Return weighted mean results as new data frame? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idPts</code></td>
<td>
<p>Identify datum number on each point? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Multiplicative factor to increase or decrease size of symbols and fonts. The default is 1.4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>The time unit for your results. (1) = Ma, (2) = Ka</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setAr</code></td>
<td>
<p>Set the %Ar40* level to be illustrated on the plot. The default is 95%.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Color to use for symbols. Default is black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs weighted mean age calculations for step-heating data, including estimation of age uncertainties, 
mean square weighted deviation, and probability of fit. 
</p>
<p>The following plots are produced:
</p>
<p>(1) %Ar40* versus %Ar39 released
</p>
<p>(2) K/Ca versus %Ar39 released
</p>
<p>(3) Ar/Ar age spectrum, with 2 sigma uncertainties for each step, and weighted mean with 95% confidence interval (in red)
</p>
<p>If the J-value and its uncertainty are input, stepHeat will calculate and include the uncertainty associated with J. The uncertainty is calculated and propagated following equation 18 of Koppers (2002).
</p>
<p>A NOTE regarding confidence intervals: There are two conventions that can be used to calculate the confidence intervals, selected with the option 'CI':
</p>
<p>(1) ISOPLOT convention (Ludwig, 2008). When the probability of fit is &gt;= 0.15, the confidence interval is based on 1.96*sigma.  When the probability of fit is &lt; 0.15, the confidence interval is based on t*sigma*sqrt(MSWD). 
</p>
<p>(2) ArArCALC convention (Koppers, 2002). When MSWD &lt;=1, the confidence interval is based on 1.96*sigma. When MSWD &gt; 1, the confidence interval is based on 1.96*sigma*sqrt(MSWD).
</p>
<p>ADDITIONAL ADVICE: Use the function readMatrix to load your data in R (rather than the function read).
</p>


<h3>References</h3>

<p>A.A.P. Koppers, 2002,
<em>ArArCALC- software for 40Ar/39Ar age calculations</em>: Computers &amp; Geosciences, v. 28, p. 605-619.
</p>
<p>K.R. Ludwig, 2008,
<em>User's Manual for Isoplot 3.70: A Geochronological Toolkit for Microsoft Excel</em>: Berkeley Geochronology Center Special Publication No. 4, Berkeley, 77 p.
</p>
<p>I. McDougall and T.M. Harrison, 1991,
<em>Geochronology and Thermochronology by the 40Ar/39Ar Method</em>: Oxford University Press, New York, 269 pp.
</p>
<p>K. Min, R. Mundil, P.R. Renne, and K. Ludwig, 2000,
<em>A test for systematic errors in 40Ar/39Ar geochronology through comparison with U/Pb analysis of a 1.1-Ga rhyolite</em>: Geochimica et Cosmochimica Acta, v. 64, p. 73-98.
</p>
<p>I. Wendt and C. Carl, 1991,
<em>The statistical distribution of the mean squared weighted deviation</em>: Chemical Geology, v. 86, p. 275-285.
</p>


<h3>See Also</h3>

 <p><code>wtMean</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
# Check to see if this is an interactive R session, for compliance with CRAN standards.
# YOU CAN SKIP THE FOLLOWING LINE IF YOU ARE USING AN INTERACTIVE SESSION.
if(interactive()) {

# Sample MT-09-09 incremental heating Ar/Ar data from Sageman et al. (2014).
perAr39 &lt;- c(4.96,27.58,19.68,39.9,6.25,1.02,0.42,0.19)
age &lt;- c(90.08,89.77,89.92,89.95,89.89,89.55,87.71,86.13)
sd &lt;- c(0.18,0.11,0.08,0.06,0.14,0.64,1.5,3.22)
KCa &lt;- c(113,138,101,195,307,27,17,24)
perAr40 &lt;- c(93.42,99.42,99.64,99.79,99.61,97.99,94.64,90.35)
Fval &lt;- c(2.148234,2.140643,2.144197,2.145006,2.143627,2.135163,2.090196,2.051682)
Fsd &lt;- c(0.00439,0.00270,0.00192,0.00149,0.00331,0.01557,0.03664,0.07846)
ex &lt;- data.frame(cbind(perAr39,age,sd,KCa,perAr40,Fval,Fsd))

stepHeat(ex)

# plot without points identified
stepHeat(ex,size=0,idPts=FALSE,cull=0)

}
 
## End(Not run)
</code></pre>


</div>