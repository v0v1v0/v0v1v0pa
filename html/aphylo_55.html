<div class="container">

<table style="width: 100%;"><tr>
<td>aphylo-model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Formulas in <code>aphylo</code>
</h2>

<h3>Description</h3>

<p>This function the the workhorse behind the likelihood function. It creates
arbitrary models by modifying the call to <code>LogLike()</code> function according to
what the user specifies as model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eta(..., env)

psi(..., env)

Pi(..., env)

mu_d(..., env)

mu_s(..., env)

aphylo_formula(fm, params, priors, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Either 0, 1 or both. Depending on the parameter, the index of the
model parameter that will be set as fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Environment (not to be called by the user).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fm</code></td>
<td>
<p>A formula. Model of the type <code style="white-space: pre;">⁠&lt;aphylo-object&gt; ~ &lt;parameters&gt;⁠</code> (see
examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>Numeric vector with model parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priors</code></td>
<td>
<p>(optional) A function. Prior for the model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>fun</code> A function. The log-likelihood function.
</p>
</li>
<li> <p><code>fixed</code> Logical vector.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(12)
x &lt;- raphylo(10)

# Baseline model
aphylo_formula(x ~ mu_d)

# Mislabeling probabilities
aphylo_formula(x ~ mu_d + psi)

# Different probabilities for speciation and duplication node
# (only works if you have both types)
aphylo_formula(x ~ mu_d + mu_s + psi)

# Mislabeling probabilities and etas(fixed)
aphylo_formula(x ~ mu_d + psi + eta(0, 1))

# Mislabeling probabilities and Pi 
aphylo_formula(x ~ mu_d + psi + Pi)

</code></pre>


</div>