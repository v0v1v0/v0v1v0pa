<div class="container">

<table style="width: 100%;"><tr>
<td>ABPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function for calculating the Abnormal Blood Profile Score</h2>

<h3>Description</h3>

<p>The <code>ABPS</code> function computes the Abnormal Blood Profile Score
from seven haematological markers. Higher values of this composite
score are associated with a higher likelihood of blood doping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ABPS(haemdata = NULL, HCT = NULL, HGB = NULL, MCH = NULL, MCHC = NULL,
  MCV = NULL, RBC = NULL, RETP = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>haemdata</code></td>
<td>
<p>a vector or data frame containing (at least) the 7
haematological variables, either with the same names as the
parameters below, or (not recommended) without names but in the
same order as the parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HCT</code></td>
<td>
<p>haematocrit level [%]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HGB</code></td>
<td>
<p>haemoglobin level [g/dL]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCH</code></td>
<td>
<p>mean corpuscular haemoglobin [pg]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCHC</code></td>
<td>
<p>mean corpuscular haemoglobin concentration [g/dL]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCV</code></td>
<td>
<p>mean corpuscular volume [fL]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RBC</code></td>
<td>
<p>red blood cell count [10^6/uL]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RETP</code></td>
<td>
<p>reticulocytes percent [%]</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ABPS uses the seven haematological variables (HCT, HGB, MCH,
MCHC, MCV, RBC, RETP) in order to obtain a combined score. This
score is more sensitive to doping than the individual markers, and
allows the detection of several types of blood doping using a
single score.
</p>
<p>The combined score is based on two classification techniques, a
naive Bayesian classifier and an SVM (Support Vector Machine). The
two models were trained using a database of 591 blood profiles
(including 402 control samples from clean athletes and 189 samples
of athletes who abused of an illegal substance); the two scores
were then combined using ensemble averaging to obtain the final
ABPS score.
</p>
<p>The ABPS is part of the Athlete Biological Passport program managed
by the World Anti-Doping Agency. While it is not a primary marker
of doping, it has been used as corroborative evidence (see e.g.
<a href="https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf</a>)
</p>


<h3>Value</h3>

<p>a vector containing the ABPS score(s). Scores between 0 and
1 indicate a possible suspicion of doping; a score above 1 should
only be found in 1 in 1000 male athletes.
</p>


<h3>Note</h3>

<p>The values for the markers can be specified using either a data
frame containing (at least) the 7 haematological variables, or
using seven named parameters, but not both at the same time.
</p>
<p>The calculation of the ABPS depends on two sets of parameters, for
the two machine learning techniques (naive Bayesian classifier and
Support Vector Machine), which are provided in the package.
</p>
<p>Each parameter must be in a prespecified range; parameters outside
this range are constrained to the min (respectively max) values.
</p>
<p>Note that several versions of the ABPS were developed (including
several different combinations of parameters). The version provided
in this package provides the same results as the WADA version
included in their ADAMS database. However, some values calculated
with other versions of the software have also been distributed (see
the help page for the <code>blooddoping</code> dataset for an example).
</p>


<h3>References</h3>

<p>Sottas, P.E., N. Robinson, S. Giraud, et al., Statistical classification of abnormal blood profiles in athletes. Int J Biostat, 2006. 2(1): p. 1557-4679.
</p>
<p><a href="https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf">https://jurisprudence.tas-cas.org/Shared%20Documents/2773.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ABPS(HCT=43.2, HGB=14.6, MCH=31.1, MCHC=33.8, MCV=92.1, RBC=4.69, RETP=0.48)
ABPS(data.frame(HCT=43.2, HGB=14.6, MCH=31.1, MCHC=33.8, MCV=92.1, RBC=4.69, RETP=0.48))
ABPS(c(43.2, 14.6, 31.1, 33.8, 92.1, 4.69, 0.48))
data(blooddoping); ABPS(blooddoping)
data(bloodcontrol); ABPS(bloodcontrol)

</code></pre>


</div>