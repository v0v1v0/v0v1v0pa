<div class="container">

<table style="width: 100%;"><tr>
<td>gfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness of fit
</h2>

<h3>Description</h3>

<p>Perform a test for goodness-of-fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gfit(target, sumstat, nb.replicate, tol=.01, statistic=mean, subset=NULL, 
trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>

<p>a data frame or vector of the observed summary statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.replicate</code></td>
<td>

<p>number of replicates used to estimate the null distribution of the 
goodness-of-fit statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>a tolerance rate. Defaults to 0.01 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>

<p>define the goodness-of-fit statistic. Typical values are <code>median</code> 
(default), <code>mean</code>, or <code>max</code>. When using <code>median</code> fo 
instance, the g.o.f. statistic is the median of the distance between 
observed and accepted summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>optional. A logical expression indicating elements or rows to keep. 
Missing values in <code>sumstat</code> are taken as <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>a boolean indicating if a trace should be displayed when calling the 
function. Default to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null distribution is estimated using already performed simulations 
contained in <code>sumstat</code> as pseudo-observed datasets. For each 
pseudo-observed dataset, the rejection algorithm is performed to obtain 
a value of the goodness-of-fit statistic. A better estimate of the 
P-value is obtained for larger <code>nb.replicate</code> but the running time
of the function is increased. 
</p>


<h3>Value</h3>

<p>An object of class <code>"gfit"</code>, which is a list with the following
elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>dist.obs</code></td>
<td>

<p>the value of the goodness-of-fit statistic for the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.sim</code></td>
<td>

<p>a vector of size <code>nb.replicate</code>. It is a sample of the null 
distribution of the test statistic.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Louisiane Lemaire and Michael Blum.
</p>


<h3>See Also</h3>

<p><code>abc</code>, <code>plot.gfit</code>, <code>summary.gfit</code>, 
<code>gfitpca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## human demographic history
require(abc.data)
data(human)

##  Perform a test of goodness-of-fit.
##  The data are the European data and we test the fit of the bottleneck 
## model (good fit) and of the constant-size population model (poor fit) 
## Use larger values of \code{nb.replicate} (e.g. 1000)
## for real applications
res.gfit.bott=gfit(target=stat.voight["italian",], 
sumstat=stat.3pops.sim[models=="bott",], statistic=mean, nb.replicate=10)
res.gfit.const=gfit(target=stat.voight["italian",], 
sumstat=stat.3pops.sim[models=="const",], statistic=mean, nb.replicate=10)


## Plot the distribution of the null statistic and indicate where is the 
## observed value.
plot(res.gfit.bott, main="Histogram under H0")
## Call the function \code{summary}
## It computes the P-value, call \code{summary} on the vector 
## \code{dist.sim} and returns the value of the observed statistic
summary(res.gfit.bott)
</code></pre>


</div>