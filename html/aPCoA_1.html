<div class="container">

<table style="width: 100%;"><tr>
<td>aPCoA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Covariate Adjusted PCoA Plot
</h2>

<h3>Description</h3>

<p>Adjusted confounding covariates to show the effect of the primary covariate in a PCoA plot. This method is designed for non-Euclidean distance. This function will plot the original PCoA plot along with the covariate adjusted PCoA plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aPCoA(formula,data,maincov,drawEllipse=TRUE,drawCenter=TRUE,
pch=19,cex=2,lwd=3,col=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A typical formula such as Y~ A, but here Y is a dissimilarity distance. The formula has the same requirements as in adonis function of the vegan package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataset with the rownames the same as the rownames in distance. This dataset should include both the confounding covariate and the primary covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maincov</code></td>
<td>
<p>the covariate of interest in the dataset, must be a factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawEllipse</code></td>
<td>
<p>Do you want to draw the 95% confidence elipse for each cluster?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drawCenter</code></td>
<td>
<p>Do you want to show the connection between cluster center (medoid) and cluster members?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>Point shapes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Number indicating the amount by which plotting text and symbols should be scaled relative to the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width of the ellipses</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color for plot. If not provided by user, will use default distinct colors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to 'dataEllipse'.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Two PCoA plots. One is the original one, while the other is the PCoA plot after adjusting for the confounding covariate.
</p>
<table><tr style="vertical-align: top;">
<td><code>plotMatrix</code></td>
<td>
<p>The matrix for plotting the adjusted PCoA plot.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Yushu Shi, Liangliang Zhang, Kim-Anh Do, Christine Peterson and Robert Jenq. (2020) aPCoA: Covariate Adjusted Principal Coordinates Analysis &lt;arXiv:2003.09544&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(vegan)
library(aPCoA)
data("Tasmania")
data&lt;-data.frame(treatment=Tasmania$treatment,block=Tasmania$block)
bray&lt;-vegdist(Tasmania$abund, method="bray")
rownames(data)&lt;-rownames(as.matrix(bray))
opar&lt;-par(mfrow=c(1,2),
          mar=c(3.1, 3.1, 3.1, 5.1),
          mgp=c(2, 0.5, 0),
          oma=c(0, 0, 0, 4))
result&lt;-aPCoA(bray~block,data,treatment)
par(opar)
</code></pre>


</div>