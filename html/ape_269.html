<div class="container">

<table style="width: 100%;"><tr>
<td>MPR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Most Parsimonious Reconstruction</h2>

<h3>Description</h3>

<p>This function does ancestral character reconstruction by parsimony as
described in Hanazawa et al. (1995) and modified by Narushima and
Hanazawa (1997).
</p>


<h3>Usage</h3>

<pre><code class="language-R">MPR(x, phy, outgroup)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of integers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>an object of class <code>"phylo"</code>; the tree must be
unrooted and fully dichotomous.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outgroup</code></td>
<td>
<p>an integer or a character string giving the tip of
<code>phy</code> used as outgroup.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Hanazawa et al. (1995) and Narushima and Hanazawa (1997) used Farris's
(1970) and Swofford and Maddison's (1987) framework to reconstruct
ancestral states using parsimony. The character is assumed to take
integer values. The algorithm finds the sets of values for each node
as intervals with lower and upper values.
</p>
<p>It is recommended to root the tree with the outgroup before the
analysis, so plotting the values with <code>nodelabels</code> is
simple.
</p>


<h3>Value</h3>

<p>a matrix of integers with two columns named “lower” and “upper”
giving the lower and upper values of the reconstructed sets for each
node.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Farris, J. M. (1970) Methods for computing Wagner trees.
<em>Systematic Zoology</em>, <b>19</b>, 83–92.
</p>
<p>Hanazawa, M., Narushima, H. and Minaka, N. (1995) Generating most
parsimonious reconstructions on a tree: a generalization of the
Farris–Swofford–Maddison method. <em>Discrete Applied
Mathematics</em>, <b>56</b>, 245–265.
</p>
<p>Narushima, H. and Hanazawa, M. (1997) A more efficient algorithm for
MPR problems in phylogeny. <em>Discrete Applied Mathematics</em>,
<b>80</b>, 231–238.
</p>
<p>Swofford, D. L. and Maddison, W. P. (1987) Reconstructing ancestral
character states under Wagner parsimony. <em>Mathematical
Biosciences</em>, <b>87</b>, 199–229.
</p>


<h3>See Also</h3>

<p><code>ace</code>, <code>root</code>, <code>nodelabels</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## the example in Narushima and Hanazawa (1997):
tr &lt;- read.tree(text = "(((i,j)c,(k,l)b)a,(h,g)e,f)d;")
x &lt;- c(1, 3, 0, 6, 5, 2, 4)
names(x) &lt;- letters[6:12]
(o &lt;- MPR(x, tr, "f"))
plot(tr)
nodelabels(paste0("[", o[, 1], ",", o[, 2], "]"))
tiplabels(x[tr$tip.label], adj = -2)
## some random data:
x &lt;- rpois(30, 1)
tr &lt;- rtree(30, rooted = FALSE)
MPR(x, tr, "t1")
</code></pre>


</div>