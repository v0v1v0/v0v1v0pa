<div class="container">

<table style="width: 100%;"><tr>
<td>capa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A technique for detecting anomalous segments and points based on CAPA.</h2>

<h3>Description</h3>

<p>A technique for detecting anomalous segments and points based on CAPA (Collective And Point Anomalies) by Fisch et al. (2022).
This is a generic method that can be used for both univariate and multivariate data. The specific method that is used for the analysis is deduced by <code>capa</code> from the dimensions of the data.
The inputted data is either a vector (in the case of a univariate time-series) or a array with p columns (if the the time-series is p-dimensional). The CAPA procedure assumes that each component
of the time-series is standardised so that the non-anomalous segments of each component have mean 0 and variance 1. This may require pre-processing/standardising.
For example, using the median of each component as a robust estimate of its mean, and the mad (median absolute deviation from the median) estimator to get a robust estimate of the variance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">capa(
  x,
  beta,
  beta_tilde,
  type = "meanvar",
  min_seg_len = 10,
  max_seg_len = Inf,
  max_lag = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A numeric matrix with n rows and p columns containing the data which is to be inspected. The time series data classes ts, xts, and zoo are also supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A numeric vector of length p giving the marginal penalties. If beta is missing and p == 1 then beta = 3log(n) when the type is "mean" or "robustmean", and beta = 4log(n) otherwise.
If beta is missing and p &gt; 1, type ="meanvar" or type = "mean" and max_lag &gt; 0 then it defaults to the penalty
regime 2' described in Fisch, Eckley and Fearnhead (2022). If beta is missing and p &gt; 1, type = "mean"/"meanvar" and max_lag = 0 it defaults to the pointwise minimum of the penalty regimes
1, 2, and 3 in Fisch, Eckley and Fearnhead (2022).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_tilde</code></td>
<td>
<p>A numeric constant indicating the penalty for adding an additional point anomaly. If beta_tilda is missing it defaults to 3log(np), where n and p are the data dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A string indicating which type of deviations from the baseline are considered. Can be "meanvar" for collective anomalies characterised by joint changes in mean and
variance (the default), "mean" for collective anomalies characterised by changes in mean only, or "robustmean" (only allowed when p = 1) for collective anomalies characterised by changes in mean only which can be polluted by outliers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_seg_len</code></td>
<td>
<p>An integer indicating the minimum length of epidemic changes. It must be at least 2 and defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_seg_len</code></td>
<td>
<p>An integer indicating the maximum length of epidemic changes. It must be at least min_seg_len and defaults to Inf.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_lag</code></td>
<td>
<p>A non-negative integer indicating the maximum start or end lag. Only useful for multivariate data. Default value is 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An instance of an S4 class of type capa.class.
</p>


<h3>References</h3>

<p>Fisch ATM, Eckley IA, Fearnhead P (2022).
“A linear time method for the detection of collective and point anomalies.”
<em>Statistical Analysis and Data Mining: The ASA Data Science Journal</em>, <b>15</b>(4), 494-508.
<a href="https://doi.org/10.1002/sam.11586">doi:10.1002/sam.11586</a>.
</p>
<p>Fisch ATM, Grose D, Eckley IA, Fearnhead P, Bardwell L (2024).
“anomaly: Detection of Anomalous Structure in Time Series Data.”
<em>Journal of Statistical Software</em>, <b>110</b>(1), 1–24.
<a href="https://doi.org/10.18637/jss.v110.i01">doi:10.18637/jss.v110.i01</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(anomaly)
# generate some multivariate data
data(simulated)
res&lt;-capa(sim.data,type="mean",min_seg_len=2,max_lag=5)
collective_anomalies(res)
plot(res)

</code></pre>


</div>