<div class="container">

<table style="width: 100%;"><tr>
<td>quantify.breaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>quantify break-point/segments</h2>

<h3>Description</h3>

<p>Quantify either break-points or
break-segment methods for pollutant time-series
</p>


<h3>Usage</h3>

<pre><code class="language-R">quantBreakPoints(
  data,
  pollutant,
  breaks,
  ylab = NULL,
  xlab = NULL,
  pt.col = c("lightgrey", "darkgrey"),
  line.col = "red",
  break.col = "blue",
  event = NULL,
  show = c("plot", "report"),
  ...
)

quantBreakSegments(
  data,
  pollutant,
  breaks,
  ylab = NULL,
  xlab = NULL,
  pt.col = c("lightgrey", "darkgrey"),
  line.col = "red",
  break.col = "blue",
  event = NULL,
  seg.method = 2,
  seg.seed = 12345,
  show = c("plot", "report"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data source, typically a data.frame or similar,
containing data-series to model and a paired time-stamp
data-series, named date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pollutant</code></td>
<td>
<p>The name of the data-series to
break-point or break-segment model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>(Optional) The break-points and
confidence intervals to use when building either
break-point or break-segment models. If not supplied
these are build using <code>findBreakPoints</code>
and supplied arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-label term, by default pollutant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-label term, by default date.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.col</code></td>
<td>
<p>Point fill and line colours for plot,
defaults lightgrey and darkgrey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.col</code></td>
<td>
<p>Line colour for plot, default red.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>break.col</code></td>
<td>
<p>Break-point/segment colour for plot, default
blue.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>An optional list of plot terms for an event
marker, applied to a vertical line and text label. List
items include: <code>x</code> the event date (YYYY-MM-DD format)
require for both line and label; <code>y</code> by default 0.9 x
y-plot range; <code>label</code> the label text, required for
label; <code>line.size</code> the line width, by default 0.5;
<code>font.size</code> the text size, by default 5; and,
<code>hjust</code> the label left/right justification, 0 left,
0.5 centre, 1 right (default). See also examples below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show</code></td>
<td>
<p>What to show before returning the break-point
quantification mode, by default plot and report.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.method</code></td>
<td>
<p>(<code>quantBreakSegments</code> only) the
break-segment fitting method to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.seed</code></td>
<td>
<p>(<code>quantBreakSegments</code> only) the
seed setting to use when fitting break-segments, default
<code>12345</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>quantBreakPoints</code> and
<code>quantBreakSegments</code> both use
<code>strucchange</code> methods to identify potential
break-points in time-series, and then quantify
these as conventional break-points or break-segments,
respectively:
</p>

<ul>
<li> <p><strong>Finding Break-points</strong> Using the
<code>strucchange</code> methods of Zeileis and colleagues
and independent change detection model, the functions
apply a rolling-window approach, assuming the first
window (or data subset) is without change, building a
statistical model of that, advancing the window,
building a second model and comparing these, and so on,
to identify the most likely points of change in a
larger data-series. See also <code>findBreakPoints</code>
</p>
</li>
<li> <p><strong>Quantifying Break-points</strong> Using the
supplied break-points to build a break-point model.
</p>
</li>
<li> <p><strong>Quantifying Break-segments</strong> Using the
confidence regions for the supplied break-points as the
starting points to build a break-segment model.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Both functions use the <code>show</code> argument
to control which elements of the functions outputs
are shown but also invisible return a <code>list</code>
of all outputs which can caught using, e.g.:
</p>
<p><code>brk.mod &lt;- quantBreakPoints(data, pollutant)</code>
</p>


<h3>Note</h3>

<p><code>AQEval</code> function <code>quantBreakSegments</code>
is currently running <code>segmented v.1.3-4</code> while we
evaluate latest version, <code>v.1.4-0</code>.
</p>


<h3>Author(s)</h3>

<p>Karl Ropkins
</p>


<h3>References</h3>

<p>Regarding <code>strucchange</code> methods see in-package
documentation, e.g. <code>breakpoints</code>,
and:
</p>
<p>Achim Zeileis, Friedrich Leisch, Kurt Hornik and Christian Kleiber
(2002). strucchange: An R Package for Testing for Structural Change
in Linear Regression Models. Journal of Statistical Software, 7(2),
1-38. URL <a href="https://www.jstatsoft.org/v07/i02/">https://www.jstatsoft.org/v07/i02/</a>.
</p>
<p>Achim Zeileis, Christian Kleiber, Walter Kraemer and Kurt Hornik
(2003). Testing and Dating of Structural Changes in Practice.
Computational Statistics &amp; Data Analysis, 44, 109-123.
DOI <a href="https://doi.org/10.1016/S0167-9473%2803%2900030-6">doi:10.1016/S0167-9473(03)00030-6</a>.
</p>
<p>Regarding <code>segmented</code> methods see in-package
documentation, e.g.
<code>segmented</code>, and:
</p>
<p>Vito M. R. Muggeo (2003). Estimating regression models
with unknown break-points. Statistics in Medicine, 22,
3055-3071. DOI 10.1002/sim.1545.
</p>
<p>Vito M. R. Muggeo (2008). segmented: an R Package to
Fit Regression Models with Broken-Line Relationships.
R News, 8/1, 20-25.
URL <a href="https://cran.r-project.org/doc/Rnews/">https://cran.r-project.org/doc/Rnews/</a>.
</p>
<p>Vito M. R. Muggeo (2016). Testing with a nuisance
parameter present only under the alternative: a
score-based approach with application to segmented
modelling. J of Statistical Computation and Simulation,
86, 3059-3067.
DOI 10.1080/00949655.2016.1149855.
</p>
<p>Vito M. R. Muggeo (2017). Interval estimation for the
breakpoint in segmented regression: a smoothed
score-based approach. Australian &amp; New Zealand Journal
of Statistics, 59, 311-322.
DOI 10.1111/anzs.12200.
</p>
<p>Regarding break-points/segment methods, see:
</p>
<p>Ropkins et al (In Prep).
</p>


<h3>See Also</h3>

<p><code>timeAverage</code> in <code>openair</code>,
<code>breakpoints</code> in <code>strucchange</code>, and
<code>segmented</code> in <code>segmented</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#using openair timeAverage to covert 1-hour data to 1-day averages

temp &lt;- openair::timeAverage(aq.data, "1 day")

#break-points

quantBreakPoints(temp, "no2", h=0.3)

#break-segments

quantBreakSegments(temp, "no2", h=0.3)

#addition examples (not run)
## Not run: 
#in-call plot modification
#removing x axis label
#recolouring break line and
#adding an event marker
quantBreakPoints(temp, "no2", h=0.3,
       xlab="", break.col = "red",
       event=list(label="Event expected here",
                 x="2002-08-01", col="grey"))

## End(Not run)
</code></pre>


</div>