<div class="container">

<table style="width: 100%;"><tr>
<td>adaptTest-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adaptive two-stage tests
</h2>

<h3>Description</h3>

<p>The functions defined in this program serve for implementing adaptive two-stage tests.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> adaptTest</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2023-10-05</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (version 2 or later)</td>
</tr>
<tr>
<td style="text-align: left;">
LazyLoad: </td>
<td style="text-align: left;"> yes</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>An adaptive two-stage test can be considered as a family of decreasing functions <code class="reqn">f[c](p_1)</code> in the unit square. Each of these functions is a conditional error function, specifying the type I error conditional on the p-value <code class="reqn">p_1</code> of the first stage. For example, <code class="reqn">f[c](p_1) = \min(1, c/p_1)</code> corresponds to Fisher's combination test (Bauer and Koehne, 1994). Based on this function family, the test can be put into practice by specifying the desired overall level <code class="reqn">\alpha</code>, stopping bounds <code class="reqn">\alpha_1 &lt;= \alpha_0</code> and a parameter <code class="reqn">\alpha_2</code>. After computing <code class="reqn">p_1</code>, the test stops with or without rejection of the null hypothesis if <code class="reqn">p_1 &lt;= \alpha_1</code> or <code class="reqn">p_1 &gt; \alpha_0</code>, respectively. Otherwise, the null hypothesis is rejected if and only if <code class="reqn">p_2 &lt;= f[c](p_1)</code> holds for the p-value <code class="reqn">p_2</code> of the second stage, where <code class="reqn">c</code> is such that the local level of this latter test is <code class="reqn">\alpha_2</code> (e.g., <code class="reqn">c = c(\alpha_2) = \exp(-\chi^2_{4,\alpha_2}/2)</code> for Fisher's combination test).
</p>
<p>This package provides functions for handling conditional error functions, performing calculations among the different parameters (<code class="reqn">\alpha</code>, <code class="reqn">\alpha_0</code>, <code class="reqn">\alpha_1</code>, <code class="reqn">\alpha_2</code> and <code class="reqn">c</code>) and computing overall p-values, in addition to graphical visualization routines. Currently, four predefined tests are included: Bauer and Koehne (1994), Lehmacher and Wassmer (1999), Vandemeulebroecke (2006), and the horizontal conditional error function. User-defined tests can also be implemented.
</p>
<p>This package contains the following functions:
</p>

<ul>
<li>
<p> Key functions are <code>CEF</code>, <code>plotCEF</code>, <code>tsT</code>, <code>ovP</code>.
</p>
</li>
<li>
<p> Further functions are <code>a1Table</code>, <code>getpar</code>, <code>parconv</code>, <code>pathCEF</code>, <code>plotBounds</code>, <code>eq</code>, <code>ne</code>, <code>ge</code>, <code>gt</code>, <code>le</code>, <code>lt</code>.
</p>
</li>
</ul>
<p>The functions <code>a1Table</code>, <code>getpar</code>, <code>parconv</code> and <code>tsT</code> can handle the four predefined tests mentioned above. The functions <code>CEF</code>, <code>plotCEF</code>, <code>pathCEF</code> and <code>ovP</code> can also handle these, and user-defined tests in addition. The functions <code>plotBounds</code>, <code>eq</code>, <code>ne</code>, <code>ge</code>, <code>gt</code>, <code>le</code> and <code>lt</code> do not directly handle tests.
</p>


<h3>Note</h3>

<p>Note that a family of conditional error functions can be parameterized in two alternative ways: more "traditionally" by some parameter <code class="reqn">c</code> that, in turn, depends on the local level <code class="reqn">\alpha_2</code> of the test after the second stage, or - perhaps more conveniently - by <code class="reqn">\alpha_2</code> itself.
</p>
<p>In this implementation, early stopping bounds are <em>not</em> part of the conditional error function. Rather, they are specified separately and "imposed" on it.
</p>
<p>I want to thank Niklas Hack for technical support.
</p>


<h3>Author(s)</h3>

<p>Marc Vandemeulebroecke
</p>
<p>Maintainer: Marc Vandemeulebroecke &lt;vandemem(at)gmx.de&gt;
</p>


<h3>References</h3>

<p>Bauer, P., Koehne, K. (1994). Evaluation of experiments with adaptive interim analyses. <em>Biometrics</em> 50, 1029-1041.
</p>
<p>Brannath, W., Posch, M., Bauer, P. (2002). Recursive combination tests. <em>J. Amer. Statist. Assoc.</em> 97, 236-244.
</p>
<p>Lehmacher, W., Wassmer, G. (1999). Adaptive sample size calculations in group sequential trials. <em>Biometrics</em> 55, 1286-1290.
</p>
<p>Vandemeulebroecke, M. (2006). An investigation of two-stage tests. <em>Statistica Sinica</em> 16, 933-951.
</p>
<p>Vandemeulebroecke, M. (2006). <em>A general approach to two-stage tests.</em> Doctoral thesis, Otto-von-Guericke-Universitaet Magdeburg, <code>http://www.dissertation.de</code>.
</p>
<p>Vandemeulebroecke, M. (2008). Group sequential and adaptive designs - a review of basic concepts and points of discussion. <em>Biometrical Journal</em> 50, 541-557.
</p>


<h3>See Also</h3>

<p><code>CEF</code>, <code>tsT</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Bauer and Koehne (1994)
alpha  &lt;- 0.1
alpha2 &lt;- 0.1
alpha0 &lt;- 0.5
alpha1 &lt;- tsT(typ="b", a=alpha, a0=alpha0, a2=alpha2)
plotCEF(typ="b", a2=alpha2, add=FALSE)
plotBounds(alpha1, alpha0)
CEF(typ="b", a2=alpha2)
</code></pre>


</div>