<div class="container">

<table style="width: 100%;"><tr>
<td>dmudr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Interface of dmudr subroutine in RKPACK
</h2>

<h3>Description</h3>

<p>To calculate a spline estimate with multiple smoothing parameters
</p>


<h3>Usage</h3>

<pre><code class="language-R">dmudr(y, q, s, weight = NULL, vmu = "v", theta = NULL, varht = NULL, 
    tol = 0, init = 0, prec = 1e-06, maxit = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a numerical vector representing the response.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>a list, or an array, of square matrices of the same order as the length of y, which are the reproducing kernels evaluated at the design points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>the design matrix of the null space <code class="reqn">H_0</code> of size (length-of-y,<code class="reqn">dim(H_0)</code>), with elements equal to the bases of <code class="reqn">H_0</code> evaluated at design points.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>a weight matrix for penalized weighted least-square: <code class="reqn">(y-f)'W(y-f)+n\lambda J(f)</code>. Default is NULL for iid random errors.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vmu</code></td>
<td>

<p>a character string specifying a method for choosing the smoothing  parameter.  "v", "m" and "u" represent GCV, GML and UBR respectively. "u<code class="reqn">\sim</code>", only used for non-Gaussian family, specifies UBR with estimated variance. Default is "v".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>If ‘init=1’, theta includes intial values for smoothing parameters. Default is NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>

<p>needed only when vmu="u", which gives the fixed variance in calculation of the UBR function. Default is NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>the tolerance for truncation in the tridiagonalization. Default is 0.0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>an integer of 0 or 1 indicating if initial values are provided for theta. If init=1, initial values are provided using theta. Default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec</code></td>
<td>

<p>precision requested for the minimum score value, where precision is the weaker of the absolute and relative precisions. Default is <code class="reqn">1e-06</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>maximum number of iterations allowed. Default is 30.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>

<p>an integer that provides error message. info=-1 indicates dimension error, 
info=-2 indicates <code class="reqn">F_{2}^{T} Q_{*}^{\theta} F_{2} !&gt;= 0</code>, info=-3 indicates tuning parameters are out of scope, info=-4 indicates fails to converge within maxite steps, info=-5 indicates fails to find a reasonable descent direction, info&gt;0 indicates the matrix S is rank deficient with <code class="reqn">info=rank(S)+1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>fitted values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>

<p>estimates of c.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>estimates of d.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resi</code></td>
<td>

<p>vector of residuals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varht</code></td>
<td>

<p>estimate of variance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>estimates of parameters <code class="reqn">log10(\theta)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlaht</code></td>
<td>

<p>the estimate of <code class="reqn">log10(nobs*\lambda)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>

<p>the minimum GCV/GML/UBR score at the estimated smoothing parameters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>

<p>equavilent degree of freedom.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>

<p>length(y), number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nnull</code></td>
<td>

<p>dim(<code class="reqn">H_0</code>), number of bases.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>

<p>length(rk), number of reproducing kernels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s,q,y</code></td>
<td>

<p>changed from the inputs.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chunlei Ke <a href="mailto:chunlei_ke@yahoo.com">chunlei_ke@yahoo.com</a> and Yuedong Wang <a href="mailto:yuedong@pstat.ucsb.edu">yuedong@pstat.ucsb.edu</a></p>


<h3>References</h3>

<p>Gu, C. (1989). RKPACK and its applications: Fitting smoothing spline models. Proceedings of the Statistical Computing Section, ASA, 42-51.
</p>
<p>Wahba, G. (1990). Spline Models for Observational Data. SIAM, Vol. 59
</p>


<h3>See Also</h3>

<p><code>dsidr</code>, <code>gdsidr</code>, <code>gdmudr</code>, <code>ssr</code>
</p>


</div>