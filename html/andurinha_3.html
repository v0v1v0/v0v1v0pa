<div class="container">

<table style="width: 100%;"><tr>
<td>findPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>findPeaks</h2>

<h3>Description</h3>

<p>This function finds peaks and allows to the most relevant based
on the second derivative/absorbance sum spectrum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findPeaks(
  data,
  resolution = 4,
  minAbs = 0.1,
  cutOff = NULL,
  scale = TRUE,
  ndd = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame object, which contains in the first column the wave
numbers and in the following columns the samples absorbances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resolution</code></td>
<td>
<p>The equipment measurement resolution; by default 4 cm-1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minAbs</code></td>
<td>
<p>The cut off value to check spectra quality; by default 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutOff</code></td>
<td>
<p>The second derivative/absorbance sum spectrum cut off to reduce
the raw peaks table; by default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>By default (TRUE) the data is scaled by Z-scores. Use FALSE in
case you do not want to scale it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndd</code></td>
<td>
<p>By default (TRUE) the peaks are searched based on the second
derivative sum spectrum. Use FALSE in case you want to search them based on
the absorbance sum spectrum.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with a collection of data frames which contains:
</p>

<ol>
<li> <p><em>dataZ</em>: the standardised data by Z-scores.
</p>
</li>
<li> <p><em>secondDerivative</em>: the second derivative values of the data.
</p>
</li>
<li> <p><em>sumSpectrum_peaksTable</em>: the peaks wave numbers and their
second derivative/absorbance sum spectrum values.
</p>
</li>
<li> <p><em>peaksTable</em>: the selected peaks wave numbers and their
absorbance for each spectrum.
</p>
</li>
</ol>
<h3>See Also</h3>

<p><code>importSpectra</code>, <code>gOverview</code> and
<code>plotPeaks</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Find Peaks based on the absorbance sum spectrum
fp.abs &lt;- findPeaks(andurinhaData, ndd = FALSE)

# See the peaks table of the absorbance sum spectrum
fp.abs$sumSpectrum_peaksTable

# Find Peaks based on the second derivative sum spectrum
fp.ndd &lt;- findPeaks(andurinhaData)

# See the peaks table of the second derivative sum spectrum
fp.ndd$sumSpectrum_peaksTable

# Select a cutOff to reduce the number of peaks in the table
# (i.e. select the most relevant)
# fp.ndd$sumSpectrum_peaksTable %&gt;%
#   arrange(desc(sumSpectrum))
# Run findPeaks() with the new cutOff
fp.ndd2 &lt;- findPeaks(andurinhaData, cutOff = 0.25)

</code></pre>


</div>