<div class="container">

<table style="width: 100%;"><tr>
<td>estimatePSCS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate boundaries of the particle size control section (U.S Soil Taxonomy;
12th edition)</h2>

<h3>Description</h3>

<p>Estimates the upper and lower boundary of the particle size control section
by applying a programmatic version of the particle size control section key
from the Keys to Soil Taxonomy (12th edition).
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimatePSCS(
  p,
  hzdesgn = hzdesgnname(p, required = TRUE),
  clay.attr = hzmetaname(p, "clay", required = TRUE),
  texcl.attr = hztexclname(p, required = TRUE),
  tax_order_field = "tax_order",
  bottom.pattern = "Cr|R|Cd",
  simplify = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A SoilProfileCollection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hzdesgn</code></td>
<td>
<p>Name of the horizon attribute containing the horizon
designation. Default 'hzname'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clay.attr</code></td>
<td>
<p>Name of the horizon attribute containing clay contents.
Default 'clay'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>texcl.attr</code></td>
<td>
<p>Name of the horizon attribute containing textural class
(used for finding sandy textures). Default 'texcl'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tax_order_field</code></td>
<td>
<p>Name of the site attribute containing taxonomic
order; for handling PSCS rules for Andisols in lieu of lab data. May be NA
or column missing altogether, in which case Andisol PSC possibility is
ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bottom.pattern</code></td>
<td>
<p>Regular expression pattern to match a root-restrictive
contact. Default matches Cr, R or Cd. This argument is passed to both
estimateSoilDepth and getArgillicBounds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>Return a length 2 vector with upper and lower boundary when p has length 1? Default TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments are passed to getArgillicBounds()</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Requires information to identify argillic horizons (clay contents, horizon
designations) with <code>getArgillicBounds()</code> as well as the presence of
plow layers and surface organic soil material. Any
<code>getArgillicBounds()</code> arguments may be passed to <code>estimatePSCS</code>.
</p>
<p>Requires information on taxonomic order (to handle andisols).
</p>
<p>WARNING: Soils in arenic or grossarenic subgroups, with fragipans, or with
strongly contrasting PSCs may not be classified correctly. The author would
welcome a dataset to develop this functionality for.
</p>


<h3>Value</h3>

<p>A numeric vector (when <code>simplify=TRUE</code>) containing the top and bottom depth of the particle
size control section. First value is top, second value is bottom.
If <code>p</code> contains more than one profile, the result is a data.frame with profile ID plus PSCS top and bottom depths.
</p>


<h3>Author(s)</h3>

<p>Andrew Gene Brown
</p>


<h3>References</h3>

<p>Soil Survey Staff. 2014. Keys to Soil Taxonomy, 12th ed.
USDA-Natural Resources Conservation Service, Washington, DC.
</p>


<h3>See Also</h3>

<p><code>getArgillicBounds</code>, <code>getSurfaceHorizonDepth</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(sp1, package = 'aqp')
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

# set required metadata
hzdesgnname(sp1) &lt;- 'name'
hztexclname(sp1) &lt;- 'texture'
hzmetaname(sp1, 'clay') &lt;- 'prop'

x &lt;- estimatePSCS(sp1)
x
</code></pre>


</div>