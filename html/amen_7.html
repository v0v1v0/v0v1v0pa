<div class="container">

<table style="width: 100%;"><tr>
<td>ame_rep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>AME model fitting routine for replicated relational data</h2>

<h3>Description</h3>

<p>An MCMC routine providing a fit to an additive and multiplicative effects
(AME) regression model to replicated relational data of
various types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ame_rep(Y,Xdyad=NULL, Xrow=NULL, Xcol=NULL, family, R=0, rvar = !(family=="rrl"),
cvar = TRUE, dcor = !symmetric, nvar=TRUE,  
intercept=!is.element(family,c("rrl","ord")),
symmetric=FALSE,
odmax=rep(max(apply(Y&gt;0,c(1,3),sum,na.rm=TRUE)),nrow(Y[,,1])), seed = 1,
nscan = 10000, burn = 500, odens = 25, plot=TRUE, print = TRUE, gof=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>an n x n x T array of relational matrix, where the third dimension correponds to replicates (over time, for example). See
family below for various data types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xdyad</code></td>
<td>
<p>an n x n x pd x T array of covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xrow</code></td>
<td>
<p>an n x pr x T array of nodal row covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xcol</code></td>
<td>
<p>an n x pc x T array of nodal column covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>character: one of "nrm","bin","ord","cbin","frn","rrl" - see
the details below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>integer: dimension of the multiplicative effects (can be zero)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rvar</code></td>
<td>
<p>logical: fit row random effects (asymmetric case)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvar</code></td>
<td>
<p>logical: fit column random effects (asymmetric case)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dcor</code></td>
<td>
<p>logical: fit a dyadic correlation (asymmetric case)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nvar</code></td>
<td>
<p>logical: fit nodal random effects (symmetric case)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical: fit model with an intercept?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>logical: Is the sociomatrix symmetric by design?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odmax</code></td>
<td>
<p>a scalar integer or vector of length n giving the maximum
number of nominations that each node may make - used for "frn" and "cbin"
families</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nscan</code></td>
<td>
<p>number of iterations of the Markov chain (beyond burn-in)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>burn in for the Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>odens</code></td>
<td>
<p>output density for the Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical: plot results while running?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>logical: print results while running?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof</code></td>
<td>
<p>logical: calculate goodness of fit statistics?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This command provides posterior inference for parameters in AME models of
independent replicated relational data, assuming one of six possible data
types/models:
</p>
<p>"nrm": A normal AME model.
</p>
<p>"bin": A binary probit AME model.
</p>
<p>"ord": An ordinal probit AME model. An intercept is not identifiable in this
model.
</p>
<p>"cbin": An AME model for censored binary data.  The value of 'odmax'
specifies the maximum number of links each row may have.
</p>
<p>"frn": An AME model for fixed rank nomination networks. A higher value of
the rank indicates a stronger relationship. The value of 'odmax' specifies
the maximum number of links each row may have.
</p>
<p>"rrl": An AME model based on the row ranks. This is appropriate if the
relationships across rows are not directly comparable in terms of scale. An
intercept, row random effects and row regression effects are not estimable
for this model.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>BETA</code></td>
<td>
<p>posterior samples of regression coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VC</code></td>
<td>
<p>posterior samples of the variance parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>APM</code></td>
<td>
<p>posterior mean of additive row effects a</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BPM</code></td>
<td>
<p>posterior
mean of additive column effects b</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>posterior mean of multiplicative
row effects u</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>posterior mean of multiplicative column effects v (asymmetric case)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UVPM</code></td>
<td>
<p>posterior mean of UV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ULUPM</code></td>
<td>
<p>posterior mean of ULU (symmetric case)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>posterior mean of L (symmetric case)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EZ</code></td>
<td>
<p>estimate of expectation of Z
matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>YPM</code></td>
<td>
<p>posterior mean of Y (for imputing missing values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GOF</code></td>
<td>
<p>observed (first row) and posterior predictive (remaining rows)
values of four goodness-of-fit statistics</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Hoff, Yanjun He
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(YX_bin_long) 
fit&lt;-ame_rep(YX_bin_long$Y,YX_bin_long$X,burn=5,nscan=5,odens=1,family="bin")
# you should run the Markov chain much longer than this

</code></pre>


</div>