<div class="container">

<table style="width: 100%;"><tr>
<td>ms_object</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Microsoft Graph object</h2>

<h3>Description</h3>

<p>Base class representing a object in Microsoft Graph. All other Graph object classes ultimately inherit from this class.
</p>


<h3>Format</h3>

<p>An R6 object of class <code>ms_object</code>.
</p>


<h3>Fields</h3>


<ul>
<li> <p><code>token</code>: The token used to authenticate with the Graph host.
</p>
</li>
<li> <p><code>tenant</code>: The Azure Active Directory tenant for this object.
</p>
</li>
<li> <p><code>type</code>: The type of object, in a human-readable format.
</p>
</li>
<li> <p><code>properties</code>: The object properties, as obtained from the Graph host.
</p>
</li>
</ul>
<h3>Methods</h3>


<ul>
<li> <p><code>new(...)</code>: Initialize a new directory object. Do not call this directly; see 'Initialization' below.
</p>
</li>
<li> <p><code>delete(confirm=TRUE)</code>: Delete an object. By default, ask for confirmation first.
</p>
</li>
<li> <p><code>update(...)</code>: Update the object information in Azure Active Directory.
</p>
</li>
<li> <p><code>do_operation(...)</code>: Carry out an arbitrary operation on the object.
</p>
</li>
<li> <p><code>sync_fields()</code>: Synchronise the R object with the data in Azure Active Directory.
</p>
</li>
<li> <p><code>get_list_pager(...)</code>: Returns a pager object, which is an <em>iterator</em> for a set of paged query results. See 'Paged results' below.
</p>
</li>
</ul>
<h3>Initialization</h3>

<p>Objects of this class should not be created directly. Instead, create an object of the appropriate subclass.
</p>


<h3>List methods</h3>

<p>All <code style="white-space: pre;">⁠list_*⁠</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.
</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.
</p>


<h3>Paged results</h3>

<p>Microsoft Graph returns lists in pages, with each page containing a subset of objects and a link to the next page. AzureGraph provides an iterator-based API that lets you access each page individually, or collect them all into a single object.
</p>
<p>To create a new pager object, call the <code>get_list_pager()</code> method with the following arguments:
</p>

<ul>
<li> <p><code>lst</code>: A list containing the first page of results, generally from a call to the <code>do_operation()</code> method.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠next_link_name,value_name⁠</code>: The names of the components of <code>first_page</code> containing the link to the next page, and the set of values for the page respectively. The default values are <code style="white-space: pre;">⁠@odata.nextLink⁠</code> and <code>value</code>.
</p>
</li>
<li> <p><code>generate_objects</code>: Whether the iterator should return a list containing the parsed JSON for the page values, or convert it into a list of R6 objects.
</p>
</li>
<li> <p><code>type_filter</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>default_generator</code>: The default generator object to use when converting a list of properties into an R6 object, if the class can't be detected. Defaults to <code>ms_object</code>. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
<li> <p><code>...</code>: Any extra arguments required to initialise the returned objects. Only used if <code>generate_objects</code> is TRUE.
</p>
</li>
</ul>
<p>This returns an object of class ms_graph_pager, which is an <em>iterator</em> for the set of paged results. Each call to the object's <code>value</code> active binding yields the next page. When all pages have been returned, <code>value</code> contains NULL.
</p>
<p>The format of the returned values can take one of 3 forms, based on the initial format of the first page and the <code>generate_objects</code> argument.
</p>
<p>If the first page of results is a data frame (each item has been converted into a row), then the pager will return results as data frames. In this case, the <code>output</code> field is automatically set to "data.frame" and the <code>generate_objects</code> initialization argument is ignored. Usually this will be the case when the results are meant to represent external data, eg items in a SharePoint list.
</p>
<p>If the first page of results is a list, the <code>generate_objects</code> argument sets whether to convert the items in each page into R6 objects defined by the AzureGraph class framework. If <code>generate_objects</code> is TRUE, the <code>output</code> field is set to "object", and if <code>generate_objects</code> is FALSE, the <code>output</code> field is set to "list".
</p>
<p>You can also call the <code>extract_list_values()</code> function to get all or some of the values from a pager, without having to manually combine the pages together.
</p>


<h3>Deprecated methods</h3>

<p>The following methods are private and <strong>deprecated</strong>, and form the older AzureGraph API for accessing paged results. They will eventually be removed.
</p>

<ul>
<li> <p><code>get_paged_list(lst, next_link_name, value_name, simplify, n)</code>: This method reconstructs the list, given the first page.
</p>
</li>
<li> <p><code>init_list_objects(lst, type_filter, default_generator, ...)</code>: <code>get_paged_list</code> returns a raw list, the result of parsing the JSON response from the Graph host. This method converts the list into actual R6 objects.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>ms_graph, az_object, ms_graph_pager, extract_list_values
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/overview?view=graph-rest-1.0">REST API reference</a>
</p>


</div>