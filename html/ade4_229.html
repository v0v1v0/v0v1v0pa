<div class="container">

<table style="width: 100%;"><tr>
<td>orthobasis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthonormal basis for orthonormal transform</h2>

<h3>Description</h3>

<p>These functions returns object of class <code>'orthobasis'</code> that
contains data frame defining an orthonormal basis.
</p>
<p><code>orthobasic.neig</code> returns the eigen vectors of the matrix N-M where M is the symmetric <em>n</em> by <em>n</em> matrix of the between-sites neighbouring graph and N is the diagonal matrix of neighbour numbers. <br><code>orthobasis.line</code> returns the analytical solution for the linear neighbouring graph. <br><code>orthobasic.circ</code> returns the analytical solution for the circular neighbouring graph. <br><code>orthobsic.mat</code> returns the eigen vectors of the general link matrix M. <br><code>orthobasis.haar</code> returns wavelet haar basis. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">orthobasis.neig(neig)
orthobasis.line(n)
orthobasis.circ(n)
orthobasis.mat(mat, cnw=TRUE)
orthobasis.haar(n)
## S3 method for class 'orthobasis'
print(x,..., nr = 6, nc = 4)
## S3 method for class 'orthobasis'
plot(x,...)
## S3 method for class 'orthobasis'
summary(object,...)
is.orthobasis(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>neig</code></td>
<td>
<p>is an object of class <code>neig</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>is an integer that defines length of vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>is a <em>n</em> by <em>n</em> phylogenetic or spatial link matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cnw</code></td>
<td>
<p>if TRUE, the matrix of the neighbouring graph is modified to give Constant Neighbouring Weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, object</code></td>
<td>
<p>is an object of class <code>orthobasis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nr, nc</code></td>
<td>
<p>the number of rows and columns to be printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>: further arguments passed to or from other methods</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>All the functions return an object of class <code>orthobasis</code> containing a data frame.
This data frame defines an orthonormal basis with various attributes: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>names of the vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.names</code></td>
<td>
<p>row names of the data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>optional associated eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>weights for the rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>: call</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>the function <code>orthobasis.haar</code> uses function <code>wavelet.filter</code> from package waveslim.</p>


<h3>Author(s)</h3>

<p>Sébastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a> <br>
Daniel Chessel 
</p>


<h3>References</h3>

<p>Misiti, M., Misiti, Y., Oppenheim, G. and Poggi, J.M. (1993) Analyse de signaux classiques par décomposition en ondelettes. 
<em>Revue de Statistique Appliquée</em>, <b>41</b>, 5–32.
</p>
<p>Cornillon, P.A. (1998) <em>Prise en compte de proximités en analyse factorielle et comparative</em>.
Thèse, Ecole Nationale Supérieure Agronomique, Montpellier.
</p>


<h3>See Also</h3>

<p><code>gridrowcol</code> that defines an orthobasis for square grid, 
<code>phylog</code> that defines an orthobasis for phylogenetic tree, 
<code>orthogram</code> and <code>mld</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# a 2D spatial orthobasis
w &lt;- gridrowcol(8, 8)
if(adegraphicsLoaded()) {
  g1 &lt;- s.value(w$xy, w$orthobasis[, 1:16], pleg.drawKey = FALSE, pgri.text.cex = 0, 
    ylim = c(0, 10), porigin.include = FALSE, paxes.draw = FALSE)
  g2 &lt;- s1d.barchart(attr(w$orthobasis, "values"), p1d.horizontal = FALSE, 
    labels = names(attr(w$orthobasis, "values")), plabels.cex = 0.7)

} else {
  par(mfrow = c(4, 4))
  for(k in 1:16)
    s.value(w$xy, w$orthobasis[, k], cleg = 0, csi = 2, incl = FALSE,
      addax = FALSE, sub = k, csub = 4, ylim = c(0, 10), cgri = 0)
  par(mfrow = c(1, 1))
  barplot(attr(w$orthobasis, "values"))
}


# Haar 1D orthobasis
w &lt;- orthobasis.haar(32)
par(mfrow = c(8, 4))
par(mar = c(0.1, 0.1, 0.1, 0.1))
 for (k in 1:31) {
    plot(w[, k], type = "S", xlab = "", ylab = "", xaxt = "n",
     yaxt = "n", xaxs = "i", yaxs = "i", ylim = c(-4.5, 4.5))
    points(w[, k], type = "p", pch = 20, cex = 1.5)
}

# a 1D orthobasis
w &lt;- orthobasis.line(n = 33)
par(mfrow = c(8, 4))
par(mar = c(0.1, 0.1, 0.1, 0.1))
 for (k in 1:32) {
    plot(w[, k], type = "l", xlab = "", ylab = "", xaxt = "n",
     yaxt = "n", xaxs = "i", yaxs = "i", ylim = c(-1.5, 1.5))
    points(w[, k], type = "p", pch = 20, cex = 1.5)
}

if(adegraphicsLoaded()) {
  s1d.barchart(attr(w, "values"), p1d.horizontal = FALSE, labels = names(attr(w, "values")), 
    plab.cex = 0.7)
} else {
  par(mfrow = c(1, 1))
  barplot(attr(w, "values"))
}

w &lt;- orthobasis.circ(n = 26)
#par(mfrow = c(5, 5))
#par(mar = c(0.1, 0.1, 0.1, 0.1))
# for (k in 1:25) 
#    dotcircle(w[, k], xlim = c(-1.5, 1.5), cleg = 0)

par(mfrow = c(1, 1))
#barplot(attr(w, "values"))

## Not run: 
# a spatial orthobasis
data(mafragh)
w &lt;- orthobasis.neig(mafragh$neig)
if(adegraphicsLoaded()) {
  s.value(mafragh$xy, w[, 1:8], plegend.drawKey = FALSE)
  s1d.barchart(attr(w, "values"), p1d.horizontal = FALSE)
} else {
  par(mfrow = c(4, 2))
  for(k in 1:8)
    s.value(mafragh$xy, w[, k], cleg = 0, sub = as.character(k), csub = 3)
  par(mfrow = c(1, 1))
  barplot(attr(w, "values"))
}

# a phylogenetic orthobasis
data(njplot)
phy &lt;- newick2phylog(njplot$tre)
wA &lt;- phy$Ascores
wW &lt;- phy$Wscores
table.phylog(phylog = phy, wA, clabel.row = 0, clabel.col  = 0.5)
table.phylog(phylog = phy, wW, clabel.row = 0, clabel.col  = 0.5)


## End(Not run)</code></pre>


</div>