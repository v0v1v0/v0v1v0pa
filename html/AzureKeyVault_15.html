<div class="container">

<table style="width: 100%;"><tr>
<td>keys</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Encryption keys in Key Vault</h2>

<h3>Description</h3>

<p>This class represents the collection of encryption keys stored in a vault. It provides methods for managing keys, including creating, importing and deleting keys, and doing backups and restores. For operations with a specific key, see key.
</p>


<h3>Methods</h3>

<p>This class provides the following methods:</p>
<pre>create(name, type=c("RSA", "EC"), hardware=FALSE,
       ec_curve=NULL, rsa_key_size=NULL, key_ops=NULL,
       attributes=vault_object_attrs(), ...)
import(name, key, hardware=FALSE,
       attributes=vault_object_attrs(), ...)
get(name)
delete(name, confirm=TRUE)
list(include_managed=FALSE)
backup(name)
restore(backup)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the key.
</p>
</li>
<li> <p><code>type</code>: For <code>create</code>, the type of key to create: RSA or elliptic curve (EC). Note that for keys backing a certificate, only RSA is allowed.
</p>
</li>
<li> <p><code>hardware</code>: For <code>create</code>, Whether to use a hardware key or software key. The former requires a premium key vault.
</p>
</li>
<li> <p><code>ec_curve</code>: For an EC key, the type of elliptic curve.
</p>
</li>
<li> <p><code>rsa_key_size</code>: For an RSA key, the key size, either 2048, 3072 or 4096.
</p>
</li>
<li> <p><code>key_ops</code>: A character vector of operations that the key supports. The possible operations are "encrypt", "decrypt", "sign", "verify", "wrapkey" and "unwrapkey". See key for more information.
</p>
</li>
<li> <p><code>attributes</code>: Optional attributes for the key, such as the expiry date and activation date. A convenient way to provide this is via the vault_object_attrs helper function.
</p>
</li>
<li> <p><code>key</code>: For <code>import</code>, the key to import. This can be the name of a PEM file, a JSON web key (JWK) string, or a key object generated by the openssl package. See the examples below.
</p>
</li>
<li> <p><code>hardware</code>: For <code>import</code>, whether to import this key as a hardware key (HSM). Only supported for a premium key vault.
</p>
</li>
<li> <p><code>...</code>: For <code>create</code> and <code>import</code>, other named arguments which will be treated as tags.
</p>
</li>
<li> <p><code>include_managed</code>: For <code>list</code>, whether to include keys that were created by Key Vault to support a managed certificate.
</p>
</li>
<li> <p><code>backup</code>: For <code>restore</code>, a string representing the backup blob for a key.
</p>
</li>
</ul>
<h3>Value</h3>

<p>For <code>get</code>, <code>create</code> and <code>import</code>, an object of class <code>stored_key</code>, representing the key itself. This has methods for carrying out the operations given by the <code>key_ops</code> argument.
</p>
<p>For <code>list</code>, a vector of key names.
</p>
<p>For <code>backup</code>, a string representing the backup blob for a key. If the key has multiple versions, the blob will contain all versions.
</p>


<h3>See Also</h3>

<p>key, vault_object_attrs
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/key-vault/">Azure Key Vault documentation</a>,
<a href="https://docs.microsoft.com/en-us/rest/api/keyvault">Azure Key Vault API reference</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

vault &lt;- key_vault("mykeyvault")

vault$keys$create("mynewkey")
vault$keys$create("myRSAkey", type="RSA", rsa_key_size=4096)
vault$keys$create("myECkey", type="EC", ec_curve="P-384")

vault$keys$list()
vault$keys$get("mynewkey")

# specifying an expiry date
today &lt;- Sys.date()
vault$keys$create("mynewkey", attributes=vault_object_attrs(expiry_date=today+365))

# setting management tags
vault$keys$create("mynewkey", tag1="a value", othertag="another value")

# importing a key from a PEM file
vault$keys$import("importedkey1", "myprivatekey.pem")

# importing a key generated by OpenSSL
vault$keys$import("importedkey2", openssl::rsa_keygen())

# importing a JWK (which is a JSON string)
key &lt;- openssl::read_key("myprivatekey.pem")
jwk &lt;- jose::write_jwk(key)
vault$keys$import("importedkey3", jwk)

# backup and restore a key
bak &lt;- vault$keys$backup("mynewkey")
vault$keys$delete("mynewkey", confirm=FALSE)
vault$keys$restore(bak)


## End(Not run)
</code></pre>


</div>