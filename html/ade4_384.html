<div class="container">

<table style="width: 100%;"><tr>
<td>s.multinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graph of frequency profiles (useful for instance in genetic)</h2>

<h3>Description</h3>

<p>The main purpose of this function is to draw categories using scores and profiles by their gravity center.
Confidence intervals of the average position (issued from a multinomial distribution) can be superimposed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">s.multinom(dfxy, dfrowprof, translate = FALSE, xax = 1, yax = 2, 
   labelcat = row.names(dfxy), clabelcat = 1, cpointcat = if (clabelcat == 0) 2 else 0,
   labelrowprof = row.names(dfrowprof), clabelrowprof = 0.75, 
   cpointrowprof = if (clabelrowprof == 0) 2 else 0, pchrowprof = 20, 
   coulrowprof = grey(0.8), proba = 0.95, n.sample = apply(dfrowprof, 1, sum),
   axesell = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfxy</code></td>
<td>
<p><code>dfxy</code> is a data frame containing at least two numerical variables.
The rows of <code>dfxy</code> are categories such as 1,2 and 3 in the triangular plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfrowprof</code></td>
<td>
<p><code>dfrowprof</code> is a data frame whose the columns are the rows of <code>dfxy</code>.
The rows of <code>dfxy</code> are profiles or frequency distributions on the categories.
The column number of <code>dfrowprof</code> must be equal to the row number of <code>dfxy</code>.
<code>row.names(dfxy)</code> and <code>names(dfrowprof)</code> must be identical. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>translate</code></td>
<td>
<p>a logical value indicating whether the plot should be translated(TRUE) or not. 
The origin becomes the gravity center weighted by profiles. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax</code></td>
<td>
<p>the column number of <code>dfxy</code> for the x-axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax</code></td>
<td>
<p>the column number of <code>dfxy</code> for the y-axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelcat</code></td>
<td>
<p>a vector of strings of characters for the labels of categories </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clabelcat</code></td>
<td>
<p>an integer specifying the character size for the labels of categories, 
used with <code>par("cex")*clabelcat</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpointcat</code></td>
<td>
<p>an integer specifying the character size for the points showing the categories, 
used with <code>par("cex")*cpointcat</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelrowprof</code></td>
<td>
<p>a vector of strings of characters for the labels of profiles (rows of <code>dfrowprof</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clabelrowprof</code></td>
<td>
<p>an integer specifying the character size for the labels of profiles 
used with par("cex")*clabelrowprof</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpointrowprof</code></td>
<td>
<p>an integer specifying the character size for the points representative 
of the profiles used with par("cex")*cpointrowprof </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pchrowprof</code></td>
<td>
<p>either an integer specifying a symbol or a single character to be used for the profile labels </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coulrowprof</code></td>
<td>
<p>a vector of colors used for ellipses, possibly recycled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba</code></td>
<td>
<p>a value lying between 0.500 and 0.999 to draw a confidence interval </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sample</code></td>
<td>
<p>a vector containing the sample size, possibly recycled. Used <code>n.sample = 0</code> if the profiles
are not issued from a multinomial distribution and that confidence intervals have no sense. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axesell</code></td>
<td>
<p>a logical value indicating whether the ellipse axes should be drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed from the <code>s.label</code> for the initial scatter plot. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns in a hidden way a list of three components :
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tra</code></td>
<td>
<p>a vector with two values giving the done original translation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ell</code></td>
<td>
<p>a matrix, with 5 columns and for rows the number of profiles, giving the means, 
the variances and the covariance of the profile for the used
numerical codes (column of <code>dfxy</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel Chessel 
</p>


<h3>Examples</h3>

<pre><code class="language-R">par(mfrow = c(2,2))
par(mar = c(0.1,0.1,0.1,0.1))
proba &lt;- matrix(c(0.49,0.47,0.04,0.4,0.3,0.3,0.05,0.05,0.9,0.05,0.7,0.25), ncol = 3, byrow = TRUE)
proba.df &lt;- as.data.frame (proba)
names(proba.df) &lt;- c("A","B","C") ; row.names(proba.df) &lt;- c("P1","P2","P3","P4")
w.proba &lt;- triangle.plot(proba.df, clab = 2, show = FALSE)
box()

w.tri = data.frame(x = c(-sqrt(1/2),sqrt(1/2),0), y = c(-1/sqrt(6),-1/sqrt(6),2/sqrt(6)))
L3 &lt;- c("A","B","C")
row.names(w.tri) &lt;- L3
s.multinom(w.tri, proba.df, n.sample = 0, coulrowprof = "black", clabelrowprof = 1.5)
s.multinom(w.tri, proba.df, n.sample = 30, coul = palette()[5])
s.multinom(w.tri, proba.df, n.sample = 60, coul = palette()[6], add.p = TRUE)
s.multinom(w.tri, proba.df, n.sample = 120, coul = grey(0.8), add.p = TRUE)

print(s.multinom(w.tri, proba.df[-3,], n.sample = 0, translate = TRUE)$tra)
</code></pre>


</div>