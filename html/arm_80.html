<div class="container">

<table style="width: 100%;"><tr>
<td>sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions to Get Posterior Distributions</h2>

<h3>Description</h3>

<p>This generic function gets posterior simulations of sigma and beta from a <code>lm</code> object, or
simulations of beta from a <code>glm</code> object, or
simulations of beta from a <code>merMod</code> object
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim(object, ...)

## S4 method for signature 'lm'
sim(object, n.sims = 100)
## S4 method for signature 'glm'
sim(object, n.sims = 100)
## S4 method for signature 'polr'
sim(object, n.sims = 100)
## S4 method for signature 'merMod'
sim(object, n.sims = 100)

## S3 method for class 'sim'
coef(object,...)
## S3 method for class 'sim.polr'
coef(object, slot=c("ALL", "coef", "zeta"),...)
## S3 method for class 'sim.merMod'
coef(object,...)
## S3 method for class 'sim.merMod'
fixef(object,...)
## S3 method for class 'sim.merMod'
ranef(object,...)
## S3 method for class 'sim.merMod'
fitted(object, regression,...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the output of a call to <code>lm</code> with n data points and k predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>return which slot of <code>sim.polr</code>, available options are <code>coef, zeta, ALL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sims</code></td>
<td>
<p>number of independent simulation draws to create.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regression</code></td>
<td>
<p>the orginial mer model</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>matrix (dimensions n.sims x k) of n.sims random draws of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>matrix (dimensions n.sims x k) of n.sims random draws of zetas (cut points in polr).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixef</code></td>
<td>
<p>matrix (dimensions n.sims x k) of n.sims random draws of coefficients     of the fixed effects for the <code>merMod</code> objects. Previously, it is called <code>unmodeled</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of n.sims random draws of sigma
(for <code>glm</code>'s, this just returns a vector of 1's or else of the
square root of the overdispersion parameter if that is in the model)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Andrew Gelman <a href="mailto:gelman@stat.columbia.edu">gelman@stat.columbia.edu</a>;
Yu-Sung Su <a href="mailto:suyusung@tsinghua.edu.cn">suyusung@tsinghua.edu.cn</a>;
Vincent Dorie <a href="mailto:vjd4@nyu.edu">vjd4@nyu.edu</a>
</p>


<h3>References</h3>

<p>Andrew Gelman and Jennifer Hill. (2006).
<em>Data Analysis Using Regression and Multilevel/Hierarchical Models</em>.
Cambridge University Press.</p>


<h3>See Also</h3>

<p><code>display</code>,
<code>lm</code>,
<code>glm</code>,
<code>lmer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Examples of "sim"
 set.seed (1)
 J &lt;- 15
 n &lt;- J*(J+1)/2
 group &lt;- rep (1:J, 1:J)
 mu.a &lt;- 5
 sigma.a &lt;- 2
 a &lt;- rnorm (J, mu.a, sigma.a)
 b &lt;- -3
 x &lt;- rnorm (n, 2, 1)
 sigma.y &lt;- 6
 y &lt;- rnorm (n, a[group] + b*x, sigma.y)
 u &lt;- runif (J, 0, 3)
 y123.dat &lt;- cbind (y, x, group)
# Linear regression
 x1 &lt;- y123.dat[,2]
 y1 &lt;- y123.dat[,1]
 M1 &lt;- lm (y1 ~ x1)
 display(M1)
 M1.sim &lt;- sim(M1)
 coef.M1.sim &lt;- coef(M1.sim)
 sigma.M1.sim &lt;- sigma.hat(M1.sim)
 ## to get the uncertainty for the simulated estimates
 apply(coef(M1.sim), 2, quantile)
 quantile(sigma.hat(M1.sim))

# Logistic regression
 u.data &lt;- cbind (1:J, u)
 dimnames(u.data)[[2]] &lt;- c("group", "u")
 u.dat &lt;- as.data.frame (u.data)
 y &lt;- rbinom (n, 1, invlogit (a[group] + b*x))
 M2 &lt;- glm (y ~ x, family=binomial(link="logit"))
 display(M2)
 M2.sim &lt;- sim (M2)
 coef.M2.sim &lt;- coef(M2.sim)
 sigma.M2.sim &lt;- sigma.hat(M2.sim)

# Ordered Logistic regression
house.plr &lt;- polr(Sat ~ Infl + Type + Cont, weights = Freq, data = housing)
display(house.plr)
M.plr &lt;- sim(house.plr)
coef.sim &lt;- coef(M.plr, slot="coef")
zeta.sim &lt;- coef(M.plr, slot="zeta")
coefall.sim &lt;- coef(M.plr)

# Using lmer:
# Example 1
 E1 &lt;- lmer (y ~ x + (1 | group))
 display(E1)
 E1.sim &lt;- sim (E1)
 coef.E1.sim &lt;- coef(E1.sim)
 fixef.E1.sim &lt;- fixef(E1.sim)
 ranef.E1.sim &lt;- ranef(E1.sim)
 sigma.E1.sim &lt;- sigma.hat(E1.sim)
 yhat &lt;- fitted(E1.sim, E1)

# Example 2
 u.full &lt;- u[group]
 E2 &lt;- lmer (y ~ x + u.full + (1 | group))
 display(E2)
 E2.sim &lt;- sim (E2)
 coef.E2.sim &lt;- coef(E2.sim)
 fixef.E2.sim &lt;- fixef(E2.sim)
 ranef.E2.sim &lt;- ranef(E2.sim)
 sigma.E2.sim &lt;- sigma.hat(E2.sim)
 yhat &lt;- fitted(E2.sim, E2)

# Example 3
 y &lt;- rbinom (n, 1, invlogit (a[group] + b*x))
 E3 &lt;- glmer (y ~ x + (1 | group), family=binomial(link="logit"))
 display(E3)
 E3.sim &lt;- sim (E3)
 coef.E3.sim &lt;- coef(E3.sim)
 fixef.E3.sim &lt;- fixef(E3.sim)
 ranef.E3.sim &lt;- ranef(E3.sim)
 sigma.E3.sim &lt;- sigma.hat(E3.sim)
 yhat &lt;- fitted(E3.sim, E3)
</code></pre>


</div>