<div class="container">

<table style="width: 100%;"><tr>
<td>get.increase.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Pair-wise Distances of Soil Properties over Depth</h2>

<h3>Description</h3>

<p>Computes pair-wise distance matrix to determine where an attribute increases within
a specified vertical distance threshold.
</p>
<p><code>get.increase.depths</code> performs the conversion of the square matrix
output of <code>get.increase.matrix</code> back to horizon top depth for where
criteria were met.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.increase.matrix(p, attr, threshold.fun, vertical.distance)

get.increase.depths(p, attr, threshold.fun, vertical.distance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a SoilProfileCollection, containing a single profile</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attr</code></td>
<td>
<p>horizon attribute name to get the "increase" of</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.fun</code></td>
<td>
<p>a function that returns the threshold (as a function of
attr); may return a constant single value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical.distance</code></td>
<td>
<p>the vertical distance (determined from difference
SPC top depth variable) within which increase must be met</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses matrix outer product to determine all pair-wise differences in <code>attr</code>
for the horizons of <code>p</code>. Supplies <code>attr</code> to <code>threshold.fun</code> to determine the
minimum value criterion to return TRUE in output matrix for an "increase".
Also, computes all pair-wise distances in depth dimension to determine
whether the vertical distance criteria have been met simultaneously with
<code>attr</code> increase.
</p>
<p>This function assumes that the <code>threshold.fun</code> supplied by the user returns
either a constant or a vector of equal length to its input.
</p>
<p>Note that the <code>threshold.fun</code> result is allowed to contain NA, but that will
result in no output for affected cells.
</p>
<p><code>get.increase.depths()</code> performs the conversion of the square matrix
output of <code>get.increase.matrix</code> back to horizon top depth for where
criteria were met.
</p>
<p>Note that the <code>threshold.fun</code> result is allowed to contain <code>NA</code>, but that will
result in no output for affected cells.
</p>


<h3>Value</h3>

<p>Returns a square logical matrix reflecting where the increase
criteria were met.
</p>
<p><code>get.increase.depths</code> converts to horizon top depth by using above
matrix output to determine depths where increase is met.
</p>
<p>Returns a numeric vector of depths where the increase requirement is
met. For the argillic, the first is the one of interest.
</p>
<p><code>get.increase.depths()</code> converts to horizon top depth by using above
matrix output to determine depths where increase is met.
</p>


<h3>Author(s)</h3>

<p>Andrew Gene Brown
</p>


<h3>See Also</h3>

<p><code>getArgillicBounds()</code>, <code>crit.clay.argillic()</code>
</p>
<p><code>getArgillicBounds()</code> <code>crit.clay.argillic()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(sp1, package = 'aqp')
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

p &lt;- sp1[1]
attr &lt;- 'prop' # clay contents
foo &lt;- get.increase.matrix(p, threshold.fun = crit.clay.argillic,
                           attr = attr, vertical.distance = 30)
foo


data(sp1, package = 'aqp')
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

p &lt;- sp1[1]
attr &lt;- 'prop' # clay contents
foo &lt;- get.increase.depths(p, threshold.fun = crit.clay.argillic,
                           attr = attr, vertical.distance = 30)
foo

</code></pre>


</div>