<div class="container">

<table style="width: 100%;"><tr>
<td>Amatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construction of Relationship Matrix A</h2>

<h3>Description</h3>

<p>Creates an additive relationship matrix A from a pedigree data in a 3-column way format based on ploidy level (an even number) and, if ploidy equals 4, based on proportion of parental gametes that are IBD (Identical by Descent) due to double reduction. Returns a dominance relationship matrix if dominance true (ploidy 2 only). Autopolyploid matrices based on Kerr (2012), used when 'ploidy' argument is higher than '2' and 'dominance=FALSE'.
Diploid additive numerator relationship matrix built as in Henderson (1976), used when 'ploidy=2' and 'dominance=FALSE'. Diploid dominance numerator relationship matrix built as in Cockerham (1954), used when 'ploidy=2' and 'dominance=FALSE'. For details of recursive method see Mrode (2005).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Amatrix(
  data = NULL,
  ploidy = 2,
  w = 0,
  verify = TRUE,
  dominance = FALSE,
  slater = FALSE,
  ASV = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>pedigree data name (3-column way format). Unknown value should be equal 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>an even number (default=2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>proportion of parental gametas IBD due to double reduction (default=0), only if ploidy=4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verify</code></td>
<td>
<p>verifies pedigree file for conflictuos entries (default=TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dominance</code></td>
<td>
<p>if true, returns the dominance relationship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slater</code></td>
<td>
<p>if true, returns the additive autotetraploid relationship matrix as Slater (2013)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ASV</code></td>
<td>
<p>if TRUE, transform matrix into average semivariance (ASV) equivalent (K = K / (trace(K) / (nrow(K)-1))). Details formula 2 of Fieldmann et al. (2022). Default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to datatreat()</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix with the Relationship between the individuals.
</p>


<h3>Author(s)</h3>

<p>Rodrigo R Amadeu, <a href="mailto:rramadeu@gmail.com">rramadeu@gmail.com</a>
</p>


<h3>References</h3>

<p><em>Cockerham, CC. 1954. An extension of the concept of partitioning hereditary variance for analysis of covariances among relatives when epistasis is present. Genetics 39, 859â€“882</em>
</p>
<p><em>Feldmann MJ, et al. 2022. Average semivariance directly yields accurate estimates of the genomic variance in complex trait analyses. G3 (Bethesda), 12(6).</em>
</p>
<p><em>Henderson, CR. 1976. A simple method for computing the inverse of a numerator relationship matrix used in prediction of breeding values. Biometrics 32, 69-83</em>
</p>
<p><em>Kerr, RJ, et al. 2012. Use of the numerator relationship matrix in genetic analysis of autopolyploid species. Theoretical and Applied Genetics 124 1271-1282</em>
</p>
<p><em>Mrode, RA. 2014. Chapter 2: Genetic Covariance Between Relatives and Chapter 9: Non-additive Animal Models in Mrode, RA. 2014. Linear models for the prediction of animal breeding values. Cabi, 3rd edition.</em>
</p>
<p><em>Slater, AT, et al. 2013. Improving the analysis of low heritability complex traits for enhanced genetic gain in potato. Theoretical and Applied Genetics 127, 809-820</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ped.mrode)
#Computing additive relationship matrix considering diploidy (Henderson 1976):
Amatrix(ped.mrode, ploidy=2)
#Computing non-additive relationship matrix considering diploidy (Cockerham 1954):
Amatrix(ped.mrode, ploidy=2, dominance=TRUE)
#Computing additive relationship matrix considering autotetraploidy (Kerr 2012):
Amatrix(ped.mrode, ploidy=4)
#Computing additive relationship matrix considering autooctaploidy (Kerr 2012):
Amatrix(ped.mrode, ploidy=8)
#Computing additive relationship matrix considering autotetraploidy and double-
#reduction of 0.1 (Kerr 2012):
Amatrix(ped.mrode, ploidy=4, w=0.1)
#Computing additive relationship matrix considering 
#autotetraploidy and double-reduction of 0.1 (Slater 2014):
Amatrix(ped.mrode, ploidy=4, w=0.1, slater = TRUE)
#Computing additive relationship matrix considering autohexaploidy and double-
#reduction of 0.1 (Kerr 2012):
Amatrix(ped.mrode, ploidy=6, w=0.1)

</code></pre>


</div>