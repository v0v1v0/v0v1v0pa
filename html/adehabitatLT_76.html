<div class="container">

<table style="width: 100%;"><tr>
<td>rasterize.ltraj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Rasterize a Trajectory
</h2>

<h3>Description</h3>

<p>The function <code>rasterize.ltraj</code> allows to rasterize a trajectory.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">rasterize.ltraj(ltr, map)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ltr</code></td>
<td>

<p>An object of class <code>ltraj</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>

<p>An object inheriting the class <code>SpatialPixels</code>
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of objects of class <code>SpatialPointsDataFrame</code>, with one
component per burst in the object of class <code>ltraj</code>. Each object
contains the coordinates of the pixels of the maps traversed by the
trajectory. The number of the step that traverse each pixel is
indicated. 
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>See Also</h3>

<p><code>as.ltraj</code> for additional information about objects of
class <code>ltraj</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(puechabonsp)
data(puechcirc)

## Show the trajectories on the map
plot(puechcirc, spixdf = puechabonsp$map)

## rasterize the trajectories
ii &lt;- rasterize.ltraj(puechcirc, puechabonsp$map)

## show, e.g. the first rasterized trajectory
tr1 &lt;- ii[[1]]
head(tr1)
plot(tr1)

## so, for example, to see the pixels traversed by the third step of the
##  trajectory
points(tr1[tr1[[1]]==3,], col="red")

## So, if we want to calculate the mean elevation for each step:
mel &lt;- over(tr1, puechabonsp$map)
mo &lt;- tapply(mel[[1]], tr1[[1]], mean)
plot(mo, ty="l")

## It is clear that elevation decreases at the middle of the monitoring
## and increases again at the end (the animal sleeps on the plateau
## and goes down in the vineyards during the night).

## Now define an infolocs component in puechcirc corresponding to the
## mean elevation:

val &lt;- lapply(1:length(ii), function(i) {

    ## get the rasterized trajectory
    tr &lt;- ii[[i]]

    ## get the pixels of the map
    mel &lt;- over(tr, puechabonsp$map)

    ## calculate the mean elevation
    mo &lt;- tapply(mel[[1]], tr[[1]], mean)

    ## prepare the output
    elev &lt;- rep(NA, nrow(puechcirc[[i]]))

    ## place the average values at the right place
    ## names(mo) contains the step number (i.e. relocation
    ## number +1)
    elev[as.numeric(names(mo))+1] &lt;- mo

    ## Checks that the row.names are the same for
    ## the result and the ltraj component
    df &lt;- data.frame(elevation = elev)
    row.names(df) &lt;- row.names(puechcirc[[i]])

    return(df)
})

## define the infolocs component
infolocs(puechcirc) &lt;- val

## and draw the trajectory
plotltr(puechcirc, "elevation")

</code></pre>


</div>