<div class="container">

<table style="width: 100%;"><tr>
<td>derive_vars_atc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Derive ATC Class Variables</h2>

<h3>Description</h3>

<p>Add Anatomical Therapeutic Chemical class variables from <code>FACM</code> to <code>ADCM</code>.
</p>
<p><strong>Note:</strong> This is a wrapper function for the more generic <code>derive_vars_transposed()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">derive_vars_atc(
  dataset,
  dataset_facm,
  by_vars = exprs(USUBJID, CMREFID = FAREFID),
  id_vars = NULL,
  value_var = FASTRESC
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>Input dataset
</p>
<p>The variables specified by the <code>by_vars</code> argument are expected to be in the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset_facm</code></td>
<td>
<p>FACM dataset
</p>
<p>The variables specified by the <code>by_vars</code> and <code>value_var</code> parameters,
<code>FAGRPID</code> and <code>FATESTCD</code> are required</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_vars</code></td>
<td>
<p>Grouping variables
</p>
<p>Keys used to merge <code>dataset_facm</code> with <code>dataset</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_vars</code></td>
<td>
<p>ID variables
</p>
<p>Variables (excluding by_vars) that uniquely identify each observation in <code>dataset_merge</code>.
</p>
<p><em>Permitted Values</em>: list of variables created by <code>exprs()</code>
e.g. <code>exprs(USUBJID, VISIT)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value_var</code></td>
<td>
<p>The variable of <code>dataset_facm</code> containing the values of the
transposed variables
</p>
<p>Default: <code>FASTRESC</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The input dataset with ATC variables added
</p>


<h3>See Also</h3>

<p>OCCDS Functions: 
<code>derive_var_trtemfl()</code>,
<code>derive_vars_query()</code>,
<code>get_terms_from_db()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(tibble)

cm &lt;- tribble(
  ~USUBJID, ~CMGRPID, ~CMREFID, ~CMDECOD,
  "BP40257-1001", "14", "1192056", "PARACETAMOL",
  "BP40257-1001", "18", "2007001", "SOLUMEDROL",
  "BP40257-1002", "19", "2791596", "SPIRONOLACTONE"
)
facm &lt;- tribble(
  ~USUBJID, ~FAGRPID, ~FAREFID, ~FATESTCD, ~FASTRESC,
  "BP40257-1001", "1", "1192056", "CMATC1CD", "N",
  "BP40257-1001", "1", "1192056", "CMATC2CD", "N02",
  "BP40257-1001", "1", "1192056", "CMATC3CD", "N02B",
  "BP40257-1001", "1", "1192056", "CMATC4CD", "N02BE",
  "BP40257-1001", "1", "2007001", "CMATC1CD", "D",
  "BP40257-1001", "1", "2007001", "CMATC2CD", "D10",
  "BP40257-1001", "1", "2007001", "CMATC3CD", "D10A",
  "BP40257-1001", "1", "2007001", "CMATC4CD", "D10AA",
  "BP40257-1001", "2", "2007001", "CMATC1CD", "D",
  "BP40257-1001", "2", "2007001", "CMATC2CD", "D07",
  "BP40257-1001", "2", "2007001", "CMATC3CD", "D07A",
  "BP40257-1001", "2", "2007001", "CMATC4CD", "D07AA",
  "BP40257-1001", "3", "2007001", "CMATC1CD", "H",
  "BP40257-1001", "3", "2007001", "CMATC2CD", "H02",
  "BP40257-1001", "3", "2007001", "CMATC3CD", "H02A",
  "BP40257-1001", "3", "2007001", "CMATC4CD", "H02AB",
  "BP40257-1002", "1", "2791596", "CMATC1CD", "C",
  "BP40257-1002", "1", "2791596", "CMATC2CD", "C03",
  "BP40257-1002", "1", "2791596", "CMATC3CD", "C03D",
  "BP40257-1002", "1", "2791596", "CMATC4CD", "C03DA"
)

derive_vars_atc(cm, facm)
</code></pre>


</div>