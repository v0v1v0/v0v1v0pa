<div class="container">

<table style="width: 100%;"><tr>
<td>ATE.ERROR.XY</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ATE.ERROR.XY Function for Estimating Average Treatment Effect (ATE) with Measurement Error in X and Misclassification in Y</h2>

<h3>Description</h3>

<p>The <code>ATE.ERROR.XY</code> function implements a method for estimating the Average Treatment Effect (ATE) that accounts for both measurement error in covariates and misclassification in the binary outcome variable Y.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ATE.ERROR.XY(
  Y_star,
  A,
  Z,
  X_star,
  p11,
  p10,
  sigma_epsilon,
  B = 100,
  Lambda = seq(0, 2, by = 0.5),
  extrapolation = "linear",
  bootstrap_number = 250
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y_star</code></td>
<td>
<p>Numeric vector. The observed binary outcome variable, possibly misclassified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>Numeric vector. The treatment indicator (1 if treated, 0 if control).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Numeric vector. A precisely measured covariate vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_star</code></td>
<td>
<p>Numeric vector. A covariate vector subject to measurement error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p11</code></td>
<td>
<p>Numeric. The probability of correctly classified Y given Y = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p10</code></td>
<td>
<p>Numeric. The probability of misclassified Y given Y = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma_epsilon</code></td>
<td>
<p>Numeric. The covariance matrix Sigma_epsilon for the measurement error model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Integer. The number of simulated datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>Numeric vector. A sequence of lambda values for simulated datasets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolation</code></td>
<td>
<p>Character. A regression model used for extrapolation ("linear", "quadratic", "nonlinear").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap_number</code></td>
<td>
<p>Numeric. The number of bootstrap samples (default is 250).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>ATE.ERROR.XY</code> function is designed to handle measurement error in covariates and misclassification in outcomes by using the augmented simulation-extrapolation approach.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>summary</dt>
<dd>
<p>A data frame with the following columns:
</p>

<ul>
<li> <p><code>Naive_ATE</code>: Naive estimate of the ATE.
</p>
</li>
<li> <p><code>Sigma_epsilon</code>: The covariance matrix Sigma_epsilon for the measurement error model.
</p>
</li>
<li> <p><code>p10</code>: The probability of misclassified Y given Y = 0.
</p>
</li>
<li> <p><code>p11</code>: The probability of correctly classified Y given Y = 1.
</p>
</li>
<li> <p><code>Extrapolation</code>:  A regression model used for extrapolation ("linear", "quadratic", "nonlinear").
</p>
</li>
<li> <p><code>ATE</code>: Mean ATE estimate from the bootstrap samples.
</p>
</li>
<li> <p><code>SE</code>: Standard error of the ATE estimate.
</p>
</li>
<li> <p><code>CI</code>: 95% confidence interval for the ATE estimate.
</p>
</li>
</ul>
</dd>
<dt>boxplot</dt>
<dd>
<p>A ggplot object representing the boxplot of the ATE estimates.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">
library(ATE.ERROR)
data(Simulated_data)
Y_star &lt;- Simulated_data$Y_star
A &lt;- Simulated_data$T
Z &lt;- Simulated_data$Z
X_star &lt;- Simulated_data$X_star
p11 &lt;- 0.8
p10 &lt;- 0.2
sigma_epsilon &lt;- 0.1
B &lt;- 100
Lambda &lt;- seq(0, 2, by = 0.5)
bootstrap_number &lt;- 10
result &lt;- ATE.ERROR.XY(Y_star, A, Z, X_star, p11, p10, sigma_epsilon, B, Lambda, 
                       "linear", bootstrap_number)
print(result$summary)
print(result$boxplot)


</code></pre>


</div>