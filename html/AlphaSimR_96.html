<div class="container">

<table style="width: 100%;"><tr>
<td>runMacs2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Alternative wrapper for MaCS</h2>

<h3>Description</h3>

<p>A wrapper function for <code>runMacs</code>. This wrapper is designed
to provide a more intuitive interface for writing custom commands
in MaCS (Chen et al. 2009). It effectively automates the creation
of an appropriate line for the manualCommand argument in <code>runMacs</code>
using user supplied variables, but only allows for a subset of the functionality
offered by this argument. The default arguments of this function were chosen to match
species="GENERIC" in <code>runMacs</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runMacs2(
  nInd,
  nChr = 1,
  segSites = NULL,
  Ne = 100,
  bp = 1e+08,
  genLen = 1,
  mutRate = 2.5e-08,
  histNe = c(500, 1500, 6000, 12000, 1e+05),
  histGen = c(100, 1000, 10000, 1e+05, 1e+06),
  inbred = FALSE,
  split = NULL,
  ploidy = 2L,
  returnCommand = FALSE,
  nThreads = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nInd</code></td>
<td>
<p>number of individuals to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nChr</code></td>
<td>
<p>number of chromosomes to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segSites</code></td>
<td>
<p>number of segregating sites to keep per chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ne</code></td>
<td>
<p>effective population size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bp</code></td>
<td>
<p>base pair length of chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genLen</code></td>
<td>
<p>genetic length of chromosome in Morgans</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutRate</code></td>
<td>
<p>per base pair mutation rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histNe</code></td>
<td>
<p>effective population size in previous
generations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histGen</code></td>
<td>
<p>number of generations ago for effective
population sizes given in histNe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inbred</code></td>
<td>
<p>should founder individuals be inbred</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>an optional historic population split in terms of generations ago</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>ploidy level of organism</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnCommand</code></td>
<td>
<p>should the command passed to manualCommand in
<code>runMacs</code> be returned. If TRUE, MaCS will not be called and
the command is returned instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nThreads</code></td>
<td>
<p>if OpenMP is available, this will allow for simulating chromosomes in parallel.
If the value is NULL, the number of threads is automatically detected.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of <code>MapPop-class</code> or if
returnCommand is true a string giving the MaCS command passed to
the manualCommand argument of <code>runMacs</code>.
</p>


<h3>References</h3>

<p>Chen GK, Marjoram P, Wall JD (2009).
“Fast and Flexible Simulation of DNA Sequence Data.”
<em>Genome Research</em>, <b>19</b>, 136-142.
<a href="https://genome.cshlp.org/content/19/1/136">https://genome.cshlp.org/content/19/1/136</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Creates a populations of 10 outbred individuals
# Their genome consists of 1 chromosome and 100 segregating sites
# The command is equivalent to using species="GENERIC" in runMacs
## Not run: 
founderPop = runMacs2(nInd=10,nChr=1,segSites=100)

# runMacs() Implementation of the cattle demography following
#  Macleod et al. (2013) https://doi.org/10.1093/molbev/mst125
cattleChrSum = 2.8e9 # https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_002263795.3/
(cattleChrBp = cattleChrSum / 30)
recRate = 9.26e-09
(cattleGenLen = recRate * cattleChrBp)
mutRate = 1.20e-08
runMacs2(nInd = 10, nChr = 1, Ne = 90, bp = cattleChrBp,
         genLen = cattleGenLen, mutRate = 1.20e-08,
         histNe  = c(120, 250, 350, 1000, 1500, 2000, 2500, 3500, 7000, 10000, 17000, 62000),
         histGen = c(  3,   6,  12,   18,   24,  154,  454,  654, 1754,  2354,  3354, 33154),
         returnCommand = TRUE)

## End(Not run)
</code></pre>


</div>