<div class="container">

<table style="width: 100%;"><tr>
<td>kinship.diagnostics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reports summary statistics, plots and filter options for a given kinship matrix K</h2>

<h3>Description</h3>

<p>It reports summary statistics, plots and allows for some filter options
for diagonal and off-diagonal elements for a given kinship matrix.
The input matrix can be a pedigree-based
relationship matrix <code class="reqn">\boldsymbol{A}</code>, a genomic relationship matrix <code class="reqn">\boldsymbol{G}</code> or a
hybrid relationship matrix <code class="reqn">\boldsymbol{H}</code>.
Individual names should be assigned to <code>rownames</code> and <code>colnames</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kinship.diagnostics(
  K = NULL,
  diagonal.thr.large = 1.2,
  diagonal.thr.small = 0.8,
  duplicate.thr = 0.95,
  clean.diagonal = FALSE,
  clean.duplicate = FALSE,
  plots = TRUE,
  sample.plot = 1,
  message = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Input of a kinship matrix in full format (<code class="reqn">n \times n</code>) (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal.thr.large</code></td>
<td>
<p>A threshold value to flag large diagonal values (default = <code>1.2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal.thr.small</code></td>
<td>
<p>A threshold value to flag small diagonal values (default = <code>0.8</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duplicate.thr</code></td>
<td>
<p>A threshold value to flag possible duplicates. Any calculation larger than the
threshold based on
<code class="reqn">\boldsymbol{k}_{i,i}\mathbin{/}\sqrt{\boldsymbol{k}_{i,i} \times \boldsymbol{k}_{j,j}}</code>
is identified as a duplicate (default = <code>0.95</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean.diagonal</code></td>
<td>
<p>If <code>TRUE</code> returns a kinship matrix filtered by values smaller than
<code>diagonal.thr.large</code> and larger than <code>diagonal.thr.small</code> (default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean.duplicate</code></td>
<td>
<p>If <code>TRUE</code> return a kinship matrix without the flagged duplicate individuals.
All individuals involved are removed (default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plots</code></td>
<td>
<p>If <code>TRUE</code> generates graphical output of the diagonal and off-diagonal
values of the kinship matrix (default = <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.plot</code></td>
<td>
<p>A numeric value between 0 and 1 indicating the proportion
of the data points to be sampled for fast plotting of off-diagonal values.
Note that for proportions other than 1, the method is not exact and low
proportions are only recommended for large kinship matrices (default = <code>1</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>If <code>TRUE</code> diagnostic messages are printed on screen (default = <code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li>
<p><code>list.diagonal</code>: a data frame with the list of flagged large or small diagonal values.
</p>
</li>
<li>
<p><code>list.duplicate</code>: a data frame with the list of possible duplicates.
</p>
</li>
<li>
<p><code>clean.kinship</code>: output of kinship matrix filtered without the flagged diagonal
and/or duplicate individuals.
</p>
</li>
<li>
<p><code>plot.diagonal</code>: histogram with the distribution of diagonal values from the kinship matrix.
</p>
</li>
<li>
<p><code>plot.offdiag</code>: histogram with the distribution of off-diagonal values from kinship matrix.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Get G matrix.
G &lt;- G.matrix(M = geno.apple, method = "VanRaden")$G

# Diagnose G.
G_summary &lt;- kinship.diagnostics(
 K = G,
 diagonal.thr.large = 1.3, diagonal.thr.small = 0.7, clean.diagonal = TRUE,
 duplicate.thr = 0.8, clean.duplicate = TRUE,
 sample.plot = 0.50)
ls(G_summary)
dim(G_summary$clean.kinship)
G_summary$clean.kinship[1:5, 1:5]
G_summary$list.duplicate
G_summary$list.diagonal
G_summary$plot.diag
G_summary$plot.offdiag

</code></pre>


</div>