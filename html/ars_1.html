<div class="container">

<table style="width: 100%;"><tr>
<td>ars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive Rejection Sampling</h2>

<h3>Description</h3>

<p>Adaptive Rejection Sampling from log-concave density functions
</p>


<h3>Usage</h3>

<pre><code class="language-R">ars(n=1,f,fprima,x=c(-4,1,4),ns=100,m=3,emax=64,lb=FALSE,ub=FALSE,xlb=0,xub=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function that computes log(f(u,...)), for given u, where f(u) is proportional to the density we want to sample from</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fprima</code></td>
<td>
<p>d/du log(f(u,...))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>some starting points in wich log(f(u,...) is defined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns</code></td>
<td>
<p>maximum number of points defining the hulls</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>number of starting points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>emax</code></td>
<td>
<p>large value for which it is possible to compute an exponential</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>
<p>boolean indicating if there is a lower bound to the domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlb</code></td>
<td>
<p>value of the lower bound </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>
<p>boolean indicating if there is a upper bound to the domain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xub</code></td>
<td>
<p>value of the upper bound bound </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to f and fprima</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>ifault codes, subroutine initial</b>
</p>

<dl>
<dt>0:</dt>
<dd>
<p>successful initialisation</p>
</dd>
<dt>1:</dt>
<dd>
<p>not enough starting points</p>
</dd>
<dt>2:</dt>
<dd>
<p>ns is less than m</p>
</dd>
<dt>3:</dt>
<dd>
<p>no abscissae to left of mode (if lb = false)</p>
</dd>
<dt>4:</dt>
<dd>
<p>no abscissae to right of mode (if ub = false)</p>
</dd>
<dt>5:</dt>
<dd>
<p>non-log-concavity detect</p>
</dd>
</dl>
<p><b>ifault codes, subroutine sample</b>
</p>

<dl>
<dt>0:</dt>
<dd>
<p>successful sampling</p>
</dd>
<dt>5:</dt>
<dd>
<p>non-concavity detected</p>
</dd>
<dt>6:</dt>
<dd>
<p>random number generator generated zero</p>
</dd>
<dt>7:</dt>
<dd>
<p>numerical instability</p>
</dd>
</dl>
<h3>Value</h3>

<p>a sampled value from density 
</p>


<h3>Author(s)</h3>

<p>Paulino Perez Rodriguez, original C++ code from Arnost Komarek based on ars.f written by P. Wild and W. R. Gilks
</p>


<h3>References</h3>

<p>Gilks, W.R., P. Wild. (1992)
Adaptive Rejection Sampling  for Gibbs Sampling, <em>Applied Statistics</em>
<b>41</b>:337â€“348.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(ars)

#Example 1: sample 20 values from the normal distribution N(2,3)
f&lt;-function(x,mu=0,sigma=1){-1/(2*sigma^2)*(x-mu)^2}
fprima&lt;-function(x,mu=0,sigma=1){-1/sigma^2*(x-mu)}
mysample&lt;-ars(20,f,fprima,mu=2,sigma=3)
mysample
hist(mysample)

#Example 2: sample 20 values from a gamma(2,0.5)
f1&lt;-function(x,shape,scale=1){(shape-1)*log(x)-x/scale}
f1prima&lt;-function(x,shape,scale=1) {(shape-1)/x-1/scale}
mysample1&lt;-ars(20,f1,f1prima,x=4.5,m=1,lb=TRUE,xlb=0,shape=2,scale=0.5)
mysample1
hist(mysample1)

#Example 3: sample 20 values from a beta(1.3,2.7) distribution
f2&lt;-function(x,a,b){(a-1)*log(x)+(b-1)*log(1-x)}
f2prima&lt;-function(x,a,b){(a-1)/x-(b-1)/(1-x)}
mysample2&lt;-ars(20,f2,f2prima,x=c(0.3,0.6),m=2,lb=TRUE,xlb=0,ub=TRUE,xub=1,a=1.3,b=2.7)
mysample2
hist(mysample2)
</code></pre>


</div>