<div class="container">

<table style="width: 100%;"><tr>
<td>weightedCor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted correlation test of WA reconstruction
</h2>

<h3>Description</h3>

<p>Weighted correlation between WA optima from training set and axis 1
scores of constrained ordination fitted to fossil data with WA model
predictions for fossil samples as constraints.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
weightedCor(x, env, fossil, method = c("rda", "cca"),
            test = TRUE, type = c("simulate", "permute"), sim = 999,
            verbose = TRUE, ...)

## S3 method for class 'weightedCor'
plot(x,
     type = c("bubble", "null"),
     weighted = TRUE,
     size = 0.25,
     xlab = paste(x$env, "WA Optima"),
     ylab = "Axis 1 Score",
     xlim,
     main = "",
     sub = NULL,
     border = "gray75",
     col = "gray75",
     obscol = "red",
     fg = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>training set covariates, a matrix-like object usually of
species/proxy data. For the <code>plot</code> method, an object of class
<code>"weightedCor"</code>, the result of a call to <code>weightedCor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>training set response, a vector usually of environmental
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fossil</code></td>
<td>
<p>matrix of fossil/core species/proxy data for which a
reconstruction is sought.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>constrained ordination method. One of <code>"rda"</code> and
<code>"cca"</code>. Currently only <code>"rda"</code> is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>logical; should the observed correlation be tested?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of test to apply. One of <code>"simulate"</code> or
<code>"permute"</code>. The latter is currently not implemented. For the
<code>plot</code> method, the type of plot to produce.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>numeric; number of simulations or permutations to permform
as part of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; should the progress of the test be shown via a
progress bar?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to other methods. In the case of the
<code>plot</code> method, additional graphical parameters can be
supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical; should the null distribution plotted be of
the weighted or normal correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>numeric; the size of the largest bubble in inches. See
<code>symbols</code> and argument <code>inches</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim,xlab,ylab,main,sub</code></td>
<td>
<p>graphical parameters with their
usual meaning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border, col</code></td>
<td>
<p>The border and fill colours for the histogram
bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fg</code></td>
<td>
<p>The colour of the bubbles drawn on the bubble plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obscol</code></td>
<td>
<p>The colour of the indicator for the observed
correlation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>plot</code> method produces a plot on the current
device. <code>weightedCor()</code> returns a list with the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>wtdCorrel,Correl</code></td>
<td>
<p>numeric; the observed weighted and standard
correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame; containing the training set WA Optima, axis 1
species scores, and mean abundance for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>the fitted constrained ordination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the fitted WA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the ordination method used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndist</code></td>
<td>
<p>the null distribution produced. <code>NULL</code> if argument
<code>test</code> was <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>numeric; the number of simulations or permutations used to
test the observed correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of test performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>the deparsed version of <code>env</code> argument. Used for
plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>References</h3>

<p>Telford R.J. and Birks, H.J.B. (2011) A novel method for assessing the
statistical significance of quantitative reconstructions inferred from
biotic assemblages. <em>Quanternary Science Reviews</em>
<strong>30</strong>:1272-1278.
</p>


<h3>See Also</h3>

<p><code>wa</code> for details on fitting weighted average models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ImbrieKipp, SumSST, V12.122)

Cor &lt;- weightedCor(ImbrieKipp, env = SumSST,
                   fossil = V12.122, type = "simulate", sim = 49)
Cor

plot(Cor)
plot(Cor, type = "null")
</code></pre>


</div>