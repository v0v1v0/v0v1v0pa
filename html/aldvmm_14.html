<div class="container">

<table style="width: 100%;"><tr>
<td>aldvmm.sefit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating Standard Errors of Fitted and Predicted Outcomes</h2>

<h3>Description</h3>

<p><code>aldvmm.sefit</code>
calculates standard errors of fitted and predicted outcomes using the delta
method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aldvmm.sefit(
  par,
  yhat,
  X,
  type,
  psi,
  cv,
  mse = NA,
  ncmp,
  dist,
  level,
  lcoef,
  lcmp,
  lcpar
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>a named numeric vector of parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>a numeric vector of predicted outcomes returned by
<code>aldvmm.pred</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a list of design matrices returned by
<code>aldvmm.mm</code>.
<code>'X'</code> is of length 2 and includes a design matrix for the model of
component distributions and a design matrix for the model of probabilities
of group membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character value of either 'fit' or 'pred' indicating whether
the standard error of the fit ('fit') or the standard error of predictions
in new data ('pred') are calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>a numeric vector of minimum and maximum possible utility values
smaller than or equal to 1 (e.g. <code>c(-0.594, 0.883)</code>). The potential
gap between the maximum value and 1 represents an area with zero density
in the value set from which utilities were obtained. The order of the
minimum and maximum limits in <code>'psi'</code> does not matter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv</code></td>
<td>
<p>a numeric matrix with covariances/variances of parameter estimates
returned by
<code>aldvmm.cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>a numeric value of the mean squared error of observed versus
predicted outcomes <code class="reqn">\sum{(y - \hat{y})^2}/(n_{obs} - n_{par})</code> for all observations in model matrices
<code>'X'</code> supplied to
<code>aldvmm.ll</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncmp</code></td>
<td>
<p>a numeric value of the number of components that are mixed. The
default value is 2. A value of 1 represents a tobit model with a gap
between 1 and the maximum value in <code>'psi'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>an optional character value of the distribution used in the
components. In this release, only the normal distribution is
available, and the default value is set to <code>"normal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a numeric value of the significance level for confidence bands
of fitted values. The default value is 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcoef</code></td>
<td>
<p>a character vector of length 2 with labels of objects including
regression coefficients of component distributions (default <code>"beta"</code>)
and coefficients of probabilities of component membership (default
<code>"delta"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcmp</code></td>
<td>
<p>a character value representing a stub (default <code>"Comp"</code>)
for labeling objects including regression coefficients in different
components (e.g. "Comp1", "Comp2", ...). This label is also used in
summary tables returned by
<code>summary.aldvmm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcpar</code></td>
<td>
<p>a character vector with the labels of objects including
constant parameters of component distributions (e.g. the standard
deviation of the normal distribution). The length of <code>'lcpar'</code>
depends on the distribution supplied to <code>'dist'</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>aldvmm.sefit</code>
calculates standard errors of fitted values using the delta method. Standard
errors of fitted values in the estimation data set are calculated as
<code class="reqn">se_{fit} = \sqrt{G^{t} \Sigma G}</code>,
where <code class="reqn">G</code> is the gradient of a fitted value with respect to changes of
parameter estimates, and <code class="reqn">\Sigma</code> is the estimated covariance matrix of
parameters (Dowd et al., 2014).  Standard errors of predicted values in new
data sets are calculated as <code class="reqn">se_{pred} = \sqrt{MSE + G^{t} \Sigma
G}</code>, where <code class="reqn">MSE</code> is the
mean squared error of fitted versus observed outcomes in the original
estimation data (Whitmore, 1986).  The gradients of fitted values with
respect to parameter estimates are approximated numerically using
<code>jacobian</code>.
</p>


<h3>Value</h3>

<p>a named numeric vector of standard errors of fitted or predicted
outcomes. The names of the elements in the vector are identical to the row
names of design matrices in <code>'X'</code>
</p>


<h3>References</h3>

<p>Whitmore, G. A. (1986). Prediction limits for a univariate
normal observation. The American Statistician, 40(2), 141-143.
https://doi.org/10.1080/00031305.1986.10475378 <br></p>
<p>Dowd, B. E., Greene, W. H., and Norton, E. C. (2014) Computation of
standard errors. <em>Health services research</em>, <b>49(2)</b>, 731â€“750.
<a href="https://doi.org/10.1111/1475-6773.12122">doi:10.1111/1475-6773.12122</a>
</p>


</div>