<div class="container">

<table style="width: 100%;"><tr>
<td>estimateAbundance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates the complete clonal relative abundance distribution</h2>

<h3>Description</h3>

<p><code>estimateAbundance</code> estimates the complete clonal relative abundance distribution 
and confidence intervals on clone sizes using bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimateAbundance(
  data,
  clone = "clone_id",
  copy = NULL,
  group = NULL,
  min_n = 30,
  max_n = NULL,
  uniform = TRUE,
  ci = 0.95,
  nboot = 200,
  progress = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data.frame with Change-O style columns containing clonal assignments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clone</code></td>
<td>
<p>name of the <code>data</code> column containing clone identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copy</code></td>
<td>
<p>name of the <code>data</code> column containing copy numbers for each 
sequence. If <code>copy=NULL</code> (the default), then clone abundance
is determined by the number of sequences. If a <code>copy</code> column
is specified, then clone abundances is determined by the sum of 
copy numbers within each clonal group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>name of the <code>data</code> column containing group identifiers. 
If <code>NULL</code> then no grouping is performed and the <code>group</code> 
column of the output will contain the value <code>NA</code> for each row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n</code></td>
<td>
<p>minimum number of observations to sample.
A group with less observations than the minimum is excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_n</code></td>
<td>
<p>maximum number of observations to sample. If <code>NULL</code> then no 
maximum is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uniform</code></td>
<td>
<p>if <code>TRUE</code> then uniformly resample each group to the same 
number of observations. If <code>FALSE</code> then allow each group to
be resampled to its original size or, if specified, <code>max_size</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>confidence interval to calculate; the value must be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap realizations to generate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>if <code>TRUE</code> show a progress bar.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A AbundanceCurve object summarizing the abundances.
</p>


<h3>References</h3>


<ol>
<li>
<p>  Chao A. Nonparametric Estimation of the Number of Classes in a Population. 
Scand J Stat. 1984 11, 265270.
</p>
</li>
<li>
<p>  Chao A, et al. Rarefaction and extrapolation with Hill numbers: 
A framework for sampling and estimation in species diversity studies. 
Ecol Monogr. 2014 84:45-67.
</p>
</li>
<li>
<p>  Chao A, et al. Unveiling the species-rank abundance distribution by 
generalizing the Good-Turing sample coverage theory. 
Ecology. 2015 96, 11891201.
</p>
</li>
</ol>
<h3>See Also</h3>

<p>See plotAbundanceCurve for plotting of the abundance distribution.
See alphaDiversity for a similar application to clonal diversity.
</p>


<h3>Examples</h3>

<pre><code class="language-R">abund &lt;- estimateAbundance(ExampleDb, group="sample_id", nboot=100)

</code></pre>


</div>