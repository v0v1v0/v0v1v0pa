<div class="container">

<table style="width: 100%;"><tr>
<td>aphylo_cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Leave-one-out Cross Validation</h2>

<h3>Description</h3>

<p>This implements Leave-one-out cross-validation (LOO-CV) for trees of class
aphylo and multiAphylo.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aphylo_cv(...)

## S3 method for class 'formula'
aphylo_cv(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to the method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>As passed to aphylo_mcmc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each observation in the dataset (either a single gene if of
class aphylo, or an entire tree if of class multiAphylo), we restimate
the model removing the observation and use the parameter estimates to make
a prediction on it. The prediction is done using the function predict.aphylo_estimates
with argument <code>loo = TRUE</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>aphylo_cv</code> with the following components:
</p>

<ul>
<li> <p><code>pred_out</code> Out of sample prediction.
</p>
</li>
<li> <p><code>expected</code> Expected annotations
</p>
</li>
<li> <p><code>call</code> The call
</p>
</li>
<li> <p><code>ids</code> Integer vector with the ids of the leafs used in the loo process.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># It takes about two minutes to run this example


  set.seed(123)
  atrees &lt;- rmultiAphylo(10, 10, P = 1)

  cv_multi  &lt;- aphylo_cv(atrees ~ mu_d + mu_s + Pi)
  cv_single &lt;- aphylo_cv(atrees[[1]] ~ mu_d + mu_s + Pi)
  

</code></pre>


</div>