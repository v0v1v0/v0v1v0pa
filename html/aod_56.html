<div class="container">

<table style="width: 100%;"><tr>
<td>varbin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mean, Variance and Confidence Interval of a Proportion</h2>

<h3>Description</h3>

<p>This function computes the mean and variance of a proportion from clustered binomial data <code class="reqn">(n, y)</code>, using various 
methods. Confidence intervals are computed using a normal approximation, which might be inappropriate when the 
proportion is close to 0 or 1.</p>


<h3>Usage</h3>

<pre><code class="language-R">varbin(n, y, data, alpha = 0.05, R = 5000)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The denominator of the proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The numerator of the proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level for the confidence intervals. Default to 0.05, providing 95% CI's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The number of bootstrap replicates to compute the bootstrap mean and variance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Five methods are used for the estimations. Let us
consider <code class="reqn">N</code> clusters of sizes <code class="reqn">n_1, \ldots, n_N</code> with observed responses (counts) <code class="reqn">y_1, \ldots, y_N</code>.
We note <code class="reqn">p_i = y_i / n_i</code> the observed proportions <code class="reqn">(i = 1, \ldots, N)</code>. An underlying assumption is that the
theoretical proportion is homogeneous across the clusters.
</p>
<p><b>Binomial method:</b> the proportion and its variance are estimated as <code class="reqn">p = \frac{\sum_{i} y_i}{\sum_{i} n_i}</code> and <code class="reqn">\frac{p * (1 - p)}{\sum_{i} n_i - 1}</code>, respectively.
</p>
<p><b>Ratio method:</b> the one-stage cluster sampling formula is used to estimate the variance of the ratio estimate
(see Cochran, 1999, p. 32 and p. 66). The proportion is estimated as above (<code class="reqn">p</code>).
</p>
<p><b>Arithmetic method:</b> the proportion is estimated as <code class="reqn">p_A = \frac{1}{N}\sum_{i}\frac{y_i}{n_i}</code>, with estimated variance <code class="reqn">\frac{\sum_{i}(p_i - p_A)^2}{N * (N - 1)}</code>.
</p>
<p><b>Jackknife method:</b> the proportion <code class="reqn">p_J</code> is the arithmetic mean of the pseudovalues <code class="reqn">pv_i</code>, with estimated
variance <code class="reqn">\frac{\sum_{i}(pv_i - p_J)^2}{N * (N - 1)}</code>
(Gladen, 1977, Paul, 1982).
</p>
<p><b>Bootstrap method:</b> <code class="reqn">R</code> samples of size <code class="reqn">N</code> are drawn with equal probability from the initial sample
<code class="reqn">(p_1, \ldots , p_N)</code> (Efron and Tibshirani, 1993). The bootstrap estimate <code class="reqn">p_B</code> and its estimated variance 
are the arithmetic mean and the empirical variance (computed with denominator <code class="reqn">R - 1</code>) of the <code class="reqn">R</code> binomial 
estimates, respectively.
</p>


<h3>Value</h3>

<p>An object of formal class “varbin”, with 5 slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CALL</code></td>
<td>
<p>The call of the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>A 4-column data frame giving for each estimation method the mean, variance, upper and lower limits
of the <code class="reqn">(1 - \alpha)</code> confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>A numeric vector containing the R bootstrap replicates of the proportion. Might be used to compute other
kinds of CI's for the proportion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used to compute the <code class="reqn">(1 - \alpha)</code> confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>features</code></td>
<td>
<p>A numeric vector with 3 components summarizing the main features of the data: <code>N</code> = number 
of clusters, <code>n</code> = number of subjects, <code>y</code> = number of cases.</p>
</td>
</tr>
</table>
<p>The “show” method displays the slot <code>tab</code> described above, substituting the standard error to the variance.
</p>


<h3>Author(s)</h3>

<p>Matthieu Lesnoff <a href="mailto:matthieu.lesnoff@cirad.fr">matthieu.lesnoff@cirad.fr</a>, Renaud Lancelot <a href="mailto:renaud.lancelot@cirad.fr">renaud.lancelot@cirad.fr</a></p>


<h3>References</h3>

<p>Cochran, W.G., 1999, 3th ed. <em>Sampling techniques</em>. Wiley, New York.<br>
Efron, B., Tibshirani, R., 1993. <em>An introduction to the bootstrap</em>. Chapman and Hall, London.<br>
Gladen, B., 1977. <em>The use of the jackknife to estimate proportions from toxicological data in the presence 
of litter effects</em>. JASA 74(366), 278-283.<br>
Paul, S.R., 1982. <em>Analysis of proportions of affected foetuses in teratological experiments</em>. 
Biometrics 38, 361-370.
</p>


<h3>See Also</h3>

 <p><code>varbin-class</code>, <code>boot</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  data(rabbits)
  varbin(n, y, rabbits[rabbits$group == "M", ])
  by(rabbits,
     list(group = rabbits$group),
     function(x) varbin(n = n, y = y, data = x, R = 1000))
  </code></pre>


</div>