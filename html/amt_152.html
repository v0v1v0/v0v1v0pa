<div class="container">

<table style="width: 100%;"><tr>
<td>log_rss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate log-RSS for a fitted model</h2>

<h3>Description</h3>

<p>Calculate log-RSS(x1, x2) for a fitted RSF or (i)SSF
</p>


<h3>Usage</h3>

<pre><code class="language-R">log_rss(object, ...)

## S3 method for class 'glm'
log_rss(object, x1, x2, ci = NA, ci_level = 0.95, n_boot = 1000, ...)

## S3 method for class 'fit_clogit'
log_rss(object, x1, x2, ci = NA, ci_level = 0.95, n_boot = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code style="white-space: pre;">⁠[fit_logit, fit_clogit]⁠</code> <br> A fitted RSF or (i)SSF model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments, none implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1</code></td>
<td>
<p><code style="white-space: pre;">⁠[data.frame]⁠</code> <br> A <code>data.frame</code> representing the habitat values
at location x_1. Must contain all fitted covariates as expected by
<code>predict()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x2</code></td>
<td>
<p><code style="white-space: pre;">⁠[data.frame]⁠</code> <br> A 1-row <code>data.frame</code> representing the single
hypothetical location of x_2. Must contain all fitted covariates as expected
by <code>predict()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p><code style="white-space: pre;">⁠[character]⁠</code> <br> Method for estimating confidence intervals around
log-RSS. <code>NA</code> skips calculating CIs. Character string <code>"se"</code> uses standard error
method and <code>"boot"</code> uses empirical bootstrap method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_level</code></td>
<td>
<p><code style="white-space: pre;">⁠[numeric]⁠</code> <br> Level for confidence interval. Defaults to 0.95
for a 95% confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_boot</code></td>
<td>
<p><code style="white-space: pre;">⁠[integer]⁠</code> <br> Number of bootstrap samples to estimate confidence
intervals. Ignored if <code>ci != "boot"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function assumes that the user would like to compare relative
selection strengths from at least one proposed location (<code>x1</code>) to exactly
one reference location (<code>x2</code>).
</p>
<p>The objects <code>object$model</code>, <code>x1</code>, and <code>x2</code> will be passed to
<code>predict()</code>. Therefore, the columns of <code>x1</code> and <code>x2</code> must match
the terms in the model formula exactly.
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> of class <code>log_rss</code> with four entries:
</p>

<ul>
<li> <p><code>df</code>: A <code>data.frame</code> with the covariates and the <code>log_rss</code>
</p>
</li>
<li> <p><code>x1</code>: A <code>data.frame</code> with covariate values for <code>x1</code>.
</p>
</li>
<li> <p><code>x2</code>: A <code>data.frame</code> with covariate values for <code>x2</code>.
</p>
</li>
<li> <p><code>formula</code>: The formula used to fit the model.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Brian J. Smith
</p>


<h3>References</h3>


<ul>
<li>
<p> Avgar, T., Lele, S.R., Keim, J.L., and Boyce, M.S.. (2017). Relative Selection
Strength: Quantifying effect size in habitat- and step-selection inference.
<em>Ecology and Evolution</em>, 7, 5322–5330.
</p>
</li>
<li>
<p> Fieberg, J., Signer, J., Smith, B., &amp; Avgar, T. (2021). A "How to" guide for interpreting parameters in habitat-selection analyses. <em>Journal of Animal Ecology</em>, 90(5), 1027-1043.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>See Avgar <em>et al.</em> 2017 for details about relative
selection strength.
</p>
<p>Default plotting method available: <code>plot.log_rss()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# RSF -------------------------------------------------------
# Fit an RSF, then calculate log-RSS to visualize results.

# Load packages
library(ggplot2)

# Load data
data("amt_fisher")
amt_fisher_covar &lt;- get_amt_fisher_covars()

# Prepare data for RSF
rsf_data &lt;- amt_fisher |&gt;
  filter(name == "Lupe") |&gt;
  make_track(x_, y_, t_) |&gt;
  random_points() |&gt;
  extract_covariates(amt_fisher_covar$elevation) |&gt;
  extract_covariates(amt_fisher_covar$popden) |&gt;
  extract_covariates(amt_fisher_covar$landuse) |&gt;
  mutate(lu = factor(landuse))

# Fit RSF
m1 &lt;- rsf_data |&gt;
  fit_rsf(case_ ~ lu + elevation + popden)

# Calculate log-RSS
# data.frame of x1s
x1 &lt;- data.frame(lu = factor(50, levels = levels(rsf_data$lu)),
                 elevation = seq(90, 120, length.out = 100),
                 popden = mean(rsf_data$popden))
# data.frame of x2 (note factor levels should be same as model data)
x2 &lt;- data.frame(lu = factor(50, levels = levels(rsf_data$lu)),
                 elevation = mean(rsf_data$elevation),
                 popden = mean(rsf_data$popden))
# Calculate (use se method for confidence interval)
logRSS &lt;- log_rss(object = m1, x1 = x1, x2 = x2, ci = "se")

# Plot
ggplot(logRSS$df, aes(x = elevation_x1, y = log_rss)) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
  geom_ribbon(aes(ymin = lwr, ymax = upr), fill = "gray80") +
  geom_line() +
  xlab(expression("Elevation " * (x[1]))) +
  ylab("log-RSS") +
  ggtitle(expression("log-RSS" * (x[1] * ", " * x[2]))) +
  theme_bw()

# SSF -------------------------------------------------------
# Fit an SSF, then calculate log-RSS to visualize results.

# Load data
data(deer)
sh_forest &lt;- get_sh_forest()

# Prepare data for SSF
ssf_data &lt;- deer |&gt;
  steps_by_burst() |&gt;
  random_steps(n = 15) |&gt;
  extract_covariates(sh_forest) |&gt;
  mutate(forest = factor(forest, levels = 1:0,
                    labels = c("forest", "non-forest")),
  cos_ta = cos(ta_),
  log_sl = log(sl_))

# Fit an SSF (note model = TRUE necessary for predict() to work)
m2 &lt;- ssf_data |&gt;
  fit_clogit(case_ ~ forest + strata(step_id_), model = TRUE)

# Calculate log-RSS
# data.frame of x1s
x1 &lt;- data.frame(forest = factor(c("forest", "non-forest")))
# data.frame of x2
x2 &lt;- data.frame(forest = factor("forest", levels = levels(ssf_data$forest)))
# Calculate
logRSS &lt;- log_rss(object = m2, x1 = x1, x2 = x2, ci = "se")

# Plot
ggplot(logRSS$df, aes(x = forest_x1, y = log_rss)) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
  geom_errorbar(aes(ymin = lwr, ymax = upr), width = 0.25) +
  geom_point(size = 3) +
  xlab(expression("Forest Cover " * (x[1]))) +
  ylab("log-RSS") +
  ggtitle(expression("log-RSS" * (x[1] * ", " * x[2]))) +
  theme_bw()

</code></pre>


</div>