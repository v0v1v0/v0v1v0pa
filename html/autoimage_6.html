<div class="container">

<table style="width: 100%;"><tr>
<td>autopoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic facetting of multiple projected scatterplots</h2>

<h3>Description</h3>

<p><code>autopoints</code> plots a sequence of scatterplots (with possibly 
projected coordinates) while also automatically plotting a 
color scale matching the image colors to the values of <code>z</code>.  
Many options are available for customization. See the Examples 
below or execute <code>vignette("autopoints")</code> to better
understand the possibilities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">autopoints(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  common.legend = TRUE,
  map = "none",
  size,
  lratio,
  outer.title,
  n = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric vector containing the values to be
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A character string indicating where the
color scale should be placed.  The default is
<code>"horizontal"</code>.  The other valid options are
<code>"none"</code> and <code>"vertical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>A character string indicating what projection
should be used for the included <code>x</code> and <code>y</code>
coordinates.  The default is <code>"none"</code>.  The other
valid choices correspond to the <code>"projection"</code>
argument in the <code>mapproject</code>
function, which is used for the projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A numeric vector specifying the values
of the <code>parameters</code> argument in the
<code>mapproject</code>.  This may be
necessary when <code>proj != "none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orientation</code></td>
<td>
<p>A vector
<code>c(latitude,longitude,rotation)</code> which describes
where the "North Pole" should be when computing the
projection.  See <code>mapproject</code> for
more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common.legend</code></td>
<td>
<p>A logical value indicating whether a common 
legend scale should be used for all images provided in the
<code>z</code> array.  Default is <code>TRUE</code>.  If <code>FALSE</code>, a
separate legend is used for each image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>The name of the map to draw on the image.
Default is <code>"none"</code>.  Other options include
<code>"world"</code>, <code>"usa"</code>, <code>"state"</code>,
<code>"county"</code>, <code>"france"</code>, <code>"nz"</code> (New
Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>A vector of length two indicating the number of rows 
and columns that should be used for the series of image data in 
<code>z</code>.  Note that <code>prod(size)</code> must match the length of 
the third dimension of <code>z</code> (if it is an array), or 
<code>c(1, 1)</code> if <code>z</code> is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the
smaller dimension of the legend scale to the width of
the image.  Default is <code>lratio = 0.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer.title</code></td>
<td>
<p>A title related to all of the images that is plotted in the outer margin of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer giving the <em>desired</em> number of
intervals.  Non-integer values are rounded down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the 
<code>plot</code>. e.g., <code>xlab</code>, <code>ylab</code>, 
<code>xlim</code>, <code>ylim</code>, <code>zlim</code>, etc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>n</code> argument specifies the desired number of color
partitions, but may not be exact. This is used to create
"pretty" color scale tick labels using the
<code>pretty</code> function.
If <code>zlim</code> or <code>breaks</code> are provided, then the 
<code>pretty</code> function is not used to determine
the color scale tick lables, and the user may need to
manually specify <code>breaks</code> to get the color scale to
have "pretty" tick labels. If <code>col</code> is specified,
then <code>n</code> is set to <code>length(col)</code>, but the 
functions otherwise works the same (i.e., pretty tick
labels are not automatic if <code>zlim</code> or <code>breaks</code>
are specified.
</p>
<p>The <code>mapproject</code> function is used to project 
the <code>x</code> and <code>y</code> coordinates when <code>proj != "none"</code>.
</p>
<p>If multiple scatterplots are to be plotted (i.e., if 
<code>z</code> is a matrix with more than 1 column), then the
<code>main</code> argument can be a vector with length matching 
<code>ncol(z)</code>, and each successive element of the vector will 
be used to add a title to each successive scatterplot.  
See the Examples.
</p>
<p>Additionally, if <code>common.legend = FALSE</code>, then separate 
z limits and breaks for the z-axis of each image can be provided as a list.  
Specifically, if <code>ncol(z) == k</code>, then <code>zlim</code> should 
be a list of length <code>k</code>, and each element of the list should 
be a 2-dimensional vector providing the lower and upper limit, 
respectively, of the legend for each image. Similarly,
the <code>breaks</code> argument should be a list of length <code>k</code>,
and each element of the list should be a vector specifying
the breaks for the color scale for each plot. Note that
the length of each element of breaks should be 1 greater
then the number of colors in the color scale.
</p>
<p>The range of <code>zlim</code> is cut into <code class="reqn">n</code> partitions, 
where <code>n</code> is the length of <code>col</code>.
</p>
<p>It is generally desirable to increase <code>lratio</code> when
more images are plotted simultaneously.
</p>
<p>The multiple plots are constructed using the 
<code>autolayout</code> function, which 
is incompatible with the <code>mfrow</code> and <code>mfcol</code> arguments 
in the <code>par</code> function and is also 
incompatible with the <code>split.screen</code> function.
</p>
<p>The <code>mtext.args</code> argument can be passed through <code>...</code> 
in order to customize the outer title.  This should be a named
list with components matching the arguments of 
<code>mtext</code>.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code>lines</code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code>points</code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code>text</code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code>axis</code>
function.  See Examples.
</p>
<p>The axes can be modified by passing <code>axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code>axis</code>
function.  The exception to this is that arguments <code>xat</code> 
and <code>yat</code> can be specified (instead of <code>at</code>) to specify
the location of the x and y ticks.  If <code>xat</code> or <code>yat</code>
are specified, then this overrides the <code>xaxt</code> and <code>yaxt</code>
arguments, respectively.  See the <code>paxes</code>
function to see how <code>axis.args can be used.</code>
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code>
to <code>autpoints</code> through <code>...</code>.  This should be a numeric
vector indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples for <code>pimage</code>.  After plotting, 
<code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code>autoimage</code>, <code>heat_ppoints</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(co, package = "gear")
easting = co$easting
northing = co$northing
# heated scatterplot for Aluminum and Cadmium
autopoints(easting, northing, co[,c("Al", "Ca")],
           common.legend = FALSE, map = "state",
           main = c("Al", "Ca"), lratio = 0.2,
           legend.mar = c(0.3, 0.1, 0.1, 0.1))

# more complicated heat scatterplot for Aluminum and
# Cadmium used more advanced options
autopoints(co$lon, co$lat, co[,c("Al", "Ca")],
          common.legend = FALSE, 
          map = "county", main = c("Aluminum", "Cadmium"),
          proj = "bonne", parameters = 40,
          text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                      labels = c("Denver", "Colorado Springs")),
          text.args = list(col = "blue"))
</code></pre>


</div>