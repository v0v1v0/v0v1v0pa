<div class="container">

<table style="width: 100%;"><tr>
<td>search_cuts_media</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create cut lists for 'FFmpeg'</h2>

<h3>Description</h3>

<p>This function creates FFmpeg commands to cut media files for each search results.
If you want to execute the commands (and cut the media files) you need to have FFmpeg installed on you computer. To install FFmpeg you can follow the instructions given in the vignette 'installation-ffmpeg'. Show the vignette with <code>vignette("installation-ffmpeg")</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">search_cuts_media(
  x,
  s,
  cutSpanBeforesec = NULL,
  cutSpanAftersec = NULL,
  outputFolder = NULL,
  filterMediaInclude = "",
  fastVideoPostioning = TRUE,
  videoCodecCopy = FALSE,
  audioCutsAsMP3 = FALSE,
  Panning = NULL,
  filename.append.medianame = FALSE,
  filename.append.separator = "__"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Corpus object; Please note: all media paths for a transcript need to be given as a list in the corpus object in <code>corpus@transcripts[[ ]]@media.path</code> . You can use the respective media functions. .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>Search object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutSpanBeforesec</code></td>
<td>
<p>Double; Start the cut some seconds before the hit to include some context; the default NULL will take the value as set in @cuts.span.beforesec of the search object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutSpanAftersec</code></td>
<td>
<p>Double; End the cut some seconds before the hit to include some context; the default NULL will take the value as set in @cuts.span.beforesec of the search object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputFolder</code></td>
<td>
<p>Character string; path to folder where files will be written.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filterMediaInclude</code></td>
<td>
<p>Character string; regular expression to match only some of the media files in <code>corpus@transcripts[[ ]]@media.path</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fastVideoPostioning</code></td>
<td>
<p>Logical; If <code>TRUE</code> the FFmpeg command will be using the parameter fast video positioning as specified in <code>options()$act.ffmpeg.command.fastVideoPostioning</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>videoCodecCopy</code></td>
<td>
<p>Logical; if <code>TRUE</code> FFMPEG will use the option <em>codec copy</em> for videos.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>audioCutsAsMP3</code></td>
<td>
<p>Logical; If <code>TRUE</code> audio cuts will be exported as '.mp3' files, using  <code>options()$act.ffmpeg.command.audioCutsAsMP3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Panning</code></td>
<td>
<p>Integer; 0=leave audio as is (ch1&amp;ch2) , 1=only channel 1 (ch1), 2=only channel 2 (ch2), 3=both channels separated (ch1&amp;ch2), 4=all three versions (ch1&amp;ch2, ch1, ch2). This setting will override the option made in 'act.ffmpeg.exportchannels.fromColumnName' .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename.append.medianame</code></td>
<td>
<p>Logical; if <code>TRUE</code> the file name of the original media file will be appended to the snippet(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename.append.separator</code></td>
<td>
<p>Character string; characters that separate the result id and the media file name.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>Cut lists</em><br>
The commands are collected in cut lists.
The cut lists will be stored in different ways:
</p>

<ul>
<li>
<p> A cut list for for ALL search results will be stored in <code>s@cuts.cutlist.mac</code> to be used on MacOS and <code>s@cuts.cutlist.win</code> to be used on Windows.
</p>
</li>
<li>
<p> Individual cut lists for EACH search result will be stored in additional columns in the data frame <code>s@results</code>.
The cut lists that can be executed in the Terminal (Apple) or the Command Line Interface (Windows).
</p>
</li>
</ul>
<p><em>Input media files</em><br>
The function will use all files in  <code>corpus@transcripts[[ ]]@media.path</code>.
Therefore you will need to set the options <code>filterMediaInclude</code> filtering for which input media files you want to create the cuts.
The filter is a regular expression, e.g.  <code>'\.(wav|aif)'</code> for '.wav' and '.aif' audio files or <code>'\.mp4'</code> for '.mp4' video files.
</p>
<p><em>Output format</em><br>
The output format is predefined by in the options:
</p>

<ul>
<li> <p><code>act.ffmpeg.command</code> defines the basic FFmpeg command
</p>
</li>
<li> <p><code>act.ffmpeg.command.fastVideoPostioning</code> defines the FFmpeg command to be used with large video files.
</p>
</li>
</ul>
<p>The default is to generate mp4 video cuts. You can also use the following commands to change the output format:<br><br>
MP4 video cuts with original video quality:
</p>

<ul>
<li> <p><code>options(act.ffmpeg.command                     = 'ffmpeg -i "INFILEPATH" -ss TIMESTART -t TIMEDURATION OPTIONS -y "OUTFILEPATH.mp4" -hide_banner')</code>
</p>
</li>
<li> <p><code>options(act.ffmpeg.command.fastVideoPostioning = 'ffmpeg -ss TIMESTARTMINUS10SECONDS -i "INFILEPATH" -ss 10.000 -t TIMEDURATION OPTIONS -y "OUTFILEPATH.mp4" -hide_banner')</code>
</p>
</li>
</ul>
<p>MP4 video cuts with reduced video quality:
</p>

<ul>
<li> <p><code>options(act.ffmpeg.command                     = 'ffmpeg -i "INFILEPATH" -ss TIMESTART -t TIMEDURATION OPTIONS -vf scale=1920:-1 -b:v 1M -b:a 192k -y "OUTFILEPATH.mp4" -hide_banner')</code>
</p>
</li>
<li> <p><code>options(act.ffmpeg.command.fastVideoPostioning = 'ffmpeg -ss TIMESTARTMINUS10SECONDS -i "INFILEPATH" -ss 10.000 -t TIMEDURATION OPTIONS -vf scale=1920:-1 -b:v 6M -b:a 192k -y "OUTFILEPATH.mp4" -hide_banner')</code>
</p>
</li>
</ul>
<p>WAV audio cuts:
</p>

<ul>
<li> <p><code>options(act.ffmpeg.command                     = 'ffmpeg -i "INFILEPATH" -ss TIMESTART -t TIMEDURATION OPTIONS -y "OUTFILEPATH.wav" -hide_banner')</code>
</p>
</li>
<li> <p><code>options(act.ffmpeg.command                     = 'ffmpeg -i "INFILEPATH" -ss TIMESTART -t TIMEDURATION OPTIONS -y "OUTFILEPATH.mp3" -hide_banner')</code>
</p>
</li>
</ul>
<p><em>Advanced options</em><br>
You can adjust the FFmpeg commands according to your needs.
The following options define the FFmpeg command that will be used by the package. The command needs to contain place holders which will be replaced by the actual values in the package. If you want to define your own ffmpeg command, please make sure to use the following placeholders:
</p>

<ul>
<li> <p><code>INFILEPATH</code> path to the input media file.
</p>
</li>
<li> <p><code>OUTFILEPATH</code> path where the output media file will be saved
</p>
</li>
<li> <p><code>OPTIONS</code> FFmpeg options that will be applied additionally, in particular fast video positioning.
</p>
</li>
<li> <p><code>TIMESTART</code> time in seconds where to begin the cutting
</p>
</li>
<li> <p><code>TIMESTARTMINUS10SECONDS</code> time in seconds where to begin the cutting, in case that fast video positioning is being used.
</p>
</li>
<li> <p><code>TIMEDURATION</code> duration of cuts.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Search object; cut lists will be stored in <code>s@cuts.cutlist.mac</code> and <code>s@cuts.cutlist.win</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(act)

# IMPORTANT: In the example corpus all transcripts are assigned media links.
# The actual media files are, however, not included in when installing the package 
# due to size limitations of CRAN.
# But you may download the media files separately.
# Please see the section 'examplecorpus' for instructions. 
# --&gt; You will need the media files to execute the following example code.

## Not run: 
	# Search
	mysearch &lt;- act::search_new(examplecorpus, pattern="yo")
	
	# Create cut lists 
	mysearch &lt;- act::search_cuts_media (x=examplecorpus, s=mysearch)
	
	# Check results for Mac:
	# Get entire cut list for Mac and display on screen, 
	# so you can copy&amp;paste this into the Terminal
	mycutlist &lt;- mysearch@cuts.cutlist.mac 
	cat(mycutlist)
	# Cut list for first search result
	mycutlist &lt;- mysearch@results$cuts.cutlist.mac[[1]]
	cat(mycutlist)
	
	# Check results for Windows:
	# Get entire cut list for Mac and display on screen, 
	# so you can copy&amp;paste this into the CLI
	mycutlist &lt;- mysearch@cuts.cutlist.win 
	cat(mycutlist)
	# Cut list for first search result
	mycutlist &lt;- mysearch@results$cuts.cutlist.win[[1]]
	cat(mycutlist)
	
	# It is, however, more convenient to specify the argument 'outputFolder' in order to get
	# the cut list as a (executable) file/batch list.

## End(Not run)
</code></pre>


</div>