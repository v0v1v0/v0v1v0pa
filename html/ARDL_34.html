<div class="container">

<table style="width: 100%;"><tr>
<td>uecm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Unrestricted ECM regression</h2>

<h3>Description</h3>

<p><code>uecm</code> is a generic function used to construct Unrestricted Error
Correction Models (UECM). The function invokes two different
<code>methods</code>. The default method works exactly like
<code>ardl</code>. The other method requires an object of
<code>class</code> 'ardl'. Both methods create the conditional UECM,
which is the UECM of the underlying ARDL.
</p>


<h3>Usage</h3>

<pre><code class="language-R">uecm(...)

## S3 method for class 'ardl'
uecm(object, ...)

## Default S3 method:
uecm(formula, data, order, start = NULL, end = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the low level regression
fitting functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of <code>class</code> 'ardl'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A "formula" describing the linear model. Details for model
specification are given under 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A time series object (e.g., "ts", "zoo" or "zooreg") or a data
frame containing the variables in the model. In the case of a data frame,
it is coerced into a <code>ts</code> object with <code>start = 1</code>,
<code>end = nrow(data)</code> and <code>frequency = 1</code>. If not found in data, the
variables are NOT taken from any environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>A specification of the order of the underlying ARDL model (e.g.,
for the UECM of an ARDL(1,0,2) model it should be <code>order = c(1,0,2)</code>).
A numeric vector of the same length as the total number of variables
(excluding the fixed ones, see 'Details'). It should only contain positive
integers or 0. An integer could be provided if all variables are of the
same order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Start of the time period which should be used for fitting the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>End of the time period which should be used for fitting the model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>formula</code> should contain only variables that exist in the data
provided through <code>data</code> plus some additional functions supported by
<code>dynlm</code> (i.e., <code>trend()</code>).
</p>
<p>You can also specify fixed variables that are not supposed to be lagged (e.g.
dummies etc.) simply by placing them after <code>|</code>. For example, <code>y ~
x1 + x2 | z1 + z2</code> where <code>z1</code> and <code>z2</code> are the fixed variables and
should not be considered in <code>order</code>. Note that the <code>|</code> notion
should not be confused with the same notion in <code>dynlm</code> where it
introduces instrumental variables.
</p>


<h3>Value</h3>

<p><code>uecm</code> returns an object of <code>class</code>
<code>c("dynlm", "lm", "uecm")</code>. In addition, attributes 'order', 'data',
'parsed_formula' and 'full_formula' are provided.
</p>


<h3>Mathematical Formula</h3>

<p>The formula of an Unrestricted ECM conditional
to an <code class="reqn">ARDL(p,q_{1},\dots,q_{k})</code> is: </p>
<p style="text-align: center;"><code class="reqn">\Delta
  y_{t} = c_{0} + c_{1}t + \pi_{y}y_{t-1} + \sum_{j=1}^{k}\pi_{j}x_{j,t-1} +
  \sum_{i=1}^{p-1}\psi_{y,i}\Delta y_{t-i} +
  \sum_{j=1}^{k}\sum_{l=1}^{q_{j}-1} \psi_{j,l}\Delta x_{j,t-l} +
  \sum_{j=1}^{k}\omega_{j}\Delta x_{j,t} + \epsilon_{t}</code>
</p>

<p style="text-align: center;"><code class="reqn">\psi_{j,l} = 0 \;\; \forall \;\; q_{j} \leq 1, \;\;\;\;\; \psi_{y,i}
  = 0 \;\; if \;\; p = 1</code>
</p>

<p>In addition, <code class="reqn">x_{j,t-1}</code> and <code class="reqn">\Delta x_{j,t}</code> cancel out
becoming <code class="reqn">x_{j,t} \;\; \forall \;\; q_{j} = 0</code>
</p>


<h3>Author(s)</h3>

<p>Kleanthis Natsiopoulos, <a href="mailto:klnatsio@gmail.com">klnatsio@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>ardl</code> <code>recm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(denmark)

## Estimate the UECM, conditional to it's underlying ARDL(3,1,3,2) -----

# Indirectly
ardl_3132 &lt;- ardl(LRM ~ LRY + IBO + IDE, data = denmark, order = c(3,1,3,2))
uecm_3132 &lt;- uecm(ardl_3132)

# Directly
uecm_3132_ &lt;- uecm(LRM ~ LRY + IBO + IDE, data = denmark, order = c(3,1,3,2))
identical(uecm_3132, uecm_3132_)
summary(uecm_3132)

## Post-estimation testing ---------------------------------------------

library(lmtest) # for bgtest(), bptest(), and resettest()
library(tseries) # for jarque.bera.test()
library(strucchange) # for efp(), and sctest()

# Breusch-Godfrey test for higher-order serial correlation
bgtest(uecm_3132, order = 4)

# Breusch-Pagan test against heteroskedasticity
bptest(uecm_3132)

# Ramsey's RESET test for functional form
## Not run: 
    # This produces an error.
    # resettest() cannot use data of class 'zoo' such as the 'denmark' data
    # used to build the original model
    resettest(uecm_3132, type = c("regressor"))

## End(Not run)

uecm_3132_lm &lt;- to_lm(uecm_3132, data_class = "ts")
resettest(uecm_3132_lm, power = 2)

# Jarque-Bera test for normality
jarque.bera.test(residuals(uecm_3132))

# CUSUM test for structural change detection
## Not run: 
    # This produces an error.
    # efp() does not understand special functions such as "d()" and "L()"
    efp(uecm_3132$full_formula, data = uecm_3132$model)

## End(Not run)

uecm_3132_lm_names &lt;- to_lm(uecm_3132, fix_names = TRUE)
fluctuation &lt;- efp(uecm_3132_lm_names$full_formula,
                   data = uecm_3132_lm_names$model)
sctest(fluctuation)
plot(fluctuation)

</code></pre>


</div>