<div class="container">

<table style="width: 100%;"><tr>
<td>AdMitIS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Importance Sampling using an Adaptive Mixture of Student-t
Distributions as the Importance Density</h2>

<h3>Description</h3>

<p>Performs importance sampling using an adaptive
mixture of Student-t distributions as the importance density
</p>


<h3>Usage</h3>

<pre><code class="language-R">
AdMitIS(N = 1e5, KERNEL, G = function(theta){theta}, mit = list(), ...)
</code></pre>


<h3>Arguments</h3>


<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of draws used in importance sampling (positive
integer number). Default: <code>N = 1e5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>KERNEL</code></td>
<td>
<p>kernel function of the target density on which the
adaptive mixture of Student-t distributions is fitted. This
function should be vectorized for speed purposes (i.e., its first
argument should be a matrix and its output a vector). Moreover, the function must contain
the logical argument <code>log</code>. If <code>log = TRUE</code>, the function
returns (natural) logarithm values of the kernel function. <code>NA</code>
and <code>NaN</code> values are not allowed. (See the function
<code>AdMit</code> for examples of <code>KERNEL</code> implementation.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>function of interest used in importance
sampling (see *Details*).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mit</code></td>
<td>
<p>list containing information on the mixture approximation (see *Details*).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>KERNEL</code> and/or <code>G</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<p>The <code>AdMitIS</code> function estimates
<code class="reqn">E_p[g(\theta)]</code>, where <code class="reqn">p</code> is the target
density, <code class="reqn">g</code> is an (integrable w.r.t. <code class="reqn">p</code>) function and <code class="reqn">E</code> denotes
the expectation operator, by importance sampling using an adaptive
mixture of Student-t distributions as the importance density.
</p>
<p>By default, the function <code>G</code> is given by:
</p>
<pre>
    G &lt;- function(theta)
    {
      theta
    } 
  </pre>
<p>and therefore, <code>AdMitIS</code> estimates the mean of
<code>theta</code> by importance sampling. For other definitions of
<code>G</code>, see *Examples*.
</p>
<p>The argument <code>mit</code> is a list containing information on the
mixture approximation. The following components must be provided:
</p>

<dl>
<dt><code>p</code></dt>
<dd>
<p>vector (of length <code class="reqn">H</code>) of mixing probabilities.</p>
</dd>
<dt><code>mu</code></dt>
<dd>
<p>matrix (of size <code class="reqn">H \times d</code>) containing
the vectors of modes (in row) of the mixture components.</p>
</dd>
<dt><code>Sigma</code></dt>
<dd>
<p>matrix (of size <code class="reqn">H \times d^2</code>)
containing the scale matrices (in row) of the mixture components.</p>
</dd>
<dt><code>df</code></dt>
<dd>
<p>degrees of freedom parameter of the Student-t
components (real number not smaller than one).</p>
</dd>
</dl>
<p>where <code class="reqn">H (\geq 1)</code> is the number of components of the
adaptive mixture of Student-t distributions and
<code class="reqn">d (\geq 1)</code> is the dimension of the first argument in <code>KERNEL</code>. Typically,
<code>mit</code> is estimated by the function <code>AdMit</code>.
</p>


<h3>Value</h3>


<p>A list with the following components:<br></p>
<p><code>ghat</code>: a vector containing the importance sampling estimates.
<code>NSE</code>: a vector containing the numerical standard error of the components of <code>ghat</code>.
<code>RNE</code>: a vector containing the relative numerical efficiency of the
components of <code>ghat</code>.
</p>


<h3>Note</h3>


<p>Further details and examples of the <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> package <code>AdMit</code>
can be found in Ardia, Hoogerheide, van Dijk (2009a,b). See also
the package vignette by typing <code>vignette("AdMit")</code>.
</p>
<p>Further information on importance sampling can be found
in Geweke (1989) or Koop (2003).
</p>
<p>Please cite the package in publications. Use <code>citation("AdMit")</code>.
</p>


<h3>Author(s)</h3>

<p>David Ardia</p>


<h3>References</h3>


<p>Ardia, D., Hoogerheide, L.F., van Dijk, H.K. (2009a).
AdMit: Adaptive Mixture of Student-t Distributions.
<em>R Journal</em> <b>1</b>(1), pp.25-30.
doi: <a href="https://doi.org/10.32614/RJ-2009-003">10.32614/RJ-2009-003</a>
</p>
<p>Ardia, D., Hoogerheide, L.F., van Dijk, H.K. (2009b).
Adaptive Mixture of Student-t Distributions as a Flexible Candidate
Distribution for Efficient Simulation: The R Package AdMit.
<em>Journal of Statistical Software</em> <b>29</b>(3), pp.1-32.
doi: <a href="https://doi.org/10.18637/jss.v029.i03">10.18637/jss.v029.i03</a>
</p>
<p>Geweke, J.F. (1989).
Bayesian Inference in Econometric Models Using Monte Carlo Integration.
<em>Econometrica</em> <b>57</b>(6), pp.1317-1339. 
</p>
<p>Koop, G. (2003). 
<em>Bayesian Econometrics</em>. 
Wiley-Interscience (London, UK). ISBN: 0470845678.
</p>


<h3>See Also</h3>


<p><code>AdMit</code> for fitting an adaptive mixture of Student-t
distributions to a target density through its <code>KERNEL</code> function,
<code>AdMitMH</code> for the independence chain Metropolis-Hastings
algorithm using an adaptive mixture of Student-t distributions
as the candidate density.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## NB : Low number of draws for speedup. Consider using more draws!
  ## Gelman and Meng (1991) kernel function
  GelmanMeng &lt;- function(x, A = 1, B = 0, C1 = 3, C2 = 3, log = TRUE)
  {
    if (is.vector(x))
      x &lt;- matrix(x, nrow = 1)
    r &lt;- -.5 * (A * x[,1]^2 * x[,2]^2 + x[,1]^2 + x[,2]^2
              - 2 * B * x[,1] * x[,2] - 2 * C1 * x[,1] - 2 * C2 * x[,2])
    if (!log)
      r &lt;- exp(r)
    as.vector(r)
  }

  ## Run the AdMit function to fit the mixture approximation
  set.seed(1234)
  outAdMit &lt;- AdMit(KERNEL = GelmanMeng, 
                    mu0 = c(0.0, 0.1), control = list(Ns = 1e4))

  ## Use importance sampling with the mixture approximation as the
  ## importance density
  outAdMitIS &lt;- AdMitIS(N = 1e4, KERNEL = GelmanMeng, mit = outAdMit$mit)
  print(outAdMitIS)
</code></pre>


</div>