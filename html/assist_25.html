<div class="container">

<table style="width: 100%;"><tr>
<td>intervals.nnr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Predictions and Approximate Posterior Standard Deviations for Spline Estimates From a nnr Object
</h2>

<h3>Description</h3>

<p>Approximate posterior standard deviations are calculated for the spline estimate of
nonparametric functions from a <code>nnr</code> object, based on which approximate Bayesian
confidence intervals may be constructed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'nnr'
intervals(object,level=0.95, newdata=NULL, terms, pstd=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>an object inheriting from class <code>nnr</code>, representing a 
nonlinear nonparametric regression model fit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>

<p>a data frame on which the fitted spline estimates are to be evaluated. 
Only those predictors, referred in <code>func</code> of <code>nnr</code> fitting, have to
be present. The variable names of the data frame should correspond 
to the function(s)' arguments appearing in the opion func=  of nnr.
Default is NULL, where predictions are made at the same values 
used to fit the object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms </code></td>
<td>

<p>an optional named list of vectors or matrices containing 0's and 1's  collecting one or several combinations 
of the components of spline estimates in the fitted snr object. The length and names of the list shall match those of 
the unknown functions appearing in the 'snr' fit object. For the case of a single function, a vector of 0's 
and 1's can also be accepted. A value "1" at a particular position means that the component at 
that position is collected. Default is a vector of 1's, representing the overall fits of all unknown functions.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstd</code></td>
<td>

<p>an optional logic value.
If TRUE (the default), the posterior standard deviations are calculated. 
Orelse, only the predictions are calculated.
Computation required for posterior standard deviations could be intensive. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>a numeric value set as 0.95.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments, currently unused.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The standard deviation returned is based on approximate Bayesian confidence 
intervals as formulated in Ke and Wang (2002). 
</p>


<h3>Value</h3>

<p>an object of class <code>bCI</code> is returned, which is a list of length 2. 
Its first element is a matrix which contains predictions for 
combinations specified by <code>terms</code>, and second element is a matrix which contains 
corresponding posterior standard deviations. 
</p>


<h3>Author(s)</h3>

<p>Chunlei Ke <a href="mailto:chunlei_ke@yahoo.com">chunlei_ke@yahoo.com</a> and Yuedong Wang <a href="mailto:yuedong@pstat.ucsb.edu">yuedong@pstat.ucsb.edu</a></p>


<h3>References</h3>

<p>Ke, C. and Wang, Y. (2002). Nonlinear Nonparametric Regression Models. Submitted.
</p>


<h3>See Also</h3>

<p><code>nnr</code>, <code>plot.bCI</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## fit a generalized varying coefficient models
data(Arosa)
Arosa$csmonth &lt;- (Arosa$month-0.5)/12
Arosa$csyear &lt;- (Arosa$year-1)/45
ozone.fit &lt;- nnr(thick~f1(csyear)+exp(f2(csyear))*f3(csmonth),
        func=list(f1(x)~list(~I(x-.5),cubic(x)), f2(x)~list(~I(x-.5)-1,cubic(x)),
        f3(x)~list(~sin(2*pi*x)+cos(2*pi*x)-1,lspline(x,type="sine0"))),
        data=Arosa[Arosa$year%%2==1,], spar="m", start=list(f1=mean(thick),f2=0,f3=sin(csmonth)),
	control=list(backfit=1))

x &lt;- seq(0,1,len=50)
u &lt;- seq(0,1,len=50)

## calculate Bayesian confidence limits for all components of all functions
p.ozone.fit &lt;- intervals(ozone.fit, newdata=list(csyear=x,csmonth=u),
                 terms=list(f1=matrix(c(1,1,1,1,1,0,0,0,1),nrow=3,byrow=TRUE),
	                    f2=matrix(c(1,1,1,0,0,1),nrow=3,byrow=TRUE),
                            f3=matrix(c(1,1,1,1,1,0,0,0,1),nrow=3,byrow=TRUE)))	
plot(p.ozone.fit, x.val=x)

## End(Not run)
</code></pre>


</div>