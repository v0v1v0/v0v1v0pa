<div class="container">

<table style="width: 100%;"><tr>
<td>mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Makes a MCMC chain using the Metropolis-Hastings algorithm.</h2>

<h3>Description</h3>

<p>Generates a single Markov Chain Monte Carlo using the Metropolis-Hastings algorithm.</p>


<h3>Usage</h3>

<pre><code class="language-R">mcmc(PDarray, 
						startPars, 
						type, 
						taphonomy=FALSE, 
						taph.min=c(0,-3), 
						taph.max=c(20000,0), 
						N=30000, 
						burn=2000, 
						thin=5, 
						jumps=0.02)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>PDarray</code></td>
<td>

<p>A Probability Density Array of calibrated dates, generated by <code>phaseCalibrator</code> .
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startPars</code></td>
<td>

<p>A vector of parameter values for the algorithm to start at. Suggest using the parameters found from a Maximum Likelihood search. Must have an odd length with values between 0 and 1 for an n-CPL model, or length 1 values between -0.1 and 0.1 for an exponential model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Choose from 'CPL', 'exp', 'norm', 'cauchy', 'sine', 'uniform', 'logistic', 'power'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taphonomy</code></td>
<td>

<p>If TRUE, the last two parameters determine the taphonomic loss rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taph.min</code></td>
<td>

<p>Minimum values for the prior range of taphonomic parameters (b,c).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taph.max</code></td>
<td>

<p>Maximum values for the prior range of taphonomic parameters (b,c). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>The total number of proposals made, before the chain is reduced for burn-in and thinning.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>

<p>The number of proposals made at the beginning of the chain to be disregarded as burn-in.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>Specifies the proportion of proposals to be disregarded (after burn-in), such that the default 5 will only keep every 5th proposal.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumps</code></td>
<td>

<p>Vector that determines the size of the random jump between the last parameters and the proposed parameters. A smaller value gives a smaller jump. Different jump values can be provided for each parameter. This can be tuned by observing how well mixed each parameter is in the chain.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates a single MCMC chain using the Metropolis-Hastings algorithm, printing to screen progress every 1000 proposals. An acceptance ratio of around 0.4 to 0.5 should be sought by adapting the arguments 'burn' and 'jumps'. If the acceptance ratio is too low try reducing jump. A larger dataset will typically require smaller jumps.
</p>


<h3>Value</h3>

<p>Returns a list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>A 2D matrix of free parameter values (between 0 and 1) in the chain, after burn-in and thinning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all.pars</code></td>
<td>
<p>A 2D matrix of free parameter values (between 0 and 1) in the chain of all N proposals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acceptance.ratio</code></td>
<td>
<p>The proportion of proposals (after burn-in) that are accepted.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># randomly sample calendar dates from the toy model
set.seed(12345) 
N &lt;- 350
cal &lt;- simulateCalendarDates(toy, N)

# Convert to 14C dates. 
age &lt;- uncalibrateCalendarDates(cal, shcal20)
data &lt;- data.frame(age = age, sd = 50, phase = 1:N, datingType = '14C')


# Calibrate each phase, taking care to restrict to the modelled date range
CalArray &lt;- makeCalArray(shcal20, calrange = range(toy$year), inc = 5)
PD &lt;- phaseCalibrator(data, CalArray, remove.external = TRUE)

# Run MCMC for a 3-CPL model (5 parameters)
chain &lt;- mcmc(PDarray = PD, 
	startPars = rep(0.5,5), 
	type='CPL', 
	jumps = 0.02)	

# Run MCMC for a 3-CPL model with taphonomy (5 + 2 parameters)
chain &lt;- mcmc(PDarray = PD, 
	startPars = c(rep(0.5,5),10000,-1.5), 
	type='CPL', 
	taphonomy=TRUE, 
	jumps = 0.02)	

</code></pre>


</div>