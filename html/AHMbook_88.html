<div class="container">

<table style="width: 100%;"><tr>
<td>simPPe</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate a spatial point pattern in a heterogeneous landscape
</h2>

<h3>Description</h3>

<p>The function simulates a spatial point pattern in a heterogeneous landscape simulated on a square landscape. The study area ('core') is simulated inside the larger landscape that includes a buffer. The size of the core is defined by the lscape.size minus twice the buffer.
</p>
<p>There is one habitat covariate X that affects the intensity of the points. X is spatially structured with negative-exponential spatial autocorrelation; the parameters of the field can be chosen to create large 'islands' of similar values or no 'islands' at all, in which case the field is spatially unstructured.
</p>
<p>The intensity of STATIC points (e.g. animal activity centers) may be inhomogeneous and affected by the coefficient beta, which is the log-linear effect of X.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>
<p>Previous versions used <span class="pkg">RandomFields</span>, but that is not currently available on CRAN. <span class="pkg">fields</span> is now used, but it cannot deal with large values of <code>lscape.size</code> and <code>theta.X</code>. If you have <span class="pkg">RandomFields</span> installed (perhaps by getting it from the CRAN archive), you can load a version of <code>simPPe</code> that supports it with <code>source(system.file("RandomFieldsSupport", "simPPe.R", package="AHMbook"))</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simPPe(lscape.size = 150, buffer.width = 25, variance.X = 1, theta.X = 10,
  M = 250, beta = 1, quads.along.side = 6, show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lscape.size</code></td>
<td>

<p>size (width = height) of the square landscape, including core and buffer.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer.width</code></td>
<td>

<p>width of buffer around core study area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.X</code></td>
<td>

<p>variance of Gaussian random field (covariate X).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.X</code></td>
<td>

<p>scale parameter of correlation in field (must be &gt;0).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>expected number of activity centers in core area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>coefficient of the habitat covariate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quads.along.side</code></td>
<td>

<p>number of quadrats along the side of the core area; the total number of quadrats will be quads.along.side^2, thus indirectly defining the quadrat area.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plots</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>core </code></td>
<td>
<p>range of x and y coordinates in the 'core'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M2 </code></td>
<td>
<p>number of ACs in the total landscape, including the buffer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid </code></td>
<td>
<p>coordinates of the center of each pixel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixel.size </code></td>
<td>
<p>length of side of each pixel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.core </code></td>
<td>
<p>the width=height of the core area</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop.core </code></td>
<td>
<p>the proportion of the landscape inside the core</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X </code></td>
<td>
<p>matrix of covariate values for each pixel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs </code></td>
<td>
<p>matrix of probabilities of an AC being inside each pixel (sums to 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pixel.id </code></td>
<td>
<p>the ID of the pixel for each AC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u </code></td>
<td>
<p>2-column matrix, coordinate of each AC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsite </code></td>
<td>
<p>number of quadrats</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quad.size </code></td>
<td>
<p>width = height of each quadrat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks </code></td>
<td>
<p>boundaries of the quadrats</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mid.pt </code></td>
<td>
<p>mid-points of the quadrats</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_pp </code></td>
<td>
<p>intensity of point pattern (ACs per unit area)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nac </code></td>
<td>
<p>site-specific abundance of ACs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zac </code></td>
<td>
<p>site-specific occurrence (0/1) of ACs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_N </code></td>
<td>
<p>average realized abundance per quadrat</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E_z </code></td>
<td>
<p>average realized occupancy per quadrat</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 10.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Nice plot (produces the really nice Fig. 10-2 in the book)
# RNGkind(sample.kind = "Rounding") # run this for R &gt;= 3.6.0
set.seed(117, kind="Mersenne-Twister")
# Fails if RandomFields is not available
#try(str(dat &lt;- simPPe(lscape.size = 200, buffer.width = 25, variance.X = 1,
#  theta.X = 70, M = 200, beta = 1, quads.along.side = 6)))

str(dat &lt;- simPPe(lscape.size = 200, buffer.width = 20, variance.X = 1,
  theta.X = 5, M = 250, beta = 1, quads.along.side = 6))
</code></pre>


</div>