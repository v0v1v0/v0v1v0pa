<div class="container">

<table style="width: 100%;"><tr>
<td>ah</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Additive Hazards Regression Models</h2>

<h3>Description</h3>

<p>Fit a semiparametric additive hazard model
'</p>
<p style="text-align: center;"><code class="reqn"> \lambda(t|Z=z) = \lambda_0(t) + \beta'z.</code>
</p>

<p>The estimating procedures follow Lin &amp; Ying (1994).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ah(formula, data, robust, weights, ties, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object for the regression model of the form
response ~ predictors. The outcome is a survival object created by
<code>Surv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame. Input dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>
<p>a logical variable.  Robust standard errors are provided if
robust == TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a numeric vector. The weight of each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ties</code></td>
<td>
<p>a logical variable. FALSE if there are no ties in the censored failure times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the low level regression
fitting functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 'ah' representing the fit.
</p>


<h3>Note</h3>

<p>The response variable is a survival object. If there are ties in the
survival time, in the current version we recommend users to break ties by adding
a small random number to the survival time. An example is provided.  The regression
model can be univariate or multivariate. This package is built upon the function
<code>ahaz</code> by Anders Gorst-Rasmussen.
</p>


<h3>References</h3>

<p>Lin, D.Y. &amp; Ying, Z. (1994). Semiparametric analysis of the additive risk model.
Biometrika; 81:61-71.
</p>


<h3>See Also</h3>

<p><code>predict.ah</code> for prediction based on fitted
<code>ah</code> model, <code>nwtsco</code> for the description of nwtsco dataset
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(survival)
### using the first 100 rows in nwtsco to build an additive hazards model
nwts&lt;- nwtsco[1:100,]

### fit the additive hazards model to the data
### the model-based standard errors are reported when setting robust = FALSE
fit1 &lt;- ah(Surv(trel,relaps) ~ age + instit, ties = FALSE, data = nwts, robust = FALSE)
summary(fit1)

### fit the additive hazards model to the data with robust standard errors
fit2 &lt;- ah(Surv(trel,relaps) ~ age + instit, ties = FALSE, data = nwts, robust = TRUE)
summary(fit2)

### when there are ties, break the ties first
nwts_all &lt;- nwtsco
nwts_all$trel &lt;- nwtsco$trel + runif(dim(nwts_all)[1],0,1)*1e-8
fit3 &lt;- ah(Surv(trel,relaps) ~ age + instit, ties = FALSE, data = nwts_all, robust = TRUE)
summary(fit3)
</code></pre>


</div>