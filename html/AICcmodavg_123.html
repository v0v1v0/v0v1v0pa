<div class="container">

<table style="width: 100%;"><tr>
<td>anovaOD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Likelihood-Ratio Test Corrected for Overdispersion
</h2>

<h3>Description</h3>

<p>Compute likelihood-ratio test between a given model and a simpler model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anovaOD(mod.simple, mod.complex, c.hat = 1, 
        nobs = NULL, ...)

## S3 method for class 'glm'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitOccu'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitColExt'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitOccuRN'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitPCount'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitPCO'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitDS'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitGDS'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitOccuFP'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitMPois'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitGMM'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitGPC'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitOccuMS'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitOccuTTD'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitMMO'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'unmarkedFitDSO'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'glmerMod'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'maxlikeFit'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'multinom'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)

## S3 method for class 'vglm'
anovaOD(mod.simple, mod.complex, c.hat = 1,  
        nobs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mod.simple</code></td>
<td>

<p>an object of class <code>glm</code>, <code>glmmTMB</code>,
<code>maxlikeFit</code>, <code>mer</code>, <code>merMod</code>, <code>multinom</code>,  
<code>vglm</code>, and various <code>unmarkedFit</code> classes containing 
the output of a model.  This model should be a simpler version of
<code>mod.complex</code> resulting from a deletion of certain terms (i.e.,
nested model).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod.complex</code></td>
<td>

<p>an object of the same class as <code>mod.simple</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.hat</code></td>
<td>

<p>value of overdispersion parameter (i.e., variance inflation factor)
such as that obtained from <code>c_hat</code>, <code>mb.gof.test</code>, or
<code>Nmix.gof.test</code>.  Typically, this value should be computed for
the most complex model and applied to simpler models.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nobs</code></td>
<td>

<p>the number of observations used in the analysis.  If <code>nobs =
    NULL</code>, the total number of rows are used as the sample size to
compute the residual degrees of freedom as <code class="reqn">nobs - K</code>, where
<em>K</em> is the number of estimated parameters.  This is relevant
only for mixed models or various models of <code>unmarkedFit</code>
classes where sample size is not straightforward.  In such cases,
one might use total number of observations or number of independent
clusters (e.g., sites) as the value of <code>nobs</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional arguments passed to the function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function applies a correction for overdispersion on the
likelihood-ratio test between a model and its simpler counterpart.
The simpler model must be nested within the more complex model,
typically as the result of deleting terms.  You should supply the
<code>c.hat</code> value of the most complex of the two models you are
comparing.
</p>
<p>When <code class="reqn">1 &lt; c.hat &lt; 4</code>, the likelihood-ratio test is computed
as:
</p>
<p style="text-align: center;"><code class="reqn">LR = \frac{-2 * (LL.simple - LL.complex)}{(K.complex - K.simple)
      * c.hat}</code>
</p>

<p>where <em>LL.simple</em> and <em>LL.complex</em> are the log-likelihoods
of the simple and complex models, respectively, and where
<em>K.complex</em> and <em>K.simple</em> are the number of estimated
parameters in each model.  The test statistic is approximately
distributed as <code class="reqn">F_{K.complex - K.simple, n - K.complex}</code>, where
<em>n</em> is the number of observations (i.e., <code>nobs</code>) used in the
analysis (Venables and Ripley 2002).
</p>
<p>When <code>nobs = NULL</code>, the number of observations is based on the
number of rows of the data frame used in the analysis.  For mixed
models or various models of <code>unmarkedFit</code>, sample size is less
straightforward, and <code>nobs</code> could be based on the total number of
observations or on the number of independent clusters (e.g., sites),
among other choices.
</p>
<p>When <code>c.hat = 1</code>, the likelihood-ratio test simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">LR = -2 * (LL.simple - LL.complex)</code>
</p>

<p>where in this case the test statistic is distributed as a
<code class="reqn">\chi^2_{K.complex - K.simple}</code> (McCullagh and Nelder 1989).
</p>
<p>The function supports different model types such as Poisson GLM's and
GLMM's, single-season and dynamic occupancy models (MacKenzie et
al. 2002, 2003),  and various <em>N</em>-mixture models (Royle 2004,
Dail and Madsen 2011).
</p>


<h3>Value</h3>

<p><code>anovaOD</code> returns an object of class <code>anovaOD</code> as a list with
the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>form.simple</code></td>
<td>
<p>a character string of the parameters estimated in <code>mod.simple</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form.complex</code></td>
<td>
<p>a character string of the parameters estimated in <code>mod.complex</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.hat</code></td>
<td>
<p>the <code>c.hat</code> estimate used to adjust the
likelihood-ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>devMat</code></td>
<td>
<p>a matrix storing as columns the number of parameters
estimated (<code>K</code>), the log-likelihood of each model <code>logLik</code>,
the difference in estimated parameters between the two models
(<code>Kdiff</code>), minus twice the difference in log-likelihoods between
the models (<code>-2LL</code>), the test statistic, and the associated
P-value. 
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc J. Mazerolle
</p>


<h3>References</h3>

<p>Dail, D., Madsen, L. (2011) Models for estimating abundance from
repeated counts of an open population. <em>Biometrics</em> <b>67</b>,
577–587. 
</p>
<p>MacKenzie, D. I., Nichols, J. D., Lachman, G. B., Droege, S., Royle,
J. A., Langtimm, C. A. (2002) Estimating site occupancy rates when
detection probabilities are less than one. <em>Ecology</em> <b>83</b>,
2248–2255.
</p>
<p>MacKenzie, D. I., Nichols, J. D., Hines, J. E., Knutson, M. G.,
Franklin, A. B. (2003) Estimating site occupancy, colonization, and
local extinction when a species is detected imperfectly. <em>Ecology</em>
<b>84</b>, 2200–2207.
</p>
<p>Mazerolle, M. J. (2006) Improving data analysis in herpetology: using
Akaike's Information Criterion (AIC) to assess the strength of
biological hypotheses. <em>Amphibia-Reptilia</em> <b>27</b>, 169–180. 
</p>
<p>McCullagh, P., Nelder, J. A. (1989) <em>Generalized Linear
Models</em>. Second edition. Chapman and Hall: New York.
</p>
<p>Royle, J. A. (2004) <em>N</em>-mixture models for estimating population
size from spatially replicated counts. <em>Biometrics</em> <b>60</b>, 
108–115.
</p>
<p>Venables, W. N., Ripley, B. D. (2002) <em>Modern Applied Statistics
with S</em>. Second edition. Springer-Verlag: New York.
</p>


<h3>See Also</h3>

<p><code>c_hat</code>, <code>mb.gof.test</code>,
<code>Nmix.gof.test</code>, <code>summaryOD</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">##anuran larvae example from Mazerolle (2006)
data(min.trap)
##assign "UPLAND" as the reference level as in Mazerolle (2006)          
min.trap$Type &lt;- relevel(min.trap$Type, ref = "UPLAND") 

##run model
m1 &lt;- glm(Num_anura ~ Type + log.Perimeter + Num_ranatra,
          family = poisson, offset = log(Effort),
          data = min.trap) 
##null model
m0 &lt;- glm(Num_anura ~ 1,
          family = poisson, offset = log(Effort),
          data = min.trap) 

##check c-hat for global model
c_hat(m1) #uses Pearson's chi-square/df

##likelihood ratio test corrected for overdispersion
anovaOD(mod.simple = m0, mod.complex = m1, c.hat = c_hat(m1))
##compare without overdispersion correction
anovaOD(mod.simple = m0, mod.complex = m1)


##example with occupancy model
## Not run: 
##load unmarked package
if(require(unmarked)){
   
   data(bullfrog)
     
   ##detection data
   detections &lt;- bullfrog[, 3:9]

   ##assemble in unmarkedFrameOccu
   bfrog &lt;- unmarkedFrameOccu(y = detections)
     
   ##run model
   fm &lt;- occu(~ 1 ~ Reed.presence, data = bfrog)
   ##null model
   fm0 &lt;- occu(~ 1 ~ 1, data = bfrog)

   ##check GOF
   ##GOF &lt;- mb.gof.test(fm, nsim = 1000)
   ##estimate of c-hat:  1.89

   ##display results after overdispersion adjustment
   anovaOD(fm0, fm, c.hat = 1.89)

   detach(package:unmarked)
}

## End(Not run)
</code></pre>


</div>