<div class="container">

<table style="width: 100%;"><tr>
<td>sim.spatialHDS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulates data for a hierarchical spatial distance sampling model
</h2>

<h3>Description</h3>

<p>Generates data for distance sampling from spatially-replicated point transects, with density dependent on a spatially correlated habitat covariate. For each point count, the procedure is:
</p>
<p>1. Simulate the habitat covariate over a grid of pixels covering a square.
</p>
<p>2. Distribute the population of individuals over the square with probability of location in a pixel related to the covariate.
</p>
<p>3. Decide which individuals are detected using a distance sampling model with an observer at the center of the square, with a half normal detection function. (Note that individuals outside the circle of radius <code>B</code> can be detected.)
</p>
<p>The locations and detection status of individuals at all sites are collated and returned, except for individuals at sites when none are detected.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.spatialHDS(lam0 = 4, sigma = 1.5, B = 3, nsites = 100,
  beta1 = 1, npix = 20, show.plots = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lam0</code></td>
<td>

<p>the expected number of individuals in the square of side = 2*B if the habitat covariate had no effect (ie, <code>beta1 = 0</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>scale parameter of the half-normal detection function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>distance from the observer to the side of the square. This is usually set so that the probability of detection of individuals outside the square is negligable, eg, <code>B = 3*sigma</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsites</code></td>
<td>

<p>number of sites
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>

<p>the size of the effect of the habitat covariate on the number of individuals in a pixel.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npix</code></td>
<td>

<p>the number of pixels along each dimension of the square: the entire grid has <code>npix x npix</code> pixels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plots</code></td>
<td>

<p>the number of sites for which plots should be displayed.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>a matrix with columns for siteID, the coordinates of each individual (<code>u1, u2</code>), distance from the center of the square (<code>d</code>) and detection status, 0/1 (<code>y</code>), and rows for each individual, except that individuals at sites where no individuals were detected are NOT included, and those sites are represented by NAs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B </code></td>
<td>
<p>the radius of the circle; the data are simulated over a square of side 2*B</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Habitat </code></td>
<td>
<p>a matrix with the values of the Habitat covariate for each pixel at each site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid </code></td>
<td>
<p>a data frame with the coordinates of each pixel (same for all sites)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>the realized number of individuals in the square at each site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsites </code></td>
<td>
<p>the number sites</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.8.5.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data with the default arguments and look at the structure:
tmp &lt;- sim.spatialHDS()
str(tmp)
</code></pre>


</div>