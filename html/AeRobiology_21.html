<div class="container">

<table style="width: 100%;"><tr>
<td>quality_control</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quality Control of a Pollen Database</h2>

<h3>Description</h3>

<p>Function to check the quality of an historical database of several pollen types.
</p>


<h3>Usage</h3>

<pre><code class="language-R">quality_control(data, int.window = 2, perc.miss = 20,
  ps.method = "percentage", result = "plot", th.day = 100,
  perc = 95, def.season = "natural", reduction = FALSE,
  red.level = 0.9, derivative = 5, man = 11, th.ma = 5,
  n.clinical = 5, window.clinical = 7, window.grains = 5,
  th.pollen = 10, th.sum = 100, type = "none",
  int.method = "lineal", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> object including the general database where quality must be checked. This data.frame must include a first column in <code>Date</code> format and the rest of columns in <code>numeric</code> format belonging to each pollen type by column. It is not necessary to insert the missing gaps; the function will automatically detect them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.window</code></td>
<td>
<p>A  <code>numeric (interger)</code>value bigger or equal to <code>1</code>. The argument specifies the number of days of each side of the start, peak or end date of the main pollen season which will be checked during the quality control. If any of these days has been interpolated, the current season will not pass the quality control. The <code>int.window</code> argument will be <code>2</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc.miss</code></td>
<td>
<p>A <code>numeric (interger)</code> value between <code>0</code> and <code>100</code>. The argument specifies the maximal percentage of interpolated days which is allowed inside the main pollen season to pass the quality control. The <code>perc.miss</code> argument will be <code>20</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.method</code></td>
<td>
<p>A <code>character</code> string specifying the method applied to calculate the pollen season and the main parameters. The implemented methods that can be used are: <code>"percentage"</code>, <code>"logistic"</code>, <code>"moving"</code>, <code>"clinical"</code> or <code>"grains"</code>. A more detailed information about the different methods for defining the pollen season may be consulted in <code>calculate_ps</code> function. The <code>ps.method</code> argument will be <code>"percentage"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>A <code>character</code> string specifying the format of the results. Only <code>"plot"</code> or <code>"table"</code> available. If <code>"plot"</code>, graphical resume of the quality control will be plotted. If <code>"table"</code>, a <code>data.frame</code> will be created indicating the filters passed by each pollen type and season. Consult 'Return' for more information .The <code>result</code> argument will be <code>"plot"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.day</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>def.season</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>red.level</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>derivative</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>man</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.ma</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.clinical</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.clinical</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window.grains</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.pollen</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th.sum</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.method</code></td>
<td>
<p>See <code>calculate_ps</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed on to the pollen season calculation as specified in <code>calculate_ps</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Quality control is a relevant topic for aerobiology (Oteros et al., 2013). This function is another approach to improve the quality control management in the field. <br><code>quality_control</code> function checks the quality of the pollen data of each pollen type and season. The filters applied by the function are: <br></p>

<ul>
<li>
<p> If the main pollen season (Galan et al., 2017) cannot be calculated according to <code>calculate_ps</code> function minimal requirements (lack of data for these pollen type and year). Filter named <code>"Complete"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li>
<li>
<p> If the start, end or peak date of the main pollen season has been interpolated or a day near to it (number of days specified by <code>int.window</code> argument). If a day near to these dates is missing, the selected date could not be the right one. Filters named <code>"Start"</code>, <code>"Peak"</code> and <code>"End"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li>
<li>
<p> The percentage of missing data inside the main pollen season. It calculates the number of days which have been interpolated by the algorithm and their percentage inside the main pollen season. If a high percentage of the main pollen season has been interpolated, the information of these season could not be reliable. Filter named <code>"Comp.MPS"</code> in the <code>"quality_control"</code> <code>data.frame</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>This function can return different results: <br></p>

<ul>
<li>
<p> If <code>result = "plot"</code>: Graphical resume of the Quality Control results showing the seasons of each pollen type and their quality (the risk assumed if they are included in further studies). The legend indicates the number of filter that have been unsuccessfully passed for each case. Object of class <code>ggplot</code>. For graphical customization, see <code>ggplot</code> function.
</p>
</li>
<li>
<p> If <code>result = "table"</code>: <code>data.frame</code> with <code>logical</code> values for each pollen type and season. If <code>TRUE</code>, the filter has been successfully passed for this case. If FALSE, this case does not fit the minimal requirements of this filter.
</p>
</li>
</ul>
<h3>References</h3>

<p>Galan, C., Ariatti, A., Bonini, M., Clot, B., Crouzy, B., Dahl, A., Fernandez_Gonzalez, D., Frenguelli, G., Gehrig, R., Isard, S., Levetin, E., Li, D.W., Mandrioli, P., Rogers, C.A., Thibaudon, M., Sauliene, I., Skjoth, C., Smith, M., Sofiev, M., 2017. Recommended terminology for aerobiological studies. Aerobiologia (Bologna). 293_295.
</p>
<p>Oteros, J., Galan, C., Alcazar, P., &amp; Dominguez_Vilches, E. (2013). Quality control in bio_monitoring networks, Spanish Aerobiology Network. Science of the Total Environment, 443, 559_565.
</p>


<h3>See Also</h3>

<p><code>calculate_ps</code>, <code>interpollen</code>, <code>ggplot</code>, <code>ggsave</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("munich_pollen")
quality_control(munich_pollen[,c(1:4)])
</code></pre>


</div>