<div class="container">

<table style="width: 100%;"><tr>
<td>sample_tmb_nuts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw MCMC samples from a model posterior using the No-U-Turn (NUTS)
sampler with dual averaging.</h2>

<h3>Description</h3>

<p>Draw MCMC samples from a model posterior using the No-U-Turn (NUTS)
sampler with dual averaging.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_tmb_nuts(
  iter,
  fn,
  gr,
  init,
  warmup = floor(iter/2),
  chain = 1,
  thin = 1,
  seed = NULL,
  control = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of samples to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>A function that returns the log of the posterior density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr</code></td>
<td>
<p>A function that returns a vector of gradients of the log of
the posterior density (same as <code>fn</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A list of lists containing the initial parameter
vectors, one for each chain or a function. It is strongly
recommended to initialize multiple chains from dispersed
points. A of NULL signifies to use the starting values
present in the model (i.e., <code>obj$par</code>) for all chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmup</code></td>
<td>
<p>The number of warmup iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>The chain number, for printing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning rate to apply to samples. Typically
not used with NUTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The random seed to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list to control the sampler. See details for
further use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements algorithm 6 of Hoffman and Gelman
(2014), which includes adaptive step sizes (<code>eps</code>) via an
algorithm called dual averaging. It also includes an adaptation scheme
to tune a diagonal mass matrix (metric) during warmup.
</p>
<p>These <code>fn</code> and <code>gr</code> functions must have Jacobians already
applied if there are transformations used.
</p>


<h3>References</h3>

<p>Hoffman and Gelman (2014). The No-U-Turn sampler: Adaptively setting
path lengths in Hamiltonian Monte Carlo. J. Mach. Learn. Res.
15:1593-1623.
</p>


<h3>See Also</h3>

<p><code>sample_tmb</code>
</p>


</div>