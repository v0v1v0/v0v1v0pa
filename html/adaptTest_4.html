<div class="container">

<table style="width: 100%;"><tr>
<td>CEF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to specify a conditional error function</h2>

<h3>Description</h3>

<p>This function returns a conditional error function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CEF(typ = NA, fun = NA, dis = NA, a2 = NA, c = NA, p1 = NA, p2 = p1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>typ</code></td>
<td>
<p>type of test: <code>"b"</code> for Bauer and Koehne (1994), <code>"l"</code> for Lehmacher and Wassmer (1999), <code>"v"</code> for Vandemeulebroecke (2006) and <code>"h"</code> for the horizontal conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>the parameter <code class="reqn">c</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2</code></td>
<td>
<p><code class="reqn">\alpha_2</code>, the local level of the test after the second stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>the p-value <code class="reqn">p_1</code> of the test after the first stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>the p-value <code class="reqn">p_2</code> of the test after the second stage, defaults to <code>p1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>a distortion method for a supplied conditional error function (see details): <code>"pl"</code> for power lines, <code>"vt"</code> for vertical translation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two alternative ways of specifying the desired conditional error function:
</p>

<ul>
<li>
<p> through a type <code>typ</code>, and either a parameter (either <code>a2</code> or <code>c</code>) or a point <code>(p1,p2)</code>, OR
</p>
</li>
<li>
<p> through an initial conditional error function <code>fun</code>, and possibly a distortion method <code>dis</code> together with either the parameter <code>a2</code> or a point <code>(p1,p2)</code>
</p>
</li>
</ul>
<p>Most people will only need the first of these two ways; the second leads to user-defined non-standard tests.
</p>
<p>If <code>typ</code> is specified, a parameter <code>a2</code> or <code>c</code> or the point <code>(p1,p2)</code> must be provided. In this case, <code>CEF</code> returns the conditional error function of the chosen type with the given parameter or running through the given point.
</p>
<p>If <code>typ</code> is not specified, a conditional error function (i.e., a nonincreasing function defined on [0,1] with values in [0,1]) <code>fun</code> must be provided. If no distortion method is selected (<code>dis = NA</code>), <code>fun</code> is returned unchanged. Otherwise, the function is distorted using the chosen distortion method, either to match a desired second stage level <code>a2</code> or to run through a specified point <code>(p1,p2)</code> (one of which must be provided). Currently, two distortion methods are implemented:
</p>

<ul>
<li> <p><code>dis = "pl"</code>, Power lines: For an initial function <code class="reqn">f</code>, define <code class="reqn">f[r](x) = (f(x^r))^(1/r)</code>, r&gt;0. Note that if <code class="reqn">f</code> is a conditional error function of type <code>"b"</code> (Bauer and Koehne, 1994), so is <code class="reqn">f[r]</code>.
</p>
</li>
<li> <p><code>dis = "pl"</code>, Vertical translation: The initial function is shifted vertically.
</p>
</li>
</ul>
<p>See <code>parconv</code> for more information on the two alternative parameterizations by <code class="reqn">\alpha_2</code> and <code class="reqn">c</code>.
</p>


<h3>Value</h3>

<p>These functions return a conditional error <em>function</em> (see details).
</p>


<h3>Note</h3>

<p>Provide either <code>typ</code> or <code>fun</code>, not both! If <code>typ</code> is provided, then also specify <code>a2</code>, <code>c</code>, or <code>p1</code> (and possibly <code>p2</code>). If <code>fun</code> is provided, then also specify <code>dis</code> and <code>a2</code>, or <code>dis</code> and <code>p1</code> (and possibly <code>p2</code>), or none of these.
</p>
<p>Warning: Values of <code>a2</code> close to 0 or 1 may not work for <code>dis = "pl"</code>. 
</p>
<p>Note that in this implementation of adaptive two-stage tests, early stopping bounds are <em>not</em> part of the conditional error function. Rather, they are specified separately (see also <code>tsT</code>).
</p>


<h3>Author(s)</h3>

<p>Marc Vandemeulebroecke</p>


<h3>References</h3>

<p>Bauer, P., Koehne, K. (1994). Evaluation of experiments with adaptive interim analyses. <em>Biometrics</em> 50, 1029-1041.
</p>
<p>Lehmacher, W., Wassmer, G. (1999). Adaptive sample size calculations in group sequential trials. <em>Biometrics</em> 55, 1286-1290.
</p>
<p>Vandemeulebroecke, M. (2006). An investigation of two-stage tests. <em>Statistica Sinica</em> 16, 933-951.
</p>


<h3>See Also</h3>

<p><code>adaptTest</code> package description, <code>parconv</code>, <code>plotCEF</code>, <code>tsT</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot two conditional error functions of the Lehmacher-Wassmer (1999) type:
## one to the local level alpha2=0.1, and one that runs through (p1,p2)=(0.3,0.7)
foo1 &lt;- CEF(typ="l", a2=0.1)
foo2 &lt;- CEF(typ="l", p1=0.3, p2=0.7)
plot(foo1, xlim=0:1)
plot(foo2, add=TRUE)

## A different way of doing the same
plotCEF(typ="l", a2=0.1, add=FALSE)
plotCEF(typ="l", p1=0.3, p2=0.7, plt.pt=FALSE)
</code></pre>


</div>