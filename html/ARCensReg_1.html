<div class="container">

<table style="width: 100%;"><tr>
<td>ARCensReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Censored linear regression model with autoregressive errors
</h2>

<h3>Description</h3>

<p>It fits a univariate left, right, or interval censored linear regression model 
with autoregressive errors under the normal distribution, using the SAEM algorithm. 
It provides estimates and standard errors of the parameters, supporting missing values on the dependent variable. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ARCensReg(cc, lcl = NULL, ucl = NULL, y, x, p = 1, M = 10, 
  perc = 0.25, MaxIter = 400, pc = 0.18, tol = 1e-04, 
  show_se = TRUE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>Vector of censoring indicators of length <code class="reqn">n</code>, where <code class="reqn">n</code> is the 
total observations. For each observation: 0 if non-censored, 1 if censored/missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcl, ucl</code></td>
<td>
<p>Vectors of length <code class="reqn">n</code> that represent the lower and upper bounds 
of the interval, which contains the observade value of the censored observation. 
Default=<code>NULL</code>, indicating no-censored data. See details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of responses of length <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>, where <code class="reqn">l</code> is the number 
of fixed effects including the intercept, if considered (in models which include an 
intercept, <code>x</code> should contain a column of ones).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Order of the autoregressive process. It must be a positive integer value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm. 
Default=10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc</code></td>
<td>
<p>Percentage of burn-in on the Monte Carlo sample. Default=0.25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p>The maximum number of iterations of the SAEM algorithm. Default=400.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory. It is recommended that 
<code>50&lt;MaxIter*pc&lt;100</code>. Default=0.18.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The convergence maximum error permitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_se</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if the standard errors should 
be estimated. Default=<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if printing information should 
be suppressed. Default=<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linear regression model with autocorrelated errors, defined as a discrete-time autoregressive (AR) process of order <code class="reqn">p</code>, at time <code class="reqn">t</code> is given by
</p>
<p><code class="reqn">Y_t = x_t^T \beta + \xi_t,</code>
</p>
<p><code class="reqn">\xi_t = \phi_1 \xi_{t-1} + ... + \phi_p \xi_{t-p} + \eta_t, t=1, ..., n,</code>
</p>
<p>where <code class="reqn">Y_t</code> is the response variable, <code class="reqn">\beta = (\beta_1, ..., \beta_l)^T</code> is a vector 
of regression parameters of dimension <code class="reqn">l</code>, and <code class="reqn">x_t = (x_{t1}, ..., x_{tl})^T</code> is a 
vector of non-stochastic regressor variables values; <code class="reqn">\xi_t</code> is the AR error with Gaussian 
disturbance <code class="reqn">\eta_t</code>, <code class="reqn">\phi = (\phi_1, ..., \phi_p)^T</code> is the vector of AR coefficients, 
and <code class="reqn">n</code> is the sample size. 
</p>
<p>It is assumed that <code class="reqn">Y_t</code> is not fully observed for all <code class="reqn">t</code>. 
For left censored observations, we have <code>lcl=-Inf</code> and <code>ucl=</code><code class="reqn">V_t</code>, 
such that the true value <code class="reqn">Y_t \leq V_t</code>. For right censoring, <code>lcl=</code><code class="reqn">V_t</code> 
and <code>ucl=Inf</code>, such that <code class="reqn">Y_t \geq V_t</code>. For interval censoring, <code>lcl</code> and <code>ucl</code> must be finite values, such that  <code class="reqn">V_{1t} \leq Y_t \leq V_{2t}</code>. Missing data can be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.
</p>
<p>The initial values are obtained by ignoring censoring and applying maximum likelihood 
estimation with the censored data replaced by their censoring limits. Furthermore, just set <code>cc</code> as a vector of zeros to fit a regression model with autoregressive errors for non-censored data.
</p>


<h3>Value</h3>

<p>An object of class "ARpCRM", representing the AR(p) censored regression normal fit. Generic functions such as print and summary have methods to show the results of the fit. The function plot provides convergence graphics for the parameters when at least one censored observation exists.
</p>
<p>Specifically, the following components are returned:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimate of the regression parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Estimated variance of the white noise process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Estimate of the autoregressive parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1</code></td>
<td>
<p>Estimate of the first <code class="reqn">p</code> partial autocorrelations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Vector of parameters estimate (<code class="reqn">\beta, \sigma^2, \phi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Vector of the standard errors of (<code class="reqn">\beta, \sigma^2, \phi</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AICcorr</code></td>
<td>
<p>Corrected Akaike information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yest</code></td>
<td>
<p>Augmented response variable based on the fitted model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yyest</code></td>
<td>
<p>Final estimative of <code>E(Y%*%t(Y))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations until convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>Attained criteria value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The <code>ARCensReg</code> call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>Table of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>critFin</code></td>
<td>
<p>Selection criteria.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens</code></td>
<td>
<p>"left", "right", or "interval" for left, right, or interval censoring, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmiss</code></td>
<td>
<p>Number of missing observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncens</code></td>
<td>
<p>Number of censored observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p>Logical indicating convergence of the estimation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxIter</code></td>
<td>
<p>The maximum number of iterations used for the SAEM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time elapsed in processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>A list containing convergence information.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>References</h3>

<p>Delyon B, Lavielle M, Moulines E (1999).
“Convergence of a stochastic approximation version of the EM algorithm.”
<em>Annals of statistics</em>, 94–128.
</p>
<p>Schumacher FL, Lachos VH, Dey DK (2017).
“Censored regression models with autoregressive errors: A likelihood-based perspective.”
<em>Canadian Journal of Statistics</em>, <b>45</b>(4), 375–392.
</p>


<h3>See Also</h3>

<p><code>arima</code>, <code>ARtCensReg</code>, <code>InfDiag</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example 1: (p = l = 1)
# Generating a sample
set.seed(23451)
n = 50
x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.5, sig2=.3, x=x, cens='left', pcens=.1)

# Fitting the model (quick convergence)
fit0 = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 M=5, pc=.12, tol=0.001, show_se=FALSE)
fit0

## Example 2: (p = l = 2)
# Generating a sample
n = 100
x = cbind(1, runif(n))
dat = rARCens(n=n, beta=c(2,1), phi=c(.48,-.2), sig2=.5, x=x, cens='left', 
              pcens=.05)

# Fitting the model
fit1 = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 p=2, tol=0.0001)
summary(fit1)
plot(fit1)

# Plotting the augmented variable
library(ggplot2)
data.plot = data.frame(yobs=dat$data$y, yest=fit1$yest)
ggplot(data.plot) + theme_bw() +
  geom_line(aes(x=1:nrow(data.plot), y=yest), color=4, linetype="dashed") +
  geom_line(aes(x=1:nrow(data.plot), y=yobs)) + labs(x="Time", y="y")

## Example 3: Simulating missing values
miss = sample(1:n, 3)
yMISS = dat$data$y
yMISS[miss] = NA
cc = dat$data$cc
cc[miss] = 1
lcl = dat$data$lcl
ucl = dat$data$ucl
ucl[miss] = Inf

fit2 = ARCensReg(cc, lcl, ucl, yMISS, x, p=2)
plot(fit2)

# Imputed missing values
data.frame(yobs=dat$data$y[miss], yest=fit2$yest[miss])
</code></pre>


</div>