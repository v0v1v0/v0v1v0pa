<div class="container">

<table style="width: 100%;"><tr>
<td>plotCEF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to plot a conditional error function</h2>

<h3>Description</h3>

<p>This function plots a conditional error function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotCEF(typ = NA, fun = NA, dis = NA, a2 = NA, c = NA, p1 = NA, p2 = p1,
        x = 0:200/200, add = TRUE, xlim = c(0, 1), ylim = c(0, 1),
        plt.pt = TRUE, plt.ptann = TRUE, xlab = NA, ylab = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>typ</code></td>
<td>
<p>type of test: <code>"b"</code> for Bauer and Koehne (1994), <code>"l"</code> for Lehmacher and Wassmer (1999), <code>"v"</code> for Vandemeulebroecke (2006) and <code>"h"</code> for the horizontal conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>a conditional error function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dis</code></td>
<td>
<p>a distortion method for a supplied conditional error function (see details): <code>"pl"</code> for power lines, <code>"vt"</code> for vertical translation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2</code></td>
<td>
<p><code class="reqn">\alpha_2</code>, the local level of the test after the second stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>the parameter <code class="reqn">c</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>the p-value <code class="reqn">p_1</code> of the test after the first stage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>the p-value <code class="reqn">p_2</code> of the test after the second stage, defaults to <code>p1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector on which the conditional error function is plotted (should be relatively dense in [0,1])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical determining whether the bounds should be added to an existing plot (default) or a new plot should be opened</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>the x limits of the plot (default: <code>c(0, 1)</code>; other choices can be used to "zoom in")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>the y limits of the plot (default: <code>c(0, 1)</code>; other choices can be used to "zoom in")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt.pt</code></td>
<td>
<p>logical determining whether the point that the conditional error function is made to run through should be plotted or not (default: yes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt.ptann</code></td>
<td>
<p>logical determining whether the point that the conditional error function is made to run through should be annotated or not (default: yes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a label for the x axis (default: no label)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>a label for the y axis (default: no label)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed on to the underlying <code>plot</code> and <code>points</code> functions (e.g., graphical parameters)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two alternative ways of specifying the desired conditional error function:
</p>

<ul>
<li>
<p> through a type <code>typ</code>, and either a parameter (either <code>a2</code> or <code>c</code>) or a point <code>(p1,p2)</code>, OR
</p>
</li>
<li>
<p> through an initial conditional error function <code>fun</code>, and possibly a distortion method <code>dis</code> together with either the parameter <code>a2</code> or a point <code>(p1,p2)</code>
</p>
</li>
</ul>
<p>Most people will only need the first of these two ways; the second leads to user-defined non-standard tests.
</p>
<p>If <code>typ</code> is specified, a parameter <code>a2</code> or <code>c</code> or the point <code>(p1,p2)</code> must be provided. In this case, <code>plotCEF</code> plots the conditional error function of the chosen type with the given parameter or running through the given point.
</p>
<p>If <code>typ</code> is not specified, a conditional error function (i.e., a nonincreasing function defined on [0,1] with values in [0,1]) <code>fun</code> must be provided. If no distortion method is selected (<code>dis = NA</code>), <code>fun</code> is plotted unchanged. Otherwise, the function is distorted using the chosen distortion method, either to match a desired second stage level <code>a2</code> or to run through a specified point <code>(p1,p2)</code> (one of which must be provided). Currently, two distortion methods are implemented:
</p>

<ul>
<li> <p><code>dis = "pl"</code>, Power lines: For an initial function <code>fun</code>, define <code class="reqn">f[r](x) = (f(x^r))^(1/r)</code>, r&gt;0. Note that if <code>fun</code> is a conditional error function of type <code>"b"</code> (Bauer and Koehne, 1994), so is f[r].
</p>
</li>
<li> <p><code>dis = "pl"</code>, Vertical translation: The initial function <code>fun</code> is shifted vertically.
</p>
</li>
</ul>
<p>See <code>parconv</code> for more information on the two alternative parameterizations by <code class="reqn">\alpha_2</code> and <code class="reqn">c</code>.
</p>
<p>Internally, <code>plotCEF</code> uses <code>CEF</code> to compute the conditional error function that is to be plotted.
</p>


<h3>Value</h3>

<p>The function <code>plotCEF</code> is invoked for its plotting effect; it returns no meaningful value.
</p>


<h3>Note</h3>

<p>Provide either <code>typ</code> or <code>fun</code>, not both! If <code>typ</code> is provided, then also specify <code>a2</code>, <code>c</code>, or <code>p1</code> (and possibly <code>p2</code>). If <code>fun</code> is provided, then also specify <code>dis</code> and <code>a2</code>, or <code>dis</code> and <code>p1</code> (and possibly <code>p2</code>), or none of these.
</p>
<p>Warning: Values of <code>a2</code> close to 0 or 1 may not work for <code>dis = "pl"</code>. 
</p>
<p><code>plt.pt</code> and <code>plt.ptann</code> are not considered if <code>p1 = NA</code>. <code>plt.ptann</code> is not considered if <code>plt.pt = FALSE</code>.
</p>
<p>Note that in this implementation of adaptive two-stage tests, early stopping bounds are <em>not</em> part of the conditional error function. Rather, they are specified separately (see also <code>tsT</code>).
</p>


<h3>Author(s)</h3>

<p>Marc Vandemeulebroecke</p>


<h3>References</h3>

<p>Bauer, P., Koehne, K. (1994). Evaluation of experiments with adaptive interim analyses. <em>Biometrics</em> 50, 1029-1041.
</p>
<p>Lehmacher, W., Wassmer, G. (1999). Adaptive sample size calculations in group sequential trials. <em>Biometrics</em> 55, 1286-1290.
</p>
<p>Vandemeulebroecke, M. (2006). An investigation of two-stage tests. <em>Statistica Sinica</em> 16, 933-951.
</p>


<h3>See Also</h3>

<p><code>adaptTest</code> package description, <code>parconv</code>, <code>CEF</code>, <code>tsT</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Plot two conditional error functions of the Lehmacher-Wassmer (1999) type:
## one to the local level alpha2=0.1, and one that runs through (p1,p2)=(0.3,0.7)
plotCEF(typ="l", a2=0.1, add=FALSE)
plotCEF(typ="l", p1=0.3, p2=0.7)

## Plot an explicitly defined conditional error function, and distort it
plotCEF(fun=function(x) ifelse(x&lt;.5,(1-x)^2, (1-x)/2), add=FALSE)
plotCEF(fun=function(x) ifelse(x&lt;.5,(1-x)^2, (1-x)/2), dis="pl", a2=.5)
foo &lt;- CEF(fun=function(x) ifelse(x&lt;.5,(1-x)^2, (1-x)/2), dis="pl", a2=.5)
plotCEF(fun=foo, col="red")
</code></pre>


</div>