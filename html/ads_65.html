<div class="container">

<table style="width: 100%;"><tr>
<td>dval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale local density of a spatial point pattern</h2>

<h3>Description</h3>

<p>Computes local density estimates of a spatial point pattern, i.e. the number of points per unit area,
within sample circles of regularly increasing radii <code class="reqn">r</code>, centred at the nodes of
a grid covering a simple (rectangular or circular) or complex sampling window (see Details). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">dval(p, upto, by, nx, ny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>a <code>"spp"</code> object defining a spatial point pattern in a given sampling window (see <code>spp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upto </code></td>
<td>
<p>maximum radius of the sample circles (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by </code></td>
<td>
<p>interval length between successive sample circles radii (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nx,ny </code></td>
<td>
<p>number of sample circles regularly spaced out in <code class="reqn">x</code> and <code class="reqn">y</code> directions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The local density is estimated for a regular sequence of sample circles radii given by <code>seq(by,upto,by)</code> (see <code>seq</code>).
The sample circles are centred at the nodes of a regular grid with size <code class="reqn">nx</code> by <code class="reqn">ny</code>. Ripley's edge effect correction is applied when 
the sample circles overlap boundary of the sampling window (see Ripley (1977) or Goreaud &amp; P?Pelissier (1999) for an extension to circular and complex 
sampling windows). Due to edge effect correction, <code>upto</code>, the maximum radius of the sample circles, is half the longer side for a rectangle sampling
window (i.e. <code class="reqn">0.5*max((xmax-xmin),(ymax-ymin))</code>) and the radius <code class="reqn">r0</code> for a circular sampling window (see <code>swin</code>).
</p>


<h3>Value</h3>

<p>A list of class <code>c("vads","dval")</code> with essentially the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>a vector of regularly spaced out distances (<code>seq(by,upto,by)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy </code></td>
<td>
<p>a data frame of <code class="reqn">(nx*ny)</code> observations giving <code class="reqn">(x,y)</code> coordinates of the centres of the sample circles (the grid nodes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cval </code></td>
<td>
<p>a matrix of size <code class="reqn">(nx*ny,length(r))</code> giving the estimated number of points of the pattern per sample circle with radius <code class="reqn">r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dval </code></td>
<td>
<p>a matrix of size <code class="reqn">(nx*ny,length(r))</code> giving the estimated number of points of the pattern per unit area per sample circle with radius <code class="reqn">r</code>.</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>In its current version, function <code>dval</code> ignores the marks of multivariate and marked point patterns (they are all considered to be univariate patterns).
</p>


<h3>Note</h3>

<p>There are printing, summary and plotting methods for <code>"vads"</code> objects.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:Raphael.Pelissier@ird.fr">Raphael.Pelissier@ird.fr</a></p>


<h3>References</h3>

<p>Goreaud, F. and P?Pelissier, R. 1999. On explicit formula of edge effect correction for Ripley's <em>K</em>-function. <em>Journal of Vegetation Science</em>, 10:433-438.<br><br>
P?Pelissier, R. and Goreaud, F. 2001. A practical approach to the study of spatial structure in simple cases of heterogeneous vegetation. <em>Journal of Vegetation Science</em>, 12:99-108.<br><br>
Ripley, B.D. 1977. Modelling spatial patterns. <em>Journal of the Royal Statistical Society B</em>, 39:172-212.
</p>


<h3>See Also</h3>

<p><code>plot.vads</code>,
<code>spp</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(BPoirier)
  BP &lt;- BPoirier
  ## Not run: spatial point pattern in a rectangle sampling window of size [0,110] x [0,90]
  swr &lt;- spp(BP$trees, win=BP$rect)
  dswr &lt;- dval(swr,25,1,11,9)
  summary(dswr)
  plot(dswr)
  
  ## Not run: spatial point pattern in a circle with radius 50 centred on (55,45)
  swc &lt;- spp(BP$trees, win=c(55,45,45))
  dswc &lt;- dval(swc,25,1,9,9)
  summary(dswc)
  plot(dswc)
  
  ## Not run: spatial point pattern in a complex sampling window
  swrt &lt;- spp(BP$trees, win=BP$rect, tri=BP$tri1)
  dswrt &lt;- dval(swrt,25,1,11,9)
  summary(dswrt)
  plot(dswrt)
</code></pre>


</div>