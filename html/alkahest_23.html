<div class="container">

<table style="width: 100%;"><tr>
<td>baseline_rubberband</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rubberband Baseline Estimation</h2>

<h3>Description</h3>

<p>Rubberband Baseline Estimation
</p>


<h3>Usage</h3>

<pre><code class="language-R">baseline_rubberband(x, y, ...)

## S4 method for signature 'numeric,numeric'
baseline_rubberband(x, y, noise = 0, spline = TRUE, ...)

## S4 method for signature 'ANY,missing'
baseline_rubberband(x, noise = 0, spline = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>A <code>numeric</code> vector. If <code>y</code> is missing, an attempt is made to
interpret <code>x</code> in a suitable way (see <code>grDevices::xy.coords()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments to be passed to <code>stats::smooth.spline()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>A length-one <code>numeric</code> vector giving the noise level.
Only used if <code>method</code> is "<code>rubberband</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spline</code></td>
<td>
<p>A <code>logical</code> scalar: should spline interpolation through the
support points be used instead of linear interpolation?
Only used if <code>method</code> is "<code>rubberband</code>".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A convex envelope of the spectrum is determined and the
baseline is estimated as the part of the convex envelope lying below the
spectrum. Note that the rubber band does not enter the concave regions
(if any) of the spectrum.
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> with two components <code>x</code> and <code>y</code>.
</p>


<h3>Note</h3>

<p><code>baseline_rubberband()</code> is slightly modified from C. Beleites'
<code>hyperSpec::spc.rubberband()</code>.
</p>


<h3>Author(s)</h3>

<p>N. Frerebeau
</p>


<h3>See Also</h3>

<p><code>signal_correct()</code>
</p>
<p>Other baseline estimation methods: 
<code>baseline_asls()</code>,
<code>baseline_linear()</code>,
<code>baseline_peakfilling()</code>,
<code>baseline_polynomial()</code>,
<code>baseline_rollingball()</code>,
<code>baseline_snip()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## gamma-ray spectrometry
data("BEGe")

## Subset from 2.75 to 200 keV
BEGe &lt;- signal_select(BEGe, from = 3, to = 200)

## Plot spectrum
plot(BEGe, type = "l", xlab = "Energy (keV)", ylab = "Count")

## Rubberband baseline
baseline &lt;- baseline_rubberband(BEGe)

plot(BEGe, type = "l", xlab = "Energy (keV)", ylab = "Count")
lines(baseline, type = "l", col = "red")
</code></pre>


</div>