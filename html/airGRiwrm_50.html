<div class="container">

<table style="width: 100%;"><tr>
<td>plot.OutputsModelReservoir</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot simulated reservoir volume, inflows and released flows time series on a reservoir node</h2>

<h3>Description</h3>

<p>Plot simulated reservoir volume, inflows and released flows time series on a reservoir node
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'OutputsModelReservoir'
plot(x, Qobs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object returned by RunModel_Reservoir</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qobs</code></td>
<td>
<p>(optional) numeric time series of observed released flow [m3/time step]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to plot.Qm3s</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Function used for side effect.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######################################################
# Daily time step simulation of a reservoir filled by #
# one catchment supplying a constant released flow    #
#######################################################

library(airGRiwrm)
data(L0123001)

# Inflows comes from a catchment of 360 kmÂ² modeled with GR4J
# The reservoir receives directly the inflows
db &lt;- data.frame(id = c(BasinInfo$BasinCode, "Reservoir"),
                 length = c(0, NA),
                 down = c("Reservoir", NA),
                 area = c(BasinInfo$BasinArea, NA),
                 model = c("RunModel_GR4J", "RunModel_Reservoir"),
                 stringsAsFactors = FALSE)
griwrm &lt;- CreateGRiwrm(db)
## Not run: 
plot(griwrm)

## End(Not run)

# Formatting of GR4J inputs for airGRiwrm (matrix or data.frame with one
# column by sub-basin and node IDs as column names)
Precip &lt;- matrix(BasinObs$P, ncol = 1)
colnames(Precip) &lt;- BasinInfo$BasinCode
PotEvap &lt;- matrix(BasinObs$E, ncol = 1)
colnames(PotEvap) &lt;- BasinInfo$BasinCode

# We propose to compute the constant released flow from
# the median of the natural flow
# The value is in m3 by time step (day)
Qrelease &lt;- median(BasinObs$Qls, na.rm = TRUE) / 1000 * 86400

# Formatting of reservoir released flow inputs for airGRiwrm (matrix or data.frame
# with one column by node and node IDs as column names)
Qrelease &lt;- data.frame(Reservoir = rep(Qrelease, length(BasinObs$DatesR)))

InputsModel &lt;- CreateInputsModel(griwrm, DatesR = BasinObs$DatesR,
                                 Precip = Precip,
                                 PotEvap = PotEvap,
                                 Qinf = Qrelease)

## run period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))

# Creation of the GRiwmRunOptions object
RunOptions &lt;- CreateRunOptions(
  InputsModel,
  IndPeriod_Run = Ind_Run,
  IndPeriod_WarmUp = seq.int(Ind_Run[1] - 365, length.out = 365)
)

# Initial states of the reservoir can be provided by the user
# For example for starting with an empty reservoir...
RunOptions[["Reservoir"]]$IniStates &lt;- c("Reservoir.V" = 0)

# calibration criterion: preparation of the InputsCrit object
Qobs &lt;- data.frame("L0123001" = BasinObs$Qmm[Ind_Run])
InputsCrit &lt;- CreateInputsCrit(InputsModel,
                               ErrorCrit_KGE2,
                               RunOptions = RunOptions,
                               Obs = Qobs)

# preparation of CalibOptions object
CalibOptions &lt;- CreateCalibOptions(InputsModel)

# Parameters of RunModel_Reservoir must be fixed
CalibOptions[["Reservoir"]]$FixedParam &lt;- c(Vmax = 30E6, celerity = 0.5)

OC &lt;- Calibration(
  InputsModel = InputsModel,
  RunOptions = RunOptions,
  InputsCrit = InputsCrit,
  CalibOptions = CalibOptions
)

# Model parameters
Param &lt;- extractParam(OC)
str(Param)

# Running simulation
OutputsModel &lt;- RunModel(InputsModel, RunOptions, Param)

# Plot the simulated flows and volumes on all nodes
Qobs &lt;- cbind(BasinObs$Qmm[Ind_Run], Qrelease[Ind_Run, ])
colnames(Qobs) &lt;- griwrm$id
plot(OutputsModel, Qobs = Qobs)
# N.B. "Observed releases" should be considered as "Target releases" here

# The plot for the reservoir can also be plotted alone
plot(OutputsModel$Reservoir, Qobs = Qobs[, "Reservoir"])
</code></pre>


</div>