<div class="container">

<table style="width: 100%;"><tr>
<td>apf_fdr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Implementation of APF and FDR robust estimation</h2>

<h3>Description</h3>

<p><code>apf_fdr</code> returns robust estimates of the Average Power Function (APF)
and Bayes False Discovery Rate (FDR) for each value of the threshold Gamma
on the p-value and Tau on the correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">apf_fdr(data, type = "datf", corr = "spearman", lobs = 0,
  seed = 111, gamm = c(1e-04, 0.1, 0.002))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Either a vector, matrix or dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Set <code>"datf"</code> if <code>data</code> is a matrix or dataframe containing
the raw data (columns); <code>"pvl"</code> for a vector of p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>The type of correlation to use when <code>type = "datf"</code>. It can be
set to either <code>"spearman"</code> or <code>"pearson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lobs</code></td>
<td>
<p>When <code>type = "pvl"</code>, it indicates the number of datapoints used to
compute the correlations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A seed (natural number) for the resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamm</code></td>
<td>
<p>The threshold gamma on the p-values to explore (typically <code class="reqn">\le</code> 0.05 or
0.1). A min, max and step length value need to be set.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with four elements. A vector <code>APF_gamma</code> containing the robust
estimates of APF (5th quantiles) for all the gamma values set in <code>gamm</code>. A vector
<code>FDR_gamma</code> with the robust estimates of Bayes FDR (95th quantiles). A
vector <code>tau_gamma</code> with the correlation coefficients <em>tau</em> for each gamma
value explored and another vector with the relative values gamma (<code>gammaval</code>).
</p>


<h3>References</h3>

<p>Quatto, P, Margaritella, N, et al. Brain networks
construction using Bayes FDR and average power function. <em>Stat Methods Med Res</em>.
Published online May 14th, 2019; DOI:10.1177/0962280219844288.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("Ex1")
APF_lst &lt;- apf_fdr(Ex1,"pvl",lobs=100)
# The example uses the dataset Ex1 (in the APFr package) which is
# a vector of 100 p-values. The number of datapoints used to
# compute each p-value in this example is set to 100. As a result,
# a list of 4 objects is returned.


</code></pre>


</div>