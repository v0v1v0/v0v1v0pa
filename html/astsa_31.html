<div class="container">

<table style="width: 100%;"><tr>
<td>dna2vector</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Convert DNA Sequence to Indicator Vectors
</h2>

<h3>Description</h3>

<p>Takes a string (e.g., a DNA sequence) of general form (e.g., FASTA) and converts it to a sequence of indicator vectors for use with the Spectral Envelope (<code>specenv</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dna2vector(data, alphabet = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A single string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphabet</code></td>
<td>

<p>The particular alphabet  being used. The default is <code>alphabet=c("A", "C", "G", "T")</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Takes a string of categories and converts it to a matrix of indicators. The data can then be used by the script <code>specenv</code>, which calculates the Spectral Envelope of the sequence (or subsequence). Many different type of sequences can be used, including FASTA and GenBank, as long as the data is a string of categories.
</p>
<p>The indicator vectors (as a matrix) are returned invisibly in case the user forgets to put the results in an object wherein the screen would scroll displaying the entire sequence.  In other words, the user should do something like <code>xdata = dna2vector(data)</code> where <code>data</code> is the original sequence.
</p>
<p>As an example, if the DNA sequence is in a FASTA file, say <code>sequence.fasta</code>, remove the first line, which will look like <code>&gt;V01555.2 ... </code>. Then the following code can be used to read the data into the session, create the indicator sequence and save it as a compressed R data file:
</p>
<pre>
  fileName &lt;- 'sequence.fasta'      # name of FASTA file
  data     &lt;- readChar(fileName, file.info(fileName)$size)  # input the sequence
  myseq    &lt;- dna2vector(data)      # convert it to indicators

  ##== to compress and save the data ==##
  save(myseq, file='myseq.rda')
  ##== and then load it when needed ==##
  load('myseq.rda')
</pre>


<h3>Value</h3>

<p>matrix of indicator vectors; returned invisibly
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code>specenv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Epstein-Barr virus (entire sequence included in astsa)
xdata = dna2vector(EBV)
head(xdata)

# part of EBV with  1, 2, 3, 4 for "A", "C", "G", "T"
xdata = dna2vector(bnrf1ebv)
head(xdata)

# raw GenBank sequence
data &lt;-
c("1 agaattcgtc ttgctctatt cacccttact tttcttcttg cccgttctct ttcttagtat
  61 gaatccagta tgcctgcctg taattgttgc gccctacctc ttttggctgg cggctattgc")
xdata = dna2vector(data, alphabet=c('a', 'c', 'g', 't'))
head(xdata)

# raw FASTA sequence
data &lt;-
 c("AGAATTCGTCTTGCTCTATTCACCCTTACTTTTCTTCTTGCCCGTTCTCTTTCTTAGTATGAATCCAGTA
    TGCCTGCCTGTAATTGTTGCGCCCTACCTCTTTTGGCTGGCGGCTATTGCCGCCTCGTGTTTCACGGCCT")
xdata = dna2vector(data)
head(xdata)
</code></pre>


</div>