<div class="container">

<table style="width: 100%;"><tr>
<td>df2genind</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a data.frame of allele data to a genind object.</h2>

<h3>Description</h3>

<p>The function <code>df2genind</code> converts a data.frame (or a matrix) into a
genind object. The data.frame must meet the following
requirements:
</p>

<ul>
<li>
<p> genotypes are in row (one row per genotype)
</p>
</li>
<li>
<p> markers/loci are in columns
</p>
</li>
<li>
<p> each element is a string of characters coding alleles, ideally
separated by a character string (argument <code>sep</code>); if no separator is
used, the number of characters coding alleles must be indicated (argument
<code>ncode</code>).</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">df2genind(
  X,
  sep = NULL,
  ncode = NULL,
  ind.names = NULL,
  loc.names = NULL,
  pop = NULL,
  NA.char = "",
  ploidy = 2,
  type = c("codom", "PA"),
  strata = NULL,
  hierarchy = NULL,
  check.ploidy = getOption("adegenet.check.ploidy")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix or a data.frame containing allelle data only (see
decription)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>a character string separating alleles. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncode</code></td>
<td>
<p>an optional integer giving the number of characters used for
coding one genotype at one locus. If not provided, this is determined from
data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ind.names</code></td>
<td>
<p>optinal, a vector giving the individuals names; if NULL,
taken from rownames of X. If factor or numeric, vector is converted to
character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loc.names</code></td>
<td>
<p>an optional character vector giving the markers names; if
NULL, taken from colnames of X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>an optional factor giving the population of each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA.char</code></td>
<td>
<p>a character string corresponding to missing allele (to be
treated as NA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>an integer indicating the degree of ploidy of the genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string indicating the type of marker: 'codom' stands
for 'codominant' (e.g. microstallites, allozymes); 'PA' stands for
'presence/absence' markers (e.g. AFLP, RAPD).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>an optional data frame that defines population stratifications
for your samples. This is especially useful if you have a hierarchical or
factorial sampling design.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hierarchy</code></td>
<td>
<p>a hierarchical formula that explicitely defines hierarchical
levels in your strata. see <code>hierarchy</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.ploidy</code></td>
<td>
<p>a boolean indicating if the ploidy should be checked (TRUE,
default) or not (FALSE). Not checking the ploidy makes the import much faster,
but might result in bugs/problems if the input file is misread or the ploidy is
wrong. It is therefore advised to first import and check a subset of data to 
see if everything works as expected before setting this option to false.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See <code>genind2df</code> to convert genind objects back to
such a data.frame.
</p>
<p>=== Details for the <code>sep</code> argument ===<br> this character is directly
used in reguar expressions like <code>gsub</code>, and thus require some characters
to be preceeded by double backslashes. For instance, "/" works but "|" must
be coded as "\|".
</p>


<h3>Value</h3>

<p>an object of the class genind for <code>df2genind</code>; a
matrix of biallelic genotypes for <code>genind2df</code>
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:t.jombart@imperial.ac.uk">t.jombart@imperial.ac.uk</a>, Zhian N. Kamvar
<a href="mailto:kamvarz@science.oregonstate.edu">kamvarz@science.oregonstate.edu</a>
</p>


<h3>See Also</h3>

<p><code>genind2df</code>, <code>import2genind</code>,
<code>read.genetix</code>, <code>read.fstat</code>,
<code>read.structure</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## simple example
df &lt;- data.frame(locusA=c("11","11","12","32"),
locusB=c(NA,"34","55","15"),locusC=c("22","22","21","22"))
row.names(df) &lt;- .genlab("genotype",4)
df

obj &lt;- df2genind(df, ploidy=2, ncode=1)
obj
tab(obj)


## converting a genind as data.frame
genind2df(obj)
genind2df(obj, sep="/")

</code></pre>


</div>