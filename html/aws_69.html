<div class="container">

<table style="width: 100%;"><tr>
<td>smse3ms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adaptive smoothing in orientation space SE(3)
</h2>

<h3>Description</h3>

<p>The functions perform adaptive weights smoothing for data in orientation space SE(3),
e.g. diffusion weighted MR data,
with spatial coordinates given by voxel location within a mask and spherical information given
by gradient direction. Observations can belong to different shells characterized by b-value <code>bv</code>.
The data provided should only refer to voxel within mask.
</p>


<h3>Usage</h3>

<pre><code class="language-R">smse3ms(sb, s0, bv, grad, kstar, lambda, kappa0, mask, sigma,
    ns0 = 1, ws0 = 1, vext = NULL, ncoils = 1, verbose = FALSE, usemaxni = TRUE)
smse3(sb, s0, bv, grad, mask, sigma, kstar, lambda, kappa0,
    ns0 = 1, vext = NULL, vred = 4, ncoils = 1, model = 0, dist = 1,
    verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sb</code></td>
<td>

<p>2D array of diffion weighted data, first dimension refers to index ov voxel within the mask,
second dimension to the number diffusion weighted images.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>

<p>vector of length <code>sum(mask)</code> containing values within mask of an average non-diffusion-weigthed image.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bv</code></td>
<td>

<p>vector of b-values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad</code></td>
<td>

<p>matrix of gradient directions with <code>dim(grad)[1]==3</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstar</code></td>
<td>

<p>number of steps in adaptive weights smoothing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Scale parameter in adaptation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa0</code></td>
<td>

<p>determines amount of smoothing on the sphere. Larger values correspond to stronger smoothing
on the sphere. If <code>kappa0=NULL</code> a value is that corresponds to a variace reduction
with factor <code>vred</code> on the sphere.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>

<p>3D image defining a mask (logical)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>Error standard deviation. Assumed to be known and homogeneous in the current implementation.
A reasonable estimate may be defined
as the modal value of standard deviations obtained using method <code>getsdofsb</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ns0</code></td>
<td>

<p>Actual number of non-diffusion-weigthed images used to obtain <code>s0</code> by averaging.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ws0</code></td>
<td>

<p>Weight for non-diffusion-weigthed images in statistical penalty.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vext</code></td>
<td>

<p>Voxel extensions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncoils</code></td>
<td>

<p>Effective number of receiver coils (in case of e.g. GRAPPA reconstructions),
should be 1 in case of SENSE reconstructions. <code>2*ncoils</code> is the number of degrees of freedom of
the intensity distribution used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If <code>verbose=TRUE</code> additional reports are given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usemaxni</code></td>
<td>

<p>If <code>"usemaxni==TRUE"</code> a strikter penalization is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vred</code></td>
<td>

<p>Used if <code>kappa0=NULL</code> to specify the variance reduction on the
sphere when suggesting a value of <code>kappa0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Determines which quantities are smoothed. Possible values are
<code>"Chi"</code> for observed values (assumed to be distributed as noncentral
Chi with <code>2*ncoils</code> degrees of freedom), <code>"Chi2"</code> for squares of
observed values (assumed to be distributed as noncentral
Chi-squared with <code>2*ncoils</code> degrees of freedom). <code>"Gapprox"</code>
and <code>"Gapprox2"</code> use a Gaussian approximation for the noncentral
Chi distribution to smooth ovserved and squared values, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>Distance in SE3. Reasonable values are 1 (default, see Becker et.al. 2012),
2 ( a slight modification of 1: with k6^2 instead of abs(k6)) and
3 (using a 'naive' distance on the sphere)
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The functions return lists with main results in components
<code>th</code> and <code>th0</code> containing the smoothed data.
</p>


<h3>Note</h3>

<p>These functions are intended to be used internally in package <code>dti</code> only.
</p>


<h3>Author(s)</h3>

<p>J\"org Polzehl <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a>
</p>


<h3>References</h3>

<p>Joerg Polzehl, Karsten Tabelow (2019). Magnetic Resonance Brain Imaging:
Modeling and Data Analysis Using R. Springer, Use R! series. Doi:10.1007/978-3-030-29184-6.
</p>
<p>S. Becker, K. Tabelow, H.U. Voss, A. Anwander, R. Heidemann, J. Polzehl.
Position-orientation adaptive smoothing of diffusion weighted magnetic resonance
data (POAS). Medical Image Analysis, 2012, 16, 1142-1155. DOI:10.1016/j.media.2012.05.007.
</p>
<p>S. Becker, K. Tabelow, S. Mohammadi, N. Weiskopf, J. Polzehl. Adaptive smoothing
of multi-shell diffusion-weighted magnetic resonance data by msPOAS.
Neuroimage, 2014, 95, 90-105. DOI:10.1016/j.neuroimage.2014.03.053.
</p>


</div>