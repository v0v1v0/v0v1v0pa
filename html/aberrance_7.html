<div class="container">

<table style="width: 100%;"><tr>
<td>detect_pm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect parametric misfit</h2>

<h3>Description</h3>

<p>Detect parametric misfit using person-fit statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_pm(
  method,
  psi,
  xi = NULL,
  x = NULL,
  d = NULL,
  r = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The person-fit statistic(s) to compute. Options for score-based
statistics are:
</p>

<ul>
<li> <p><code>"ECI2_S_*"</code> for the second standardized extended caution index, also
known as <code class="reqn">\zeta_1</code> (Tatsuoka, 1984; see also Sinharay, 2018b).
</p>
</li>
<li> <p><code>"ECI4_S_*"</code> for the fourth standardized extended caution index, also
known as <code class="reqn">\zeta_2</code> (Tatsuoka, 1984; see also Sinharay, 2018b).
</p>
</li>
<li> <p><code>"L_S_*"</code> for the standardized log-likelihood statistic (Drasgow et al.,
1985).
</p>
</li>
</ul>
<p>Options for distractor-based statistics are:
</p>

<ul><li> <p><code>"L_D_*"</code> for the standardized log-likelihood statistic (Gorney &amp;
Wollack, 2023).
</p>
</li></ul>
<p>Options for score and distractor-based statistics are:
</p>

<ul><li> <p><code>"L_SD_*"</code> for the log-likelihood statistic (Gorney &amp; Wollack, 2023).
</p>
</li></ul>
<p>Options for response-based statistics are:
</p>

<ul><li> <p><code>"L_R_*"</code> for the standardized log-likelihood statistic (Drasgow et al.,
1985).
</p>
</li></ul>
<p>Options for response time-based statistics are:
</p>

<ul><li> <p><code>"L_T"</code> for the log-likelihood statistic (Sinharay, 2018a).
</p>
</li></ul>
<p>Options for score and response time-based statistics are:
</p>

<ul>
<li> <p><code>"Q_ST_*"</code> for the log-likelihood statistic that combines <code>"L_S_*"</code> and
<code>"L_T"</code> (Gorney, Sinharay, &amp; Liu, 2024).
</p>
</li>
<li> <p><code>"L_ST_*"</code> for the standardized log-likelihood statistic (Gorney,
Sinharay, &amp; Liu, 2024). <em>Note:</em> This statistic cannot be computed using
the <code>"CF"</code>, <code>"CS"</code>, <code>"EW"</code>, <code>"TSCF"</code>, <code>"TSCS"</code>, or <code>"TSEW"</code> corrections.
</p>
</li>
</ul>
<p>Options for response and response time-based statistics are:
</p>

<ul>
<li> <p><code>"Q_RT_*"</code> for the log-likelihood statistic that combines <code>"L_R_*"</code> and
<code>"L_T"</code> (Gorney, Sinharay, &amp; Liu, 2024).
</p>
</li>
<li> <p><code>"L_RT_*"</code> for the standardized log-likelihood statistic (Gorney,
Sinharay, &amp; Liu, 2024). <em>Note:</em> This statistic cannot be computed using
the <code>"CF"</code>, <code>"CS"</code>, <code>"EW"</code>, <code>"TSCF"</code>, <code>"TSCS"</code>, or <code>"TSEW"</code> corrections.
</p>
</li>
</ul>
<p>Statistics ending in <code>"*"</code> can be computed using various corrections.
Options are:
</p>

<ul>
<li> <p><code>"*"</code> for all possible corrections.
</p>
</li>
<li> <p><code>"NO"</code> for no correction.
</p>
</li>
<li> <p><code>"CF"</code> for the Cornish-Fisher expansion (Molenaar &amp; Hoijtink, 1990).
</p>
</li>
<li> <p><code>"CS"</code> for the chi-squared approximation (Molenaar &amp; Hoijtink, 1990).
</p>
</li>
<li> <p><code>"EW"</code> for the Edgeworth expansion (Bedrick, 1997).
</p>
</li>
<li> <p><code>"TS"</code> for the Taylor series expansion (Snijders, 2001; see also
Sinharay, 2016a, 2016b).
</p>
</li>
<li> <p><code>"TSCF"</code> for the Taylor series expansion and Cornish-Fisher expansion
(Gorney, Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li>
<li> <p><code>"TSCS"</code> for the Taylor series expansion and chi-squared approximation
(Gorney Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li>
<li> <p><code>"TSEW"</code> for the Taylor series expansion and Edgeworth expansion (Gorney
Sinharay, &amp; Eckerly, 2024; see also Gorney, 2024).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>A matrix of person parameters. If <code>NULL</code> (default), person
parameters are estimated using maximum likelihood estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, d, r, y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores, <code>d</code> the item
distractors, <code>r</code> the item responses, and <code>y</code> the item log response times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A matrix of parametric person-fit statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
persons, the second dimension to methods, and the third dimension to
significance levels.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bedrick, E. J. (1997). Approximating the conditional distribution of person
fit indexes for checking the Rasch model. <em>Psychometrika</em>, <em>62</em>(2), 191–199.
</p>
<p>Drasgow, F., Levine, M. V., &amp; Williams, E. A. (1985). Appropriateness
measurement with polychotomous item response models and standardized indices.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>38</em>(1),
67–86.
</p>
<p>Gorney, K. (2024). Three new corrections for standardized person-fit
statistics for tests with polytomous items. <em>British Journal of Mathematical
and Statistical Psychology</em>. Advance online publication.
</p>
<p>Gorney, K., Sinharay, S., &amp; Eckerly, C. (2024). Efficient corrections for
standardized person-fit statistics. <em>Psychometrika</em>, <em>89</em>(2), 569–591.
</p>
<p>Gorney, K., Sinharay, S., &amp; Liu, X. (2024). Using item scores and response
times in person-fit assessment. <em>British Journal of Mathematical and
Statistical Psychology</em>, <em>77</em>(1), 151–168.
</p>
<p>Gorney, K., &amp; Wollack, J. A. (2023). Using item scores and distractors in
person-fit assessment. <em>Journal of Educational Measurement</em>, <em>60</em>(1), 3–27.
</p>
<p>Molenaar, I. W., &amp; Hoijtink, H. (1990). The many null distributions of person
fit indices. <em>Psychometrika</em>, <em>55</em>(1), 75–106.
</p>
<p>Sinharay, S. (2016a). Asymptotic corrections of standardized extended caution
indices. <em>Applied Psychological Measurement</em>, <em>40</em>(6), 418–433.
</p>
<p>Sinharay, S. (2016b). Asymptotically correct standardization of person-fit
statistics beyond dichotomous items. <em>Psychometrika</em>, <em>81</em>(4), 992–1013.
</p>
<p>Sinharay, S. (2018a). A new person-fit statistic for the lognormal model for
response times. <em>Journal of Educational Measurement</em>, <em>55</em>(4), 457–476.
</p>
<p>Sinharay, S. (2018b). Extension of caution indices to mixed-format tests.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>71</em>(2),
363–386.
</p>
<p>Snijders, T. A. B. (2001). Asymptotic null distribution of person fit
statistics with estimated person parameter. <em>Psychometrika</em>, <em>66</em>(3),
331–342.
</p>
<p>Tatsuoka, K. K. (1984). Caution indices based on item response theory.
<em>Psychometrika</em>, <em>49</em>(1), 95–110.
</p>


<h3>See Also</h3>

<p><code>detect_nm()</code> to detect nonparametric misfit.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = misfitting, 0 = fitting)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 3PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 3PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = runif(n, min = 0.05, max = 0.30),
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect parametric misfit
out &lt;- detect_pm(
  method = c("L_S_TS", "L_T", "Q_ST_TS", "L_ST_TS"),
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect parametric misfit
out &lt;- detect_pm(
  method = c("ECI2_S_TSCF", "ECI4_S_TSCF", "L_S_TSCF"),
  psi = psi,
  x = x
)
</code></pre>


</div>