<div class="container">

<table style="width: 100%;"><tr>
<td>kmfun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale second-order neighbourhood analysis of a marked spatial point pattern</h2>

<h3>Description</h3>

<p>Computes estimates of the mark correlation <em>Km</em>-function and associated neighbourhood functions from a marked spatial point pattern 
in a simple (rectangular or circular) or complex sampling window. Computes optionally local confidence limits of the functions
under the null hypothesis of no correlation between marks (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kmfun(p, upto, by, nsim=0, alpha=0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a <code>"spp"</code> object defining a marked spatial point pattern in a given sampling window (see <code>spp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upto </code></td>
<td>
<p>maximum radius of the sample circles (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by </code></td>
<td>
<p>interval length between successive sample circles radii (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim </code></td>
<td>
<p>number of Monte Carlo simulations to estimate local confidence limits of the null hypothesis of no correlation between marks (see Details).
By default <code>nsim=0</code>, so that no confidence limits are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>if <code>nsim&gt;0</code>, significant level of the confidence limits. By default <code class="reqn">\alpha=0.01</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>kmfun</code> computes the mark correlation function <code class="reqn">Km(r)</code> and the associated function <code class="reqn">gm(r)</code>.<br><br>
It is defined from a general definition of spatial autocorrelation (Goreaud 2000) as:<br></p>
<p><code class="reqn">Km(r) = (COV(Xi,Xj)|d(i,j)&lt;r) / VAR(X)</code><br></p>
<p>where <code class="reqn">X</code> is a quantitative random variable attached to each point of the pattern.
</p>
<p><em>Km(r)</em> has a very similar interpretation than more classical correlation functions, such as Moran's <em>I</em>: it takes values between -1 and 1, with an expectation of 0 under the null hypothesis of no spatial correlation between the values of <em>X</em>, becomes positive when values of <code class="reqn">X</code> at distance <em>r</em> are positively correlated and negative when values of <code class="reqn">X</code> at distance <em>r</em> are negatively correlated.
</p>
<p><code class="reqn">gm(r)</code> is the derivative of <code class="reqn">Km(r)</code> or pair mark correlation function, which gives the correlation of marks within an annuli between two successive circles with radii <code class="reqn">r</code> and <code class="reqn">r-by</code>).<br><br></p>
<p>The program introduces an edge effect correction term according to the method proposed by Ripley (1977) and extended to circular and complex sampling windows by Goreaud &amp; P?Pelissier (1999).
</p>
<p>Local Monte Carlo confidence limits and p-values of departure from the null hypothesis of no correlation are estimated at each distance <code class="reqn">r</code>, after reallocating at random the values of <em>X</em> over all points of the pattern, the location of trees being kept unchanged.
</p>


<h3>Value</h3>

<p>A list of class <code>"fads"</code> with essentially the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>a vector of regularly spaced out distances (<code>seq(by,upto,by)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gm </code></td>
<td>
<p>a data frame containing values of the pair mark correlation function <code class="reqn">gm(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>km </code></td>
<td>
<p>a data frame containing values of the mark correlation function <code class="reqn">Km(r)</code>.<br></p>
</td>
</tr>
</table>
<p>Each component except <code>r</code> is a data frame with the following variables:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>obs </code></td>
<td>
<p>a vector of estimated values for the observed point pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theo </code></td>
<td>
<p>a vector of theoretical values expected for the null hypothesis of no correlation between marks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the upper local confidence limits of the null hypothesis at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inf </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the lower local confidence limits of the null hypothesis at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of local p-values of departure from the null hypothesis.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Applications of this function can be found in Oddou-Muratorio <em>et al.</em> (2004) and Madelaine <em>et al.</em> (submitted).
</p>


<h3>Author(s)</h3>

<p><a href="mailto:Raphael.Pelissier@ird.fr">Raphael.Pelissier@ird.fr</a></p>


<h3>References</h3>

<p>Goreaud, F. 2000. <em>Apports de l'analyse de la structure spatiale en foret tempere a l'etude et la modelisation des peuplements complexes</em>. These de doctorat, ENGREF, Nancy, France.<br><br>
Goreaud F. &amp; P?Pelissier R. 1999. On explicit formulas of edge effect correction for Ripley's K-function. <em>Journal of Vegetation Science</em>, 10:433-438.<br><br>
Madelaine, C., Pelissier, R., Vincent, G., Molino, J.-F., Sabatier, D., Prevost, M.-F. &amp; de Namur, C. 2007. Mortality and recruitment in a lowland tropical rainforest of French Guiana: effects of soil type and species guild. <em>Journal of Tropical Ecology</em>, 23:277-287.
</p>
<p>Oddou-Muratorio, S., Demesure-Musch, B., Pelissier, R. &amp; Gouyon, P.-H. 2004. Impacts of gene flow and logging history on the local genetic structure of a scattered tree species, Sorbus torminalis L. <em>Molecular Ecology</em>, 13:3689-3702.
</p>
<p>Ripley B.D. 1977. Modelling spatial patterns. <em>Journal of the Royal Statistical Society B</em>, 39:172-192.
</p>


<h3>See Also</h3>

<p><code>plot.fads</code>,
<code>spp</code>,
<code>kfun</code>,
<code>k12fun</code>,
<code>kijfun</code>,
<code>ki.fun</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(BPoirier)
  BP &lt;- BPoirier
  ## Not run: spatial point pattern in a rectangle sampling window of size [0,110] x [0,90]
  swrm &lt;- spp(BP$trees, win=BP$rect, marks=BP$dbh)
  kmswrm &lt;- kmfun(swrm, 25, 2, 500)
  plot(kmswrm)
  
  ## Not run: spatial point pattern in a circle with radius 50 centred on (55,45)
  swc &lt;- spp(BP$trees, win=c(55,45,45), marks=BP$dbh)
  kmswc &lt;- kmfun(swc, 25, 2, 500)
  plot(kmswc)

  ## Not run: spatial point pattern in a complex sampling window
  swrt &lt;- spp(BP$trees, win=BP$rect, tri=BP$tri2, marks=BP$dbh)
  kmswrt &lt;- kmfun(swrt, 25, 2, 500)
  plot(kmswrt)

</code></pre>


</div>