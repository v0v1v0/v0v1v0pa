<div class="container">

<table style="width: 100%;"><tr>
<td>s.density</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2-D scatter plot with kernel density estimation</h2>

<h3>Description</h3>

<p>This function represents a two dimensional scatter plot of points distribution.
Densities' representation is based on the <code>levelplot</code> graphic in <code>lattice</code>
(density's surface, filled with colors and/or contour lines).
</p>


<h3>Usage</h3>

<pre><code class="language-R">s.density(dfxy, xax = 1, yax = 2, bandwidth = NULL, gridsize = c(450L, 450L), 
  nrpoints = 300, threshold = 0.1, col = NULL, contour = FALSE, region = !contour, 
  nclass = 8, facets = NULL, plot = TRUE, storeData = TRUE, add = FALSE, pos = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfxy</code></td>
<td>
<p>a data frame used to produce the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax</code></td>
<td>
<p>an integer (or a vector) indicating which column(s) of <code>dfxy</code> is(are) plotted on the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax</code></td>
<td>
<p>an integer (or a vector) indicating which column(s) of <code>dfxy</code> is(are) plotted on the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidth</code></td>
<td>
<p>bandwidth for density calculations which is passed in parameters in the <code>bkde2D</code> function of the <code>KernSmooth</code> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>grid dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrpoints</code></td>
<td>
<p>number of points on the density image</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a value between 0 and 1 to draw densities greater than this threshold. No density is visible whether it is equal to 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a color or a colors vector to color densities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>a logical to draw contour lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>a logical to fill grid regions with <code>col</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>number of class for density</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facets</code></td>
<td>
<p>a factor splitting the rows of <code>dfxy</code> so that subsets
of the data are represented on different sub-graphics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical indicating if the graphics is displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>storeData</code></td>
<td>
<p>a logical indicating if the data should be stored in
the returned object. If <code>FALSE</code>, only the names of the data
arguments are stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical. If <code>TRUE</code>, the graphic is superposed to the graphics
already plotted in the current device</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>an integer indicating the position of the
environment where the data are stored, relative to the environment
where the function is called. Useful only if <code>storeData</code> is
<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphical parameters (see
<code>adegpar</code> and <code>trellis.par.get</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Density calculation is made using the <code>kde2d</code> function of the <code>KernSmooth</code> package.
</p>


<h3>Value</h3>

<p>An object of class <code>ADEg</code> (subclass <code>S2.density</code>) or <code>ADEgS</code> (if <code>add</code> is <code>TRUE</code> and/or 
if facets or vectors for <code>xax</code>/<code>yax</code> are used).<br>
The result is displayed if <code>plot</code> is <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Alice Julien-Laferriere, Aurelie Siberchicot <a href="mailto:aurelie.siberchicot@univ-lyon1.fr">aurelie.siberchicot@univ-lyon1.fr</a> and Stephane Dray
</p>


<h3>See Also</h3>

<p><code>S2.density</code>
<code>ADEg.S2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">xx2 &lt;- c(rnorm(50000, 1, 1), rnorm(50000, -1, 1))
yy2 &lt;- c(rnorm(50000, -1, 0.5), rnorm(50000, 1, 0.5))
s.density(cbind(xx2, yy2), paxes.draw = TRUE, gridsize = c(200, 200), region = TRUE, 
  contour = TRUE, plabels.cex = 0, threshold = 0.05, nclass = 3, 
  col = colorRampPalette(c("lightgrey", "black"))(100))
</code></pre>


</div>