<div class="container">

<table style="width: 100%;"><tr>
<td>nll_proportional_virulence</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative log-likelihood function: nll proportional virulence</h2>

<h3>Description</h3>

<p>Function assuming hazard functions describing virulence are proportional
among infected treatments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nll_proportional_virulence(
  a1 = a1,
  b1 = b1,
  a2 = a2,
  b2 = b2,
  theta = theta,
  data = data,
  time = time,
  censor = censor,
  infected_treatment = infected_treatment,
  reference_virulence = reference_virulence,
  d1 = "Weibull",
  d2 = "Weibull"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a1, b1</code></td>
<td>
<p>location and scale parameters describing background mortality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2, b2</code></td>
<td>
<p>location and scale parameters describing mortality due to
infection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a constant describing the proportional relationship
of virulence; theta &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of data frame containing survival data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>name of data frame column identifying time of event; time &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>name of data frame column identifying if event was death (0) or
right-censoring (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infected_treatment</code></td>
<td>
<p>name of data frame column identifying if data are
from an infected (1) or uninfected (0) treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference_virulence</code></td>
<td>
<p>name of data frame column identifying the
infected treatment to use as a reference when estimating virulence;
value of 1 the reference treatment and 2 for treatment to be compared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1, d2</code></td>
<td>
<p>names of probability distributions describing background
mortality and mortality due to infection, respectively; both default to the
Weibull distribution</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The proportional hazards assumption requires, h1(t) / h2(t) = c,
where h1(t) and h2(t) are two hazard functions at time t,
and c is a constant. In this function the hazard functions for the
increased mortality due to infection are assumed to be proportional for
different infection treatments within the same experiment.
</p>
<p>In the default form, one infected treatment is denoted '1' and used as the
reference treatment for virulence against which the virulence in a second
infected population, '2', is scaled. The default function can be extended
to compare multiple treatments against the reference
(see vignette: Worked examples II)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data01 &lt;- data_lorenz

# create column 'reference_virulence' with values of 1 and 2 when
  # Infectious.dose = 5000 and 160000, respectively, otherwise 0

data01$reference_virulence &lt;- ifelse(data01$g == 0, 0,
 ifelse(data01$g == 1, ifelse(data01$Infectious.dose == 5000, 1,
   ifelse(data01$Infectious.dose == 160000, 2, 0)), 0)
 )

m01_prep_function &lt;- function(
  a1 = a1, b1 = b1, a2 = a2, b2 = b2, theta = theta){
    nll_proportional_virulence(
      a1 = a1, b1 = b1, a2 = a2, b2 = b2, theta = theta,
      data = data01,
      time = t,
      censor = censored,
      infected_treatment = g,
      reference_virulence = reference_virulence,
      d1 = 'Gumbel', d2 = 'Weibull')
      }

m01 &lt;- mle2(m01_prep_function,
  start = list(a1 = 23, b1 = 5, a2 = 4, b2 = 0.2, theta = 1)
  )

summary(m01)

# virulence in the high dose treatment is estimated as
 # ~ 6x greater than in the low dose treatment

</code></pre>


</div>