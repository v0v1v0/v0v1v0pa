<div class="container">

<table style="width: 100%;"><tr>
<td>pimage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display image for projected coordinates</h2>

<h3>Description</h3>

<p><code>pimage</code> plots an image for (potentially) projected locations.
A color scale is automatically provided with the image. The 
function is essentially an extension of the 
<code>image</code> function and the <code>x</code> and 
<code>y</code> locations can be irregularly-spaced locations, sequences 
of increasing values for locations on a regular grid, or matrices 
(with dimensions matching those of <code>z</code>) for locations on an 
irregular grid.  Functionality for automatic projection is 
provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pimage(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  lratio = 0.2,
  map = "none",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric or logical vector or matrix containing the 
values to be plotted (NAs are allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A character string indicating where the color scale 
should be placed.  The default is <code>"horizontal"</code>.  The other
valid options are <code>"none"</code> and <code>"vertical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code>mapproject</code> function, which is used for the
projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A numeric vector specifying the values of the 
<code>parameters</code> argument in the 
<code>mapproject</code>.  This may be necessary when
<code>proj != "none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orientation</code></td>
<td>
<p>A vector <code>c(latitude,longitude,rotation)</code> 
which describes where the "North Pole" should be when computing 
the projection.  See <code>mapproject</code> for more
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the smaller 
dimension of the legend scale to the width of the image.  Default
is <code>lratio = 0.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>The name of the map to draw on the image. Default is 
<code>"none"</code>.  Other options include <code>"world"</code>, 
<code>"usa"</code>, <code>"state"</code>, <code>"county"</code>, <code>"france"</code>, 
<code>"nz"</code> (New Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the 
<code>image</code> or <code>poly.image</code>
functions.  e.g., <code>xlab</code>, <code>ylab</code>, <code>xlim</code>, 
<code>ylim</code>, <code>zlim</code>, etc.  Additionally, arguments that can 
be used to further customize the plot (like adding lines or 
points), as described in Details and Examples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>x</code>, <code>y</code>, and <code>z</code> are numeric vectors of the same
length, then the <code>mba.surf</code> function is used to 
predict the response on a regular grid using multilevel
B-splines before constructing 
the image.  This interpolation can be customized by passing 
<code>interp.args</code> through <code>...</code>.  <code>interp.args</code> should 
be a named list with component matching the non <code>xyz</code>
arguments of the <code>mba.surf</code> function.
</p>
<p>If <code>x</code> are <code>y</code> are vectors of increasing values and 
<code>nrow(z) == length(x)</code> and <code>ncol(z) == length(y)</code>, then 
an image on a regular grid is constructed.
</p>
<p>If <code>x</code>, <code>y</code> and <code>z</code> are matrices with the same 
dimensions, then an image for irregularly gridded data is 
constructed.
</p>
<p>When <code>proj != "none"</code>, the <code>mapproject</code> 
function is used to project the <code>x</code> and <code>y</code> coordinates. 
In that case, <code>proj</code> must correspond to one of the choices for
the <code>projection</code> argument in the 
<code>mapproject</code> function.  Necessary arguments 
for <code>mapproject</code> should be provided via the 
<code>parameters</code> and <code>orientation</code> arguments. See Examples 
and the <code>mapproject</code> function.
</p>
<p>Valid options for <code>legend</code> are <code>"none"</code>, 
<code>"horizontal"</code>, and <code>"vertical"</code>.  If <code>legend = 
"none"</code>, then no color scale is provided.  If <code>legend = 
"horizontal"</code>, then a color scale is included under the image.  If 
<code>legend = "vertical"</code>, then a color scale is added to the 
right of the image.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code>lines</code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code>points</code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code>text</code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list 
corresponding to the arguments of the <code>axis</code> 
function.  See Examples.
</p>
<p>The image axes can be modified by passing <code>axis.args</code> through
<code>...</code>.  The argument should be a named list corresponding to
the arguments of the <code>axis</code> function.  The
exception to this is that arguments <code>xat</code> and <code>yat</code> can
be specified (instead of <code>at</code>) to specify the location of the
x and y ticks.  If <code>xat</code> or <code>yat</code> are specified, then
this overrides the <code>xaxt</code> and <code>yaxt</code> arguments,
respectively.  See the <code>paxes</code> function to
see how <code>axis.args</code> can be used.
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code> to
<code>pimage</code> through <code>...</code>.  This should be a numeric vector
indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples.  After plotting, <code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code>image</code>, 
<code>image.plot</code>, <code>axis</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># image plot for data on an irregular grid
pimage(lon, lat, tasmax[,,1], legend = "h", map = "world")
# same plot but with projection and vertical legend
pimage(lon, lat, tasmax[,,1], legend = "v", map = "world", 
       proj = "bonne", parameters = 45)
# different projection
pimage(lon, lat, tasmax[,,1], proj = "albers",
       parameters = c(33, 45), map = "world")

reset.par() # reset graphics device
# image plot for non-gridded data
data(co, package = "gear")
pimage(co$longitude, co$latitude, co$Al)

# show observed locations on image,
# along with Colorado border, locations of Denver and Colorado 
# Springs
data(copoly)
copoints &lt;- list(x = co$lon, y = co$lat)
pimage(co$longitude, co$latitude, co$Al, 
       lines = copoly, 
       lines.args = list(lwd = 2, col = "grey"),
       points = copoints, 
       points.args = list(pch = 21, bg = "white"),
       text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                   labels = c("Denver", "Colorado Springs")), 
       text.args = list(col = "purple"),
       xlim = c(-109.1, -102),
       ylim = c(36.8, 41.1))

# image plot for data on irregular grid
# notice the poor axis labeling
data(narccap)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world")
# same plot but customize axis labeling 
# need to extend horizontally-running axis lines
# farther to the west and east
# also need the vertically-running lines
# to run further north/sount
# will need manual adjusting depending on size
# of current device 
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world", 
       xaxp = c(-200, 0, 10), yaxp = c(-10, 80, 9))

# the same effect can be acheived by specifying axis.args
# we also modify the color and size of the axis labels
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world", 
       axis.args = list(xat = seq(-200, 0, by = 20),
                        yat = seq(0, 70, by = 10),
                        col.axis = "blue", 
                        cex.axis = 0.5))

# modify colors of legend, map, line type for grid lines
# and customize axis
pimage(lon, lat, tasmax[,,1], 
       legend = "v", proj = "bonne", parameters = 45,
       map = "state",
       paxes.args = list(lty = 3),
       legend.axis.args = list(col = "blue", col.axis = "blue"),
       col = fields::tim.colors(64),
       xlab = "longitude",
       ylab = "latitude",
       main = "temperature (K)")
reset.par() # reset graphics device

# change many aspects of plot appearance using par
par(cex.axis = 0.5, cex.lab = 0.5, mgp = c(1.5, 0.5, 0),
    mar = c(2.1, 2.1, 4.1, 0.2), col.axis = "orange",
    col.main = "blue", family = "mono")
pimage(lon, lat, tasmax[,,1])
title("very customized plot")
reset.par()

</code></pre>


</div>