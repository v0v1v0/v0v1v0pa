<div class="container">

<table style="width: 100%;"><tr>
<td>directional.response</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Directional indices of community change</h2>

<h3>Description</h3>

<p>Compute directional indices of community change along coenoclines or time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">directional.response(mat, method = "overlap", relativize = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>A community composition data matrix with sites in rows and species 
in columns. The direction of the physical process is indicated by the order of the 
sampling units in <code>mat</code>. The class of <code>mat</code> can be either <code>data.frame</code> 
or <code>matrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of the 11 calculation methods available in the function:
<code>"overlap"</code>, <code>"gain"</code>, <code>"loss"</code>, <code>"gaining.turnover"</code>, 
<code>"neutral.turnover"</code>, <code>"losing.turnover"</code>, <code>"gaining.nestedness"</code>, 
<code>"neutral.nestedness"</code>, <code> "losing.nestedness"</code>, 
<code>"gaining.strict.nestedness"</code>, <code>"losing.strict.nestedness"</code>. 
The default value is <code>method="overlap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relativize</code></td>
<td>
<p>Compute relativized indices: <code>relativize="J"</code> for the
Jaccard denominator (a+b+c) or <code>relativize="S"</code> for the Sorensen denominator 
(2*a+b+c). If <code>relativize=NULL</code>, the index is not divided by a denominator.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output matrix is non-symmetric, meaning that its upper triangle is not the mirror 
image of the lower triangle. Given the direction of the physical process through space 
or time indicated by the order of the sampling units, the output matrix <code>mat.out</code> 
reflects that direction in its non-symmetric presentation, <em>From</em> (rows of the 
matrix) <em>To</em> (columns of the matrix). Users of the function can extract one or the 
other of these triangular portions and analyse them separately. See Appendix xx for 
examples.
</p>


<h3>Value</h3>

<p>A list containing the following results: </p>
 <ul><li>
<p><code>mat.out</code>: A square matrix with the chosen index computed among the sites.
Depending on the method chosen, this matrix may be symmetric or non-symmetric.
<code>total.t</code>: methods  #4 to 6, a matrix with total turnover (b+c); else NA.
<code>total.n</code>: For methods #7 to 9, a matrix with total nestedness a+abs(b-c) 
if a&gt;0; else NA.
<code>total.strict.n</code>: For methods #10 and 11, a matrix with total strict nestedness 
a+abs(b-c) if a&gt;0 and b!=c; else NA.
<code>den</code>: For calculation results with Jaccard or Sorensen denominators: 
a square matrix of denominators. If <code>relativize=NULL</code>, <code>den=NA</code>. </p>
</li></ul>
<h3>Author(s)</h3>

<p>Dénes Schmera <a href="mailto:schmera.denes@blki.hu">schmera.denes@blki.hu</a> 
and Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>
</p>


<h3>References</h3>

<p>Schmera, D., P. Legendre, T. Eros, M. Toth, E. K. Magyari, B. Baur and J. Podani. 
2022. New measures for quantifying directional changes in presence-absence community 
data. Ecological Indicators 136: 108618. https://doi.org/10.1016/j.ecolind.2022.108618
</p>
<p>Verneaux, J. (1973) <em>Cours d'eau de Franche-Comté (Massif du Jura). 
Recherches écologiques sur le réseau hydrographique du Doubs. Essai de biotypologie</em>. 
Thèse d'État, Besançon. 1–257.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Artificial Example
art &lt;- c(1,1,1,0,0,0,
         0,0,0,1,1,0,
         0,0,0,0,0,1)
art.data &lt;- matrix(art, nrow=3, ncol=6, byrow=TRUE)

art.out &lt;- directional.response(art.data, method="overlap",relativize=NULL)

# Real data example: the Doubs River fish data (Verneaux 1973), available in ade4.
# 30 sites, 27 species. No fish had been caught at site 8; remove that site
if(require("ade4", quietly = TRUE)) {

data(doubs)
dim(doubs$fish)   
fish &lt;- doubs$fish[-8,] 
dim(fish)
doubs.out &lt;- directional.response(fish, method="gain", relativize="S")
}

</code></pre>


</div>