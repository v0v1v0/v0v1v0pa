<div class="container">

<table style="width: 100%;"><tr>
<td>enfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ecological Niche Factor Analysis</h2>

<h3>Description</h3>

<p><code>enfa</code> performs an Ecological Niche Factor Analysis.
<code>hist.enfa</code> draws histograms of the row scores or of the initial
variables of the ENFA.
</p>


<h3>Usage</h3>

<pre><code class="language-R">enfa(dudi, pr, scannf = TRUE, nf = 1)
## S3 method for class 'enfa'
hist(x, scores = TRUE, type = c("h", "l"), adjust = 1,
                    Acol, Ucol, Aborder, Uborder, Alwd = 1, Ulwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudi</code></td>
<td>
<p>a duality diagram, object of class <code>dudi</code> (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>a vector giving the utilization weights associated to each unit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues barplot should be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept
specialization axes </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>enfa</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the histograms display
the row scores of the ENFA.  If <code>FALSE</code>, they display the
niche on the environmental variables (in this case, this is equivalent to
<code>histniche</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>what type of plot should be drawn.  Possible types are:<br><code>"h"</code> for histograms,<br><code>"l"</code> for kernel density estimates (see <code>?density</code>).<br>
By default, <code>type = "h"</code> is used.  If <code>type = "l"</code> is used,
the position of the mean of each distribution is indicated by dotted
lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>if <code>type = "l"</code>, a parameter used to control the
bandwidth of the density estimates (see <code>?density</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Acol</code></td>
<td>
<p>if <code>type = "h"</code>, a color to be used to fill the histogram
of the available pixels. if <code>type = "l"</code>, a color to be used for the
kernel density estimates of the available pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ucol</code></td>
<td>
<p>if <code>type = "h"</code>, a color to be used to fill the histogram
of the used pixels. if <code>type = "l"</code>, a color to be used for the
kernel density estimates of the used pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aborder</code></td>
<td>
<p>color for the border of the histograms of the available
pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Uborder</code></td>
<td>
<p>color for the border of the histograms of the used
pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Alwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the available pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ulwd</code></td>
<td>
<p>if <code>type = "l"</code>, the line width of the kernel density 
estimates of the used pixels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The niche concept, as defined by Hutchinson (1957), considers the
ecological niche of a species as an hypervolume in the multidimensional
space defined by environmental variables, within
which the populations of a species can persist.  The Ecological Niche
Factor Analysis (ENFA) has been developped by Hirzel et al. (2002) to
analyse the position of the niche in the ecological space.  Nicolas
Perrin (1984) described the position of the niche in the n-dimensional
space using two measures: the M-specialization (hereafter termed marginality)
and the S-specialization (hereafter termed specialization).  The
marginality represents the squared distance of the niche barycentre from
the mean available habitat.  A large specialization corresponds to a
narrow niche relative to the habitat conditions available to the species.
</p>
<p>The ENFA first extracts an axis of marginality (vector from the average
of available habitat conditions to the average used habitat conditions).
Then the analysis extracts successives orthogonal axes (i.e. uncorrelated),
which maximises the specialization of the species.  The calculations
used in the function are described in Hirzel et al. (2002).
</p>
<p>The function <code>enfa</code> can be used on both quantitative variables and
qualitative variables (though the interpretation of the results of the
ENFA for qualitative variables is still under research), provided that
the table containing the values of habitat variables (columns) for
each resource unit (rows) is correctly transformed
(e.g. column-centered and standardised for tables containing only
quantitative variables), and that appropriate column weights are given
(e.g. the sum of the weights for
the levels of a factor should be the same as the weight of one
quantitative variable). Therefore, the function <code>enfa</code> requires
that a preliminary multivariate analysis is performed on the table
(using analysis of the family of duality diagram, e.g. principal
component analysis or Hill and Smith analysis). The object returned
by this preliminary analysis contains the appropriate weights and
transformation of the original data frame. For example, 
the function <code>dudi.mix</code> can be used first on the data.frame
containing the value of both quantitative (e.g. slope, elevation) and
qualitative habitat variables (e.g. vegetation) for each pixel of a
raster map. The result of this analysis can then be passed as argument
to the function <code>enfa</code> (see examples below).<br></p>


<h3>Value</h3>

<p><code>enfa</code> returns a list of class <code>enfa</code> containing the
following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>original call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>a vector of length n containing the number of points in each
pixel of the map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>the number of kept specialization axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>the marginality (squared length of the marginality vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>row weights, a vector with n components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>li</code></td>
<td>
<p>row coordinates, data frame with n rows and nf columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw</code></td>
<td>
<p>column weights, a vector with p components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>column coordinates, data frame with p rows and nf columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>coordinates of the marginality vector.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mathieu Basille <a href="mailto:basille@ase-research.org">basille@ase-research.org</a> </p>


<h3>References</h3>

<p>Hutchinson, G.E. (1957) Concluding Remarks. <em>Cold Spring Harbor
Symposium on Quantitative Biology</em>, <b>22</b>: 415–427. 
</p>
<p>Perrin, N. (1984) Contribution a l'ecologie du genre Cepaea
(Gastropoda) : Approche descriptive et experimentale de l'habitat et
de la niche ecologique. These de Doctorat. Universite de Lausanne,
Lausanne. 
</p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. and Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat-suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027–2036.
</p>
<p>Basille, M., Calenge, C., Marboutin, E., Andersen, R. and Gaillard,
J.M. (2008) Assessing habitat selection using multivariate statistics:
Some refinements of the ecological-niche factor
analysis. <em>Ecological Modelling</em>, <b>211</b>, 233–240.
</p>


<h3>See Also</h3>

<p><code>niche</code>, <code>kselect</code> for other types of
analysis of the niche, when several species are under studies,
and <code>scatter.enfa</code> to have a
graphical display of objects of class
<code>enfa</code>.  See <code>madifa</code> for another factorial analysis of
the ecological niche.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(lynxjura)

map &lt;- lynxjura$map

## We keep only "wild" indices.
locs &lt;- lynxjura$locs
locs &lt;- locs[slot(locs, "data")[,2]!="D",]

hist(map, type = "l")
## The variable artif is far from symetric

## We perform a square root transformation
## of this variable
## We therefore normalize the variable 'artif'
slot(map,"data")[,4] &lt;- sqrt(slot(map,"data")[,4])
hist(map, type = "l")

## We prepare the data for the ENFA
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]


## We then perform the PCA before the ENFA
pc &lt;- dudi.pca(tab, scannf = FALSE)

## The object 'pc' contains the transformed table (i.e.
## centered so that all columns have a mean of 0
## and scaled so that all columns have a variance of 1
## 'pc' also contains the weights of the habitat variables,
## and the weights of the pixels in the analysis

(enfa1 &lt;- enfa(pc, pr,
               scannf = FALSE))
hist(enfa1)
hist(enfa1, scores = FALSE, type = "l")


## scatterplot
scatter(enfa1)


## randomization test
## Not run: 
(renfa &lt;- randtest(enfa1))
plot(renfa)

## End(Not run)

</code></pre>


</div>