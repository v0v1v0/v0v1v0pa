<div class="container">

<table style="width: 100%;"><tr>
<td>filter.ampliconduo.set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
AmpliconDuo List Amplicon Filter
</h2>

<h3>Description</h3>

<p>Marks or removes amplicons from each ampliconduo data frame in a list according to the specified filter criteria.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter.ampliconduo.set(x, min.freq = 1, OR = NULL, q = NULL, p = NULL, remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>List of ampliconduo data frames, return value of an <code>ampliconduo</code> call.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.freq</code></td>
<td>

<p>Optional. Integer, minimium frequency/read count for a given amplicon in each of the two amplicon sets of an ampliconduo to be retained.
Default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR</code></td>
<td>

<p>Optional. Numeric, minimum odds ratio for an amplicon to be retained. 
If no value is specified the odds ratio is excluded from the filter criteria.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>Optional. Numeric, minimum value for <code>q</code>, the adjusted p-value foran amplicon to pass the filter. 
If no value is specified, <code>q</code> is excluded from the filter criteria.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>Optional. Numeric, minimum p-value for an amplicon to pass the filter.
If no value for <code>p</code> is specified <code>p</code> is excluded from the filter criteria.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove</code></td>
<td>

<p>Optional. Logical, decides whether amplicons that fail the filter criteria should be removed (<code>TRUE</code>),
or retained (<code>FALSE</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For every <code>ampliconduo</code> data frame in argument <code>x</code>, applies
each filter criterion that was specified to each amplicon.
If an amplicon <em>i</em> fails any of the applied criteria, the logical value in column <code>rejected</code> in row <em>i</em> is set to <code>TRUE</code>.
In case the parameter <code>remove</code> was set to <code>TRUE</code>, all amplicons with <code>rejected = TRUE</code> are removed. The position information in respect to the data used as input for the <code>ampliconduo</code> call are kept.
This method uses the function <code>filter.ampliconduo</code>.
</p>


<h3>Value</h3>

<p>List of ampliconduo data frames. Same as input parameter <code>x</code> but with the adjustments in the <code>rejected</code> column according to the specified filter criteria, or removed rows (<code>removed = TRUE</code>)
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code>filter.ampliconduo</code>, performs filtering on single ampliconduo data.frames, is called by this method.
</p>
<p><code>ampliconduo</code>, generates the input data <code>x</code> for this method.
</p>
<p><code>accepted.amplicons</code>, returns the indices of amplicons that
have passed the filter criteria.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load example data
data(amplicons)

## apply filter criteria
ampliconduos.f &lt;- filter.ampliconduo.set(amplicons)
ampliconduos.f &lt;- filter.ampliconduo.set(amplicons, min.freq = 3, remove = TRUE)

## to return a list with the indices (corresponding to the indices of the data 
## the ampliconduo function was called on) of all amplicons that passed the filter criteria 
good.reads &lt;- accepted.amplicons(ampliconduos.f)
</code></pre>


</div>