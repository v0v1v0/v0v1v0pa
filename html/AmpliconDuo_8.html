<div class="container">

<table style="width: 100%;"><tr>
<td>discordance.delta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Measure Of Discordance Between Two Amplicon Data Sets 
</h2>

<h3>Description</h3>

<p>Calculates delta (<code class="reqn">\Delta</code>) and delta prime (<code class="reqn">\Delta'</code>), the fraction of amplicon frequencies and amplicons, respectively, with a false discovery rate below a certain threshold <code class="reqn">\theta</code> as a measure of discordance between two amplicon data sets A and B.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discordance.delta(x, names = NULL, theta = 0.05, corrected = TRUE,
printToTex = FALSE, directory = NULL, file.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A list of amplicon duo data frames as returned by the <code>ampliconduo</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>

<p>Optional. Vector or list of characters specifying the sample/amplicon pair names. By default 
names are taken from the element names of <code>x</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>Optional. Numeric, threshold for the false discovery rate. Default value is 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected</code></td>
<td>

<p>Optional. Logical, indicates whether the p-value from Fisher's exact test (FALSE) or the 
adjusted p-value (TRUE), here called q, is used for calculation of <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printToTex</code></td>
<td>

<p>Optional. Logical, if <code>TRUE</code> writes a file with the resulting table in Tex format. Default is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directory</code></td>
<td>

<p>Optional. If <code>printToTex</code> is <code>TRUE</code>, the output file will be saved in the specified directory.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>

<p>Optional. If <code>printToTex</code> is <code>TRUE</code>, the output file will have the name <code>file.name</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code>, the fraction of frequencies of amplicons and amplicons, respectively, with false discovery rate below a certain threshold <code class="reqn">\theta</code> as a measure of discordance between two amplicon data sets A and B with occurence <code class="reqn">r_{(iAS)}</code> of amplicon <em>i</em> in amplicon set A of sample S (the ampliconduo data frame).
<code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code> are defined as follows:
</p>
<p style="text-align: center;"><code class="reqn"> 
  \Delta_{S\theta}  = \frac{\sum_{i=1}^{n_S}(r_{iAS}+r_{iBS})\delta(q_{iS}&lt;\theta)}{\sum_{i=1}^{n_S}(r_{iAS}+r_{iBS})}\\
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \Delta'_{S\theta} = \frac{\sum_{i=1}^{n_S}\delta(q_{iS}&lt;\theta)}{n_S},\\
</code>
</p>

<p style="text-align: center;"><code class="reqn">
  \mathrm{with\;} \delta(q_{iS}&lt;\theta) =
  \left\{
  \begin{array}{cc}
  1 &amp; \mathrm{\;for\;} q_{iS} &lt; \theta\\
  0 &amp; \mathrm{\;for\;} q_{iS} \ge \theta
  \end{array}
  \right. 
</code>
</p>

<p><img src="../help/figures/discordanceDelta.png" width="400" alt="discordanceDelta.png"></p>
<p>for number <code class="reqn">n_S</code> of amplicons detected in sample/ampliconduo S. <code class="reqn">\Delta_{S\theta}</code> and <code class="reqn">\Delta'_{S\theta}</code> are located between 0 (no discordance, i.e. no statistically significant deviations between experimental branches) and 1 (complete discordance).
</p>
<p><code>x</code> is the return value of a <code>ampliconduo</code> call.
</p>


<h3>Value</h3>

<p>Data frame with three columns. The first column contains the sample/amplicon pair names. Second and third column 
harbor the corresponding <code class="reqn">\Delta</code> and <code class="reqn">\Delta'</code> values, respectively.
</p>


<h3>Author(s)</h3>

<p>Anja Lange
&amp;
Daniel Hoffmann
</p>


<h3>See Also</h3>

<p><code>ampliconduo</code>, generates the expected data format for <code>x</code>
</p>
<p><code>xtable</code>, used to convert the returned data frame into a <code>Latex</code> table.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load example ampliconduo data frame
data(amplicons)

## calculate the discordance between amplicon data sets of an ampliconduo data frame
dd.a &lt;- discordance.delta(amplicons)
dd.b &lt;- discordance.delta(amplicons, theta = 0.1)
</code></pre>


</div>