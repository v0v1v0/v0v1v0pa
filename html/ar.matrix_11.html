<div class="container">

<table style="width: 100%;"><tr>
<td>sim.AR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate correlated data from a precision matrix.</h2>

<h3>Description</h3>

<p>Takes in a square precision matrix, which ideally should be
sparse and using Choleski factorization simulates data from a mean 0 process
where the inverse of the precision matrix represents the variance-covariance
of the points in the process. The resulting simulants represent samples of a
Gaussian Markov random field (GMRF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.AR(n, Q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>int &gt; 0, number of observations to simulate from the GMRF.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>matrix, a square precision matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix object, matrix where each row is a single obsrevation from
a GMRF with covariance structure Q^-1.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("ggplot2")

# simulate 2D ar1 process
# pairwise correlation
rho &lt;- .95
# pairwise variance
sigma &lt;- .5

# 2 dimensions of simulations
years &lt;- 20
ages &lt;- 10

# kronnecker product to get joint covariance
Q2D &lt;- kronecker(Q.AR1(M=years, sigma, rho), Q.AR1(M=ages, sigma, rho))

# simulate the data and place it in a data frame
Q2D.df &lt;- data.frame(obs=c(sim.AR(1, Q2D)), age=rep(1:ages, years),
                     year=rep(1:years, each=ages))

# graph results
ggplot(data=Q2D.df, aes(year, obs, group=age, color=age)) + geom_line()

</code></pre>


</div>