<div class="container">

<table style="width: 100%;"><tr>
<td>posterior</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior decoding.</h2>

<h3>Description</h3>

<p>Calculate the posterior probability of a sequence given a model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">posterior(x, y, ...)

## S3 method for class 'HMM'
posterior(x, y, logspace = "autodetect", cpp = TRUE, ...)

## S3 method for class 'PHMM'
posterior(x, y, logspace = "autodetect", cpp = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>'HMM'</code> or <code>'PHMM'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of mode "character" or "raw" (a "DNAbin" or "AAbin"
object) representing a single sequence hypothetically emitted by
the model in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed between methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logspace</code></td>
<td>
<p>logical indicating whether the emission and transition
probabilities of x are logged. If <code>logspace = "autodetect"</code>
(default setting), the function will automatically detect
if the probabilities are logged, returning an error if
inconsistencies are found. Note that choosing the latter option
increases the computational overhead; therefore specifying
<code>TRUE</code> or <code>FALSE</code> can reduce the running time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpp</code></td>
<td>
<p>logical, indicates whether the dynamic programming matrix
should be filled using compiled C++ functions (default; many times faster).
The R version is primarily retained for bug-fixing and experimentation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Durbin et al (1998) chapter 3.2 for details on the calculation
and interpretation of posterior state probabilities.
Currently no method is available for profile HMMs, but this may be
included in a future version if required.
</p>


<h3>Value</h3>

<p>a vector, matrix or array of posterior probabilities.
</p>


<h3>Author(s)</h3>

<p>Shaun Wilkinson
</p>


<h3>References</h3>

<p>Durbin R, Eddy SR, Krogh A, Mitchison G (1998) Biological
sequence analysis: probabilistic models of proteins and nucleic acids.
Cambridge University Press, Cambridge, United Kingdom.
</p>


<h3>See Also</h3>

<p><code>forward</code>, <code>backward</code>, <code>Viterbi</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Posterior decoding for standard hidden Markov models
  ## The dishonest casino example from Durbin et al (1998) chapter 3.2
  states &lt;- c("Begin", "Fair", "Loaded")
  residues &lt;- paste(1:6)
  ### Define the transition probability matrix
  A &lt;- matrix(c(0, 0, 0, 0.99, 0.95, 0.1, 0.01, 0.05, 0.9), nrow = 3)
  dimnames(A) &lt;- list(from = states, to = states)
  ### Define the emission probability matrix
  E &lt;- matrix(c(rep(1/6, 6), rep(1/10, 5), 1/2), nrow = 2, byrow = TRUE)
  dimnames(E) &lt;- list(states = states[-1], residues = residues)
  ### Build and plot the HMM object
  x &lt;- structure(list(A = A, E = E), class = "HMM")
  plot(x, main = "Dishonest casino HMM")
  ### Calculate posterior probabilities
  data(casino)
  casino.post &lt;- posterior(x, casino)
  plot(1:300, casino.post[1, ], type = "l", xlab = "Roll number",
       ylab = "Posterior probability of dice being fair",
       main = "The dishonest casino")
</code></pre>


</div>