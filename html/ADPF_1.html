<div class="container">

<table style="width: 100%;"><tr>
<td>ADPF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adaptive Degree Polynomial Filter [ADPF]</h2>

<h3>Description</h3>

<p>ADPF outputs a <code>data.frame</code> containing a column for the original data, the polynomial degree used to smooth it, and the requested derivative(s).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ADPF(YData, SthDeriv,MaxOrder,FilterLength, DeltaX, WriteFile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>YData</code></td>
<td>
<p>a numeric <code>data.frame</code>, <code>matrix</code> or <code>vector</code> to transform</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SthDeriv</code></td>
<td>
<p>differentiation order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxOrder</code></td>
<td>
<p>maximum polynomial order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FilterLength</code></td>
<td>
<p>window size (must be odd)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DeltaX</code></td>
<td>
<p>optional sampling interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WriteFile</code></td>
<td>
<p>a boolean that writes a <code>data.frame</code> to the working directory if true</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a code listing of a smoothing algorithm published in 1995 and written by Phillip Barak. ADPF modifies the Savitzky-Golay algorithm with a statistical heurism that increases signal fidelty while decreasing statisical noise.
Mathematically, it operates simply as a weighted sum over a given window:
</p>
<p style="text-align: center;"><code class="reqn">f_{t}^{n,s}=\sum{_{i=-m}^{m} h_{i}^{n,s,t}y_{i}}</code>
</p>

<p>Where <code class="reqn">h_{i}^{n,s,t}</code> is the convolution weight of the <code class="reqn">i</code>th point to the evaluate the <code class="reqn">s</code>th derivative at point <code class="reqn">t</code> using a polynomial of degree <code class="reqn">n</code>
on 2<code class="reqn">m+1</code> data points, <code class="reqn">y</code>. These convolution weights <code class="reqn">h</code> are calculated using Gram polynomials which are optimally selected using a <code class="reqn">F_{chi}</code> test.
This improves upon the signal fidelity of Savitzky-Golay by optimally choosing the Gram polynomial degree between zero and the max polynomial order give by the user while removing statistical noise.
The sampling interval specified with the <code>DeltaX</code> argument is used for scaling and get numerically correct derivatives. For more details on the statistical heurism see the Barak, 1995 article. This can be found at http://soils.wisc.edu/facstaff/barak/ under the publications section.
</p>


<h3>Author(s)</h3>

<p>Phillip Barak
</p>
<p>Samuel Kruse
</p>


<h3>References</h3>

<p>Barak, P., 1995. Smoothing and Differentiation by and Adaptive-Degree Polynomial filter; Anal. Chem. 67, 2758-2762.
</p>
<p>Marchand, P.; Marmet, L. Rev. Sci. Instrum. 1983, 54, 1034-1041.
</p>
<p>Greville, T. N. E., Ed. Theory and Applications of Spline Functions; Academic Press: New York, 1969.
</p>
<p>Press, W. H.; Flannery, B. P.; Teukolsky, S. A.;Vetterling. W. T. Numerical Recipes; Cambridge University Press: Cambridge U.K., 1986.
</p>
<p>Savitzky, A., and Golay, M. J. E., 1964. Smoothing and differentiation of data by simplified least squares procedures. Anal. Chem. 36, 1627-1639.
</p>
<p>Macauly, F. R. The Smoothing of Time Series; National Bureau of Economic Research, Inc,: New York, 1931.
</p>
<p>Gorry, P. A. Anal. Chem. 1964, 36,1627-1639.
</p>
<p>Steiner, J.; Termonia, Y.; Deltour, J. Anal. Chem. 1972, 44. 1906-1909.
</p>
<p>Ernst, R. R. Adv. magn. Reson. 1966, 2,1-135.
</p>
<p>Gorry P. A. Anal. Chem. 1991, 64, 534-536.
</p>
<p>Ratzlaff, K. L.; Johnson, J. T. Adal. Chem. 1989, 61, 1303-1305.
</p>
<p>Kuo, J. E.; Wang, H.; Pickup, S. Anal. Chem. 1991, 63,630-645.
</p>
<p>Enke, C. G; Nieman, T. A. Anal. Chm 1976, 48, 705A-712A.
</p>
<p>Phillips, G. R., Harris, J. M. Anal. Chem. 1990, 62, 2749-2752.
</p>
<p>Duran, B.S. Polynomial Regression. In Encyclopedia of the Statistical Sciences, Kotz, S., Johnsonn N. L., Eds.; Wiley: New York, 1986; Vol. 7, pp 700-703.
</p>
<p>Bevington, P. R. Data Reduction and Error Analysis for the Physical Sciences; McGraw-Hill Book Co,: New York, 1969; Chapter 10.
</p>
<p>Snedecor, G. W.; Cochran, W. G. Statistical Methods, 6th ed.; Iowa State University Press: Ames, IA, 1967; Chapter 15.
</p>
<p>Hanning, R. W. Digital Filters, 2nd ed.; Prentice-Hall: Englewood Cliffs, NJ, 1983; Chapter 3.
</p>
<p>Ralston, A. A First Course in Numerical Analysis McGraw-Hill: New York, 1965; Chapter 6.
</p>
<p>Robert De Levie. 2008. Advanced Excel for Scientific data analysis. 2nd edn. Chapter 3.15 Least squares for equidistant data. Oxford Univ. Press, New York, NY.
</p>
<p>Wentzell, P. D., and Brown, C. D., 2000. Signal processing in analytical chemistry. Encyclopedia of Analytical Chemistry, 9764-9800.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ADPF::CHROM

smooth&lt;-ADPF(CHROM[,6],0,9,13)
numpoints=length(CHROM[,6])
plot(x=1:numpoints,y=CHROM[,6]);lines(x=1:numpoints, y=smooth[,3])
</code></pre>


</div>