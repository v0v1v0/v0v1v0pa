<div class="container">

<table style="width: 100%;"><tr>
<td>apd_similarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Applicability domain methods using binary similarity analysis</h2>

<h3>Description</h3>

<p><code>apd_similarity()</code> is used to analyze samples in terms of similarity scores
for binary data. All features in the data should be binary (i.e. zero or
one).
</p>


<h3>Usage</h3>

<pre><code class="language-R">apd_similarity(x, ...)

## Default S3 method:
apd_similarity(x, quantile = NA_real_, ...)

## S3 method for class 'data.frame'
apd_similarity(x, quantile = NA_real_, ...)

## S3 method for class 'matrix'
apd_similarity(x, quantile = NA_real_, ...)

## S3 method for class 'formula'
apd_similarity(formula, data, quantile = NA_real_, ...)

## S3 method for class 'recipe'
apd_similarity(x, data, quantile = NA_real_, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Depending on the context:
</p>

<ul>
<li>
<p> A <strong>data frame</strong> of binary predictors.
</p>
</li>
<li>
<p> A <strong>matrix</strong> of binary predictors.
</p>
</li>
<li>
<p> A <strong>recipe</strong> specifying a set of preprocessing steps
created from <code>recipes::recipe()</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options to pass to <code>proxyC::simil()</code>, such as <code>method</code>. If no
options are specified, <code>method = "jaccard"</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile</code></td>
<td>
<p>A real number between 0 and 1 or NA for how the similarity
values for each sample versus the training set should be summarized. A value
of <code>NA</code> specifies that the mean similarity is computed. Otherwise, the
appropriate quantile is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula specifying the predictor terms on the right-hand
side. No outcome should be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>When a <strong>recipe</strong> or <strong>formula</strong> is used, <code>data</code> is specified as:
</p>

<ul><li>
<p> A <strong>data frame</strong> containing the binary predictors. Any predictors with
no 1's will be removed (with a warning).
</p>
</li></ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes measures of similarity for different samples
points. For example, suppose samples <code>A</code> and <code>B</code> both contain <em>p</em> binary
variables. First, a 2x2 table is constructed between <code>A</code> and <code>B</code> <em>across
their elements</em>. The table will contain <em>p</em> entries across the four cells
(see the example below). From this, different measures of likeness are
computed.
</p>
<p>For a training set of <em>n</em> samples, a new sample is compared to each,
resulting in <em>n</em> similarity scores. These can be summarized into a single
value; the median similarity is used by default by the scoring function.
</p>
<p>For this method, the computational methods are fairly taxing for large data
sets. The training set must be stored (albeit in a sparse matrix format) so
object sizes may become large.
</p>
<p>By default, the computations are run in parallel using <em>all possible
cores</em>. To change this, call the <code>setThreadOptions</code> function in the
<code>RcppParallel</code> package.
</p>


<h3>Value</h3>

<p>A <code>apd_similarity</code> object.
</p>


<h3>References</h3>

<p>Leach, A. and Gillet V. (2007). <em>An Introduction to
Chemoinformatics</em>. Springer, New York
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(qsar_binary)

jacc_sim &lt;- apd_similarity(binary_tr)
jacc_sim

# plot the empirical cumulative distribution function (ECDF) for the training set:
library(ggplot2)
autoplot(jacc_sim)

# Example calculations for two samples:
A &lt;- as.matrix(binary_tr[1, ])
B &lt;- as.matrix(binary_tr[2, ])
xtab &lt;- table(A, B)
xtab

# Jaccard statistic
xtab[2, 2] / (xtab[1, 2] + xtab[2, 1] + xtab[2, 2])

# Hamman statistic
((xtab[1, 1] + xtab[2, 2]) - (xtab[1, 2] + xtab[2, 1])) / sum(xtab)

# Faith statistic
(xtab[1, 1] + xtab[2, 2] / 2) / sum(xtab)

# Summarize across all training set similarities
mean_sim &lt;- score(jacc_sim, new_data = binary_unk)
mean_sim

</code></pre>


</div>