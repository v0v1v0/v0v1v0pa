<div class="container">

<table style="width: 100%;"><tr>
<td>setPheno</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set phenotypes</h2>

<h3>Description</h3>

<p>Sets phenotypes for all traits by adding random error
from a multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setPheno(
  pop,
  h2 = NULL,
  H2 = NULL,
  varE = NULL,
  corE = NULL,
  reps = 1,
  fixEff = 1L,
  p = NULL,
  onlyPheno = FALSE,
  traits = NULL,
  simParam = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>an object of <code>Pop-class</code> or
<code>HybridPop-class</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2</code></td>
<td>
<p>a vector of desired narrow-sense heritabilities for
each trait. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>a vector of desired broad-sense heritabilities for
each trait. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varE</code></td>
<td>
<p>error (co)variances for traits. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corE</code></td>
<td>
<p>an optional matrix for correlations between errors.
See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>number of replications for phenotype. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixEff</code></td>
<td>
<p>fixed effect to assign to the population. Used
by genomic selection models only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the p-value for the environmental covariate
used by GxE traits. If NULL, a value is
sampled at random.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyPheno</code></td>
<td>
<p>should only the phenotype be returned, see return</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traits</code></td>
<td>
<p>an integer vector indicate which traits to set. If NULL,
all traits will be set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simParam</code></td>
<td>
<p>an object of <code>SimParam</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are three arguments for setting the error variance of a
phenotype: h2, H2, and varE. The user should only use one of these
arguments. If the user supplies values for more than one, only one
will be used according to order in which they are listed above.
</p>
<p>The h2 argument allows the user to specify the error variance
according to narrow-sense heritability. This calculation uses the
additive genetic variance and total genetic variance in the founder
population. Thus, the heritability relates to the founder population
and not the current population.
</p>
<p>The H2 argument allows the user to specify the error variance
according to broad-sense heritability. This calculation uses the
total genetic variance in the founder population. Thus, the heritability
relates to the founder population and not the current population.
</p>
<p>The varE argument allows the user to specify the error variance
directly. The user may supply a vector describing the error variance
for each trait or supply a matrix that specify the covariance of
the errors.
</p>
<p>The corE argument allows the user to specify correlations for the
error covariance matrix. These correlations are be supplied in addition
to the h2, H2, or varE arguments. These correlations will be used to
construct a covariance matrix from a vector of variances. If the user
supplied a covariance matrix to varE, these correlations will supercede
values provided in that matrix.
</p>
<p>The reps parameter is for convenient representation of replicated data.
It is intended to represent replicated yield trials in plant
breeding programs. In this case, varE is set to the plot error and
reps is set to the number of plots per entry. The resulting phenotype
represents the entry-means.
</p>


<h3>Value</h3>

<p>Returns an object of <code>Pop-class</code> or
<code>HybridPop-class</code> if onlyPheno=FALSE, if
onlyPheno=TRUE a matrix is returned
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create founder haplotypes
founderPop = quickHaplo(nInd=10, nChr=1, segSites=10)

#Set simulation parameters
SP = SimParam$new(founderPop)

SP$addTraitA(10)

#Create population
pop = newPop(founderPop, simParam=SP)

#Add phenotype with error variance of 1
pop = setPheno(pop, varE=1)

</code></pre>


</div>