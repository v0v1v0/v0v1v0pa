<div class="container">

<table style="width: 100%;"><tr>
<td>apc.polygon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add connected line and standard deviation polygons to a plot</h2>

<h3>Description</h3>

<p>Draws a line for point forecasts and adds shaded region for forecast distribution around it. This is added to a plot in the same way as
<code>lines</code> and <code>polygon</code> add lines and polygons to a plot.</p>


<h3>Usage</h3>

<pre><code class="language-R">apc.polygon(m.forecast,x.origin=1,
	plot.se=TRUE,plot.se.proc=FALSE,plot.se.est=FALSE,
	unit=1,
	col.line=1,lty.line=1,lwd.line=1,
	q.se=c(2,2,2),
	angle.se=c(45,45,45),
	border.se=c(NA,NA,NA),
	col.se=gray(c(0.50,0.80,0.90)),
	density.se=c(NULL,NULL,NULL),
	lty.se=c(1,1,1))</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>m.forecast</code></td>
<td>
<p>Matrix.  Up to 4 columns.
Column 1: point forecasts.
Column 2: forecast standard errors.
Column 3: process standard errors.
Column 4: estimation standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.origin</code></td>
<td>
<p><em>Optional.</em> Numerical. x-coordinate for last observation. The first point forecast is made at <code>x.origin+unit</code>, where <code>unit</code> (with default 1) is defined in <code>apc.data.list</code>. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.se</code></td>
<td>
<p><em>Optional.</em> Logical. Should forecast   standard errors be plotted? Default: <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.se.proc</code></td>
<td>
<p><em>Optional.</em> Logical. Should process    standard errors be plotted? Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.se.est</code></td>
<td>
<p><em>Optional.</em> Logical. Should estimation standard errors be plotted? Default: <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p><em>Optional.</em> Numerical. step length for point forecasts. Default=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.line</code></td>
<td>
<p><em>Optional.</em> Point forecasts: Colour of line. Same as <code>col</code> for <code>lines</code>. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.line</code></td>
<td>
<p><em>Optional.</em> Point forecasts: Type   of line. Same as <code>lty</code> for <code>lines</code>. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.line</code></td>
<td>
<p><em>Optional.</em> Point forecasts: Width  of line. Same as <code>lwd</code> for <code>lines</code>. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.se</code></td>
<td>
<p><em>Optional.</em> Vector of length 3. Multiplication factors for standard errors. Default: <code>c(2,2,2)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle.se</code></td>
<td>
<p><em>Optional.</em> Standard error polygon: 3-vector: Angle  of shading.  Same as <code>angle</code> 	for <code>polygon</code>. Default: <code>=c(45,45,45)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border.se</code></td>
<td>
<p><em>Optional.</em> Standard error polygon: 3-vector: Border of polygon.  Same as <code>border</code> 	for <code>polygon</code>. Default: <code>=c(NA,NA,NA)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.se</code></td>
<td>
<p><em>Optional.</em> Standard error polygon: 3-vector: Colour of polygon.  Same as <code>col</code> 	for <code>polygon</code>. Default: <code>gray(c(0.50,0.80,0.90))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.se</code></td>
<td>
<p><em>Optional.</em> Standard error polygon: 3-vector: Density of shading. Same as <code>density</code> for <code>polygon</code>. Default: <code>=c(NULL,NULL,NULL)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.se</code></td>
<td>
<p><em>Optional.</em> Standard error polygon: 3-vector: Type of shading.    Same as <code>lty</code> 	for <code>polygon</code>. Default: <code>=c(1,1,1)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The empirical example of
Martinez Miranda, Nielsen and Nielsen (2015)
uses the data
<code>data.asbestos</code>.
The results of that paper are reproduced in 
the vignette
<a href="../doc/ReproducingMMNN2015.pdf"><code>ReproducingMMNN2015.pdf</code></a>,
<a href="../doc/ReproducingMMNN2015.R"><code>ReproducingMMNN2015.R</code></a>
on
<a href="../doc/index.html"><code>Vignettes</code></a>.
The function is used there.
</p>


<h3>Author(s)</h3>

<p>Bent Nielsen &lt;bent.nielsen@nuffield.ox.ac.uk&gt; 6 Jan 2016</p>


<h3>References</h3>

<p>Martinez Miranda, M.D., Nielsen, B. and Nielsen, J.P. (2015) Inference and forecasting in the age-period-cohort model with unknown exposure with an application to mesothelioma mortality. <em>Journal of the Royal Statistical Society</em> A 178, 29-55. <em>Download</em>: <a href="https://doi.org/10.1111/rssa.12051">Article</a>, <a href="http://www.nuffield.ox.ac.uk/economics/papers/2013/Asbestos8mar13.pdf">Nuffield DP</a>. 
</p>


</div>