<div class="container">

<table style="width: 100%;"><tr>
<td>ah</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ah</h2>

<h3>Description</h3>

<p>This function offers the methods to fit the additive hazards model, including Aalen's method and Maximum likelihood method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ah(
  formula = formula(data),
  data = sys.parent(),
  matrix_domain = NULL,
  progbar = FALSE,
  method = "ml_opt",
  scale = TRUE,
  startedge = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula, the dependent variable must be of type Surv in the survival package..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with the covariates mentioned in the formula stored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix_domain</code></td>
<td>
<p>A matrix describing the domain to find the maximum likelihood. The default constraint matrix guarantees the hazards to be positive for all possible covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progbar</code></td>
<td>
<p>A logical value, shows the progress bar if it is TRUE, hide the progress bar if FALSE, default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string with values "aalen", "ml_opt", "ml_enum", "ml_asc" and "ml_desc". Default value is "ml_opt".  "aalen" represents the Aalen's method.  "ml_opt" is the default method with respect to the default constraint matrix. "ml_enum","ml_asc" and "ml_desc" represents to the naive method, ascending method and descending method. Please check the referee for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>A logical value, scales the input data in the interval [0,1] if it is TRUE. Default value is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startedge</code></td>
<td>
<p>a vector which satisfies the domain condition. Only used for the ascending method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame, containing the coefficients (beta) at each time point and the cumulative beta at each time point.
</p>


<h3>References</h3>

<p>Chengyuan Lu, Jelle Goeman, Hein Putter 
Maximum likelihood estimation in the additive hazards model
arXiv:2004.06156
</p>


<h3>Examples</h3>

<pre><code class="language-R">X1 = rnorm(100); X2 = rnorm(100)
Survival_Time = rep(0,100)
U = runif(100,min =0, max =1)
for (i in 1:100){Survival_Time[i] = sqrt((-2*log(U[i]))/(0.3*X1[i] + 0.7*X2[i]))}
tcens = runif(100, 2.5, 7.5)
time =  pmin(Survival_Time, tcens)
event = as.numeric(Survival_Time&lt;=tcens)
Data = data.frame(time = time, X1 = X1, X2 = X2, event = event)

Result = ah(Surv(time = time, event = event)~ X1 + X2, Data)

</code></pre>


</div>