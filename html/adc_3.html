<div class="container">

<table style="width: 100%;"><tr>
<td>fa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Flow Anomalies</h2>

<h3>Description</h3>

<p>Flow anomalies are a dimensionless term that reflects the difference in in
current discharges compared to past discharges. A positive flow anomaly
indicates the current time period, <code class="reqn">T_{1}</code>,
is wetter than the precedent time period, <code class="reqn">T_{2}</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fa(discharge, dates, T_1, T_2, clean_up = FALSE, transform = "log10")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>discharge</code></td>
<td>
<p>numeric vector of daily discharges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>vector of dates coresponding to daily discharge measurements.
Must be class <code>"Date"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_1</code></td>
<td>
<p>size of period <code class="reqn">T_{1}</code>
preceding a given day t. Specified in the same way as the <code>by</code> argument
in <code>seq.POSIXt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_2</code></td>
<td>
<p>size of period <code class="reqn">T_{2}</code>
preceding a given day t. Specified in the same way as the <code>by</code> argument
in <code>seq.POSIXt</code>. Period T_2 is expected to be longer than T_1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean_up</code></td>
<td>
<p>logical. runs .... prior to ....</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>on of <code>NA, log, log10</code>,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The FA term describes how different the antecedent discharge
conditions are for a selected temporal period compared to a selected period
or day of analysis. Ryberg and Vecchia (2014) and Vechia et al. (2009)
describe the flow anomaly (FA) term as:
</p>
<p style="text-align: center;"><code class="reqn">FA(t)=X_{T_1}(t) - X_{T_2}(t)</code>
</p>

<p>The <code>T_1</code> and <code>T_2</code> arguments can be specified as character strings
containing one of <code>"sec"</code>, <code>"min"</code>, <code>"hour"</code>, <code>"day"</code>,
<code>"DSTday"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code>, or
<code>"year"</code>. This is generally preceded by an integer and a space. Can also
be followed by an <code>"s"</code>. Additionally, <code>T_2</code> accepts
<code>"period"</code> which coresponds with the mean of the entire flow record.
</p>


<h3>Value</h3>

<p>vector of numeric values corresponding to <code class="reqn">X_{T_1}(t) - X_{T_2}(t)</code>.
</p>


<h3>References</h3>

<p>Ryberg, Karen R., and Aldo V. Vecchia. 2012. “WaterData—An R Package for
Retrieval, Analysis, and Anomaly Calculation of Daily Hydrologic Time Series
Data.” Open Filer Report 2012-1168. National Water-Quality Assessment
Program. Reston, VA: USGS. <a href="https://pubs.usgs.gov/of/2012/1168/">https://pubs.usgs.gov/of/2012/1168/</a>.
</p>
<p>Vecchia, Aldo V., Robert J. Gilliom, Daniel J. Sullivan, David L. Lorenz,
and Jeffrey D. Martin. 2009. “Trends in Concentrations and Use of
Agricultural Herbicides for Corn Belt Rivers, 1996-2006.” Environmental
Science &amp; Technology 43 (24): 9096–9102.
<a href="https://doi.org/10.1021/es902122j">doi:10.1021/es902122j</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ## examples from Ryberg &amp; Vechia 2012
 ## Long-term Flow Anomaly LTFA
 LTFA &lt;- fa(lavaca$Flow,
            dates = lavaca$Date,
            T_1 = "1 year",
            T_2 = "period",
            clean_up = TRUE,
            transform = "log10")

 

 ## Mid-term Flow Anomaly MTFA
 MTFA &lt;- fa(lavaca$Flow,
            dates = lavaca$Date,
            T_1 = "1 month",
            T_2 = "1 year",
            clean_up = TRUE,
            transform = "log10")

 ## Short-term Flow Anomaly STFA
 STFA &lt;- fa(lavaca$Flow,
            dates = lavaca$Date,
            T_1 = "1 day",
            T_2 = "1 month",
            clean_up = TRUE,
            transform = "log10")
 
</code></pre>


</div>