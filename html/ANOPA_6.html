<div class="container">

<table style="width: 100%;"><tr>
<td>anopa_asn_trans1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>anopaPlot: Easy plotting of proportions.</h2>

<h3>Description</h3>

<p>The function 'anopaPlot()' performs a plot of proportions for designs
with up to 4 factors according to the
'ANOPA' framework. See Laurencelle and Cousineau (2023) for more. The plot is
realized using the 'suberb' library; see Cousineau et al. (2021).
It uses the arc-sine transformation 'A()'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anopaPlot(w, formula, confidenceLevel = .95, allowImputing = FALSE,
		showPlotOnly = TRUE, plotStyle = "line", 
     errorbarParams  = list( width =0.5, linewidth=0.75 ), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>An ANOPA object obtained with <code>anopa()</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>(optional) Use formula to plot just specific terms of the omnibus test.
For example, if your analysis stored in <code>w</code> has factors A, B and C, then
<code>anopaPlot(w, ~ A * B)</code> will only plot the factors A and B.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidenceLevel</code></td>
<td>
<p>Provide the confidence level for the confidence intervals
(default is 0.95, i.e., 95%).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allowImputing</code></td>
<td>
<p>(default FALSE) if there are cells with no observations, can they be
imputed? If imputed, the option "ANOPA.zeros" will be used to determine
how many additional observations to add, and with how many successes.
If for example, the option is (by default) <code>c(0.05, 1)</code>, then
20 cases will be added, only one being a success (respecting the .05 target).
<em>Keep in mind that imputations has never been studies with regards to proportions
so be mindfull that the default optin has never been tested nor validated.</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlotOnly</code></td>
<td>
<p>(optional, default True) shows only the plot or else
shows the numbers needed to make the plot yourself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotStyle</code></td>
<td>
<p>(optional; default "line") How to plot the proportions;
see superb for other layouts (e.g., "line").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorbarParams</code></td>
<td>
<p>(optional; default list( width =0.5, linewidth=0.75 ) ) is
a list of attributes used to plot the error bars. See superb for more.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other directives sent to superb(), typically 'plotStyle',
'errorbarParams', etc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot shows the proportions on the vertical axis as a
function of the factors (the first on the horizontal axis, the second
if any in a legend; and if a third or even a fourth factors are present,
as distinct rows and columns). It also shows 95% confidence intervals of
the proportions, adjusted for between-cells comparisons.
The confidence intervals are based on a z distribution, which is adequate
for large samples (Chen 1990; Lehman and Loh 1990). This "stand-alone" confidence
interval is then adjusted for between-cell comparisons using the <em>superb</em>
framework (Cousineau et al. 2021).
</p>
<p>See the vignette <a href="../articles/B-DataFormatsForProportions.html"><code>DataFormatsForProportions</code></a>
for more on data formats and how to write their formula.
See the vignette <a href="../articles/C-ConfidenceIntervals.html"><code>ConfidenceIntervals</code></a> for
details on the adjustment and its purpose.
</p>


<h3>Value</h3>

<p>a ggplot2 object of the given proportions.
</p>


<h3>References</h3>

<p>Chen H (1990).
“The accuracy of approximate intervals for a binomial parameter.”
<em>Journal of the American Statistical Associtation</em>, <b>85</b>, 514–518.
<a href="https://doi.org/10.1080/01621459.1990.10476229">doi:10.1080/01621459.1990.10476229</a>.<br><br> Cousineau D, Goulet M, Harding B (2021).
“Summary plots with adjusted error bars: The superb framework with an implementation in R.”
<em>Advances in Methods and Practices in Psychological Science</em>, <b>4</b>, 1–18.
<a href="https://doi.org/10.1177/25152459211035109">doi:10.1177/25152459211035109</a>.<br><br> Laurencelle L, Cousineau D (2023).
“Analysis of proportions using arcsine transform with any experimental design.”
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.<br><br> Lehman EL, Loh W (1990).
“Pointwise versus uniform robustness of some large-sample tests and confidence intervals.”
<em>Scandinavian Journal of Statistics</em>, <b>17</b>, 177–187.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 
# The Arrington Et Al., 2002, data on fishes' stomach
ArringtonEtAl2002

# This examine the omnibus analysis, that is, a 3 x 2 x 4 ANOPA:
w &lt;- anopa( {s;n} ~ Location * Trophism * Diel, ArringtonEtAl2002) 

# Once processed into w, we can ask for a standard plot
anopaPlot(w)

# As you may notice, there are points missing because the data have
# three missing cells. The litterature is not clear what should be 
# done with missing cells. In this package, we propose to impute
# the missing cells based on the option `getOption("ANOPA.zeros")`.
# Consider this option with care.  
anopaPlot(w, allowImputing = TRUE)

# We can place the factor `Diel` on the x-axis (first):
anopaPlot(w, ~ Diel * Trophism * Location )

# Change the style for a plot with bars instead of lines
anopaPlot(w, plotStyle = "bar")

# Changing the error bar style
anopaPlot(w, plotStyle = "bar", errorbarParams = list( width =0.1, linewidth=0.1 ) )

# Illustrating the main effect of Location (not interacting with other factors)
# and the interaction Diel * Trophism separately
anopaPlot(w, ~ Location ) 
anopaPlot(w, ~ Diel * Trophism ) 

# All these plots are ggplot2 so they can be followed with additional directives, e.g.
library(ggplot2)
anopaPlot(w, ~ Location) + ylim(0.0, 1.0) + theme_classic()
anopaPlot(w, ~ Diel * Trophism) + ylim(0.0, 1.0) + theme_classic()

# etc. Any ggplot2 directive can be added to customize the plot to your liking.
# See the vignette `ArringtonExample`.


</code></pre>


</div>