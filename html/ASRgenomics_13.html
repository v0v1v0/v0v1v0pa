<div class="container">

<table style="width: 100%;"><tr>
<td>G.predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates the conditional predictions of random effects (BLUPs)</h2>

<h3>Description</h3>

<p>Predicts random effects values for individuals with unobserved responses (here called <code>x</code>,
a vector of length <code class="reqn">nx</code>) based on known random effect values for individuals with
observed responses (here called <code>y</code>, a vector of length <code class="reqn">ny</code>). This is done using the
common genomic relationship matrix  <code class="reqn">\boldsymbol{G}</code> for all
individuals (full matrix of dimension <code class="reqn">(nx + ny) \times (nx + ny)</code>).
</p>
<p>The prediction of unobserved responses will be performed through the
multivariante Normal conditional distribution. These predictions are identical to
what would be obtained if the entire set of individuals (<code class="reqn">nx + ny</code>) were included into a
GBLUP animal model fit with individuals in the set <code>x</code> coded as missing.
</p>
<p>The user needs to provide the matrix <code class="reqn">\boldsymbol{G}</code> in full form.
Individual names (<code class="reqn">nx + ny</code>) should be assigned to <code>rownames</code> and <code>colnames</code>, and these
can be in any order. If the variance-covariance matrix of the set <code>y</code> is provided,
standard errors of random effects in set <code>x</code> are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">G.predict(G = NULL, gy = NULL, vcov.gy = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Input of the genomic relationship matrix <code class="reqn">\boldsymbol{G}</code> in full form
(of dimension <code class="reqn">(nx + ny) \times (nx + ny)</code>) (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gy</code></td>
<td>
<p>Input of random effects (<em>e.g.</em> breeding values) for individuals with known values.
Individual names should be assigned to <code>rownames</code> of this vector
and be found on the matrix <code class="reqn">\boldsymbol{G}</code> (default = <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov.gy</code></td>
<td>
<p>The variance-covariance matrix associated with the random effects from the
individuals with known values (set <code>y</code>, of dimension <code class="reqn">ny \times ny</code>)
(default = <code>NULL</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with the predicted random effect values for individuals with
unobserved responses in the set <code>x</code>. If the variance-covariance matrix is provided,
standard errors are included in an additional column.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(asreml) # Load asreml.

# Example: Apple data creating 100 missing observations.

# Prepare G (nx + ny).
G &lt;- G.matrix(M = geno.apple, method = "VanRaden", sparseform = FALSE)$G
dim(G)

# Prepare subset of data.
# Select only 147 from 247 individuals from pheno.apple and geno.apple.
Gy &lt;- G[1:147, 1:147]
phenoy &lt;- pheno.apple[1:147, ]

# Obtain the BLUPs for the 147 individuals using ASReml-R.

# Blend Gy.
Gyb &lt;- G.tuneup(G = Gy, blend = TRUE, pblend = 0.02)$Gb

# Get the Gy inverse
Gyinv  &lt;- G.inverse(G = Gyb, sparseform = TRUE)$Ginv.sparse

# Fit a GBLUP model
phenoy$INDIV &lt;- as.factor(phenoy$INDIV)
modelGBLUP &lt;-
 asreml(
  fixed = JUI_MOT ~ 1,
  random = ~vm(INDIV, Gyinv),
  workspace = 128e06,
  data = phenoy)

# Obtain Predictions - BLUP (set y).
BLUP &lt;- summary(modelGBLUP,coef = TRUE)$coef.random
head(BLUP)
gy &lt;- as.matrix(BLUP[, 1])
rownames(gy) &lt;- phenoy$INDIV

# Ready to make conditional predictions.
g.cond &lt;- G.predict(G = G, gy = gy)
head(g.cond)

## End(Not run)

</code></pre>


</div>