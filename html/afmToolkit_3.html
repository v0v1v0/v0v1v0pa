<div class="container">

<table style="width: 100%;"><tr>
<td>afmContactPoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Contact point</h2>

<h3>Description</h3>

<p>Find the contact point in for the Force-Distance curve
following the local regression and two thresholds methods described 
in Microscopy Research and Technique 2013 (see reference).
</p>


<h3>Usage</h3>

<pre><code class="language-R">afmContactPoint(afmdata, width = 1, mul1, mul2, lagdiff = width, Delta = TRUE,
  loessSmooth = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>afmdata</code></td>
<td>
<p>A Force-Distance curve with the afmdata structure. It should be a list
with at least the 'data' field with a data frame of at least 4 columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Width of the window for the local regression (in vector position units)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mul1</code></td>
<td>
<p>First multiplier for the first alarm threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mul2</code></td>
<td>
<p>Second multiplier for the second alarm threshold</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lagdiff</code></td>
<td>
<p>Lag for estimating the differences in Delta (or slopes) signal. By
default it takes the same value as the window with.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>Logical. If TRUE, then the statistic for determining the contact point is
the differences between two consecutive values of the slope of the local regression
line. If FALSE then the slope itself is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loessSmooth</code></td>
<td>
<p>Logical If TRUE, a loess smoothing (via loess.smooth()) is done
prior to the determination of the contact point. The span of the  smoothing is 0.05
(5
approach segment.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>afmdata</code> class variable which will consist on the original input
<code>afmdata</code> variable plus a new list named <code>CP</code> with the following fields:
</p>
<p><code>CP</code> The contact point value.
</p>
<p><code>iCP</code> The position in the array for the contact point value.
</p>
<p><code>delta</code> The delta signal.
</p>
<p><code>noise</code> The noise of the delta signal
</p>


<h3>References</h3>

<p>Benitez R., Moreno-Flores S., Bolos V. J. and Toca-Herrera J.L. (2013). "A 
new automatic contact point detection algorithm for AFM force curves". 
Microscopy research and technique, <strong>76</strong> (8), pp. 870-876.
</p>


<h3>See Also</h3>

<p><code>afmDetachPoint</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">path &lt;- path.package("afmToolkit")
data &lt;- afmReadJPK("force-save-JPK-3h.txt.gz", path = path)
width &lt;- 20
mul1 &lt;- 1
mul2 &lt;- 10
data &lt;- afmContactPoint(data, width = width, mul1 = mul1, mul2 = mul2)
## Not run: 
plot(data, segment = "approach") + geom_vline(xintercept = data$CP$CP, lty = 2)

## End(Not run)
</code></pre>


</div>