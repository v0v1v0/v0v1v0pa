<div class="container">

<table style="width: 100%;"><tr>
<td>dunnfa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factorial Analysis of the Specialization in Habitat Selection
Studies.  Unpublished Work of James Dunn (University of Arkansas)</h2>

<h3>Description</h3>

<p><code>dunnfa</code> performs a factorial decomposition of the Mahalanobis
distances in habitat selection studies (see details). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">dunnfa(dudi, pr, scannf = TRUE, nf = 2)
## S3 method for class 'dunnfa'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudi</code></td>
<td>
<p>an object of class <code>pca</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>a vector giving the utilization weights associated to
each unit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>
<p>logical.  Whether the eigenvalues barplot should be
displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>an integer indicating the number of kept axes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>dunnfa</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the function
<code>print</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This analysis is in essence very similar to the MADIFA (see
<code>?madifa</code>).   The Mahalanobis distances are often used in the
context of niche-environment studies (Clark et al. 1993, see the
function  <code>mahasuhab</code>).  Each resource unit takes a value on a
set of environmental variables.  Each environmental variable defines a
dimension in a multidimensionnal space, namely the ecological space.
A set of points (resource units) describes what is available to the
species.  For each point, a "utilization weight" measures the
intensity of use of the point by the species.  The set of points for
which the utilization weight is greater than zero defines the
"niche". The Mahalanobis distance between any resource unit in this
space (e.g. the point defined by the values of environmental variables
in a pixel of a raster map) and the centroid of the niche (the
distribution of used resource units) can be used to give a value of
eccentricity to this point.
</p>
<p>For a given distribution of available resource units, for which a
measure of Mahalanobis distances is desired, the MADIFA (MAhalanobis
DIstances Factor Analysis) partitions the ecological space into a set
of axes, so that the first axes maximises the average proportion of
their squared Mahalanobis distances.  James Dunn (formerly University
of Arkansas) proposed the analysis programmed in the function
<code>dunnfa</code>, as an alternative to the MADIFA (unpublished
results).  This analysis is closely related to both the ENFA
(Ecological niche factor analysis, Hirzel et al. 2002) and the
MADIFA.
</p>
<p>The analysis proposed by James Dunn searches, in the multidimensional
space defined by environmental variables, synthesis variables which
maximise the ratio (variance of the scores of available resource
units) / (variance of the scores of used resource units).  This ratio
is sometimes called "specialization" in the ecological literature
(Hirzel et al. 2002).  It is therefore very similar to the ENFA (which
also maximises the specialization), except that the factorial axes
returned by this analysis are not required to be *orthogonal to the
marginality axis*.
</p>
<p>James Dunn demonstrated that this analysis also partitions the
Mahalanobis distances into uncorrelated axes, which makes it similar
to the MADIFA (the difference is that the MADIFA maximises the mean
squared Mahalanobis distances on the first axes, whereas the DUNNFA
maximises the specialization on the first axes).  Therefore, as for
the MADIFA, the DUNNFA can be used to build reduced rank habitat
suitability map.
</p>
<p>Note that although this analysis could theoretically be used with all
kinds of variables, it it currently implemented only for numeric
variables.
</p>


<h3>Value</h3>

<p><code>dunnfa</code> returns a list of class <code>dunnfa</code> containing the
following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>original call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a data frame with n rows and p columns (original data frame
centered by column for the uniform weighting).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>a vector of length n containing the number of points in each
pixel of the map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>the number of kept axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>a vector with all the eigenvalues of the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>liA</code></td>
<td>
<p>row coordinates (centering on the centroid of the cloud of
available points), data frame with n rows and nf columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>liU</code></td>
<td>
<p>row coordinates (centering on the centroid of the cloud of
available points), data frame with p rows and nf columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mahasu</code></td>
<td>
<p>a vector of length n containing the reduced-rank squared
Mahalanobis distances for the n units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>co</code></td>
<td>
<p>column (environmental variables) coordinates, a data frame
with p rows and nf columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor</code></td>
<td>
<p>the correlation between the DUNNFA axes and the original
variable</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This analysis was developed by James Dunn during an e-mail discussion
on the MADIFA, and is still unpublished work.  Implemented in
adehabitatHS with his autorization.
</p>


<h3>Author(s)</h3>

<p>Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a>
</p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519–526.<br></p>
<p>Hirzel, A.H., Hausser, J., Chessel, D. &amp; Perrin, N. (2002)
Ecological-niche factor analysis: How to compute habitat-suitability
maps without absence data? <em>Ecology</em>, <b>83</b>, 2027–2036.  
</p>
<p>Calenge, C., Darmon, G., Basille, M., Loison, A. and Jullien
J.M. (2008) The factorial decomposition of the Mahalanobis distances
in habitat selection studies. <em>Ecology</em>, <b>89</b>, 555–566.<br></p>


<h3>See Also</h3>

 <p><code>madifa</code>, <code>enfa</code> and
<code>gnesfa</code> for related methods.  <code>mahasuhab</code> for
details about the Mahalanobis distances.</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(bauges)

map &lt;- bauges$map
locs &lt;- bauges$loc

## We prepare the data for the analysis
tab &lt;- slot(map, "data")
pr &lt;- slot(count.points(locs, map), "data")[,1]

## We then perform the PCA before the analysis
pc &lt;- dudi.pca(tab, scannf = FALSE)
(dun &lt;- dunnfa(pc, pr, nf=2,
               scannf = FALSE))

## We should keep one axis:
barplot(dun$eig)

## The correlation of the variables with the first two axes:
s.arrow(dun$cor)

## A factorial map of the niche (centering on the available points)
scatterniche(dun$liA, dun$pr, pts=TRUE)

## a map of the reduced rank Mahalanobis distances
## (here, with one axis)
dun2 &lt;- dunnfa(pc, pr, nf=1,
              scannf = FALSE)
df &lt;- data.frame(MD=dun2$mahasu)
coordinates(df) &lt;- coordinates(map)
gridded(df) &lt;- TRUE
image(df)


## Compute the specialization on the row scores of
## the analysis:
apply(dun$liA, 2, function(x) {
   varav &lt;- sum((x - mean(x))^2) / length(x)
   meanus &lt;- sum(dun$pr*x)/sum(dun$pr)
   varus &lt;- sum(dun$pr * (x - meanus )^2)/sum(dun$pr)
   return(varav/varus)
})
## The eigenvalues:
dun$eig


## End(Not run)


</code></pre>


</div>