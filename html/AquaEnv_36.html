<div class="container">

<table style="width: 100%;"><tr>
<td>titration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>titration</h2>

<h3>Description</h3>

<p>PUBLIC function: creates an object of class aquaenv which contains a titration simulation</p>


<h3>Usage</h3>

<pre><code class="language-R">titration(aquaenv, mass_sample, mass_titrant, conc_titrant,
          S_titrant=NULL, steps, type="HCl", seawater_titrant=FALSE,
          k_w=NULL, k_co2=NULL, k_hco3=NULL, k_boh3=NULL, k_hso4=NULL,
          k_hf=NULL, k1k2="lueker", khf="dickson")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>aquaenv </code></td>
<td>
<p>an object of type aquaenv: minimal definition, contains all information about the system: T, S, d, total concentrations of nutrients etc (Note that it is possible to give values for SumBOH4, SumHSO4, and SumHF in the sample other than the ones calculated from salinity)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass_sample</code></td>
<td>
<p>the mass of the sample solution in kg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mass_titrant</code></td>
<td>
<p>the total mass of the added titrant solution in kg</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc_titrant</code></td>
<td>
<p>the concentration of the titrant solution in mol/kg-soln</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_titrant</code></td>
<td>
<p>the salinity of the titrant solution, if not supplied it is assumed that the titrant solution has the same salinity as the sample solution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>the amount of steps the mass of titrant is added in</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of titrant: either "HCl" or "NaOH", default: "HCl"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seawater_titrant</code></td>
<td>
<p>is the titrant based on natural seawater?
(does it contain SumBOH4, SumHSO4, and SumHF in the same proportions
as seawater, i.e., correlated to S?); Note that you can only assume
a seawater based titrant (i.e. SumBOH4, SumHSO4, and SumHF ~ S) or a
water based titrant (i.e. SumBOH4, SumHSO4, and SumHF = 0). It is
not possible to give values for SumBOH4, SumHSO4, and SumHF of the
titrant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_w</code></td>
<td>
<p>a fixed K\_W can be specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_co2</code></td>
<td>
<p>a fixed K\_CO2 can be specified; used for TA fitting: give a K\_CO2 and NOT calculate it from T and S: i.e. K\_CO2 can be fitted in the routine as well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_hco3</code></td>
<td>
<p>a fixed K\_HCO3 can be specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_boh3</code></td>
<td>
<p>a fixed K\_BOH3 can be specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_hso4</code></td>
<td>
<p>a fixed K\_HSO4 can be specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_hf</code></td>
<td>
<p>a fixed K\_HF can be specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1k2</code></td>
<td>
<p>either "lueker" (default, Lueker2000) or "roy" (Roy1993a) for K\_CO2 and K\_HCO3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>khf</code></td>
<td>
<p>either "dickson" (default, Dickson1979a) or "perez" (Perez1987a) for K\_HF</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>object of class aquaenv which contains a titration simulation
</p>


<h3>Author(s)</h3>

<p>Andreas F. Hofmann. Maintained by Karline Soetaert (Karline.Soetaert@nioz.nl).</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
####################
# Titration with HCl
####################
S &lt;- 35
t &lt;- 15

SumCO2 &lt;- 0.003500
SumNH4 &lt;- 0.000020

mass_sample  &lt;- 0.01 # the mass of the sample solution in kg
mass_titrant &lt;- 0.02 # the total mass of the added titrant solution in
                     # kg
conc_titrant &lt;- 0.01 # the concentration of the titrant solution in
                     # mol/kg-soln
S_titrant    &lt;- 0.5  # the salinity of the titrant solution (the
                     # salinity of a solution with a ionic strength of
                     # 0.01 according to: I = (19.924 S) / (1000 - 1.005S)
steps        &lt;- 50   # the amount of steps the mass of titrant is added
                     # in
type         &lt;- "HCl"

pHstart &lt;- 11.3


ae &lt;- titration(aquaenv(S=S, t=t, SumCO2=SumCO2, SumNH4=SumNH4,
                pH=pHstart), mass_sample, mass_titrant, conc_titrant,
                S_titrant, steps, type)


# plotting everything
plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
mfrow=c(10,10))


# plotting selectively
size  &lt;- c(12,8) #inches
mfrow &lt;- c(4,4)
what  &lt;- c("TA", "pH", "CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH",
           "NH4", "NH3", "H2SO4", "HSO4", "SO4", "HF", "F", "pCO2")


plot(ae, xval=ae$delta_mass_titrant, xlab="HCl solution added [kg]",
     what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$pH, xlab="free scale pH", what=what, size=size,
     mfrow=mfrow)


# different x values
plot(ae, xval=ae$delta_conc_titrant, xlab="[HCl] offset added
     [mol/kg-soln]", what=what, size=size, mfrow=mfrow)

plot(ae, xval=ae$delta_moles_titrant, xlab="HCl added [mol]", what=what,
     size=size, mfrow=mfrow)


# bjerrum plots
par(mfrow=c(1,1))
plot(ae, bjerrum=TRUE)

what  &lt;- c("CO2", "HCO3", "CO3")
plot(ae, what=what, bjerrum=TRUE)
plot(ae, what=what, bjerrum=TRUE, lwd=4, palette=c("cyan", "magenta",
     "yellow"), bg="gray", legendinset=0.1, legendposition="topleft")



what  &lt;- c("CO2", "HCO3", "CO3", "BOH3", "BOH4", "OH", "NH4", "NH3",
           "H2SO4", "HSO4", "SO4", "HF", "F")

plot(ae, what=what, bjerrum=TRUE, log=TRUE)
plot(ae, what=what, bjerrum=TRUE, log=TRUE, ylim=c(-6,-1),
     legendinset=0, lwd=3, palette=c(1,3,4,5,6,colors()[seq(100,250,6)]))

## End(Not run)</code></pre>


</div>