<div class="container">

<table style="width: 100%;"><tr>
<td>ems</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expected values of mean squares for factorial designs
Implements the Cornfield-Tukey algorithm for deriving the expected values of the mean squares for factorial designs.</h2>

<h3>Description</h3>

<p>Expected values of mean squares for factorial designs
</p>
<p>Implements the Cornfield-Tukey algorithm for deriving the expected values of the mean squares for factorial designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ems(design, nested = NULL, random = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>A <code>formula</code> object specifying the factors in the design (except residual error, which is always implicitly included). The left hand side of the <code>~</code> is the symbol that will be used to denote the number of replications per lowest-level factor combination (I usually use "r" or "n"). The right hand side should include all fixed and random factors separated by <code>*</code>. Factor names should be single letters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nested</code></td>
<td>
<p>A <code>character</code> vector, where each element is of the form <code>"A/B"</code>, indicating that the levels of factor B are nested under the levels of factor A.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A <code>character</code> string indicating, without spaces or any separating characters, which of the factors specified in the design are random.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value is a formatted table where the rows represent the mean squares, the columns represent the variance components that comprise the various mean squares, and the entries in each cell represent the terms that are multiplied and summed to form the expectation of the mean square for that row. Each term is either the lower-case version of one of the experimental factors, which indicates the number of levels for that factor, or a "1", which means the variance component for that column is contributes to the mean square but is not multiplied by anything else.
</p>


<h3>Note</h3>

<p>Names for factors or parameters should only be of length 1 as they are simply concatenated in the returned table.
</p>


<h3>Author(s)</h3>

<p>Jake Westfall
</p>


<h3>See Also</h3>

<p>A detailed description with explanation of the example can be found <a href="https://web.archive.org/web/20210805121242/http://www.talkstats.com/threads/share-your-functions-code.18603/page-9#post-82050">elsewhere</a> (note that the <code>design</code> argument of the function described at the link behaves slightly different).
</p>
<p>Example applications of this function can be found here: <a href="https://stats.stackexchange.com/a/122662/442">https://stats.stackexchange.com/a/122662/442</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 2x2 mixed anova
# A varies between-subjects, B varies within-subjects
ems(r ~ A*B*S, nested="A/S", random="S")

# Clark (1973) example
# random Subjects, random Words, fixed Treatments
ems(r ~ S*W*T, nested="T/W", random="SW")

# EMSs for Clark design if Words are fixed
ems(r ~ S*W*T, nested="T/W", random="S")

</code></pre>


</div>