<div class="container">

<table style="width: 100%;"><tr>
<td>pbf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Behrens-Fisher distribution
</h2>

<h3>Description</h3>

<p>Used in <code>bfTest</code>. Distribution of the t-statistic used in 
Welch's t-test. The distribution depends on the sample sizes of the two groups, and the ratio of the two standard errors of the means.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbf(q, n1, n2, R = NULL, s1 = NULL, s2 = NULL, epsilon = 10^(-8))
qbf(p,n1,n2,R=NULL,s1=NULL,s2=NULL,epsilon=10^(-8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>vector of quantiles
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>sample size in group 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>

<p>sample size in group 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>

<p>a function of the ratio of the two standard errors of the mean. Specifically, 
<code>atan((s1/sqrt(n1))/(s2/sqrt(n2)))</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s1</code></td>
<td>

<p>sample standard deviation in group 1
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2</code></td>
<td>

<p>sample standard deviation in group 2
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>a small positive number used to avoid computer errors</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The user must supply either <code>s1</code> and <code>s2</code> or supply <code>R</code>.
Suppose m1 and m2 are the means of the two groups and D is the true difference in means. Then the Behrens-Fisher test statistic is 
<code>T=(m1-m2-D)/sqrt(s1/sqrt(n1)+ s2/sqrt(n2))</code>. The value T can be equivalently written as <code>T=T1*sin(R)+T2*cos(R)</code>, where T1 and T2 are t random variables with n1-1 and n2-1 degrees of freedom. The cumulative distribution of T is found by numeric integration.
</p>
<p>We rewrite <code class="reqn">Pr[T&lt;=q]</code> as <code class="reqn"> \int_{-Inf}^{Inf} Pr[T2&lt;= (q-u*sin(R))/cos(R) | T1=u] Pr[T1=u] du</code>.
</p>


<h3>Value</h3>

<p>pbf gives the distribution function, qbf givds the quantile function.
</p>


<h3>References</h3>

<p>Kim, S-H, and Cohen, AS (1996). Table of percentage points of the Behrens-Fisher distribution. Journal of Statistical Computation and Simulation. 55(3) 181-187.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># See Table 1 from Kim and Cohen, 1996
# at v1=n1-1=8 and v2=n2-1=12 with 45 degrees = 45*pi/180 radians
# for 0.95th percentile
# Table gives: 1.83496
qbf(0.95,9,13,45*pi/180)
# check Inf degrees of freedom, should give qnorm value
qbf(.95,Inf,Inf,45*pi/180)
qnorm(.95)
</code></pre>


</div>