<div class="container">

<table style="width: 100%;"><tr>
<td>trace_asco</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates the spread of Ascochyta blight in a chickpea field</h2>

<h3>Description</h3>

<p>Simulate the spatiotemporal development of Ascochyta blight in a chickpea
paddock over a growing season. Both host and pathogen activities are
simulated in one square metre cells.
</p>


<h3>Usage</h3>

<pre><code class="language-R">trace_asco(
  weather,
  paddock_length,
  paddock_width,
  sowing_date,
  harvest_date,
  initial_infection,
  seeding_rate = 40,
  gp_rr = 0.0065,
  max_gp_lim = 5000,
  max_new_gp = 350,
  latent_period_cdd = 150,
  time_zone = "UTC",
  primary_infection_foci = "random",
  primary_inoculum_intensity = 1,
  n_foci = 1,
  spores_per_gp_per_wet_hour = 0.22,
  splash_cauchy_parameter = 0.5,
  wind_cauchy_multiplier = 0.015,
  daily_rain_threshold = 2,
  hourly_rain_threshold = 0.1,
  susceptible_days = 2,
  rainfall_multiplier = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>weather</code></td>
<td>
<p>weather data for a representative chickpea paddock for a
complete chickpea growing season for the model's operation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paddock_length</code></td>
<td>
<p>length of a paddock in metres (y).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paddock_width</code></td>
<td>
<p>width of a paddock in metres (x).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sowing_date</code></td>
<td>
<p>a character string of a date value indicating sowing date
of chickpea seed and the start of the ‘ascotraceR’ model. Preferably
in ISO8601 format (YYYY-MM-DD), <em>e.g.</em> “2020-04-26”. Assumes there
is sufficient soil moisture to induce germination and start the crop
growing season.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>harvest_date</code></td>
<td>
<p>a character string of a date value indicating harvest
date of chickpea crop, which is also the last day to run the
‘ascotraceR’ model. Preferably in ISO8601 format (YYYY-MM-DD),
<em>e.g.</em>, “2020-04-26”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_infection</code></td>
<td>
<p>a character string of a date value referring to the
initial or primary infection on seedlings, resulting in the production of
infectious growing points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seeding_rate</code></td>
<td>
<p>indicate the rate at which chickpea seed is sown per
square metre. Defaults to <code>40</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gp_rr</code></td>
<td>
<p>refers to rate of increase in chickpea growing points per degree
Celsius per day. Defaults to <code>0.0065</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_gp_lim</code></td>
<td>
<p>maximum number of chickpea growing points (meristems)
allowed per square metre. Defaults to <code>5000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_new_gp</code></td>
<td>
<p>Maximum number of new chickpea growing points (meristems),
which develop per day, per square metre. Defaults to <code>350</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent_period_cdd</code></td>
<td>
<p>latent period in cumulative degree days (sum of
daily temperature means) is the period between infection and production of
lesions on susceptible growing points. Defaults to <code>150</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_zone</code></td>
<td>
<p>refers to time in Coordinated Universal Time (UTC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primary_infection_foci</code></td>
<td>
<p>refers to the inoculated coordinates where the
infection starts. Accepted inputs are: <code>centre</code>/<code>center</code> or <code>random</code>
(Default) or a <code>data.frame</code> with column names ‘x’, ‘y’ and
‘load’. The <code>data.frame</code> inputs inform the model of specific grid
cell/s coordinates where the epidemic should begin. The ‘load’
column is optional and can specify the <code>primary_inoculum_intensity</code> for
each coordinate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>primary_inoculum_intensity</code></td>
<td>
<p>Refers to the amount of primary infection
as lesions on chickpea plants at the time of <code>initial_infection</code>. On the
date of initial infection in the experiment. The sources of primary
inoculum can be infected seed, volunteer chickpea plants or infested
stubble from the previous seasons. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_foci</code></td>
<td>
<p>Quantifies the number of primary infection foci. The value is
<code>1</code> when <code>primary_infection_foci = "centre"</code> and can be greater than <code>1</code> if
<code style="white-space: pre;">⁠primary_infection_foci = "random⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spores_per_gp_per_wet_hour</code></td>
<td>
<p>number of spores produced per infectious
growing point during each wet hour. Also known as the <code>spore_rate</code>. Value
is dependent on the susceptibility of the host genotype.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splash_cauchy_parameter</code></td>
<td>
<p>a parameter used in the Cauchy distribution
and describes the median distance spores travel due to rain splashes.
Default to <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind_cauchy_multiplier</code></td>
<td>
<p>a scaling parameter to estimate a Cauchy
distribution which resembles the possible distances a conidium travels due
to wind driven rain. Defaults to <code>0.015</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>daily_rain_threshold</code></td>
<td>
<p>minimum cumulative rainfall required in a day to
allow hourly spore spread events. See also <code>hourly_rain_threshold</code>.
Defaults to <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hourly_rain_threshold</code></td>
<td>
<p>minimum rainfall in an hour to trigger a spore
spread event in the same hour (assuming daily_rain_threshold is already
met). Defaults to <code>0.1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>susceptible_days</code></td>
<td>
<p>the number of days for which conidia remain viable on
chickpea after dispersal. Defaults to <code>2</code>. Conidia remain viable on the
plant for at least 48 hours after a spread event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rainfall_multiplier</code></td>
<td>
<p>logical values will turn on or off rainfall
multiplier default method. The default method increases the number of
spores spread per growing point if the rainfall in the spore spread event
hour is greater than one. Numeric values will scale the number of spores
spread per growing point against the volume of rainfall in the hour.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a nested <code>list</code> object where each sub-list contains daily data for
the day <code>i_day</code> (the model's iteration day) generated by the model
including: * <strong>paddock</strong>, an 'x' 'y' <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> containing: *
<strong>x</strong>, location of quadrat on x-axis in paddock, * <strong>y</strong>, location of
quadrat on y-axis in paddock, * <strong>new_gp</strong>, new growing points produced in
the last 24 hours, * <strong>susceptible_gp</strong>, susceptible growing points in the
last 24 hours, * <strong>exposed_gp</strong>, exposed growing points in the last 24
hours, * <strong>infectious_gp</strong>, infectious growing points in the last 24 hours,
</p>

<ul><li> <p><strong>i_day</strong>, model iteration day, * <strong>cumulative daily weather data</strong>, a
<a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> containing: * <strong>cdd</strong>, cumulative degree days, *
<strong>cwh</strong>, cumulative wet hours, * <strong>cr</strong>, cumulative rainfall in mm, *
<strong>gp_standard</strong>, standard growing points assuming growth is not impeded by
infection, * <strong>infected_coords</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of only infectious
growing point coordinates, * <strong>new_infections</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of
newly infected growing points, * <strong>exposed_gps</strong>, a <a href="https://CRAN.R-project.org/package=data.table"><span class="pkg">data.table</span></a> of
exposed growing points in the latent period phase of infection.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>tidy_trace()</code>, <code>summarise_trace()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# First weather data needs to be imported and formatted with `format_weather`
Newmarracarra &lt;-
   read.csv(system.file("extdata",
            "1998_Newmarracarra_weather_table.csv", package = "ascotraceR"))
station_data &lt;-
   system.file("extdata", "stat_dat.csv", package = "ascotraceR")

weather_dat &lt;- format_weather(
   x = Newmarracarra,
   POSIXct_time = "Local.Time",
   temp = "mean_daily_temp",
   ws = "ws",
   wd_sd = "wd_sd",
   rain = "rain_mm",
   wd = "wd",
   station = "Location",
   time_zone = "Australia/Perth",
   lonlat_file = station_data)

# Now the `trace_asco` function can be run to simulate disease spread
traced &lt;- trace_asco(
  weather = weather_dat,
  paddock_length = 100,
  paddock_width = 100,
  initial_infection = "1998-06-10",
  sowing_date = "1998-06-09",
  harvest_date = "1998-06-30",
  time_zone = "Australia/Perth",
  gp_rr = 0.0065,
  primary_inoculum_intensity = 40,
  spores_per_gp_per_wet_hour = 0.22,
  primary_infection_foci = "centre")

traced[[23]] # extracts the model output for day 23

</code></pre>


</div>