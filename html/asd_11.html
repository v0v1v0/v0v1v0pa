<div class="container">

<table style="width: 100%;"><tr>
<td>treatsel.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ASD simulation for treatment selection
</h2>

<h3>Description</h3>

<p>Function <code>treatsel.sim</code> runs simulations for a trial design that tests a number of experimental treatments against a single control treatment group in a seamless adaptive trial. Test treatments are compared to the control treatment using Dunnett's many-to-one testing procedure. An interim analysis is undertaken using an early outcome measure for each treatment (and control). A decision is made on which of the treatments to take forward, using a pre-defined selection rule. Data are simulated for the final outcome measure, and data from the interim and final analyses for the final outcome measure are combined together using either the inverse normal or Fisher combination test, and hypotheses tested at the selected level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">treatsel.sim(n=list(stage1=32,stage2=32),
             effect=list(early=c(0,0,0),final=c(0,0,0)),
             outcome=list(early="N",final="N"),nsim=1000,
             corr=0,seed=12345678,select=0,epsilon=1,
             weight=NULL,thresh=1,level=0.025,ptest=c(1),
             method="invnorm",fu=FALSE,file = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>List giving sample sizes for each treatment group at stage 1 (interim) and stage 2 (final) analyses
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>

<p>List giving effect sizes for early and final outcomes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outcome</code></td>
<td>

<p>List giving outcome type for early and final outcomes; available options are “<code>N</code>”, “<code>T</code>” and “<code>B</code>”, for normal, time-to-event and binary data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>

<p>Number of simulations (maximum=10,000,000)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>

<p>Correlation between early and final outcomes
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Seed number
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>

<p>Selection rule type (<code>select.rule</code>); 0 = select all treatments, 1 = select maximum, 2 = select maximum two, 3 = select maximum three, 4 = epsilon rule (select means within epsilon of maximum), 5 = randomly select  a single treatment and 6 = threshold rule (select means greater than or equal to threshold)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>

<p>For <code>select</code> = 4, set epsilon criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>

<p>Optional user set weight for combination test; default is to use those suggested by Jenkins <em>et al.</em> (2011)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>

<p>For <code>select</code> = 6, set threshold criterion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>Test level (default=0.025)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptest</code></td>
<td>

<p>Vector of treatment numbers for determining power; for example, c(1,2) will count rejections of one or both hypotheses for testing treatments 1 and 2 against the control
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Select combination method; available options are “<code>invnorm</code>” or “<code>fisher</code>”, with default “<code>invnorm</code>”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fu</code></td>
<td>

<p>Logical indicating whether patients from dropped treatments (after interim selection) should be followed-up; default <code>FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>File name to dump output; if unset will default to R console
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A structured description of the the methodology and the simulation model is given by Friede <em>et al.</em> (2011) and implementation by Parsons <em>et al.</em> (2012).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>count.total</code></td>
<td>
<p>Number of times one or more treatments are selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select.total</code></td>
<td>
<p>Number of times each test treatment is selected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject.total</code></td>
<td>
<p>Number of times each hypothesis is rejected</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.reject</code></td>
<td>
<p>Number of times one or more of the treatments selected using <code>ptest</code> is rejected</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Nick Parsons (<a href="mailto:nick.parsons@warwick.ac.uk">nick.parsons@warwick.ac.uk</a>)
</p>


<h3>References</h3>

<p>Friede T, Parsons N, Stallard N, Todd S, Valdes Marquez E, Chataway J, Nicholas R. Designing a Seamless Phase II/III Clinical Trial using Early Outcomes for Treatment Selection: an Application in Multiple Sclerosis. <em>Statistics in Medicine</em> 2011;30:1528-1540.<br></p>
<p>Parsons N, Friede T, Todd S, Valdes Marquez E, Chataway J, Nicholas R, Stallard N. An R package for implementing simulations for seamless phase II/III clinicals trials using early outcomes for treatment selection. <em>Computational Statistics and Data Analysis</em> 2012;56:1150-1160.<br></p>
<p>Bretz F, Schmidli H, Koenig F, Racine A, Maurer W. Confirmatory seamless phase II/III clinical trials with hypotheses selection at interim: General concepts. <em>Biometrical Journal</em> 2006;48:623-634.<br></p>


<h3>See Also</h3>

<p><code>gtreatsel.sim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# two test treatment groups
# effect size = 0.3 for group 1
# for both early and final normal outcomes
# correlation = 0.3
# select one treatment only at interim
treatsel.sim(n=list(stage1=100,stage2=300),
        effect=list(early=c(0,0.3,0),final=c(0,0.3,0)),
        outcome=list(early="N",final="N"),
        nsim=100,corr=0.3,seed=145514,select=1,
        level=0.025,ptest=c(1,2),fu=FALSE,
        method="invnorm",file="")

# five test treatment groups
# correlation = 0.3
# flexible selection rule, with epsilon = 1
treatsel.sim(n=list(stage1=100,stage2=300),
        effect=list(early=c(0,0.3,0.2,0.1,0.3,0.05),
        final=c(0,0.2,0.3,0.2,0.1,0.5)),
        outcome=list(early="N",final="N"),
        nsim=200,corr=0.3,seed=145514,select=4,epsilon=1,
        level=0.025,ptest=c(1:5),method="invnorm")

</code></pre>


</div>