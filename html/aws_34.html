<div class="container">

<table style="width: 100%;"><tr>
<td>nlmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
NLMeans filter in 1D/2D/3D
</h2>

<h3>Description</h3>

<p>Implements the Non-Local-Means Filter of Buades et al 2005
</p>


<h3>Usage</h3>

<pre><code class="language-R">nlmeans(x, lambda, sigma, patchhw = 1, searchhw = 7, pd = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>1, 2 or 3-dimensional array of obseved response (image intensity) data.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>scale factor for kernel in image space.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>

<p>error standard deviation (for additive Gaussian errors).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patchhw</code></td>
<td>

<p>Half width of patches in each dimension (patchsize is <code>(2*patchhw+1)^d</code>
for d-dimensional array).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchhw</code></td>
<td>

<p>Half width of search area (size of search area is <code>(2searchhw+1)^d</code>
for d-dimensional array)).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>

<p>If <code>pd &lt; (2*patchhw+1)^d</code> use <code>pd</code> principal components instead
of complete patches.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The implementation follows the description of the Non-Local-Means Filter of
Buades et al 2005 on <a href="http://www.numerical-tours.com/matlab/denoisingadv_6_nl_means/#biblio">http://www.numerical-tours.com/matlab/denoisingadv_6_nl_means/#biblio</a>
that incorporates dimension reduction for patch comparisons by PCA.
</p>


<h3>Value</h3>



<p>A list of class <code>"nlmeans"</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Denoised array</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Scale parameter used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The error standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patchhw</code></td>
<td>
<p>Half width of patches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pd</code></td>
<td>
<p>Effective patchsize used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>searchhw</code></td>
<td>
<p>Half width of search area</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>use <code>setCores='number of threads'</code> to enable parallel execution.
</p>


<h3>Author(s)</h3>

<p> Joerg Polzehl, <a href="mailto:polzehl@wias-berlin.de">polzehl@wias-berlin.de</a>,
<a href="https://www.wias-berlin.de/people/polzehl/">https://www.wias-berlin.de/people/polzehl/</a>
</p>


<h3>References</h3>

<p>J. Polzehl, K. Papafitsoros, K. Tabelow (2020). Patch-Wise Adaptive Weights Smoothing in R, Journal of
Statistical Software, 95(6), 1-27. doi:10.18637/jss.v095.i06 .
</p>
<p>A. Buades, B. Coll and J. M. Morel (2006). A review of image denoising algorithms, with a new one.
Simulation, 4, 490-530. DOI:10.1137/040616024.
</p>
<p><a href="http://www.numerical-tours.com/matlab/denoisingadv_6_nl_means/#biblio">http://www.numerical-tours.com/matlab/denoisingadv_6_nl_means/#biblio</a>
</p>


</div>