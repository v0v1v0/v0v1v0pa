<div class="container">

<table style="width: 100%;"><tr>
<td>ABC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluating ABC for each fitted model<br>
</h2>

<h3>Description</h3>

<p>This function evaluates ABC score for fitted model, one model at a time. For a model I,
the ABC is defined as
</p>
<p style="text-align: center;"><code class="reqn">ABC(I)=\sum\limits_{i=1}^n\bigg(Y_i-\hat{Y}_i^{I}\bigg)^2+2r_I\sigma^2+\lambda\sigma^2C_I.</code>
</p>

<p>When comparing ABC of fitted models to the same data set, the smaller
the ABC, the better fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ABC(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  sigma = NULL,
  extract = "No",
  varind = NULL,
  interaction.ind = NULL,
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  lambda = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is "Strong".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract</code></td>
<td>
<p>A either "Yes" or "No" logical vector that represents whether or not
to extract specific columns from <code>X</code>. Default is "No".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varind</code></td>
<td>
<p>Only used when <code>extract = "Yes"</code>. A numeric vector of class
<code>c()</code> that specifies the indices of variables to be extracted from <code>X</code>.
If <code>varind</code> contains indices of two-way interaction effects, then this function
automatically generates corresponding two-way interaction effects from <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interaction.ind</code></td>
<td>
<p>Only used when <code>extract = "Yes"</code>. A two-column numeric
matrix containing all possible two-way interaction effects. It must be generated
outside of this function using <code>t(utils::combn())</code> or <code>indchunked()</code>. See Example section for
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td>
</tr>
</table>
<h3>Details</h3>


<ul>
<li>
<p> For inputs <code>pi1</code>, <code>pi2</code>, and <code>pi3</code>, the number needs to
satisfy the condition: <code class="reqn">\pi_1+\pi_2+\pi_3=1-\pi_0</code> where <code class="reqn">\pi_0</code>
is a numeric value between 0 and 1, the smaller the better.
</p>
</li>
<li>
<p> For input <code>lambda</code>, the number needs to satisfy the condition:
<code class="reqn">\lambda\geq 5.1/log(2)</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A numeric value is returned. It represents the ABC score of the fitted model.
</p>


<h3>References</h3>

<p>Ye, C. and Yang, Y., 2019. <em>High-dimensional adaptive minimax sparse estimation with interactions.</em>
</p>


<h3>See Also</h3>

<p><code>Extract</code>, <code>initial</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># sigma is unknown
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y&lt;- 1+X[,1]+X[,2]+X[,3]+X[,4]+epl
ABC(X, y, nmain.p = 4, interaction.ind = interaction.ind)
ABC(X, y, nmain.p = 4, extract = "Yes",
    varind = c(1,2,5), interaction.ind = interaction.ind)
#'
# users want to enter a suggested value for sigma

# model with only one predictor
try(ABC(X, y, nmain.p = 4, extract = "Yes",
  varind = 1, interaction.ind = interaction.ind)) # warning message
</code></pre>


</div>