<div class="container">

<table style="width: 100%;"><tr>
<td>BinAddHaz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Binomial Additive Hazard Models</h2>

<h3>Description</h3>

<p>This function fits binomial additive hazard models subject to linear inequality constraints using the function <code>constrOptim</code> in the <code>stats</code> package for binary outcomes. Additionally, it calculates the cause-specific contributions to the disability prevalence based on the attribution method, as proposed by Nusselder and Looman (2004).
</p>


<h3>Usage</h3>

<pre><code class="language-R">BinAddHaz(formula, data, subset, weights, na.action, model = TRUE,
          contrasts = NULL, start, attrib = TRUE,
          attrib.var, collapse.background = FALSE, attrib.disease = FALSE,
          type.attrib = "abs", seed, bootstrap = FALSE, conf.level = 0.95,
          nbootstrap, parallel = FALSE, type.parallel = "snow", ncpus = 4,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression of the form response ~ predictors, similar to other regression models. In case of <code>attrib = TRUE</code>, the first predictor in the formula should be the <code>attrib.var</code>. See example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame or matrix containing the variables in the model. If not found in <code>data</code>, the variables are taken from environment(formula), typically the environment from which <code>BinAddHaz</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process. All observations are included by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of survey weights to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when the data contain NAs. The default is set by the <code>na.action</code> setting of options, and is <code>na.fail</code> if that is unset. The 'factory-fresh' default is <code>na.omit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>logical. If <code>TRUE</code>, the model frame is included as a component of the returned object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list to be used for some or all of the factors appearing as variables in the model formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional vector of starting values. If not provided by the user, it is automatically generated using <code>glm</code>, <code>family = poisson</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrib</code></td>
<td>
<p>logical. Should the attribution of disability to chronic diseases/conditions be estimated? Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrib.var</code></td>
<td>
<p>character indicating the name of the attribution variable to be used if <code>attrib = TRUE</code>. If missing, the attribution results will not be stratified by the levels of the attribution variable. The attribution variable must be the first variable included in the linear predictor in <code>formula</code>. See example.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse.background</code></td>
<td>
<p>logical. Should the background be collapsed across the levels of the <code>attrib.var</code>? If <code>FALSE</code>, the background will be estimated for each level of the <code>attrib.var</code>. If <code>TRUE</code>, only one background will be estimated. If <code>TRUE</code>, <code>attrib.var</code> must be specified. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrib.disease</code></td>
<td>
<p>logical. Should the attribution of diseases be stratified by the levels of the attribution variable? If <code>FALSE</code>, the attribution of diseases will not be stratified by the levels of the <code>attrib.var</code>. If <code>TRUE</code>, the attribution of diseases will be estimated for each level of the <code>attrib.var</code>. If <code>TRUE</code>, interaction between diseases and the attribution variable must be provided in the <code>formula</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.attrib</code></td>
<td>
<p>type of attribution to be estimated. The options are <code>"abs"</code> for  absolute contribution, <code>"rel"</code> for relative contribution, or <code>"both"</code> for both absolute and relative contributions. Default is <code>"abs"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an optional integer indicating the random seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>logical. Should bootstrap percentile confidence intervals be estimated for the model parameters and attributions? Default is <code>FALSE</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>scalar containing the confidence level of the bootstrap percentile confidence intervals. Default is <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbootstrap</code></td>
<td>
<p>integer. Number of bootstrap replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. Should parallel calculations be used to obtain the bootstrap percentile confidence intervals? Only valid if <code>bootstrap = TRUE</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.parallel</code></td>
<td>
<p>type of parallel operation to be used (if <code>parallel = TRUE</code>), with options: <code>"multicore"</code> and <code>"snow"</code>. Default is <code>"snow"</code>. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncpus</code></td>
<td>
<p>integer. Number of processes to be used in the parallel operation: typically one would choose this to be the number of available CPUs. Default is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to or from the other functions.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model is a generalized linear model with a non-canonical link function, which requires a restriction on the linear predictor (<code class="reqn">\eta \ge 0</code>) to produce valid probabilities. This restriction is implemented in the optimization procedure, with an adaptive barrier algorithm, using the function <code>constrOptim</code> in the <code>stats</code> package.
</p>
<p>The variance-covariance matrix is based on the observed information matrix.
</p>
<p>This version of the package only allows the calculation of non-parametric bootstrap percentile confidence intervals (CI). Also,  the function gives the user the option to do parallel calculation of the bootstrap CI. The <code>snow</code> parallel option is available for all operating systems (Windows, Linux, and Mac OS) while the <code>multicore</code> option is  only available for Linux and Mac OS systems. These two calculations are done by calling the <code>boot</code> function in the <code>boot</code> package. For more details, see the documentation of the <code>boot</code> package.
</p>
<p>More information about the binomial additive hazard model and the calculation of the contribution of chronic conditions to the disability prevalence can be found in the references.
</p>


<h3>Value</h3>

<p>A list with arguments:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>numerical vector with the regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>confidence intervals calculated via bootstraping (if <code>bootstrap = TRUE</code>) or as the inverse of the observed information matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resDeviance</code></td>
<td>
<p>residual deviance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>numerical vector of p-values based on the Wald test. Only provided if  <code>bootstrap = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdError</code></td>
<td>
<p>numerical vector with the standard errors for the parameter estimates based on the inverse of the observed information matrix. Only provided if  <code>bootstrap = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>variance-covariance (inverse of the observed information matrix). Only provided if <code>bootstrap = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contribution</code></td>
<td>
<p>for  <code>type.attrib = "abs"</code> or  <code>"rel"</code>, a matrix is provided. For  <code>type.attrib = "both"</code>, a list with two matrices ( <code>"abs"</code> and  <code>"rel"</code>) is provided. This represents the contribution of each predictor in the model (usually diseases) to the disability prevalence. Percentile bootstrap confidence intervals are provided if  <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootsRep</code></td>
<td>
<p>matrix with the bootstrap replicates of the regression coefficients and contributions (if <code>attrib = TRUE</code>). If <code>attrib = FALSE</code>, it returns a logical, <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the bootstrap CI. Only provided if <code>bootstrap = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstrap</code></td>
<td>
<p>logical. Was bootstrap CI requested?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming the linear predictor by the inverse of the link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>difference between the observed response and the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Renata T C Yokota. This function is based on the R code developed by Caspar W N Looman and Wilma J Nusselder for non R-users, with modifications. Original R code is available upon request to Wilma J Nusselder (w.nusselder@erasmusmc.nl).
</p>


<h3>References</h3>

<p>Nusselder, W.J., Looman, C.W.N. (2004). Decomposition of differences in health expectancy by cause. Demography, 41(2), 315-334.
</p>
<p>Nusselder, W.J., Looman, C.W.N. (2010). WP7: Decomposition tools: technical report on attribution tool. European Health Expectancy Monitoring Unit (EHEMU). Available at
&lt;<a href="http://www.eurohex.eu/pdf/Reports_2010/2010TR7.2_TR%20on%20attribution%20tool.pdf">http://www.eurohex.eu/pdf/Reports_2010/2010TR7.2_TR%20on%20attribution%20tool.pdf</a>&gt;.
</p>
<p>Yokota, R.T.C., Van Oyen, H., Looman, C.W.N., Nusselder, W.J., Otava, M., Kifle, Y.W., Molenberghs, G. (2017). Multinomial additive hazard model to assess the disability burden using cross-sectional data. Biometrical Journal, 59(5), 901-917.
</p>


<h3>See Also</h3>

<p><code>MultAddHaz</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(disabData)

  ## Model without bootstrap CI and no attribution

  fit1 &lt;- BinAddHaz(dis.bin ~ diab + arth + stro , data = disabData, weights = wgt,
                    attrib = FALSE)
  summary(fit1)

  ## Model with bootstrap CI and attribution without stratification, no parallel calculation
  # Warning message due to the low number of bootstrap replicates
## Not run: 
  fit2 &lt;- BinAddHaz(dis.bin ~ diab + arth + stro , data = disabData, weights = wgt,
                    attrib = TRUE, collapse.background = FALSE, attrib.disease = FALSE,
                    type.attrib = "both", seed = 111, bootstrap = TRUE, conf.level = 0.95,
                    nbootstrap = 5)
  summary(fit2)

  ## Model with bootstrap CI and attribution of diseases and background stratified by
  ## age, with parallel calculation of bootstrap CI
  # Warning message due to the low number of bootstrap replicates

  diseases &lt;- as.matrix(disabData[,c("diab", "arth", "stro")])
  fit3 &lt;- BinAddHaz(dis.bin ~ factor(age) -1 + diseases:factor(age), data = disabData,
                    weights = wgt, attrib = TRUE, attrib.var = age,
                    collapse.background = FALSE, attrib.disease = TRUE, type.attrib = "both",
                    seed = 111,  bootstrap = TRUE, conf.level = 0.95, nbootstrap = 10,
                    parallel = TRUE, type.parallel = "snow", ncpus = 4)
  summary(fit3)
## End(Not run)
</code></pre>


</div>