<div class="container">

<table style="width: 100%;"><tr>
<td>betabin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beta-Binomial Model for Proportions</h2>

<h3>Description</h3>

<p>Fits a beta-binomial generalized linear model accounting for overdispersion in clustered binomial data <code class="reqn">(n, y)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  betabin(formula, random, data, link = c("logit", "cloglog"), phi.ini = NULL,
          warnings = FALSE, na.action = na.omit, fixpar = list(),
          hessian = TRUE, control = list(maxit = 2000), ...)
  </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula for the fixed effects <code>b</code>. The left-hand side of the formula must be of the form
<code>cbind(y, n - y)</code> where the modelled probability is <code>y/n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>A right-hand formula for the overdispersion parameter(s) <code class="reqn">\phi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link</code></td>
<td>
<p>The link function for the mean <code class="reqn">p</code>: “logit” or “cloglog”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the response (<code>n</code> and <code>y</code>) and explanatory variable(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.ini</code></td>
<td>
<p>Initial values for the overdispersion parameter(s) <code class="reqn">\phi</code>. Default to 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>Logical to control the printing of warnings occurring during log-likelihood maximization. 
Default to <code>FALSE</code> (no printing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>A function name: which action should be taken in the case of missing value(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixpar</code></td>
<td>
<p>A list with 2 components (scalars or vectors) of the same size, indicating which parameters are 
fixed (i.e., not optimized) in the global parameter vector <code class="reqn">(b, \phi)</code> and the corresponding fixed values.<br>
For example, <code>fixpar = list(c(4, 5), c(0, 0))</code> means that 4th and 5th parameters of the model are set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>A logical. When set to <code>FALSE</code>, the hessian and the variances-covariances matrices of the 
parameters are not computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list to control the optimization parameters. See <code>optim</code>. By default, set the maximum number of iterations to 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given cluster <code class="reqn">(n, y)</code>, the model is:
</p>
<p style="text-align: center;"><code class="reqn">y~|~\lambda \sim Binomial(n,~\lambda)</code>
</p>

<p>with <code class="reqn">\lambda</code> following a Beta distribution <code class="reqn">Beta(a1,~a2)</code>.<br>
If <code class="reqn">B</code> denotes the beta function, then:
</p>
<p style="text-align: center;"><code class="reqn">P(\lambda) = \frac{\lambda^{a1~-~1} * (1~-~\lambda)^{a2 - 1}}{B(a1,~a2)}</code>
</p>

<p style="text-align: center;"><code class="reqn">E[\lambda] = \frac{a1}{a1 + a2}</code>
</p>

<p style="text-align: center;"><code class="reqn">Var[\lambda] = \frac{a1 * a2}{(a1 + a2 + 1) * (a1 + a2)^2}</code>
</p>

<p>The marginal beta-binomial distribution is:
</p>
<p style="text-align: center;"><code class="reqn">P(y) = \frac{C(n,~y) * B(a1 + y, a2 + n - y)}{B(a1,~a2)}</code>
</p>

<p>The function uses the parameterization <code class="reqn">p = \frac{a1}{a1 + a2} = h(X b) = h(\eta)</code> and <code class="reqn">\phi = \frac{1}{a1 + a2 + 1}</code>, 
where <code class="reqn">h</code> is the inverse of the link function (logit or complementary log-log), <code class="reqn">X</code> is a design-matrix, <code class="reqn">b</code> 
is a vector of fixed effects, <code class="reqn">\eta = X b</code> is the linear predictor and <code class="reqn">\phi</code> is the overdispersion
parameter (i.e., the intracluster correlation coefficient, which is here restricted to be positive).<br>
The marginal mean and variance are:
</p>
<p style="text-align: center;"><code class="reqn">E[y] = n * p</code>
</p>

<p style="text-align: center;"><code class="reqn">Var[y] = n * p * (1 - p) * [1 + (n - 1) * \phi]</code>
</p>

<p>The parameters <code class="reqn">b</code> and <code class="reqn">\phi</code> are estimated by maximizing the log-likelihood of the marginal model (using the
function <code>optim</code>). Several explanatory variables are allowed in <code class="reqn">b</code>, only one in <code class="reqn">\phi</code>.
</p>


<h3>Value</h3>

<p>An object of formal class “glimML”: see <code>glimML-class</code> for details.
</p>


<h3>Author(s)</h3>

<p>Matthieu Lesnoff <a href="mailto:matthieu.lesnoff@cirad.fr">matthieu.lesnoff@cirad.fr</a>, Renaud Lancelot <a href="mailto:renaud.lancelot@cirad.fr">renaud.lancelot@cirad.fr</a>
</p>


<h3>References</h3>

<p>Crowder, M.J., 1978. <em>Beta-binomial anova for proportions</em>. Appl. Statist. 27, 34-37.<br>
Griffiths, D.A., 1973. <em>Maximum likelihood estimation for the beta-binomial distribution and an application
to the household distribution of the total number of cases of disease</em>. Biometrics 29, 637-648.<br>
Prentice, R.L., 1986. <em>Binary regression using an extended beta-binomial distribution, with discussion of
correlation induced by covariate measurement errors</em>. J.A.S.A. 81, 321-327.<br>
Williams, D.A., 1975. <em>The analysis of binary responses from toxicological experiments involving
reproduction and teratogenicity</em>. Biometrics 31, 949-952.
</p>


<h3>See Also</h3>

 <p><code>glimML-class</code>, <code>glm</code> and <code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(orob2)
  fm1 &lt;- betabin(cbind(y, n - y) ~ seed, ~ 1, data = orob2)
  fm2 &lt;- betabin(cbind(y, n - y) ~ seed + root, ~ 1, data = orob2)
  fm3 &lt;- betabin(cbind(y, n - y) ~ seed * root, ~ 1, data = orob2)
  # show the model
  fm1; fm2; fm3
  # AIC
  AIC(fm1, fm2, fm3)
  summary(AIC(fm1, fm2, fm3), which = "AICc")
  # Wald test for root effect
  wald.test(b = coef(fm3), Sigma = vcov(fm3), Terms = 3:4)
  # likelihood ratio test for root effect
  anova(fm1, fm3)
  # model predictions
  New &lt;- expand.grid(seed = levels(orob2$seed),
                     root = levels(orob2$root))
  data.frame(New, predict(fm3, New, se = TRUE, type = "response"))
  # Djallonke sheep data
  data(dja)
  betabin(cbind(y, n - y) ~ group, ~ 1, dja)
  # heterogeneous phi
  betabin(cbind(y, n - y) ~ group, ~ group, dja,
          control = list(maxit = 1000))
  # phi fixed to zero in group TREAT
   betabin(cbind(y, n - y) ~ group, ~ group, dja,
    fixpar = list(4, 0))
  # glim without overdispersion
  summary(glm(cbind(y, n - y) ~ group,
    family = binomial, data = dja))
  # phi fixed to zero in both groups
  betabin(cbind(y, n - y) ~ group, ~ group, dja,
    fixpar = list(c(3, 4), c(0, 0))) 
  </code></pre>


</div>