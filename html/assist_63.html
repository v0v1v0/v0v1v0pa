<div class="container">

<table style="width: 100%;"><tr>
<td>slm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a Semi-parametric Linear Mixed Effects Model
</h2>

<h3>Description</h3>

<p>Returns an object of class <code>slm</code> that represents a
semi-parametric linear mixed effects model fit. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">slm(formula, rk, data=list(), random, weights=NULL, 
correlation=NULL, control=list(apVar=FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>a formula object, with the response on the left of a <code class="reqn">\sim</code> operator, and the bases 
of the null space <code class="reqn">H_0</code> of the non-parametric function and other terms, separated by + operators, on the right.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rk</code></td>
<td>

<p>a list of expressions that specify the reproducing kernels of the spline function(s), <code class="reqn">R^1,\dots,R^p</code> for spaces <code class="reqn">H_1,\dots,H_p</code>. See the help file of ssr for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>An optional data frame containing the variables appearing in <code>formula</code>, <code>random</code>, <code>rk</code>, <code>correlation</code>, <code>weights</code>. 
By default, the variables are taken from the environment from which <code>slm</code> is called.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>

<p>A named list of formulae, lists of formulae, or pdMat objects, which defines
nested random effects structures. See help file of lme for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>An optional <code>varFun</code> object or one-sided formula describing the within-group heteroscedasticity stucture. 
See the help file of <code>lme</code> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>

<p>An optional <code>corStruct</code> object specifying the within-group correlation structure. See <code>lme</code> for more details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>an optional list of any applicable control parameters from <code>lme</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This generic function fits a semi-parametric linear mixed effects model (or non-parametric mixed effects models) 
as described in Wang (1998), but allowing for general random and correlation structures. Because the connection
to a linear mixed effects model is adopted, only GML is available to choose smoothing parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>slm</code> is returned. Generic functions such as print, summary, predict and intervals have
methods to show the results of the fit.
</p>
<p>Note: output from earlier versions of <code>slm</code> shows incorrect smoothing spline parameters for SSANOVA, which is corrected in this version.
</p>


<h3>Author(s)</h3>

<p>Chunlei Ke <a href="mailto:chunlei_ke@yahoo.com">chunlei_ke@yahoo.com</a> and Yuedong Wang <a href="mailto:yuedong@pstat.ucsb.edu">yuedong@pstat.ucsb.edu</a>.</p>


<h3>References</h3>

<p>Wang, Y. (1998) Mixed Effects Smoothing Spline ANOVA. JRSS, Series B, 60:159â€“174.
</p>
<p>Pinherio, J. C. and Bates, D. M. (2000) Mixed-effects Models in S and S-Plus. Springer.       
</p>


<h3>See Also</h3>

<p><code>ssr</code>, <code>predict.slm</code>, <code>intervals.slm</code>,
<code>print.slm</code>,<code>summary.slm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## SS ANOVA is used to model "time" and "group" 
## with random intercept for "dog".
data(dog)

dog.fit&lt;- slm(y~group*time, rk=list(cubic(time), shrink1(group),
    	rk.prod(kron(time-0.5),shrink1(group)),rk.prod(cubic(time), 
    	shrink1(group))), random=list(dog=~1), data=dog)

## End(Not run)
</code></pre>


</div>