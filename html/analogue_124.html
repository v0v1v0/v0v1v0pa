<div class="container">

<table style="width: 100%;"><tr>
<td>cma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Close modern analogues</h2>

<h3>Description</h3>

<p>Extracts and formats close modern analogue samples from a modern
reference set that are closer than a defined cut off threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cma(object, ...)

## Default S3 method:
cma(object, ...)

## S3 method for class 'analog'
cma(object, cutoff, prob = c(0.01, 0.025, 0.05), ...)

## S3 method for class 'mat'
cma(object, k, cutoff, prob = c(0.01, 0.025, 0.05), ...)

## S3 method for class 'predict.mat'
cma(object, k, cutoff, prob = c(0.01, 0.025,
0.05), ...)

## S3 method for class 'cma'
plot(x, method = c("overplot", "jitter", "stack"),
   jitter = 0.1, vertical = FALSE,
   draw.quant = TRUE, xlab = NULL, ylab = "",
   main = "", cex.axis = NULL, ...,
   col.quant = "red", lty.quant= "dashed")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object for which close modern analogues are to be
returned. Currently only for objects of class <code>analog</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric; the number of analogues to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>numeric; critical value determining level below which
samples from the modern reference set are defined as close modern
analogues. May be missing, in which case the 2.5% quantile of the
training set dissimilarities is used unless <code>object$train</code> is
<code>NULL</code>, in which case <code>"cutoff"</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>numeric vector of probabilities with values in [0,1], for
which quantiles of the distribution of training set dissimilarities
will be calculated. See <code>quantile</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to other <code>cma</code>
methods or additional arguments passed to <code>stripchart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"cma"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used to separate coincident points. The
default method<br><code>"overplot"</code> causes such points to be
overplotted, but it is also possible to specify <code>"jitter"</code> to 
jitter the points, or <code>"stack"</code> have coincident points
stacked.  The last method only makes sense for very granular data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>when <code>method="jitter"</code> is used, <code>jitter</code> gives
the amount of jittering applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vertical</code></td>
<td>
<p>when vertical is <code>TRUE</code> the plots are drawn
vertically rather than the default horizontal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.quant</code></td>
<td>
<p>logical; should the quantiles be drawn on the stripchart?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab,main</code></td>
<td>
<p>Graphical parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation
relative to the current setting of <code>cex</code>. See
<code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.quant,lty.quant</code></td>
<td>
<p>colour and line type in which to drawn the
quantile lines.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot method is simply a wrapper to <code>stripchart</code>.
</p>
<p>The methods for <code>mat</code> and <code>predict.mat</code> objects allow the
user to select the k-closest analogues (argument <code>k</code>) or those
samples as close or closer than a stated threshold of dissimilarity
(argument <code>cutoff</code>). Only one of <code>k</code> and <code>cutoff</code> may
be specified. If neither is specified, <code>getK</code> is used to
extract the value for <code>k</code> stored within <code>object</code>. As such,
the default is to return the automatically selected set of <code>k</code>
closest samples, behaviour that is consistent with other functions in
the package.
</p>


<h3>Value</h3>

<p>For the plot method, a plot on the current device. Invisibly the
plotted data are returned; see Note for further details.
</p>
<p>A list of class <code>"cma"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>close</code></td>
<td>
<p>a named list of named vectors of close modern analogues
and their dissimilarities. The names of the list components are the
names of the fossil samples. The named vector in each
component of <code>close</code> is the distances for the close modern
analogues from the training set that are as close as <code>cutoff</code>,
or closer, to the fossil sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>the cutoff threshold used to define close modern
analogues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>numeric vector of the requested quantiles. Note returned
by the <code>predict.mat</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>the probabilities of the requested quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character; the dissimilarity coefficient used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.analogs</code></td>
<td>
<p>numeric vector of the number of analogues per fossil
sample.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Only objects of classes <code>analog</code>, <code>mat</code>, and
<code>predict.mat</code> are supported.
</p>
<p>The plot method invisibly returns a list with the following
components:
</p>

<dl>
<dt><code>distances</code></dt>
<dd>
<p>a vector of stacked distances extracted from
<code>object</code>.</p>
</dd>
<dt><code>groups</code></dt>
<dd>
<p>a factor listing the fossil sample for which the
distances are the distances to the close modern analogues for the
training set.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>References</h3>

<p>Flower, R.J., Juggins, S. and Battarbee, R.W. (1997) Matching diatom
assemblages in lake sediment cores and modern surface sediment
samples: the implications for lake conservation and restoration with
special reference to acidified systems. <em>Hydrobiologia</em>
<strong>344</strong>; 27–40.
</p>
<p>Simpson, G.L., Shilland, E.M., Winterbottom, J. M. and Keay, J. (2005)
Defining reference conditions for acidified waters using a modern
analogue approach. <em>Environmental Pollution</em> <strong>137</strong>;
119–133.
</p>


<h3>See Also</h3>

<p><code>analog</code>, <code>stripchart</code>, or
<code>boxplot</code> for an alternative representation.</p>


<h3>Examples</h3>

<pre><code class="language-R">## Imbrie and Kipp example
## load the example data
data(ImbrieKipp)
data(SumSST)
data(V12.122)

## merge training and test set on columns
dat &lt;- join(ImbrieKipp, V12.122, verbose = TRUE)

## extract the merged data sets and convert to proportions
ImbrieKipp &lt;- dat[[1]] / 100
V12.122 &lt;- dat[[2]] / 100

## analog matching between SWAP and RLGH reference samples
(ik.ana &lt;- analog(ImbrieKipp, V12.122, method = "chord"))

## close modern analogues
(ik.cma &lt;- cma(ik.ana, cutoff = 0.4))
summary(ik.cma)

## plot the results
plot(ik.cma)

</code></pre>


</div>