<div class="container">

<table style="width: 100%;"><tr>
<td>AdjustAPOTC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Adjust the parameters of the APackOfTheClones reduction in a seurat
object</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a>
</p>
<p>If the user is unsatisfied with the clonal expansion plot that
was generated from <code>RunAPOTC()</code> and <code>APOTCPlot()</code>, this function has a range of
arguments to modify the data and/or parameters of the visualization. Note
that some of the arguments may conflict with each other.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AdjustAPOTC(
  seurat_obj,
  reduction_base = NULL,
  clonecall = NULL,
  ...,
  extra_filter = NULL,
  run_id = NULL,
  new_rad_scale_factor = NULL,
  new_clone_scale_factor = NULL,
  repulse = FALSE,
  repulsion_threshold = 1,
  repulsion_strength = 1,
  max_repulsion_iter = 10L,
  relocate_cluster = NULL,
  relocation_coord = NULL,
  nudge_cluster = NULL,
  nudge_vector = NULL,
  recolor_cluster = NULL,
  new_color = NULL,
  rename_label = NULL,
  new_label = NULL,
  relocate_label = NULL,
  label_relocation_coord = NULL,
  nudge_label = NULL,
  label_nudge_vector = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seurat_obj</code></td>
<td>
<p>The seurat object to be adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction_base</code></td>
<td>
<p>character. The seurat reduction to base the clonal
expansion plotting on. Defaults to <code>'umap'</code> but can be any reduction present
within the reductions slot of the input seurat object, including custom ones.
If ''pca'“, the cluster coordinates will be based on PC1 and PC2.
However, generally APackOfTheClones is used for displaying UMAP and
occasionally t-SNE versions to intuitively highlight clonal expansion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clonecall</code></td>
<td>
<p>character. The column name in the seurat object metadata to
use. See <code>scRepertoire</code> documentation for more information about this
parameter that is central to both packages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional "subsetting" keyword arguments indicating the rows
corresponding to elements in the seurat object metadata that should be
filtered by. E.g., <code>seurat_clusters = c(1, 9, 10)</code> will filter the cells to
those in the <code>seurat_clusters</code> column with any of the values 1, 9, and 10.
Unfortunately, column names in the seurat object metadata cannot
conflict with the keyword arguments. <em><strong>MAJOR NOTE</strong></em> if any subsetting
keyword arguments are a <em>prefix</em> of any preceding argument names (e.g. a
column named <code>reduction</code> is a prefix of the <code>reduction_base</code> argument)
R will interpret it as the same argument unless <em>both</em> arguments
are named. Additionally, this means any subsequent arguments <em>must</em> be named.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra_filter</code></td>
<td>
<p>character. An additional string that should be formatted
<em>exactly</em> like a statement one would pass into dplyr::filter that does
<em>additional</em> filtering to cells in the seurat object - on top of the other
keyword arguments - based on the metadata. This means that it will be
logically AND'ed with any keyword argument filters. This is a more flexible
alternative / addition to the filtering keyword arguments. For example, if
one wanted to filter by the length of the amino acid sequence of TCRs, one
could pass in something like <code>extra_filter = "nchar(CTaa) - 1 &gt; 10"</code>. When
involving characters, ensure to enclose with single quotes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>run_id</code></td>
<td>
<p>character. This will be the ID associated with the data of a
run, and will be used by other important functions like <code>APOTCPlot()</code> and
AdjustAPOTC. Defaults to <code>NULL</code>, in which case the ID will be generated
in the following format:
</p>
<p><code style="white-space: pre;">⁠reduction_base;clonecall;keyword_arguments;extra_filter⁠</code>
</p>
<p>where if keyword arguments and extra_filter are underscore characters if
there was no input for the <code>...</code> and <code>extra_filter</code> parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_rad_scale_factor</code></td>
<td>
<p>a single numeric in (0, 1]. changes the
radius scaling factor of all circles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_clone_scale_factor</code></td>
<td>
<p>a single numeric in (0, 1]. changes the
clone_scale_factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulse</code></td>
<td>
<p>If <code>TRUE</code>, will attempt to push overlapping clusters away from
each other.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulsion_threshold</code></td>
<td>
<p>numeric. The radius that clonal circle clusters
overlap is acceptable when repulsing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulsion_strength</code></td>
<td>
<p>numeric. The smaller the value the less the
clusters repulse each other per iteration, and vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_repulsion_iter</code></td>
<td>
<p>integer. The number of repulsion iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relocate_cluster</code></td>
<td>
<p>Numeric or Character. Indicates which
cluster(s) based on the index or label to relocate to new coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relocation_coord</code></td>
<td>
<p>numeric of length two or a list of numerics of length
two of length of <code>relocate_cluster</code>. If its a list, indicates each coordinate
that the clusters in <code>relocate_cluster</code> should move to. If its just a
numeric, then will relocate all clusters in <code>relocate_cluster</code> to the input,
which is likely not desired behavior, so this should only be convenience
syntax if <code>relocate_cluster</code> has length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nudge_cluster</code></td>
<td>
<p>Numeric or Character. Indicates which
cluster(s) based on the index or label to "nudge"/translate their
coordinate(s) by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nudge_vector</code></td>
<td>
<p>numeric of length two or a list of numerics of length
two of length of <code>nudge_cluster</code>. If its a list, indicates each translation
vector (in other words, x-y coordinates) that the clusters in
<code>nudge_cluster</code> should be translate by. If its just a numeric, then will
translate all clusters in <code>nudge_cluster</code> by the input - which mostly is
syntactic sugar for translating a single cluster if the input of
<code>nudge_cluster</code> is of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recolor_cluster</code></td>
<td>
<p>Numeric or Character. Indicates which
cluster(s) based on the index or label to change their color by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_color</code></td>
<td>
<p>character of arbitrary length. Indicates the corresponding
new colors that selected clusters in <code>recolor_cluster</code> should be changed to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rename_label</code></td>
<td>
<p>Numeric or character. Indicates the index or name of
label(s) to be renamed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_label</code></td>
<td>
<p>Character. Indicates the corresponding new label(s) that
selected label(s) in <code>rename_label</code> should be changed to.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relocate_label</code></td>
<td>
<p>Numeric or character. Indicates the index or name of
label(s) to be relocated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_relocation_coord</code></td>
<td>
<p>Numeric of length two or a list of numerics of
length two of length of <code>relocate_label</code>. If it's a list, indicates each
coordinate that the labels in <code>relocate_label</code> should move to. If it's just
a numeric, then will relocate all labels in <code>relocate_label</code> to the input,
which is likely not desired behavior, so this should only be convenience
syntax if <code>relocate_label</code> has length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nudge_label</code></td>
<td>
<p>Numeric or character. Indicates the index or name of
label(s) to be "nudged"/translated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_nudge_vector</code></td>
<td>
<p>Numeric of length two or a list of numerics of
length two of length of <code>nudge_label</code>. If it's a list, indicates each
translation vector (in other words, x-y coordinates) that the labels in
<code>nudge_label</code> should be translated by. If it's just a numeric, then will
translate all labels in <code>nudge_label</code> by the input - which mostly is
syntactic sugar for translating a single label if the input of
<code>nudge_label</code> is of length 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Decides if visual cues are displayed to the R console
of the progress.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The adjusted <code>seurat_obj</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># do an APackOfTheClones run
pbmc &lt;- RunAPOTC(get(data("combined_pbmc")), verbose = FALSE)

# adjust the rad_scale_factor, and nudge cluster 1 by x = 1, y = 1
pbmc &lt;- AdjustAPOTC(
    pbmc,
    new_rad_scale_factor = 0.9,
    nudge_cluster = 1,
    nudge_vector = c(1, 1),
    verbose = FALSE
)

# plot the result
APOTCPlot(pbmc)

# rename some labels
pbmc &lt;- AdjustAPOTC(
    pbmc, rename_label = c(2, 5), new_label = c("Foo", "Bar")
)

# perhaps multiple clusters need to be relocated and repulsed
pbmc &lt;- AdjustAPOTC(
    pbmc,
    relocate_cluster = c("Foo", "C10"), # using labels works too
    relocation_coord = list(c(2, 3.5), c(0, 5)),
    repulse = TRUE,
    verbose = FALSE
)

# plot again to check results
APOTCPlot(pbmc, show_labels = TRUE, verbose = FALSE)

</code></pre>


</div>