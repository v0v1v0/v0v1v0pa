<div class="container">

<table style="width: 100%;"><tr>
<td>ACE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analysis of Correlated High-Dimensional Expression (ACE) Data</h2>

<h3>Description</h3>

<p>A function for estimating factor models, giving factor-adjusted statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ACE(Z, X, H0_indicator, gama)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>The observed data matrix with the variables in rows and samples in columns. It is a <code class="reqn">p</code>-by-<code class="reqn">n_1</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>(Optional) The observed data matrix with the variables in rows and samples in columns. It is a <code class="reqn">p</code>-by-<code class="reqn">n_2</code> matrix.
If X is present, then perform the two-sample test; otherwise, perform one-sample test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H0_indicator</code></td>
<td>
<p>(Optional) A <code class="reqn">p</code>-dimensional vector containing only 0 and 1.
A value of 1 means the variable/gene is non-null and a value of 0 means the gene is null.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gama</code></td>
<td>
<p>FDR control level.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with S3 class <code>ACE</code> containing the following items will be returned:
</p>

<dl>
<dt><code>FDP</code></dt>
<dd>
<p>If H0_indicator exists, FDP is true FDP, otherwise, it is estimated FDP.</p>
</dd>
<dt><code>Power</code></dt>
<dd>
<p>If H0_indicator exists, power is output which is defined as the ratio of the number of correctly rejected to the number of non-nulls.</p>
</dd>
<dt><code>Rejection</code></dt>
<dd>
<p>The number of rejections.</p>
</dd>
<dt><code>Adjusted_mean_difference</code></dt>
<dd>
<p>Factor-adjusted mean difference which is a <code class="reqn">p</code>-dimensional vector.</p>
</dd>
<dt><code>Adjusted_statistics</code></dt>
<dd>
<p>Factor-adjusted statistics (<code class="reqn">p</code>-dimensional vector).</p>
</dd>
<dt><code>Threshold</code></dt>
<dd>
<p>A critical value. When absolute factor-adjusted statistics is larger than the threshold, we reject it.</p>
</dd>
<dt><code>Estimated_number_factor</code></dt>
<dd>
<p>The estimated number of factors.</p>
</dd>
<dt><code>pai1_hat</code></dt>
<dd>
<p>The estimated proportion of non-nulls.</p>
</dd>
</dl>
<h3>References</h3>

<p>Cao, H., &amp; Kosorok, M. R. (2011). Simultaneous critical values for t-tests in very high dimensions. Bernoulli, 17, 347.
</p>
<p>Wang, P., Lyu, P., Peddada, S., Cao, H. (2023+). A powerful methodology for analyzing correlated high dimensional data using factor models. results not shown.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm); library(quantreg)
p &lt;- 200; n &lt;- 100; h &lt;- 3 # the number of variables, samples and factors
berlii &lt;- rbinom(p, 1, 0.2) # 1 means the variable is non-null and 0 means it is null.
index0 &lt;- which(berlii == 0); index1 &lt;- which(berlii == 1)

mu &lt;- matrix(rep(0, 1*p), nrow=p)
mu[index1] &lt;- runif(length(index1), min=0.4, max=0.7) # expectation of data
B &lt;- matrix(runif(h*p, min=-1, max=1), nrow=p) # factor loading matrix
t_error &lt;- t(rmvt(n, sigma = diag(p), df = 10)) # error term followed t-distribution
f &lt;- t(rmvt(n, diag(h), df = 4))/sqrt(4/(4-2)) # factor followed t-distribution
Y &lt;- mu %*% matrix(rep(1, n*1), nrow=1) + B %*% f + t_error # data
res &lt;- ACE(Z = Y, H0_indicator = berlii, gama = 0.05)
res$FDP # true FDP
res$Power # power

</code></pre>


</div>