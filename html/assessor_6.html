<div class="container">

<table style="width: 100%;"><tr>
<td>resid_quasi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quasi Emprical residuals functions</h2>

<h3>Description</h3>

<p>Draw the QQ-plot for regression models with discrete outcomes using the quasi-empirical residual distribution functions.
Specifically, the model assumption of GLMs with binary, ordinal, Poisson, negative binomial,
zero-inlated Poisson, and zero-inflated negative binomial outcomes can be applicable to <code>resid_quasi()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">resid_quasi(model)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model object (e.g., <code>glm</code>, <code>glm.nb</code>, <code>polr</code>, <code>zeroinfl</code>)</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The quasi-empirical residual distribution function is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{U}(s; \beta) = \sum_{i=1}^{n} W_{n}(s;\mathbf{X}_{i},\beta) 1[F(Y_{i}| X_{i}) &lt; H(s;X_{i})]</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">W_n(s; \mathbf{X}_i, \beta) = \frac{K[(H(s; \mathbf{X}_i)-s)/ \epsilon_n]}{\sum_{j=1}^{n} K[(H(s; \mathbf{X}_j)-s)/ \epsilon_n]}</code>
</p>

<p>and <code class="reqn">K</code> is a bounded, symmetric, and Lipschitz continuous kernel.
</p>


<h3>Value</h3>

<p>A QQ plot.
</p>

<ul>
<li>
<p> x-axis: Theoretical quantiles
</p>
</li>
<li>
<p> y-axis: Sample quantiles
</p>
</li>
</ul>
<h3>References</h3>

<p>Lu Yang (2021). Assessment of Regression Models with Discrete Outcomes Using Quasi-Empirical Residual Distribution Functions, Journal of Computational and Graphical Statistics, 30(4), 1019-1035.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Negative Binomial example
library(MASS)
# Covariates
n &lt;- 500
x1 &lt;- rnorm(n)
x2 &lt;- rbinom(n, 1, 0.7)
### Parameters
beta0 &lt;- -2
beta1 &lt;- 2
beta2 &lt;- 1
size1 &lt;- 2
lambda1 &lt;- exp(beta0 + beta1 * x1 + beta2 * x2)
# generate outcomes
y &lt;- rnbinom(n, mu = lambda1, size = size1)

# True model
model1 &lt;- glm.nb(y ~ x1 + x2)
resid.nb1 &lt;- resid_quasi(model1)

# Overdispersion
model2 &lt;- glm(y ~ x1 + x2, family = poisson(link = "log"))
resid.nb2 &lt;- resid_quasi(model2)

## Zero inflated Poisson example
library(pscl)
n &lt;- 500
set.seed(1234)
# Covariates
x1 &lt;- rnorm(n)
x2 &lt;- rbinom(n, 1, 0.7)
# Coefficients
beta0 &lt;- -2
beta1 &lt;- 2
beta2 &lt;- 1
beta00 &lt;- -2
beta10 &lt;- 2

# Mean of Poisson part
lambda1 &lt;- exp(beta0 + beta1 * x1 + beta2 * x2)
# Excess zero probability
p0 &lt;- 1 / (1 + exp(-(beta00 + beta10 * x1)))
## simulate outcomes
y0 &lt;- rbinom(n, size = 1, prob = 1 - p0)
y1 &lt;- rpois(n, lambda1)
y &lt;- ifelse(y0 == 0, 0, y1)
## True model
modelzero1 &lt;- zeroinfl(y ~ x1 + x2 | x1, dist = "poisson", link = "logit")
resid.zero1 &lt;- resid_quasi(modelzero1)
</code></pre>


</div>