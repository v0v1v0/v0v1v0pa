<div class="container">

<table style="width: 100%;"><tr>
<td>run</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Run-time tools for Acumos
</h2>

<h3>Description</h3>

<p>The following functions are not exported and not intended to be used
by users, but are useful for Acumos developers, testing and used by
the platform itself.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run(where = getwd(), file = "component.zip", runtime = "runtime.json",
    init.only = FALSE)
data2msg(data, output)
msg2data(msg, input)
send.msg(url, payload, response=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>where</code></td>
<td>
<p>directory in which the component will be run</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>path to the model component file (as created by
<code>compose()</code>) or a directory containing the
unpacked content of the component.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>payload</code></td>
<td>
<p>raw vector, message to send - typically constructed by
<code>data2msg</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runtime</code></td>
<td>
<p>either path to the runtime JSON file or a structure
corresponding to the parsed payload of the file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.only</code></td>
<td>
<p>logical, if <code>TRUE</code> then the runtime is setup but
the actual server/generator is not executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data to wrap into a message - it is expected to be a list
(hence a data frame qualifies)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>name of the proto message type to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msg</code></td>
<td>
<p>raw vector containing the message</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>name of the proto message type to use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>url</code></td>
<td>
<p>string, URL to send the message to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>logical, if <code>TRUE</code> then the HTTP response object
is returned, otherwise only a logical denoting success or failure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>run</code> loads and runs the component by providing a service
endpoint on localhost and post specified by the <code>input_port</code>
property in the <code>runtime</code> object.
</p>
<p>The component file is expected to be created by the
<code>compose</code> function. <code>runtime</code>
defines the run-time properties such as input port and
outputs.
</p>
<p><code>data2msg</code> performs the conversion of native types to the binary
message for communication with other Acumos components.
</p>
<p><code>msg2data</code> converts a Acumos message to data according to the
provided schema.
</p>


<h3>Value</h3>

<p>The return value of <code>run</code> is undefined since it is executed for
its side-effect of providing the service and may never return.
</p>
<p><code>data2msg</code> returns a raw vector constituting the message
</p>
<p><code>msg2data</code> returns the data represented by the message
</p>
<p><code>send.msg</code> returns <code>TRUE</code> on success, <code>FALSE</code> otherwise
unless <code>response</code> is <code>TRUE</code> in which case the full response
object is returned.
</p>


<h3>Note</h3>

<p>The <code>.proto</code> file containing the schema definitions must be
loaded before <code>data2msg()</code> and <code>msg2data()</code> are used, e.g.,
by the virtue of being inside the <code>run()</code> function or explicitly
using <code>RProtoBuf::readProtoFiles(proto)</code>.
</p>
<p>The <code>run()</code> function can be used only once in a session, because
protobuf definitions are global and cannot be overridden without a
conflict.
</p>
<p>The internal Acumos communication protocol is subject to change and
all of the above functions are hidden.
</p>
<p>If the <code>runtime</code> list contains an entry <code>data_response=TRUE</code>
then the component also returns the result in the response body (in
addition to any output URL specifications). In all other cases the
response is always <code>"OK"</code> on success and error string on error.
</p>


<h3>Author(s)</h3>

<p>Simon Urbanek
</p>


<h3>See Also</h3>

<p><code>compose</code>
</p>


</div>