<div class="container">

<table style="width: 100%;"><tr>
<td>mld</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multi Level Decomposition of unidimensional data</h2>

<h3>Description</h3>

<p>The function <code>mld</code> performs an additive decomposition of the input vector <code>x</code> onto sub-spaces associated 
to an orthonormal orthobasis. The sub-spaces are defined by levels of the input factor <code>level</code>.
The function <code>haar2level</code> builds the factor <code>level</code> such that the multi level decomposition corresponds exactly to a multiresolution analysis performed with the haar basis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mld(x, orthobas, level, na.action = c("fail", "mean"),
 plot = TRUE, dfxy = NULL, phylog = NULL, ...)
haar2level(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>is a vector or a time serie containing the data to be decomposed. This must be a dyadic length vector (power of 2) for the function <code>haar2level</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orthobas</code></td>
<td>
<p>is a data frame containing the vectors of the orthonormal basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>is a factor which levels define the sub-spaces on which the function <code>mld</code> performs the additive decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p> if 'fail' stops the execution of the current expression when <code>x</code> contains any missing value. If 'mean' replaces any missing values by mean(<code>x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if TRUE plot <code>x</code> and the components resulting from the decomposition.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dfxy</code></td>
<td>
<p>is a data frame with two coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylog</code></td>
<td>
<p>is an object of class <code>phylog</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with the components resulting from the decomposition.
</p>


<h3>Author(s)</h3>

<p>Sébastien Ollier <a href="mailto:sebastien.ollier@u-psud.fr">sebastien.ollier@u-psud.fr</a></p>


<h3>References</h3>

<p>Mallat, S. G. (1989) A theory for multiresolution signal decomposition: the wavelet representation. 
<em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, <b>11</b>, 7, 674–693.
</p>
<p>Percival, D. B. and Walden, A. T. (2000) <em>Wavelet Methods for Time Series Analysis</em>, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code>gridrowcol</code>, <code>orthobasis</code>, 
<code>orthogram</code>, <code>mra</code> 
for multiresolution analysis with various families of wavelets
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# decomposition of a time serie
data(co2)
x &lt;- log(co2)
orthobas &lt;- orthobasis.line(length(x))
level&lt;-rep("D", 467)
level[1:3]&lt;-rep("A", 3)
level[c(77,78,79,81)]&lt;-rep("B", 4)
level[156]&lt;-"C"
level&lt;-as.factor(level)
res &lt;- mld(x, orthobas, level)
sum(scale(x, scale = FALSE) - apply(res, 1, sum))

## End(Not run)
# decomposition of a biological trait on a phylogeny
data(palm)
vfruit&lt;-palm$traits$vfruit
vfruit&lt;-scalewt(vfruit)   
palm.phy&lt;-newick2phylog(palm$tre)
level &lt;- rep("F", 65)
level[c(4, 21, 3, 6, 13)] &lt;- LETTERS[1:5]
level &lt;- as.factor(level)
res &lt;- mld(as.vector(vfruit), palm.phy$Bscores, level,
 phylog = palm.phy, clabel.nod = 0.7, f.phylog=0.8,
  csize = 2, clabel.row = 0.7, clabel.col = 0.7)
</code></pre>


</div>