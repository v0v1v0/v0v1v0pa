<div class="container">

<table style="width: 100%;"><tr>
<td>ar.mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Bayesian AR Model 
</h2>

<h3>Description</h3>

<p>Uses Gibbs sampling to fit an AR model to time series data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ar.mcmc(xdata, porder, n.iter = 1000, n.warmup = 100, plot = TRUE, col = 4, 
        prior_var_phi = 50, prior_sig_a = 1, prior_sig_b = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xdata</code></td>
<td>

<p>time series data (univariate only)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>porder</code></td>
<td>

<p>autoregression order
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>

<p>number of iterations for the sampler
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.warmup</code></td>
<td>

<p>number of startup iterations for the sampler (these are removed)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>if TRUE (default) returns two graphics, (1) the draws after warmup and (2) a
scatterplot matrix of the draws with histograms on the diagonal
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>

<p>color of the plots
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_var_phi</code></td>
<td>

<p>prior variance of the vector of AR coefficients; see details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sig_a</code></td>
<td>

<p>first prior for the variance component; see details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_sig_b</code></td>
<td>

<p>second prior for the variance component; see details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>additional graphic parameters for the scatterplots
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Assumes a normal-inverse gamma model,
</p>
<p style="text-align: center;"><code class="reqn">x_t = \phi_0 + \phi_1 x_{t-1} + \dots + \phi_p x_{t-p} + \sigma z_t ,</code>
</p>

<p>where <code class="reqn">z_t</code> is standard Gaussian noise.
With <code class="reqn">\Phi</code> being the (p+1)-dimensional vector of the <code class="reqn">\phi</code>s,
the priors are 
<code class="reqn">\Phi \mid \sigma \sim N(0, \sigma^2 V_0)</code> and
<code class="reqn">\sigma^2 \sim IG(a,b)</code>, where <code class="reqn">V_0 = \gamma^2 I</code>.
Defaults are given for the hyperparameters, but the user
may choose <code class="reqn">(a,b)</code> as <code>(prior_sig_a, prior_sig_b)</code>
and <code class="reqn">\gamma^2</code> as <code>prior_var_phi</code>.
</p>
<p>The algorithm is efficient and converges quickly.
Further details can be found in Chapter 6 of the 5th edition of the 
Springer text.
</p>


<h3>Value</h3>

<p>In addition to the graphics (if plot is TRUE), 
the  draws of each parameter (<code>phi0, phi1, ..., sigma</code>)
are returned invisibly and
various quantiles are displayed.  
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>Based on the script <code>arp.mcmc</code> used in Douc,  Moulines, &amp; Stoffer, D. (2014).
<em> Nonlinear Time Series: Theory, Methods and Applications with R Examples</em>. CRC press. 
ISBN 9781466502253.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

u = ar.mcmc(rec, 2)

tsplot(u, ncolm=2, col=4)  # plot the traces

apply(u, 2, ESS)    # effective sample sizes

## End(Not run)
</code></pre>


</div>