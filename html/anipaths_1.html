<div class="container">

<table style="width: 100%;"><tr>
<td>animate_paths</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>animate paths</h2>

<h3>Description</h3>

<p>Animates telemetry data for the purposed of EDA using smoothing splines to interpolate the observed locations. The animations are particularly useful when examining multiple simultaneous trajectories. The output of the call to <code>animate_paths()</code> should bring up a browser window that shows the animation. Additionally, the images generated in <code>images/</code> (or else the value set for <code>imgdir</code>) may be used with ffmpeg, latex, or other presentation software that can build animations directly from a sequence of images.
</p>


<h3>Usage</h3>

<pre><code class="language-R">animate_paths(
  paths,
  coord = c("x", "y"),
  Time.name = "time",
  background = NULL,
  bg.axes = TRUE,
  bg.misc = NULL,
  bg.opts = NULL,
  blur.size = 8,
  covariate = NULL,
  covariate.colors = c("black", "white"),
  covariate.legend.loc = "bottomright",
  covariate.thresh = NULL,
  crawl.mu.color = "black",
  crawl.plot.type = "point.tail",
  date.col = "black",
  delta.t = NULL,
  dev.opts = list(),
  dimmed = NULL,
  ID.name = NULL,
  interpolation_type = "gam",
  interval = 1/12,
  legend.loc = "topright",
  main = NULL,
  max_refit_attempts = 10,
  method = "html",
  n.frames = NULL,
  network = NULL,
  network.colors = NULL,
  network.thresh = 0.5,
  network.times = NULL,
  network.ring.trans = 1,
  network.ring.wt = 3,
  network.segment.trans = 0.5,
  network.segment.wt = 3,
  override = FALSE,
  par.opts = list(),
  paths.proj = "+proj=longlat",
  paths.tranform.crs = "+proj=aea",
  plot.date = TRUE,
  pt.alpha = 0.4,
  pt.cex = 1,
  pt.colors = NULL,
  pt.wd = 1,
  res = 1.5,
  return.paths = FALSE,
  s_args = NULL,
  simulation = FALSE,
  simulation.iter = 12,
  tail.alpha = 0.6,
  tail.colors = "gray87",
  tail.length = 5,
  tail.wd = 1,
  theme_map = NULL,
  times = NULL,
  uncertainty.level = NA,
  uncertainty.type = 1,
  whole.path = FALSE,
  xlim = NULL,
  ylim = NULL,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>paths</code></td>
<td>
<p>Either a <code>data.frame</code> with longitudes/eastings, latitudes/northings, IDs, and times (see <code>coord</code>, <code>ID.name</code>, and <code>Time.name</code>), a <code>SpatialPointsDataFrame</code> with IDs and times, or a list of data.frames containing the longitudes, latitudes, and times for each individual (with names provided).
If all paths are already synchronous, another option for passing the data is to define <code>paths</code> as a list of matrices, all with the same number of rows, and to specify the times separately via the next argument. This situation might arise when, for example, locations the user wishes to animated correspond to realizations/sampler from a discrete-time movement model. Covariates may be provided as named columns of the matrices in <code>paths</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord</code></td>
<td>
<p>A character vector of length 2 giving the names of the longitude/easting and latitude/northing columns in the <code>paths</code> <code>data.frame</code> (in that order). This is required if <code>paths</code> is not a <code>SpatialPointsDataFrame</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time.name</code></td>
<td>
<p>The name of the columns in <code>paths</code> gving the observation times. This column must be of class <code>POSIXt</code>, or numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>background</code></td>
<td>
<p>Three possibilities: (1) A single background image over which animation will be overlayed, or a SpatRaster objects with one layers corresponding to each frame. (2) A list with values <code>center</code> (long/lat), <code>zoom</code>, and <code>maptype</code> (see <code>ggmap::get_googlemap()</code>) which will be used to generate a background for the animation based on Google maps tiles. Additional arguments may be added which will be passed to <code>ggmap::get_googlemap()</code>. (3) A logical value of <code>TRUE</code>, which will cue the function to get the best Google Map tile combination it can come up with. Note: <code>ggmap</code> must be installed for (2) and (3). Note: if you are calling <code>animate_paths()</code> several times in a short period of time you may get an error from Google for trying to pull tiles too often (e.g., <code>Error in download.file(url, destfile = tmp, quiet = !messaging, mode = "wb") : cannot open URL 'http://maps.googleapis...'</code>). Waiting a minute or so usually solves this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.axes</code></td>
<td>
<p>logical: should animation place axis labels when using a background image (default is <code>TRUE</code>). If <code>RGoogleMaps</code> is used to produce background, labels will be "northing" and "easting". Otherwise, the strings given to <code>coord</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.misc</code></td>
<td>
<p>Character string which will be executed as <code>R</code> code after generating the background, and before adding trajectories, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg.opts</code></td>
<td>
<p>Options passed to <code>plot()</code> function call that makes background in each frame. For example, this could be used to specify blue ocean and gray landcover if <code>background</code> is a <code>MULTIPOLYGON</code> simple features object and <code>bg.opts = list(bg = "dodgerblue4", col = "gray", border = "gray")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blur.size</code></td>
<td>
<p>a integer of the size for blur points; default is 8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>The name of the column in <code>paths</code> that identifies the covariate to be mapped to a ring of color around each point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate.colors</code></td>
<td>
<p>vector of colors which will be used in their given order to make a color ramp (see <code>colorRamp()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate.legend.loc</code></td>
<td>
<p>either the location of the covariate legend, or <code>NA</code> if no legend is desired</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate.thresh</code></td>
<td>
<p>if changed from its default value of <code>NULL</code>, the interpolated value of the covariate will be binarized based on this numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crawl.mu.color</code></td>
<td>
<p>color for the main predictions for crawl interpolation; default is black</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crawl.plot.type</code></td>
<td>
<p>a character string of what type of the plot you wish to generate when <code>interpolation_type = "crawl"</code>. Default is "point.tail" for points with tails; input "point" for point plot and input "blur" for blur point plot; ; input "blur.point" for blur point with tails.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.col</code></td>
<td>
<p>default is <code>"black"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.t</code></td>
<td>
<p>The gap in time between each frame in the animation. Specify one of <code>delta.t</code> or <code>n.frames</code>. If both are specified, <code>delta.t</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dev.opts</code></td>
<td>
<p>Options passed to <code>png()</code> before creating each frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimmed</code></td>
<td>
<p>Numeric vector of individuals to "dim" in the animation. Order corresponds to the order of the ID.name variable, or order of paths list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID.name</code></td>
<td>
<p>The name of the column in <code>paths</code> that identifies each individual. If left as <code>NULL</code> (default), a single individual is assumed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolation_type</code></td>
<td>
<p>a character string of the type of interpolation. Default is "gam" for a generalized addictive model. Use "crawl" to interpolate using <code>crawl</code> package. Note: due to the ongoing shift in PROJ4/6 standards, warning about CRS comments may appear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>Seconds per frame in animation. Default is 1/12 (or 12 frames per second).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>passed to first argument of <code>legend()</code> function. Default is <code>"topright"</code>. <code>NA</code> removes legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title for each frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_refit_attempts</code></td>
<td>
<p>an integer of number of resampling when the fit for crawl failed to run; default is 10</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>either <code>"html"</code> (default) or <code>"mp4"</code>. The latter requires the user has installed <code>ffmpeg</code> (see <code>?animation::saveVideo()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.frames</code></td>
<td>
<p>The number of frames used to animate the complete time domain of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>
<p>Array of dimensions (# individuals, # individuals, <code>n.frames</code>) that gives a dyanmic network structure among the individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.colors</code></td>
<td>
<p>A symmetric matrix of dimension <code>length(paths)</code> <code class="reqn">\times</code> <code>length(paths)</code> giving the colors associated with each pairwise relationship.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.thresh</code></td>
<td>
<p>Network structure is summarized in the animation in a binary way, regardless of whether or not the <code>network</code> is continuously weighted or not. The value of <code>network.thresh</code> determines the level below which no connection is shown, and above which an active connection is shown via colored rings and connecting segments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.times</code></td>
<td>
<p>Numeric vector. If network time grid doesn't match <code>n.frames</code>, supply the times at which the network has been evaluated so it can be interpolated using smoothing splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.ring.trans</code></td>
<td>
<p>transparency of network segments (default is 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.ring.wt</code></td>
<td>
<p>thickness of network rings (default is 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.segment.trans</code></td>
<td>
<p>transparency of network segments (default is 0.5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network.segment.wt</code></td>
<td>
<p>thickness of network segments (default is 3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>override</code></td>
<td>
<p>Logical variable toggling where or not to override warnings about how long the animation procedure will take.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.opts</code></td>
<td>
<p>Options passed to <code>par()</code> before creating each frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paths.proj</code></td>
<td>
<p>PROJ.4 string corresponding to the projection of the data. Default is "+proj=longlat".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paths.tranform.crs</code></td>
<td>
<p>a PROJ.4 string of coordinate projection transformation based on the animals' location; default is "+proj=aea +lat_1=30 +lat_2=70".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.date</code></td>
<td>
<p>Logical variable toggling date text at the time center of the animation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.alpha</code></td>
<td>
<p>alpha value for the points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.cex</code></td>
<td>
<p>A numeric value giving the character expansion (size) of the points for each individual. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.colors</code></td>
<td>
<p>A vector of colors to be used for each individual in the animation. Default values come from Color Brewer palettes. When a network is provided, this is ignored and individuals are all colored black. If <code>NA</code>, no plot colors are chosen to distinguish individuals. This can be useful when making animations involving a covariate. Consider also setting <code>legend.loc</code> to <code>NA</code> in this case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.wd</code></td>
<td>
<p>size of the points; default is 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Resolution of images in animation. Increase this for higher quality (and larger) images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.paths</code></td>
<td>
<p>logical. Default is <code>FALSE</code>, but if <code>TRUE</code> then the interpolated paths are returned and no animation is produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_args</code></td>
<td>
<p>Default is <code>NULL</code>, in which case <code>anipaths</code> attempts to select a reasonable number of knots for the GAM interpolation. Alternatively, the user can provide a list of arguments to <code>mgcv::s()</code> the same length and order as number of unique individuals (i.e., <code>unique(paths[, ID.name])</code>). Each entry in the list should be a named list/vector (e.g., <code>s_args = list(list(k = 10), list(k = 12), ...)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation</code></td>
<td>
<p>logical. Generate simulation predictions to have multiple projects for the animal paths; default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulation.iter</code></td>
<td>
<p>an integer of how many paths the crawl model will generate; default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.alpha</code></td>
<td>
<p>alpha value for the tails</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.colors</code></td>
<td>
<p>default is <code>"gray87"</code>. Can be single color or vector of colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.length</code></td>
<td>
<p>Length of the tail trailing each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.wd</code></td>
<td>
<p>Thickness of tail trailing behind each individual. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theme_map</code></td>
<td>
<p>plot theme for <code>ggplot</code>, default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>If all paths are already synchronous, another option for passing the data is to define <code>paths</code> as a list of matrices, all with the same number of rows, and to specify the times separately via this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty.level</code></td>
<td>
<p>value in (0, 1) corresponding to <code>level</code> at which to draw uncertainty ellipses. <code>NA</code> (default) results in no ellipses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty.type</code></td>
<td>
<p>State what type of uncertainty plot 1 is default for tails more than 1 is amount of predicted trajectories for each unique individual and blurs for blur plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whole.path</code></td>
<td>
<p>logical. If <code>TRUE</code> (default = <code>FALSE</code>), the complete interpolated trajectories will be plotted in the background of the animation. If <code>whole.path = TRUE</code>, consider also setting <code>tail.length = 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Boundaries for plotting. If left undefined, the range of the data will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Boundaries for plotting. If left undefined, the range of the data will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; <code>TRUE</code> prints messages about fitting details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>ani.options</code> to animation options such as the time interval between image frames.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>video file, possibly a directory containing the individual images, or interpolated paths.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##
vultures$POSIX &lt;- as.POSIXct(vultures$timestamp, tz = "UTC")
vultures_paths &lt;- vultures[vultures$POSIX &gt; as.POSIXct("2009-03-01", origin = "1970-01-01") &amp;
  vultures$POSIX &lt; as.POSIXct("2009-05-01", origin = "1970-01-01"), ]
animate_paths(
  paths = vultures_paths,
  delta.t = "week",
  coord = c("location.long", "location.lat"),
  Time.name = "POSIX",
  ID.name = "individual.local.identifier"
)
## Not run: 
background &lt;- list(
  center = c(-90, 10),
  zoom = 3,
  maptype = "satellite"
)
library(ggmap)
library(RColorBrewer)
COVARIATE &lt;- cos(as.numeric(vultures_paths$timestamp) /
  diff(range(as.numeric(vultures_paths$timestamp))) * 4 * pi)
animate_paths(
  paths = cbind(vultures_paths, COVARIATE),
  delta.t = "week",
  coord = c("location.long", "location.lat"),
  Time.name = "POSIX", covariate = "COVARIATE",
  covariate.colors = brewer.pal(n = 9, "RdYlGn"),
  ID.name = "individual.local.identifier",
  background = background
)

# animation using crawl interpolation
animate_paths(
  paths = vultures_paths,
  delta.t = "week",
  coord = c("location.long", "location.lat"),
  Time.name = "POSIX",
  ID.name = "individual.local.identifier",
  interpolation_type = "crawl"
)

## End(Not run)

# Run to remove files generated by this function
system("rm -r js; rm -r css; rm -r images; rm index.html")

</code></pre>


</div>