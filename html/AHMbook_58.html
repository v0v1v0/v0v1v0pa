<div class="container">

<table style="width: 100%;"><tr>
<td>simComm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate community occupancy or community abundance data
</h2>

<h3>Description</h3>

<p>Simulate detection/nondetection or count data, respectively, under a community occupancy or abundance model with random species effects for psi or lambda and p (both including effects of one covariate, 'habitat' for psi or lambda and 'wind speed' for p) (introduced in AHM1 - 11.2)
</p>


<h3>Usage</h3>

<pre><code class="language-R">simComm(type = c("det/nondet", "counts"), nsites = 30, nreps = 3, nspecies = 100,
  mean.psi = 0.25, sig.lpsi = 1, mu.beta.lpsi = 0, sig.beta.lpsi = 0,
  mean.lambda = 2, sig.loglam = 1, mu.beta.loglam = 1, sig.beta.loglam = 1,
  mean.p = 0.25, sig.lp = 1, mu.beta.lp = 0, sig.beta.lp = 0, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>choose whether you want to simulate detection/nondetection ("det/nondet") data or count data ("counts").
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsites</code></td>
<td>

<p>number of sites
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>

<p>number of replicate samples (occasions or repeated measurements)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nspecies</code></td>
<td>

<p>total number of species in the area that is sampled by these sites (regional species pool)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.psi</code></td>
<td>

<p>community mean of occupancy probability over all species in community (probability scale); ignored if <code>type = "counts"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.lpsi</code></td>
<td>

<p>community standard deviation of logit(occupancy probability intercept); ignored if <code>type = "counts"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.beta.lpsi</code></td>
<td>

<p>community mean of the effects of 'habitat' covariate on occupancy probability; ignored if <code>type = "counts"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.beta.lpsi</code></td>
<td>

<p>community standard deviation of the effects of 'habitat' covariate on occupancy probability; ignored if <code>type = "counts"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lambda</code></td>
<td>

<p>community mean of expected abundance over all species in superpopulation; ignored if <code>type = "det/nondet"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.loglam</code></td>
<td>

<p>community standard deviation of log(lambda intercept); ignored if <code>type = "det/nondet"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.beta.loglam</code></td>
<td>

<p>community mean of the effects of 'habitat' covariate on log(lambda); ignored if <code>type = "det/nondet"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.beta.loglam</code></td>
<td>

<p>community standard deviation of the effects of 'habitat' covariate on expected abundance; ignored if <code>type = "det/nondet"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.p</code></td>
<td>

<p>community mean of detection probability over all species in superpopulation (probability scale)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.lp</code></td>
<td>

<p>community standard deviation of logit(detection probability intercept)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.beta.lp</code></td>
<td>

<p>community mean of the effects of 'wind' covariate on detection probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.beta.lp</code></td>
<td>

<p>community standard deviation of the effects of 'wind' covariate on detection probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function simulates data from repeated sampling of a metacommunity (or spatially structured community) according to the model of Dorazio &amp; Royle (JASA, 2005) for <code>type = "det/nondet"</code> (this is the default) or under the model of Yamaura et al. (2012) for <code>type = "counts"</code>.
</p>
<p>Occupancy probability (psi) or expected abundance (lambda) can be made dependent on a continuous site covariate 'habitat', while detection probability can be made dependent an observational covariate 'wind'. Both intercept and slope of the two log-linear or logistic regressions (for occupancy or expected abundance, respectively, and for detection) are simulated as draws from a normal distribution with mean and standard deviation that can be selected using function arguments.
</p>
<p>Specifically, the data are simulated under the following linear models:
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>

<table>
<tr>
<td style="text-align: left;">
(occupancy (psi) and detection (p) for site i, replicate j and species k) </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>psi[i,k] &lt;- plogis(beta0[k] + beta1[k] * habitat[i]</code> </td>
<td style="text-align: left;"> Occupancy </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p[i,j,k] &lt;- plogis(alpha0[k] + alpha1[k] * wind[i,j]</code> </td>
<td style="text-align: left;"> Detection </td>
</tr>
</table>
<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>

<table>
<tr>
<td style="text-align: left;">
(exp. abundance (lambda) and detection (p) for site i, rep. j and species k) </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>lambda[i,k] &lt;- exp(beta0[k] + beta1[k] * habitat[i]</code> </td>
<td style="text-align: left;"> E(N) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>p[i,j,k] &lt;- plogis(alpha0[k] + alpha1[k] * wind[i,j]</code> </td>
<td style="text-align: left;"> Detection </td>
</tr>
</table>
<p>Species-specific heterogeneity in intercepts and slopes is modeled by up to four independent normal distributions (note: no correlation between the intercepts as in Dorazio et al. (2006) or KÃ©ry &amp; Royle (2008))
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>

<table>
<tr>
<td style="text-align: left;">
<code>beta0 ~ dnorm(logit(mean.psi), sig.lpsi)</code> </td>
<td style="text-align: left;"> Mean and SD of normal distribution </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta1 ~ dnorm(mu.beta.lpsi, sig.beta.lpsi)</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>alpha0 ~ dnorm(logit(mean.p), sig.lp)</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>alpha1 ~ dnorm(mu.beta.lp, sig.beta.lp)</code> </td>
<td style="text-align: left;"> </td>
</tr>
</table>
<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>

<table>
<tr>
<td style="text-align: left;">
<code>beta0 ~ dnorm(log(mean.lambda), sig.loglam)</code> </td>
<td style="text-align: left;"> Mean and SD of normal distribution </td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta1 ~ dnorm(mu.beta.loglam, sig.beta.loglam)</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>alpha0 ~ dnorm(logit(mean.p), sig.lp)</code> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;">
<code>alpha1 ~ dnorm(mu.beta.lp, sig.beta.lp)</code> </td>
<td style="text-align: left;"> </td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the arguments supplied and the following additional elements:
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>habitat</code></td>
<td>
<p>length <code>nsites</code> vector with the habitat covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p><code>nsites * nreps</code> matrix with the wind covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p><code>psi[i, k]</code> occupancy probability for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p><code>p[i, j, k]</code> detection probability for site i, occasion j and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p><code>z[i, k]</code> true presence/absence for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.obs</code></td>
<td>
<p><code>z.obs[i, k]</code> observed presence/absence for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.all</code></td>
<td>
<p><code>y.all[i, j, k]</code> detection/nondetection data for site i, occasion j and species k for all species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.obs</code></td>
<td>
<p><code>y.obs[i, j, k]</code> detection/nondetection data for site i, occasion j and species k for observed species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.sum.all</code></td>
<td>
<p>detection frequency for all species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.sum.obs</code></td>
<td>
<p>detection frequency for observed species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal.fs</code></td>
<td>
<p>finite sample (or conditional) species richness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal.obs</code></td>
<td>
<p>observed species richness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.true</code></td>
<td>
<p>true number of species occurring at each site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S.obs</code></td>
<td>
<p>observed number of species occurring at each site</p>
</td>
</tr>
</table>
<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>
<table>
<tr style="vertical-align: top;">
<td><code>habitat</code></td>
<td>
<p>length <code>nsites</code> vector with the habitat covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind</code></td>
<td>
<p><code>nsites * nreps</code> matrix with the wind covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p><code>lambda[i, k]</code> expected number of individuals for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p><code>p[i, j, k]</code> detection probability for site i, occasion j and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p><code>N[i, k]</code> true number present for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.all</code></td>
<td>
<p><code>y.all[i, j, k]</code> number observed for site i, occasion j and species k for all species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.obs</code></td>
<td>
<p><code>y.obs[i, j, k]</code> number observed for site i, occasion j and species k for observed species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax.obs</code></td>
<td>
<p><code>ymax.obs[i, k]</code> maximum number observed for site i and species k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal.fs</code></td>
<td>
<p>finite sample (or conditional) species richness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ntotal.obs</code></td>
<td>
<p>observed species richness</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc KÃ©ry &amp; Andy Royle, with community occupancy model code partly based on code by Richard Chandler.
</p>


<h3>References</h3>

<p>Dorazio, R.M. &amp; Royle, J.A. (2005) Estimating size and composition of biological communities by modeling the occurrence of species. <em>J American Statistical Association</em>, 100, 389-398.
</p>
<p>Dorazio, R.M., et al (2006) Estimating species richness and accumulation by modeling species occurrence and detectability. <em>Ecology</em> 87, 842-854.
</p>
<p>KÃ©ry, M. &amp; Royle, J.A. (2008) Hierarchical Bayes estimation of species richness and occupancy in spatially replicated surveys. <em>Journal of Applied Ecology</em> 45, 589-598.
</p>
<p>Yamaura, Y., et al. (2012) Biodiversity of man-made open habitats in an underused country: a class of multispecies abundance models for count data. <em>Biodiversity and Conservation</em> 21, 1365-1380.
</p>
<p>KÃ©ry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 11.2.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Default arguments:
str(simComm())

# Some possibly interesting settings of the function
data &lt;- simComm(nsites = 267, nspecies = 190, mean.psi = 0.25, sig.lpsi = 2,
  mean.p = 0.12, sig.lp = 2) # similar to Swiss MHB
data &lt;- simComm(mean.psi = 1)         # all species occur at every site
data &lt;- simComm(mean.p = 1)           # no measurement error (perfect detection)

# Effect of spatial sample size (nsites) on species richness in sample (Ntotal.fs)
data &lt;- simComm(nsites=50, nspecies = 200) # 1-3 are usually missed in sample
data &lt;- simComm(nsites=30, nspecies = 200) # 4-6 usually missed
data &lt;- simComm(nsites=10, nspecies = 200) # around 30 typically missed
</code></pre>


</div>