<div class="container">

<table style="width: 100%;"><tr>
<td>transcripts_cure_single</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cure a single transcript</h2>

<h3>Description</h3>

<p>Transcript object may contain errors, e.g. because of defect annotation input files or user modifications.
This function may cure some of these errors.
</p>

<ul>
<li>
<p> Annotations with reversed times: annotations with <code>endSec</code> lower than <code>startSec</code> will be deleted.
</p>
</li>
<li>
<p> Overlapping annotations: earlier annotations will end where the next annotation starts.
</p>
</li>
<li>
<p> Annotations below 0 sec: Annotations that are starting and ending before 0 sec will be deleted; Annotations starting before but ending after 0 sec will be truncated.
</p>
</li>
<li>
<p> Missing tiers: Tiers that are present in the annotations but missing in the list of tiers in <code>@tiers</code> of the transcript object will be added.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">transcripts_cure_single(
  t,
  annotationsWithReversedTimes = TRUE,
  overlappingAnnotations = TRUE,
  annotationsWithTimesBelowZero = TRUE,
  missingTiers = TRUE,
  showWarning = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Transcript object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotationsWithReversedTimes</code></td>
<td>
<p>Logical; If <code>TRUE</code> annotations with reversed times will be deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlappingAnnotations</code></td>
<td>
<p>Logical; If <code>TRUE</code> overlapping annotations will be corrected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotationsWithTimesBelowZero</code></td>
<td>
<p>Logical; If <code>TRUE</code> annotations before 0 sec will be corrected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingTiers</code></td>
<td>
<p>Logical; If <code>TRUE</code> tiers missing in <code>@tiers</code> slot of the transcript object will be added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showWarning</code></td>
<td>
<p>Logical; If <code>TRUE</code> a warning notice will be shown upon correction.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Transcript object;
</p>


<h3>See Also</h3>

<p>transcripts_cure
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(act)

# --- annotationsWithReversedTimes: will be deleted
# get example transcript and reverse the times of an annotation
t &lt;- examplecorpus@transcripts[[1]]
t@annotations$startSec[1] &lt;- 20
t@annotations$endSec[1] &lt;- 10
t2 &lt;- act::transcripts_cure_single(t)
tail(t2@history, n=1)


# --- annotationsWithTimesBelowZero: will be deleted or start at 0 sec
t &lt;- examplecorpus@transcripts[[1]]
t@annotations$startSec[1] &lt;- -2
t@annotations$endSec[1]   &lt;- -1
t2 &lt;- act::transcripts_cure_single(t)
tail(t2@history, n=1)

t &lt;- examplecorpus@transcripts[[1]]
t@annotations$startSec[2] &lt;- -5
t2 &lt;- act::transcripts_cure_single(t)
tail(t2@history, n=1)


# --- overlappingAnnotations: will end where the next starts
t&lt;- examplecorpus@transcripts[[1]]
t@annotations &lt;- t@annotations[order(t@annotations$tier.name, t@annotations$startSec), ]
t@annotations$endSec[1] &lt;- 8
t2 &lt;- act::transcripts_cure_single(t)
tail(t2@history, n=1)


# --- missingTiers: will be added to @tiers in transcript object
t&lt;- examplecorpus@transcripts[[1]]
t@annotations &lt;- t@annotations[order(t@annotations$tier.name, t@annotations$startSec), ]
t@annotations$tier.name[1] &lt;- "NEW"
t2 &lt;- act::transcripts_cure_single(t)
tail(t2@history, n=1)
t2@tiers
# compare with original tiers
t@tiers


# --- several things at once
t&lt;- examplecorpus@transcripts[[1]]
t@annotations &lt;- t@annotations[order(t@annotations$tier.name, t@annotations$startSec), ]
# annotation completely below 0 sec
t@annotations$startSec[1] &lt;- -6
t@annotations$endSec[1]   &lt;- -5
# annotation starts before but ends after 0 sec
t@annotations$startSec[2] &lt;- -3
# annotation with reversed times
t@annotations$startSec[3] &lt;- 6.9
t@annotations$endSec[3]   &lt;- -6.8
# annotation overlaps with next annotation
t@annotations$endSec[6]   &lt;- 9
# new tier, missing tier list
t@annotations$tier.name[8] &lt;- "NEW"
t2 &lt;- act::transcripts_cure_single(t, showWarning=TRUE)
tail(t2@history, n=1)


examplecorpus@transcripts[[1]]@history
</code></pre>


</div>