<div class="container">

<table style="width: 100%;"><tr>
<td>apollo_insertFunc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Modifies function to make it compatible with analytic gradients</h2>

<h3>Description</h3>

<p>Takes a likelihood function and inserts <code>function ()</code> before key elements to allow for analytic gradient calculation
</p>


<h3>Usage</h3>

<pre><code class="language-R">apollo_insertFunc(f, like = TRUE, randCoeff = FALSE, lcPars = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>Function. Expressions inside it will be turned into functions. Usually <code>apollo_probabilities</code> or 
<code>apollo_randCoeff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>like</code></td>
<td>
<p>Logical. Must be TRUE if <code>f</code> is <code>apollo_probabilities</code>. FALSE otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randCoeff</code></td>
<td>
<p>Logical. Must be TRUE if <code>f</code> is <code>apollo_randCoeff</code>. FALSE otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcPars</code></td>
<td>
<p>Logical. Must be TRUE if <code>f</code> is <code>apollo_lcPars</code>. FALSE otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It modifies the definition of the following models.
</p>

<ul>
<li> <p><strong><code>apollo_mnl</code></strong>: Turns all elements inside <code>mnl_settings$V</code> into functions.
</p>
</li>
<li> <p><strong><code>apollo_ol</code></strong>: Turns <code>ol_settings$V</code> and all elements inside <code>ol_settings$tau</code> into functions.
</p>
</li>
<li> <p><strong><code>apollo_op</code></strong>: Turns <code>op_settings$V</code> and all elements inside <code>op_settings$tau</code> into functions.
</p>
</li>
<li> <p><strong><code>apollo_normalDensity</code></strong>: Turns <code>normalDensity_settings$xNormal</code>, <code>normalDensity_settings$mu</code> and <code>normalDensity_settings$sigma</code> into functions.
</p>
</li>
</ul>
<p>It can only track a maximum of 3 levels of depth in definitions. For example:
<code>
V &lt;- list()
V[["A"]] &lt;- b1*x1A + b2*x2A
V[["B"]] &lt;- b1*x1B + b2*x2B
mnl_settings1 &lt;- list(alternatives=c("A", "B"), V = V, choiceVar= Y, avail = 1, componentName="MNL1")
P[["MNL1"]] &lt;- apollo_mnl(mnl_settings1, functionality)
</code>
But it may not be able to deal with the following:
<code>
VA &lt;- b1*x1A + b2*x2A
V &lt;- list()
V[["A"]] &lt;- VA
V[["B"]] &lt;- b1*x1B + b2*x2B
mnl_settings1 &lt;- list(alternatives=c("A", "B"), V = V, choiceVar= Y, avail = 1, componentName="MNL1")
P[["MNL1"]] &lt;- apollo_mnl(mnl_settings1, functionality)
</code>
But that might be enough given how apollo_dVdB works.
</p>


<h3>Value</h3>

<p>Function <code>f</code> but with relevant expressions turned into function definitions.
</p>


</div>