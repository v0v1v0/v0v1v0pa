<div class="container">

<table style="width: 100%;"><tr>
<td>aem.time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>AEM for time series</h2>

<h3>Description</h3>

<p>This function constructs AEM eigenfunctions for multi-scale analysis of a
regular time series or spatial transect of univariate or multivariate data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aem.time(n, w = NULL, moran = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numeric. Number of points in the series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A vector of weights to be applied to the edges (columns of matrix
E). Equal weights are used if no vector <code>w</code> is provided. The length of
vector <code>w</code> must be (<code>n</code>-1) where <code>n</code> is the number of points
in the spatial or temporal series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moran</code></td>
<td>
<p>Logical. If <code>TRUE</code>, Moran's I are computed for all AEM. If
<code>FALSE</code> (default value), Moran's I are not computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Time series represent a form of directional stochastic process. To emphasize
the directional nature of the process influencing the data, AEM analysis,
which was designed to take trends into account, should be applied to the
non-detrended series. MEM analysis (see <code>scores.listw</code>) can be applied
to data series that were detrended to remove the directional component as
recommended by Blanchet et al. (2008, 2011) and  Legendre &amp; Legendre (2012,
Subsection 14.1.2). Detrended palaeoecological sediment core data, for
example, could be studied by MEM analysis.
</p>
<p>No data file needs to be provided to this function. The AEM eigenvectors are
constructed from a matrix E generated from the regular sequence of points
along the series.
</p>
<p>A vector of weights <code>w</code> can be provided, representing the ease of
communication of matter, energy or information among the points. The most
simple form would be the inverse of (d/dmax) where d is the distance between
adjacent nodes and dmax is the maximum distance between adjacent nodes in the
spatial or time series. More general forms of weights may represent the
inverse of landscape resistance to the movement of organisms, propagules,
genes, etc.
</p>
<p>If the calculation of Moran's I is requested, the point coordinates are
generated from the point positions along the series.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>Nodes-by-edges matrix E. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>Eigenvalues of the
principal component analysis of E. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aem</code></td>
<td>
<p>Matrix of AEM eigenfunctions
normalized to unit length. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Moran</code></td>
<td>
<p>Moran's I statistics tested by a bilateral test with 999 permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>An object of class <code>listw</code> with the associated spatial weighting matrix</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Pierre Legendre and F. Guillaume Blanchet
</p>


<h3>References</h3>

<p>Blanchet F.G., P. Legendre and Borcard D. (2008) Modelling directional
spatial processes in ecological data. <em>Ecological Modelling</em>, 215,
325-336.
</p>
<p>Blanchet F.G., P. Legendre, R. Maranger, D. Monti, and P. Pepin. (2011)
Modelling the effect of directional spatial ecological processes at different
scales. <em>Oecologia</em>, 166, 357-368.
</p>
<p>Legendre, P. and L. Legendre (2012) <em>Numerical Ecology</em>, 3rd English
edition. Elsevier Science BV, Amsterdam.
</p>
<p>Legendre, P. and O. Gauthier (2014) Statistical methods for temporal and
space-time analysis of community composition data. <em>Proceedings of the
Royal Society B - Biological Sciences</em>, 281, 20132728.
</p>


<h3>See Also</h3>

<p><code>aem</code>, <code>scores.listw</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Time series containing 20 equispaced observations
out &lt;- aem.time(20, moran = TRUE)

# Time series containing 20 observations with unequal spacing
# Generate (n-1) random interpoint distances
distances &lt;- runif(19,1,5)

# Compute weights representing the ease of communication among points
w &lt;- 1/(distances/max(distances))

# Compute the AEM eigenfunctions
out &lt;- aem.time(20, w = w, moran = TRUE)

</code></pre>


</div>