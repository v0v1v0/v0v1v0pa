<div class="container">

<table style="width: 100%;"><tr>
<td>kfun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiscale second-order neighbourhood analysis of an univariate spatial point pattern</h2>

<h3>Description</h3>

<p>Computes estimates of Ripley's <em>K</em>-function and associated neighbourhood functions from an univariate spatial point pattern 
in a simple (rectangular or circular) or complex sampling window. Computes optionally local confidence limits of the functions
under the null hypothesis of Complete Spatial Randomness (see Details).
</p>


<h3>Usage</h3>

<pre><code class="language-R">kfun(p, upto, by, nsim=0, prec=0.01, alpha=0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>a <code>"spp"</code> object defining a spatial point pattern in a given sampling window (see <code>spp</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upto </code></td>
<td>
<p>maximum radius of the sample circles (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by </code></td>
<td>
<p>interval length between successive sample circles radii (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim </code></td>
<td>
<p>number of Monte Carlo simulations to estimate local confidence limits of the null hypothesis of complete spatial randomness (CSR) (see Details).
By default <code>nsim=0</code>, so that no confidence limits are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec </code></td>
<td>
<p>if <code>nsim&gt;0</code>, precision of points' coordinates generated during simulations. By default <code>prec=0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha </code></td>
<td>
<p>if <code>nsim&gt;0</code>, significant level of the confidence limits. By default <code class="reqn">\alpha=0.01</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>kfun</code> computes Ripley's <code class="reqn">K(r)</code> function of second-order neighbourhood analysis and the associated functions <code class="reqn">g(r)</code>, <code class="reqn">n(r)</code> and <code class="reqn">L(r)</code>.<br><br>
For a homogeneous isotropic point process of intensity <code class="reqn">\lambda</code>, Ripley (1977) showed that
the second-order property could be characterized by a function <code class="reqn">K(r)</code>, so that the expected
number of neighbours within a distance <code class="reqn">r</code> of an arbitrary point of the pattern is:
<code class="reqn">N(r) = \lambda*K(r)</code>.<br><br><code class="reqn">K(r)</code> is a intensity standardization of <code class="reqn">N(r)</code>, which has an expectation of <code class="reqn">\pi*r^2</code> under the null hypothesis of CSR: <code class="reqn">K(r) = N(r)/\lambda</code>.<br><br><code class="reqn">n(r)</code> is an area standardization of <code class="reqn">N(r)</code>, which has an expectation of <code class="reqn">\lambda</code> under the null hypothesis of CSR: <code class="reqn">n(r) = N(r)/(\pi*r^2)</code>, where <code class="reqn">\pi*r^2</code> is the area of the disc of radius <code class="reqn">r</code>.<br><br><code class="reqn">L(r)</code> is a linearized version of <code class="reqn">K(r)</code> (Besag 1977), which has an expectation of 0 under the null hypothesis of CSR: <code class="reqn">L(r) = \sqrt(K(r)/\pi)-r</code>. <em>L(r)</em> becomes positive when the pattern tends to clustering and negative when it tends to regularity.<br><br><code class="reqn">g(r)</code> is the derivative of <code class="reqn">K(r)</code> or pair density function (Stoyan et al. 1987), so that the expected
number of neighbours at a distance <code class="reqn">r</code> of an arbitrary point of the pattern (i.e. within an annuli between two successive circles with radii <code class="reqn">r</code> and <code class="reqn">r-by</code>) is:
<code class="reqn">O(r) = \lambda*g(r)</code>.<br><br></p>
<p>The program introduces an edge effect correction term according to the method proposed by Ripley (1977)
and extended to circular and complex sampling windows by Goreaud &amp; P?Pelissier (1999).<br><br></p>
<p>Theoretical values under the null hypothesis of CSR as well as
local Monte Carlo confidence limits and p-values of departure from CSR (Besag &amp; Diggle 1977) are estimated at each distance <code class="reqn">r</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"fads"</code> with essentially the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>r </code></td>
<td>
<p>a vector of regularly spaced out distances (<code>seq(by,upto,by)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g </code></td>
<td>
<p>a data frame containing values of the pair density function <code class="reqn">g(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n </code></td>
<td>
<p>a data frame containing values of the local neighbour density function <code class="reqn">n(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k </code></td>
<td>
<p>a data frame containing values of Ripley's function <code class="reqn">K(r)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l </code></td>
<td>
<p>a data frame containing values of the modified Ripley's function <code class="reqn">L(r)</code>.<br></p>
</td>
</tr>
</table>
<p>Each component except <code>r</code> is a data frame with the following variables:<br></p>
<table>
<tr style="vertical-align: top;">
<td><code>obs </code></td>
<td>
<p>a vector of estimated values for the observed point pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theo </code></td>
<td>
<p>a vector of theoretical values expected for a Poisson pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sup </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the upper local confidence limits of a Poisson pattern at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inf </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of the lower local confidence limits of a Poisson pattern at a significant level <code class="reqn">\alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval </code></td>
<td>
<p>(optional) if <code>nsim&gt;0</code> a vector of local p-values of departure from a Poisson pattern.</p>
</td>
</tr>
</table>
<h3>Warning </h3>

<p>Function <code>kfun</code> ignores the marks of multivariate and marked point patterns, which are analysed as univariate patterns.
</p>


<h3>Note</h3>

<p>There are printing and plotting methods for <code>"fads"</code> objects.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:Raphael.Pelissier@ird.fr">Raphael.Pelissier@ird.fr</a></p>


<h3>References</h3>

<p>Besag J.E. 1977. Discussion on Dr Ripley's paper. <em>Journal of the Royal Statistical Society B</em>, 39:193-195.
</p>
<p>Besag J.E. &amp; Diggle P.J. 1977. Simple Monte Carlo tests spatial patterns. <em>Applied Statistics</em>, 26:327-333.
</p>
<p>Goreaud F. &amp; P?Pelissier R. 1999. On explicit formulas of edge effect correction for Ripley's K-function. <em>Journal of Vegetation Science</em>, 10:433-438.
</p>
<p>Ripley B.D. 1977. Modelling spatial patterns. <em>Journal of the Royal Statistical Society B</em>, 39:172-192.
</p>
<p>Stoyan D., Kendall W.S. &amp; Mecke J. 1987. <em>Stochastic geometry and its applications</em>. Wiley, New-York.
</p>


<h3>See Also</h3>

<p><code>plot.fads</code>,
<code>spp</code>,
<code>kval</code>,
<code>k12fun</code>,
<code>kijfun</code>,
<code>ki.fun</code>,
<code>kmfun</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(BPoirier)
  BP &lt;- BPoirier
  ## Not run: spatial point pattern in a rectangle sampling window of size [0,110] x [0,90]
  swr &lt;- spp(BP$trees, win=BP$rect)
  kswr &lt;- kfun(swr,25,1,500)
  plot(kswr)

  ## Not run: spatial point pattern in a circle with radius 50 centred on (55,45)
  swc &lt;- spp(BP$trees, win=c(55,45,45))
  kswc &lt;- kfun(swc, 25, 1, 500)
  plot(kswc)
  
  ## Not run: spatial point pattern in a complex sampling window
  swrt &lt;- spp(BP$trees, win=BP$rect, tri=BP$tri1)
  kswrt &lt;- kfun(swrt, 25, 1, 500)
  plot(kswrt)
</code></pre>


</div>