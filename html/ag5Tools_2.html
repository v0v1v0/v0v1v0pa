<div class="container">

<table style="width: 100%;"><tr>
<td>ag5_extract</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract AgERA5 data stored in a local hard drive</h2>

<h3>Description</h3>

<p>Extract data from AgERA5 data files previously downloaded from the Copernicus Climate Data Store.
These functions use package 'terra' to read *.nc files and extract the requested data for a given location
and dates. If dates is one value it extracts a single observation for the specified variable and location.
If dates is a character vector of <code>length == 2</code>, it will extract a time series of the specified variable
and location, where the first dates value is the start date and the second the end date.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ag5_extract(coords, ..., path)

## S3 method for class 'numeric'
ag5_extract(
  coords,
  dates,
  variable,
  statistic = NULL,
  time = NULL,
  celsius = FALSE,
  parallel = TRUE,
  ...,
  path
)

## S3 method for class 'data.frame'
ag5_extract(
  coords,
  lon = "lon",
  lat = "lat",
  start_date = "start_date",
  end_date = "end_date",
  variable,
  statistic = NULL,
  time = NULL,
  celsius = FALSE,
  ncores = NULL,
  ...,
  path
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>numeric vector of length = 2 of the form (lon, lat), or a <code>data.frame</code> with required columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p><code>character</code> The path for the folder containing the AgERA5 files</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p><code>character</code> The dates for extracting the specified variable, a vector of length 1 extracts a single date, while
a vector of length 2 indicates the start and end dates.
or the column name in the case of <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p><code>character</code> The AgERA5 variable to extract, see details for available options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p><code>character</code> Only for some variables, see details for valid options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Only for variable Relative-Humidity-2m, see details for valid options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>celsius</code></td>
<td>
<p>logical Only for variables "Temperature-Air-2m" and "2m_dewpoint_temperature".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical Use parallel computation to speed-up data processing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon</code></td>
<td>
<p><code>character</code> Column name of longitude values in the case of <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p><code>character</code> Column name of latitude values in the case of <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_date</code></td>
<td>
<p><code>character</code> Column name of start_date values in the case that coords is a <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_date</code></td>
<td>
<p><code>character</code> Column name of end_date values in the case that coords is a <code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use with parallel. If NULL and parallel is ON, half the available cores will be used.
If <code>TRUE</code> the values are converted from Kelvin to Celsius. Default is <code>FALSE</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>numeric</code> vector with length equal to the number of dates between first and
second date. The returned vecter is a named vector, with requested dates as names.
If only one date is provided the function returns a <code>numeric</code> vector
with <code>length = 1</code>.
If <code>coords</code> is a <code>data.frame</code>, the function returns a <code>list</code> of
<code>numeric</code> vectors, each one corresponding to the rows in the input <code>data.frame</code>
</p>


<h3>Valid variable values</h3>


<ul>
<li>
<p> "cloud_cover"
</p>
</li>
<li>
<p> "liquid_precipitation_duration_fraction"
</p>
</li>
<li>
<p> "snow_thickness_lwe"
</p>
</li>
<li>
<p> "Solar-Radiation-Flux"
</p>
</li>
<li>
<p> "Temperature-Air-2m"
</p>
</li>
<li>
<p> "2m_dewpoint_temperature"
</p>
</li>
<li>
<p> "Precipitation-Flux"
</p>
</li>
<li>
<p> "solid_precipitation_duration_fraction"
</p>
</li>
<li>
<p> "snow_thickness"
</p>
</li>
<li>
<p> "vapour_pressure"
</p>
</li>
<li>
<p> "10m_wind_speed"
</p>
</li>
<li>
<p> "Relative-Humidity-2m"
</p>
</li>
</ul>
<h3>Valid statistics for variable "Temperature-Air-2m"</h3>


<ul>
<li>
<p> Max-24h
</p>
</li>
<li>
<p> Mean-24h
</p>
</li>
<li>
<p> Min-24h
</p>
</li>
<li>
<p> Max-Day-Time
</p>
</li>
<li>
<p> Mean-Day-Time
</p>
</li>
<li>
<p> Mean-Night-Time
</p>
</li>
<li>
<p> Min-Night-Time</p>
</li>
</ul>
<h3>Variables that require statistic</h3>

<p>For the following variables, only "24_hour_mean" statistic is available,
but should be explicitly indicated.
</p>

<ul>
<li>
<p> cloud_cover
</p>
</li>
<li>
<p> snow_thickness_lwe
</p>
</li>
<li>
<p> 2m_dewpoint_temperature
</p>
</li>
<li>
<p> snow_thickness
</p>
</li>
<li>
<p> vapour_pressure
</p>
</li>
<li>
<p> 10m_wind_speed
</p>
</li>
</ul>
<h3>Valid time values for variable "Relative-Humidity-2m"</h3>


<ul>
<li>
<p> 06h
</p>
</li>
<li>
<p> 09h
</p>
</li>
<li>
<p> 12h
</p>
</li>
<li>
<p> 15h
</p>
</li>
<li>
<p> 18h
</p>
</li>
</ul>
<h3>References</h3>

<p>Temperature conversion is made accordingly to:
Preston-Thomas, H. (1990). The International Temperature Scale of 1990 (ITS-90).
Metrologia, 27(1), 3-10. doi:10.1088/0026-1394/27/1/002
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
temp &lt;- ag5_extract(coords = c(lon = 35.72636, lat = -2.197162),
                      dates = "1991-04-22",
                      variable = "Temperature-Air-2m",
                      statistic = "Max-Day-Time",
                      path = "C:/temperature_data/")

## End(Not run)

</code></pre>


</div>