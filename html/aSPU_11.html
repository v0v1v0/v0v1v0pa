<div class="container">

<table style="width: 100%;"><tr>
<td>estcov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>estcov</h2>

<h3>Description</h3>

<p>Estimate the covariance matrix of multiple traits based on their (null) summary Z-scores.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estcov(allZ, Ps = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>allZ</code></td>
<td>
<p>matrix of summary Z-scores for all SNP. each row for SNP; each column for single trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ps</code></td>
<td>
<p>TRUE if input is p-value, FALSE if input is Z-scores. The default is FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>estimated correlation matrix.
</p>


<h3>Author(s)</h3>

<p>Junghi Kim, Yun Bai and Wei Pan
</p>


<h3>References</h3>

<p>Junghi Kim, Yun Bai and Wei Pan (2015) An Adaptive Association Test for Multiple Phenotypes with GWAS Summary Statistics, Genetic Epidemiology, 8:651-663
</p>


<h3>See Also</h3>

<p><code>MTaSPUs</code> <code>minP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# -- n.snp: number of SNPs
# -- n.trait: number of traits
# -- n.subject: number of subjects

n.snp &lt;- 100
n.traits &lt;- 10
n.subjects &lt;- 1000
traits &lt;- matrix(rnorm(n.subjects*n.traits), n.subjects, n.traits)
v &lt;- cov(traits)
allZ &lt;- rmvnorm(n.snp, Sigma=v)
colnames(allZ) &lt;- paste("trait", 1:n.traits, sep="")
rownames(allZ) &lt;- paste("snp", 1:n.snp, sep="")


r &lt;- estcov(allZ)
MTaSPUs(Z = allZ, v = r, B = 100, pow = c(1:4, Inf), transform = FALSE)
MTaSPUs(Z = allZ[1,], v = r, B = 100, pow = c(1:4, Inf), transform = FALSE)
minP(Zi= allZ[1,], r = r)

</code></pre>


</div>