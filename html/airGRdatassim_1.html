<div class="container">

<table style="width: 100%;"><tr>
<td>airGRdatassim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ensemble-Based Data Assimilation with GR Hydrological Models</h2>

<h3>Description</h3>

<p>Add-on to the 'airGR' package which provides the tools to assimilate observed discharges in daily GR hydrological models. The package consists in two functions allowing to perform the assimilation of observed discharges via the Ensemble Kalman filter or the Particle filter as described in Piazzi et al. (2021) &lt;doi:10.1029/2020WR028390&gt;. airGRdatassim currently runs on daily hydrological models (GR4J, GR5J and GR6J, with and without the CemaNeige snow model). The package is developed at INRAE-Antony (<a href="https://webgr.inrae.fr/en/home/">Catchment Hydrology research group</a> of the HYCAR Research Unit, France). More information about the efficiency of these data assimilation schemes with GR5J can be found in Piazzi et al. (accepted). <br><br></p>
<p>## — Functions and objects
</p>
<p>The airGRdatassim package allows users of GR hydrological models to assimilate discharge observations with the aim of improving streamflow simulations.
The package has been designed to allow the choice between two sequential ensemble-based data assimilation (DA) techniques, namely the Ensemble Kalman filter (EnKF) and the Particle filter (PF). <br>
The functions are coded in R and both their names and arguments are consistent with the airGR package. <br></p>
<p>With the aim of providing a user-friendly package, airGRdatassim relies on two main functions: <br>
- <code>CreateInputsPert</code> generates the probabilistic model inputs to perform ensemble-based DA when accounting for the uncertainty in meteorological forcings; <br>
- <code>RunModel_DA</code> performs streamflow ensemble simulations with the assimilation of observed discharges through the EnKF or the PF schemes. <br><br></p>
<p>Consistently with the airGR package, both structure and class of function arguments are specifically defined to prevent from mis-use and to ensure the flexibility of functions. Advanced users wishing to apply the package to their own models will need to comply with these imposed structures and refer to the package source codes to get all the specification requirements. <br><br></p>
<p>## — Models
</p>
<p>DA schemes are designed to be coupled with GR daily hydrological models, which are implemented in the airGR package. These models can be called within the airGRdatassim package using the following airGR functions (use the command '?airGR' to get the references of the GR models): <br>
- <code>RunModel_GR4J</code>: four-parameter daily lumped hydrological model <br>
- <code>RunModel_GR5J</code>: five-parameter daily lumped hydrological model <br>
- <code>RunModel_GR6J</code>: six-parameter daily lumped hydrological model  <br>
- <code>RunModel_CemaNeigeGR4J</code>: combined use of GR4J and CemaNeige    <br>
- <code>RunModel_CemaNeigeGR5J</code>: combined use of GR5J and CemaNeige    <br>
- <code>RunModel_CemaNeigeGR6J</code>: combined use of GR6J and CemaNeige    <br><br></p>
<p>## — How to get started
</p>
<p>Because airGRdatassim is an airGR-based package, specific airGR functions should be jointly used to ensure the proper use of the airGRdatassim tools. Indeed, before performing the DA-based streamflow simulations, the hydrological model needs to be calibrated through the airGR calibration function. Therefore, the following steps are recommended: <br></p>
<p>1. refer to the help for <code>Calibration_Michel</code> in the airGR package, run the provided example and then refer to the help for <code>CreateCalibOptions</code> to understand how a model calibration is prepared/made; <br>
2. refer to the help for <code>CreateInputsPert</code> to understand how the probabilistic model inputs are generated, if the uncertainty in meteorological forcings is taken into account; <br>
3. refer to the help for <code>RunModel_DA</code> to understand how to perform the DA-based streamflow simulations; <br>
4. refer to the help for <code>ErrorCrit_NSE</code> and <code>CreateInputsCrit</code> in the airGR package to understand how the computation of an error criterion is prepared/made. <br></p>
<p>For more information and to get started with the package, you can refer to the vignette: <br><code>vignette("get_started", package = "airGRdatassim")</code>. <br><br></p>
<p>## — References
</p>
<p>- Piazzi, G., Thirel, G., Perrin, C. and Delaigue, O. (accepted). Sequential data assimilation for streamflow forecasting: assessing the sensitivity to uncertainties and updated variables of a conceptual hydrological model. Water Resources Research, doi: <a href="https://doi.org/10.1029/2020WR028390">10.1029/2020WR028390</a>.
</p>


</div>