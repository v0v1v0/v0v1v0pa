<div class="container">

<table style="width: 100%;"><tr>
<td>rand.kselect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test of the Third-Order Habitat Selection </h2>

<h3>Description</h3>

<p><code>rand.kselect</code> tests whether the marginality vector of animals
is significantly larger than what is expected under the hypothesis of
random habitat use (third-order habitat selection:
selection by the animals of the relocations within their home range;
the habitat availability is measured for each animal).  The effect of
each variable  on individual marginality is also tested. 
Finally, the pertinence of a K-select analysis is also tested.  This is
a randomisation test.  The alpha-level of the tests is
ajusted using the Bonferroni inequality.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rand.kselect(dudi, factor, weight, nrep = 200, alpha = 0.05, ewa = FALSE)
## S3 method for class 'rand.kselect'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudi</code></td>
<td>
<p>an object of class <code>dudi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor</code></td>
<td>
<p>a factor defining the animals identity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a weight vector of integer values (number of relocations
counted in each resource unit in row of the object dudi)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>the number of repetitions of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the alpha level for the tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ewa</code></td>
<td>
<p>logical. If <code>TRUE</code>, uniform weights are given
to all animals in the analysis. If <code>FALSE</code>, animal weights are
given by the proportion of relocations of each animal (i.e. an
animal with 10 relocations has a weight 10 times lower than an
animal with 100 relocations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of the class <code>rand.kselect</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the generic function 
<code>print</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This test is carried out by simulating a random use of space by
animals. <code>rand.kselect</code> is closely related to the function
<code>kselect</code> (same  arguments). 
</p>
<p>At each step  of the randomisation procedure, and for each
animal, the test randomly allocates the nk relocations (where nk is the
sum of the weight vector for the animal k) in the Ik pixels available
to this animal (where Ik is the length of the weight vector for animal
k).
</p>
<p>The length of the marginality vector is 
recomputed at each step of the randomisation procedure and for each
animal. The effect of each variable on the use of pixels by each
animal is measured by the criterion "(average habitat variable j
used by animal i) minus (average habitat variable j available to
animal i)". Finally the value of the first eigenvalue of the 
K-select analysis provides a criterion to test the pertinence of the
K-select analysis. 
</p>
<p>All these values are then compared to the observed values to assess
the significance of theses effects.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>rand.kselect</code>. This list has three
components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code> global </code></td>
<td>
<p>a vector of length 2 
giving the results of the randomisation procedure for the first
eigenvalue of the K-select analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> marg </code></td>
<td>
<p>a matrix giving the significance of the marginality of
each animal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> per.ind </code></td>
<td>
<p>a list giving the results of the randomisation test for the 
coordinates of the marginality vector for each animal
on each habitat variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> alpha </code></td>
<td>
<p>the alpha level of the tests.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Calenge, C., Dufour, A.B. and Maillard, D. (2005) K-select analysis: a
new method to analyse habitat selection in radio-tracking
studies. <em>Ecological modelling</em>, <b>186</b>, 143â€“153.
</p>


<h3>See Also</h3>

 <p><code>kselect</code> to perform a K-select analysis. </p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Loads the data
data(puechabonsp)

locs &lt;- puechabonsp$relocs
map &lt;- puechabonsp$map


## compute the home range of animals (e.g. using the minimum convex
## polygon)
pc &lt;- mcp(locs[,"Name"])

## rasterize it
hr &lt;- do.call("data.frame", lapply(1:nrow(pc), function(i) {
    sp::over(map, geometry(pc[i,]))
}))
names(hr) &lt;- slot(pc, "data")$id
coordinates(hr) &lt;- coordinates(map)
gridded(hr) &lt;- TRUE


## Compute the number of relocation in each pixel of the map
cp &lt;- count.points(locs[,"Name"], map)

## prepares the data for the kselect analysis
x &lt;- prepksel(map, hr, cp)
tab &lt;- x$tab
dud &lt;- dudi.mix(tab, scannf = FALSE, nf = 2)

## the randomisation tests
## be patient, this can be very long on some machines
(te &lt;- rand.kselect(dud, x$factor, x$weight, nrep = 500))


## End(Not run)
</code></pre>


</div>