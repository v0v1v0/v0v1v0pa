<div class="container">

<table style="width: 100%;"><tr>
<td>arms_gibbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gibbs sampling using ARMS</h2>

<h3>Description</h3>

<p>This function uses ARMS (see also <code>arms</code>) to sample from
a multivariate target distribution specified by its (potentially
unnormalised) log density using Gibbs sampling. The function updates each
argument to the log pdf in turn using ARMS, returning a matrix of samples.
<br><br>
The arguments to this function have the same meaning as for
<code>arms</code>, except here they are recycled along the dimension of
<code>previous</code>, rather than from sample to sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">arms_gibbs(n_samples, previous, log_pdf, lower, upper, initial = NULL,
  n_initial = 10, convex = 0, max_points = 100, metropolis = TRUE,
  include_n_evaluations = FALSE, show_progress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_samples</code></td>
<td>
<p>Number of samples to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous</code></td>
<td>
<p>Starting value for the Gibbs sampler. Vectors of this length
are passed to <code>log_pdf</code> as the first argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_pdf</code></td>
<td>
<p>Potentially unnormalised log density of target distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower bound of the support of the target distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper bound of the support of the target distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>Initial points with which to build the rejection distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_initial</code></td>
<td>
<p>Number of points used to form <code>initial</code>; ignored if
<code>initial</code> provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convex</code></td>
<td>
<p>Convexity adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_points</code></td>
<td>
<p>Maximum number of points to allow in the rejection
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metropolis</code></td>
<td>
<p>Whether to use a Metropolis-Hastings step after rejection
sampling. Not necessary if the target distribution is log concave.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_n_evaluations</code></td>
<td>
<p>Whether to return an object specifying the
number of function evaluations used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_progress</code></td>
<td>
<p>If <code>TRUE</code>, a progress bar is shown.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Matrix of samples if <code>include_n_evaluations</code> is <code>FALSE</code>,
otherwise a list.
</p>


<h3>References</h3>

<p>Gilks, W. R., Best, N. G. and Tan, K. K. C. (1995) Adaptive
rejection Metropolis sampling. Applied Statistics, 44, 455-472.
</p>


<h3>See Also</h3>

<p><a href="http://www1.maths.leeds.ac.uk/~wally.gilks/adaptive.rejection/web_page/Welcome.html">http://www1.maths.leeds.ac.uk/~wally.gilks/adaptive.rejection/web_page/Welcome.html</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># The classic 8schools example from RStan
# https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started
schools_data &lt;- list(
  J = 8,
  y = c(28,  8, -3,  7, -1,  1, 18, 12),
  sigma = c(15, 10, 16, 11,  9, 11, 10, 18)
)

log_pdf &lt;- function(params, p) {
  mu &lt;- params[1]
  tau &lt;- params[2]
  eta &lt;- params[3 : (3 + schools_data$J - 1)]
  output &lt;- (
    sum(dnorm(eta, 0, 1, log = TRUE)) +
    sum(dnorm(
      schools_data$y,
      mu + tau * eta,
      schools_data$sigma,
      log = TRUE
    ))
  )
  return(output)
}

x_start &lt;- c(0, 0, rep(0, schools_data$J))
names(x_start) &lt;- c(
  'mu',
  'tau',
  paste0('eta', 1 : schools_data$J)
)

samples &lt;- arms_gibbs(
  250,
  x_start,
  log_pdf,
  c(-1000, 0, rep(-1000, schools_data$J)),
  1000,
  metropolis = FALSE
)
print(colMeans(samples[51 : 250, ]))
</code></pre>


</div>