<div class="container">

<table style="width: 100%;"><tr>
<td>SZVDcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation of sparse zero variance discriminant analysis</h2>

<h3>Description</h3>

<p>Applies alternating direction methods of multipliers to solve sparse
zero variance discriminant analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SZVDcv(Atrain, ...)

## Default S3 method:
SZVDcv(
  Atrain,
  Aval,
  k,
  num_gammas,
  g_mults,
  D,
  sparsity_pen,
  scaling,
  penalty,
  beta,
  tol,
  ztol,
  maxits,
  quiet,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Atrain</code></td>
<td>
<p>Training data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Parameters passed to SZVD.default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aval</code></td>
<td>
<p>Validation set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of classes within training and validation sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_gammas</code></td>
<td>
<p>Number of gammas to train on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_mults</code></td>
<td>
<p>Parameters defining range of gammas to train, g_max*(c_min, c_max).
Note that it is an array/vector with two elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Penalty dictionary basis matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparsity_pen</code></td>
<td>
<p>weight defining validation criteria as weighted sum of misclassification error and
cardinality of discriminant vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>Whether to rescale data so each feature has variance 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>Controls whether to apply reweighting of l1-penalty (using sigma = within-class std devs)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Parameter for augmented Lagrangian term in the ADMM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Stopping tolerances for the ADMM algorithm, must have tol$rel and tol$abs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ztol</code></td>
<td>
<p>Threshold for truncating values in DVs to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxits</code></td>
<td>
<p>Maximum number of iterations used in the ADMM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Controls display of intermediate results.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function might require a wrapper similar to ASDA.
</p>


<h3>Value</h3>

<p><code>SZVDcv</code> returns an object of <code>class</code> "<code>SZVDcv</code>"
including a list with the following named components:
</p>

<dl>
<dt><code>DVs</code></dt>
<dd>
<p>Discriminant vectors for the best choice of gamma.</p>
</dd>
<dt><code>all_DVs</code></dt>
<dd>
<p>Discriminant vectors for all choices of gamma.</p>
</dd>
<dt><code>l0_DVs</code></dt>
<dd>
<p>Discriminant vectors for gamma minimizing cardinality.</p>
</dd>
<dt><code>mc_DVs</code></dt>
<dd>
<p>Discriminant vector minimizing misclassification.</p>
</dd>
<dt><code>gamma</code></dt>
<dd>
<p>Choice of gamma minimizing validation criterion.</p>
</dd>
<dt><code>gammas</code></dt>
<dd>
<p>Set of all gammas trained on.</p>
</dd>
<dt><code>max_g</code></dt>
<dd>
<p>Maximum value of gamma guaranteed to yield a nontrivial solution.</p>
</dd>
<dt><code>ind</code></dt>
<dd>
<p>Index of best gamma.</p>
</dd>
<dt><code>w0</code></dt>
<dd>
<p>unpenalized zero-variance discriminants (initial solutions) plus B and W, etc. from ZVD</p>
</dd>
</dl>
<p><code>NULL</code>
</p>


<h3>See Also</h3>

<p>Non CV version: <code>SZVD</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  P &lt;- 300 # Number of variables
  N &lt;- 50 # Number of samples per class

  # Mean for classes, they are zero everywhere except the first 3 coordinates
  m1 &lt;- rep(0,P)
  m1[1] &lt;- 3

  m2 &lt;- rep(0,P)
  m2[2] &lt;- 3

  m3 &lt;- rep(0,P)
  m3[3] &lt;- 3

  # Sample dummy data
  Xtrain &lt;- rbind(MASS::mvrnorm(n=N,mu = m1, Sigma = diag(P)),
                 MASS::mvrnorm(n=N,mu = m2, Sigma = diag(P)),
                MASS::mvrnorm(n=N,mu = m3, Sigma = diag(P)))
 Xval &lt;- rbind(MASS::mvrnorm(n=N,mu = m1, Sigma = diag(P)),
                 MASS::mvrnorm(n=N,mu = m2, Sigma = diag(P)),
                MASS::mvrnorm(n=N,mu = m3, Sigma = diag(P)))

  # Generate the labels
  Ytrain &lt;- rep(1:3,each=N)
  Yval &lt;- rep(1:3,each=N)


  # Train the classifier and increase the sparsity parameter from the default
  # so we penalize more for non-sparse solutions.

  res &lt;- accSDA::SZVDcv(cbind(Ytrain,Xtrain),cbind(Yval,Xval),num_gammas=4,
                        g_mults = c(0,1),beta=2.5,
                        D=diag(P), maxits=100,tol=list(abs=1e-3,rel=1e-3), k = 3,
                        ztol=1e-4,sparsity_pen=0.3,quiet=FALSE,penalty=TRUE,scaling=TRUE)
</code></pre>


</div>