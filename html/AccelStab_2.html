<div class="container">

<table style="width: 100%;"><tr>
<td>excursion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Temperature Excursion</h2>

<h3>Description</h3>

<p>Predict a temperature excursion for a product.
</p>


<h3>Usage</h3>

<pre><code class="language-R">excursion(
  step1_down_object,
  temp_changes,
  time_changes,
  CI = TRUE,
  PI = TRUE,
  draw = 10000,
  confidence_interval = 0.95,
  intercept = NULL,
  ribbon = TRUE,
  xname = NULL,
  yname = NULL,
  plot_simulations = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>step1_down_object</code></td>
<td>
<p>The fit object from the step1.down function (required).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temp_changes</code></td>
<td>
<p>A list that represents the order of the temperatures that
the product is subjected to. Must be the same length as time_changes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_changes</code></td>
<td>
<p>List that represents the times at which the temperature changes,
Starts from time zero and must be the same length as temp_changes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Show confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PI</code></td>
<td>
<p>Show prediction intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw</code></td>
<td>
<p>Number of simulations used to estimate confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confidence_interval</code></td>
<td>
<p>Confidence level for the confidence and prediction intervals
around the predictions (default 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Use a forced y-intercept. If null, the fitted value will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ribbon</code></td>
<td>
<p>Add shade to confidence and prediction intervals (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xname</code></td>
<td>
<p>Label for the x-axis (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yname</code></td>
<td>
<p>Label for the y-axis (optional).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_simulations</code></td>
<td>
<p>If TRUE, randomly selects 100 of the simulations to
display on the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use the output from step1.down to run a temperature excursion prediction.
</p>


<h3>Value</h3>

<p>An SB class object, a list including the following elements:
</p>

<ul>
<li> <p><em>prediction</em> - A data frame containing the predictions with the confidence and prediction intervals.
</p>
</li>
<li> <p><em>simulations</em> - Matrix of the simulations.
</p>
</li>
<li> <p><em>excursion plot</em> - A plot with predictions and statistical intervals.
</p>
</li>
<li> <p><em>user_parameters</em> - List of users input parameters which is utilised by other
functions in the package.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">#load antigenicity
data(antigenicity)

#run step1.down fit
fit1 &lt;- step1_down(data = antigenicity, y = "conc", .time = "time",
 C = "Celsius", max_time_pred = 3)

#run excursion function with fixed intercept.
excursion &lt;- excursion(step1_down_object = fit1,
                       temp_changes = c(5,15,10),
                       time_changes = c(0.5,1.5,3),
                       CI = TRUE, PI = TRUE, draw = 4000,
                       confidence_interval = 0.95,
                       intercept = 80,
                       xname = "Time in years", yname = "Concentration",
                       ribbon = TRUE, plot_simulations = TRUE)

excursion$excursion_plot

</code></pre>


</div>