<div class="container">

<table style="width: 100%;"><tr>
<td>nll_two_inf_subpops_obs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Negative log-likelihood function:
two observed subpopulations of infected hosts</h2>

<h3>Description</h3>

<p>Function returning negative log-likelihood (nll) for patterns of mortality in
infected and uninfected treatments when an infected population harbours two
identified, or 'observed', subpopulations of hosts experiencing
different patterns of virulence,
e.g. with/without visible signs of infection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nll_two_inf_subpops_obs(
  a1 = a1,
  b1 = b1,
  a2 = a2,
  b2 = b2,
  a3 = a3,
  b3 = b3,
  data = data,
  time = time,
  censor = censor,
  infected_treatment = infected_treatment,
  d1 = "Weibull",
  d2 = "Weibull",
  d3 = "Weibull",
  infsubpop = infsubpop
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a1, b1</code></td>
<td>
<p>location and scale parameters describing background mortality</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a2, b2</code></td>
<td>
<p>location and scale parameters describing mortality due to
infection in one subpopulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a3, b3</code></td>
<td>
<p>location and scale parameters describing mortality due to
infection in the other subpopulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>name of data frame containing survival data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>name of data frame column identifying time of event; time &gt; 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>censor</code></td>
<td>
<p>name of data frame column idenifying if event was death (0)
or right-censoring (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infected_treatment</code></td>
<td>
<p>name of data frame column identifying if data
are from an infected (1) or uninfected (0) treatment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1, d2, d3</code></td>
<td>
<p>names of probability distributions chosen to describe
background mortality and mortality due to infection, respectively;
each defaults to the Weibull distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>infsubpop</code></td>
<td>
<p>name of data frame column identifying
the two subpopulations of infected hosts; '1' or '2'</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The nll is based on six parameters, the location and scale
parameters for background mortality,
plus separate location and scale parameters for each of
the two infected subpopulations.
</p>
<p>It is assumed the patterns of mortality within each subpopulation
act independently of one another.
</p>


<h3>See Also</h3>

<p><code>nll_exposed_infected</code>
<code>nll_two_inf_subpops_unobs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># example using data from Parker et al
    data01 &lt;- data_parker

# create column 'infsubpop' in data01, fill with '0'
    data01$infsubpop &lt;- 0

# infsubpop = '1' for individuals in infected treatments (g == 1)
  # with visible signs of sporulation (Sporulation = 1)
# infsubpop = '2' for individuals in infected treatments (g == 1)
  # with no visible signs of sporulation (Sporulation = 0)
    data01$infsubpop[data01$g == 1 &amp; data01$Sporulation == 1] &lt;- 1
    data01$infsubpop[data01$g == 1 &amp; data01$Sporulation == 0] &lt;- 2

    head(data01)

# step #1: parameterise nll function to be passed to 'mle2'
    m01_prep_function &lt;- function(
      a1 = a1, b1 = b1, a2 = a2, b2 = b2, a3 = a3, b3 = b3){
        nll_two_inf_subpops_obs(
          a1 = a1, b1 = b1, a2 = a2, b2 = b2, a3 = a3, b3 = b3,
          data = data01,
          time = t,
          censor = censored,
          infected_treatment = g,
          d1 = "Frechet",
          d2 = "Weibull",
          d3 = "Weibull",
          infsubpop = infsubpop
        )}

# step #2: send 'prep_function' to 'mle2' for maximum likelihood estimation
    m01 &lt;- mle2(
      m01_prep_function,
      start = list(a1 = 3, b1 = 1, a2 = 2, b2 = 0.5, a3 = 2, b3 = 0.5)
      )

    summary(m01)

</code></pre>


</div>