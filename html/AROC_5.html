<div class="container">

<table style="width: 100%;"><tr>
<td>AROC.kernel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Non parametric kernel-based estimation of the covariate-adjusted ROC curve (AROC).
</h2>

<h3>Description</h3>

<p>Estimates the covariate-adjusted ROC curve (AROC) using the nonparametric kernel-based method proposed by Rodriguez-Alvarez et al. (2011). The method, as it stands now, can only deal with one continuous covariate. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">AROC.kernel(marker, covariate, group, tag.healthy, data, p = seq(0, 1, l = 101), B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>A character string with the name of the diagnostic test variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>A character string with the name of the continuous covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A character string with the name of the variable that distinguishes healthy from diseased individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tag.healthy</code></td>
<td>
<p>The value codifying the healthy individuals in the variable <code>group</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame representing the data and containing all needed variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Set of false positive fractions (FPF) at which to estimate the covariate-adjusted ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>An integer value specifying the number of bootstrap resamples for the construction of the confidence intervals. By default 1000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimates the covariate-adjusted ROC curve (AROC) defined as
</p>
<p style="text-align: center;"><code class="reqn">AROC\left(t\right) = Pr\{1 - F_{\bar{D}}(Y_D | X_{D}) \leq t\},</code>
</p>

<p>where <code class="reqn">F_{\bar{D}}(\cdot|X_{D})</code> denotes the conditional distribution function for <code class="reqn">Y_{\bar{D}}</code> conditional on the vector of covariates <code class="reqn">X_{\bar{D}}</code>. In particular, the method implemented in this function estimates the outer probability empirically (see Janes and Pepe, 2008) and <code class="reqn">F_{\bar{D}}(\cdot|X_{\bar{D}})</code> is estimated assuming a nonparametric location-scale regression model for <code class="reqn">Y_{\bar{D}}</code>, i.e., 
</p>
<p style="text-align: center;"><code class="reqn">Y_{\bar{D}} = \mu_{\bar{D}}(X_{\bar{D}}) + \sigma_{\bar{D}}(X_{\bar{D}})\varepsilon_{\bar{D}},</code>
</p>

<p>where <code class="reqn">\mu_{\bar{D}}</code> is the regression funcion, <code class="reqn">\sigma_{\bar{D}}</code> is the variance function, and <code class="reqn">\varepsilon_{\bar{D}}</code> has zero mean, variance one, and
distribution function <code class="reqn">F_{\bar{D}}</code>. As a consequence, and for a random sample <code class="reqn">\{(x_{\bar{D}i},y_{\bar{D}i})\}_{i=1}^{n_{\bar{D}}}</code>
</p>
<p style="text-align: center;"><code class="reqn">F_{\bar{D}}(y_{\bar{D}i} | X_{\bar{D}}= x_{\bar{D}i}) = F_{\bar{D}}\left(\frac{y_{\bar{D}i}-\mu_{\bar{D}}(x_{\bar{D}i})}{\sigma_{\bar{D}}(x_{\bar{D}i})}\right).</code>
</p>
 
<p>Both the regression and variance functions are estimated using the Nadaraya-Watson estimator, and the bandwidth are selected using least-squares cross-validation. Implementation relies on the <code>R</code>-package <code>np</code>. No assumption is made about the distribution of <code class="reqn">\varepsilon_{\bar{D}}</code>, which is empirically estimated on the basis of standardised residuals. 
</p>


<h3>Value</h3>

<p>As a result, the function provides a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Set of false positive fractions (FPF) at which the pooled ROC curve has been estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ROC</code></td>
<td>
<p>Estimated covariate-adjusted ROC curve (AROC), and 95% pointwise confidence intervals (if required)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUC</code></td>
<td>
<p>Estimated area under the covariate-adjusted ROC curve (AAUC), and 95% pointwise confidence intervals (if required).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw.mean</code></td>
<td>
<p>An object of class <code>npregbw</code> with the selected bandwidth for the nonparametric regression function. For further details, see  <code>R</code>-package <code>np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw.var</code></td>
<td>
<p>An object of class <code>npregbw</code> with the selected bandwidth for the nonparametric variance function. For further details, see  <code>R</code>-package <code>np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.mean</code></td>
<td>
<p>An object of class <code>npreg</code> with the nonparametric regression function estimate. For further details, see  <code>R</code>-package <code>np</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.var</code></td>
<td>
<p>An object of class <code>npreg</code> with the nonparametric variance function estimate. For further details, see  <code>R</code>-package <code>np</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hayfield, T., and Racine, J. S.(2008). Nonparametric Econometrics: The np Package. Journal of Statistical Software 27(5). URL http://www.jstatsoft.org/v27/i05/.
</p>
<p>Inacio de Carvalho, V., and Rodriguez-Alvarez, M. X. (2018). Bayesian nonparametric inference for the covariate-adjusted ROC curve. arXiv preprint arXiv:1806.00473.
</p>
<p>Rodriguez-Alvarez, M. X., Roca-Pardinas, J., and Cadarso-Suarez, C. (2011). ROC curve and covariates: extending induced methodology to the non-parametric framework. Statistics and Computing, 21(4), 483 - 499.
</p>


<h3>See Also</h3>

<p><code>AROC.bnp</code>, <code>AROC.bsp</code>, <code>AROC.sp</code>, <code>AROC.kernel</code>, <code>pooledROC.BB</code> or <code>pooledROC.emp</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(AROC)
data(psa)
# Select the last measurement
newpsa &lt;- psa[!duplicated(psa$id, fromLast = TRUE),]

# Log-transform the biomarker
newpsa$l_marker1 &lt;- log(newpsa$marker1)

m2 &lt;- AROC.kernel(marker = "l_marker1", covariate = "age",
group = "status", tag.healthy = 0, data = newpsa, 
p = seq(0,1,l=101), B = 500)

summary(m2)

plot(m2)


</code></pre>


</div>