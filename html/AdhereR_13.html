<div class="container">

<table style="width: 100%;"><tr>
<td>CMA_polypharmacy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>CMA constructor for polypharmacy.</h2>

<h3>Description</h3>

<p>Constructs a CMA (continuous multiple-interval measures of medication
availability/gaps) object for polypharmacy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CMA_polypharmacy(
  data = data,
  medication.groups = medication.class.colname,
  CMA.to.apply = NA,
  aggregate.first = TRUE,
  aggregation.method = NA,
  aggregation.method.arguments = NA,
  thresholds = NA,
  ID.colname = NA,
  event.date.colname = NA,
  event.duration.colname = NA,
  event.daily.dose.colname = NA,
  medication.class.colname = NA,
  carry.only.for.same.medication = NA,
  consider.dosage.change = NA,
  followup.window.start = 0,
  followup.window.start.unit = c("days", "weeks", "months", "years")[1],
  followup.window.duration = 365 * 2,
  followup.window.duration.unit = c("days", "weeks", "months", "years")[1],
  observation.window.start = 0,
  observation.window.start.unit = c("days", "weeks", "months", "years")[1],
  observation.window.duration = 365 * 2,
  observation.window.duration.unit = c("days", "weeks", "months", "years")[1],
  date.format = "%m/%d/%Y",
  summary = "CMA for polypharmacy",
  force.NA.CMA.for.failed.patients = TRUE,
  parallel.backend = c("none", "multicore", "snow", "snow(SOCK)", "snow(MPI)",
    "snow(NWS)")[1],
  parallel.threads = "auto",
  suppress.warnings = FALSE,
  suppress.special.argument.checks = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <em><code>data.frame</code></em> containing the events (prescribing or
dispensing) used to compute the CMA. Must contain, at a minimum, the patient
unique ID, the event date and duration, medication type, and might also contain the daily
dosage (the actual column names are defined in the
following four parameters).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.groups</code></td>
<td>
<p>A <em>string</em> with the name of the column containing the medication
groups. If multiple medication classes should belong to the same treatment group, they can be
differentiated here (important to investigate treatment switches)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CMA.to.apply</code></td>
<td>
<p>A <em>string</em> giving the name of the CMA function (1 to
9) that will be computed for each treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregate.first</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code>, aggregate across treatment groups before
summarizing over time during OW.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregation.method</code></td>
<td>
<p>A <em>string</em> giving the name of the function to
aggregate CMA values of medication group, or <code>NA</code> to return only raw CMA estimates
per medication group. Accepts summary functions such as "mean", "sd", "var", "min", "max",
and "median". Custom functions are possible as long as they take a numeric vector as input
and return a single numeric value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggregation.method.arguments</code></td>
<td>
<p>optional, A <em>named list</em> of additional arguments to the
function given in <code>aggregation method</code>, e.g. <code>na.rm = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>optional, a <em>number</em> to apply as threshold between aggregation and summarizing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID.colname</code></td>
<td>
<p>A <em>string</em>, the name of the column in
<code>data</code> containing the medication type. Defaults to
<code>medication.class.colname</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event.date.colname</code></td>
<td>
<p>A <em>string</em>, the name of the column in
<code>data</code> containing the start date of the event (in the format given in
the <code>date.format</code> parameter); must be present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event.duration.colname</code></td>
<td>
<p>A <em>string</em>, the name of the column in
<code>data</code> containing the event duration (in days); must be present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event.daily.dose.colname</code></td>
<td>
<p>A <em>string</em>, the name of the column in
<code>data</code> containing the prescribed daily dose, or <code>NA</code> if not defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.class.colname</code></td>
<td>
<p>A <em>string</em>, the name of the column in
<code>data</code> containing the medication type, or <code>NA</code> if not defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>carry.only.for.same.medication</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code>, the
carry-over applies only across medication of the same type; valid only for
CMAs 5 to 9, in which case it is coupled (i.e., the same value is used for
computing the treatment episodes and the CMA on each treatment episode).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>consider.dosage.change</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code>, the carry-over
is adjusted to also reflect changes in dosage; valid only for CMAs 5 to 9, in
which case it is coupled (i.e., the same value is used for computing the
treatment episodes and the CMA on each treatment episode).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup.window.start</code></td>
<td>
<p>If a <em><code>Date</code></em> object, it represents
the actual start date of the follow-up window; if a <em>string</em> it is the
name of the column in <code>data</code> containing the start date of the follow-up
window either as the numbers of <code>followup.window.start.unit</code> units after
the first event (the column must be of type <code>numeric</code>) or as actual
dates (in which case the column must be of type <code>Date</code>); if a
<em>number</em> it is the number of time units defined in the
<code>followup.window.start.unit</code> parameter after the begin of the
participant's first event; or <code>NA</code> if not defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup.window.start.unit</code></td>
<td>
<p>can be either <em>"days"</em>,
<em>"weeks"</em>, <em>"months"</em> or <em>"years"</em>, and represents the time
units that <code>followup.window.start</code> refers to (when a number), or
<code>NA</code> if not defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup.window.duration</code></td>
<td>
<p>either a <em>number</em> representing the
duration of the follow-up window in the time units given in
<code>followup.window.duration.unit</code>, or a <em>string</em> giving the column
containing these numbers. Should represent a period for which relevant
medication events are recorded accurately (e.g. not extend after end of
relevant treatment, loss-to-follow-up or change to a health care provider
not covered by the database).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup.window.duration.unit</code></td>
<td>
<p>can be either <em>"days"</em>,
<em>"weeks"</em>, <em>"months"</em> or <em>"years"</em>, and represents the time
units that <code>followup.window.duration</code> refers to, or <code>NA</code> if not
defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observation.window.start, observation.window.start.unit, observation.window.duration, observation.window.duration.unit</code></td>
<td>
<p>the definition of the observation window
(see the follow-up window parameters above for details). Can be defined separately
for each patient and treatment group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.format</code></td>
<td>
<p>A <em>string</em> giving the format of the dates used in the
<code>data</code> and the other parameters; see the <code>format</code> parameters of the
<code>as.Date</code> function for details (NB, this concerns only the
dates given as strings and not as <code>Date</code> objects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Metadata as a <em>string</em>, briefly describing this CMA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.NA.CMA.for.failed.patients</code></td>
<td>
<p><em>Logical</em> describing how the
patients for which the CMA estimation fails are treated: if <code>TRUE</code>
they are returned with an <code>NA</code> CMA estimate, while for
<code>FALSE</code> they are omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.backend</code></td>
<td>
<p>Can be "none" (the default) for single-threaded
execution, "multicore"  (using <code>mclapply</code> in package <code>parallel</code>)
for multicore processing (NB. not currently implemented on MS Windows and
automatically falls back on "snow" on this platform),  or "snow",
"snow(SOCK)" (equivalent to "snow"), "snow(MPI)" or "snow(NWS)" specifying
various types of SNOW clusters (can be on the local machine or more complex
setups â€“ please see the documentation of package <code>snow</code> for details;
the last two require packages <code>Rmpi</code> and <code>nws</code>, respectively, not
automatically installed with <code>AdhereR</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.threads</code></td>
<td>
<p>Can be "auto" (for <code>parallel.backend</code> ==
"multicore", defaults to the number of cores in the system as given by
<code>options("cores")</code>, while for <code>parallel.backend</code> == "snow",
defaults to 2), a strictly positive integer specifying the number of parallel
threads, or a more complex specification of the SNOW cluster nodes for
<code>parallel.backend</code> == "snow" (see the documentation of package
<code>snow</code> for details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.warnings</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code> don't show any
warnings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppress.special.argument.checks</code></td>
<td>
<p><em>Logical</em> parameter for internal
use; if <code>FALSE</code> (default) check if the important columns in the <code>data</code>
have some of the reserved names, if <code>TRUE</code> this check is not performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other possible parameters</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>S3</code> object of class <code>CMA_polypharmacy</code> with the
following fields:
</p>

<ul>
<li> <p><code>data</code> The actual event data, as given by the <code>data</code>
parameter.
</p>
</li>
<li> <p><code>ID.colname</code> the name of the column in <code>data</code> containing the
unique patient ID, as given by the <code>ID.colname</code> parameter.
</p>
</li>
<li> <p><code>event.date.colname</code> the name of the column in <code>data</code>
containing the start date of the event (in the format given in the
<code>date.format</code> parameter), as given by the <code>event.date.colname</code>
parameter.
</p>
</li>
<li> <p><code>event.duration.colname</code> the name of the column in <code>data</code>
containing the event duration (in days), as given by the
<code>event.duration.colname</code> parameter.
</p>
</li>
<li> <p><code>event.daily.dose.colname</code> the name of the column in <code>data</code>
containing the prescribed daily dose, as given by the
<code>event.daily.dose.colname</code> parameter.
</p>
</li>
<li> <p><code>medication.class.colname</code> the name of the column in <code>data</code>
containing the classes/types/groups of medication, as given by the
<code>medication.class.colname</code> parameter.
</p>
</li>
<li> <p><code>carry.only.for.same.medication</code> whether the carry-over applies
only across medication of the same type, as given by the
<code>carry.only.for.same.medication</code> parameter.
</p>
</li>
<li> <p><code>consider.dosage.change</code> whether the carry-over is adjusted to
reflect changes in dosage, as given by the <code>consider.dosage.change</code>
parameter.
</p>
</li>
<li> <p><code>followup.window.start</code> the beginning of the follow-up window, as
given by the <code>followup.window.start</code> parameter.
</p>
</li>
<li> <p><code>followup.window.start.unit</code> the time unit of the
<code>followup.window.start</code>, as given by the
<code>followup.window.start.unit</code> parameter.
</p>
</li>
<li> <p><code>followup.window.duration</code> the duration of the follow-up window,
as given by the <code>followup.window.duration</code> parameter.
</p>
</li>
<li> <p><code>followup.window.duration.unit</code> the time unit of the
<code>followup.window.duration</code>, as given by the
<code>followup.window.duration.unit</code> parameter.
</p>
</li>
<li> <p><code>observation.window.start</code> the beginning of the observation
window, as given by the <code>observation.window.start</code> parameter.
</p>
</li>
<li> <p><code>observation.window.start.unit</code> the time unit of the
<code>observation.window.start</code>, as given by the
<code>observation.window.start.unit</code> parameter.
</p>
</li>
<li> <p><code>observation.window.duration</code> the duration of the observation
window, as given by the <code>observation.window.duration</code> parameter.
</p>
</li>
<li> <p><code>observation.window.duration.unit</code> the time unit of the
<code>observation.window.duration</code>, as given by the
<code>observation.window.duration.unit</code> parameter.
</p>
</li>
<li> <p><code>date.format</code> the format of the dates, as given by the
<code>date.format</code> parameter.
</p>
</li>
<li> <p><code>summary</code> the metadata, as given by the <code>summary</code> parameter.
</p>
</li>
<li> <p><code>event.info</code> the <code>data.frame</code> containing the event info
(irrelevant for most users; see <code>compute.event.int.gaps</code> for
details).
</p>
</li>
<li> <p><code>aggregation.method</code> the aggregation method to combine CMA values
from different groups.
</p>
</li>
<li> <p><code>computed.CMA</code> the class name of the computed CMA.
</p>
</li>
<li> <p><code>medication.groups</code> a <code>data.frame</code> with medication groups and
classes
</p>
</li>
<li> <p><code>CMA</code> the <code>data.frame</code> containing the actual <code>CMA</code>
estimates for each participant (the <code>ID.colname</code> column) and
sometimes treatment group, with columns:
</p>

<ul>
<li> <p><code>ID.colname</code> the patient ID as given by the <code>ID.colname</code>
parameter.
</p>
</li>
<li> <p><code>medication.groups</code> only when no aggregation method is used
(<code>aggregation.method = NA</code>); the treatment group as given by the
<code>medication.groups</code> parameter.
</p>
</li>
<li> <p><code>CMA</code> the treatment episode's estimated CMA.
</p>
</li>
</ul>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
CMA_PP &lt;- CMA_polypharmacy(data = med.events.pp,
medication.groups = med.groups,
CMA.to.apply = "CMA7",
aggregate.first = TRUE, # aggregate before summarizing
aggregation.method = "mean", # compute mean of CMAs
aggregation.method.arguments = list(na.rm = TRUE), # remove NA's during calculation
thresholds = NA, # don't apply threshold
ID.colname="PATIENT_ID",
event.date.colname="DATE",
event.duration.colname="DURATION",
event.daily.dose.colname="PERDAY",
medication.class.colname="CATEGORY",
followup.window.start=0,
observation.window.start=180,
observation.window.duration=365,
carry.only.for.same.medication = TRUE);
## End(Not run)
</code></pre>


</div>