<div class="container">

<table style="width: 100%;"><tr>
<td>detect_pk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect preknowledge</h2>

<h3>Description</h3>

<p>Detect preknowledge under the assumption that the set of
compromised items is known.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_pk(
  method,
  ci,
  psi,
  xi = NULL,
  xi_c = NULL,
  xi_s = NULL,
  x = NULL,
  y = NULL,
  interval = c(-4, 4),
  alpha = 0.05,
  cutoff = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The preknowledge detection statistic(s) to compute. Options for
score-based statistics are:
</p>

<ul>
<li> <p><code>"L_S"</code> for the signed likelihood ratio test statistic (Sinharay, 2017).
</p>
</li>
<li> <p><code>"ML_S"</code> for the modified signed likelihood ratio test statistic
(Sinharay &amp; Jensen, 2019). For numerical stability, an absolute cutoff
value can be specified using <code>cutoff</code>. <em>Note:</em> This statistic cannot be
computed under the 3PL model or the graded response model.
</p>
</li>
<li> <p><code>"LR_S"</code> for the Lugannani-Rice approximation (Sinharay &amp; Jensen, 2019).
For numerical stability, an absolute cutoff value can be specified using
<code>cutoff</code>. <em>Note:</em> This statistic cannot be computed under the 3PL model
or the graded response model.
</p>
</li>
<li> <p><code>"S_S"</code> for the signed score test statistic (Sinharay, 2017).
</p>
</li>
<li> <p><code>"W_S"</code> for the Wald test statistic (Sinharay &amp; Jensen, 2019).
</p>
</li>
</ul>
<p>Options for response time-based statistics are:
</p>

<ul><li> <p><code>"L_T"</code> for the signed likelihood ratio test statistic, or equivalently,
<code>"W_T"</code> for the Wald test statistic (Sinharay, 2020).
</p>
</li></ul>
<p>Options for score and response time-based statistics are:
</p>

<ul><li> <p><code>"L_ST"</code> for the constrained likelihood ratio test statistic (Sinharay &amp;
Johnson, 2020).
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>A vector of compromised item positions. All other items are
presumed secure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>A matrix of item parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi, xi_c, xi_s</code></td>
<td>
<p>Matrices of person parameters. <code>xi</code> is based on all
items, <code>xi_c</code> is based on the compromised items, and <code>xi_s</code> is based on the
secure items. If <code>NULL</code> (default), person parameters are estimated using
maximum likelihood estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores and <code>y</code> the item
log response times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>The interval to search for the person parameters. Default is
<code>c(-4, 4)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value(s) between 0 and 1 indicating the significance level(s)
used for flagging. Default is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Use with the modified signed likelihood ratio test statistic
and the Lugannani-Rice approximation. If the absolute value of the signed
likelihood ratio test statistic is less than the cutoff (default is
<code>0.05</code>), then the modified signed likelihood ratio test statistic is
replaced with the signed likelihood ratio test statistic and the
Lugannani-Rice approximation is replaced with the <code class="reqn">p</code>-value of the
signed likelihood ratio test statistic.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A matrix of preknowledge detection statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>A matrix of <em>p</em>-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flag</code></td>
<td>
<p>An array of flagging results. The first dimension corresponds to
persons, the second dimension to methods, and the third dimension to
significance levels.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Sinharay, S. (2017). Detection of item preknowledge using likelihood ratio
test and score test. <em>Journal of Educational and Behavioral Statistics</em>,
<em>42</em>(1), 46–68.
</p>
<p>Sinharay, S. (2020). Detection of item preknowledge using response times.
<em>Applied Psychological Measurement</em>, <em>44</em>(5), 376–392.
</p>
<p>Sinharay, S., &amp; Jensen, J. L. (2019). Higher-order asymptotics and its
application to testing the equality of the examinee ability over two sets of
items. <em>Psychometrika</em>, <em>84</em>(2), 484–510.
</p>
<p>Sinharay, S., &amp; Johnson, M. S. (2020). The use of item scores and response
times to detect examinees who may have benefited from item preknowledge.
<em>British Journal of Mathematical and Statistical Psychology</em>, <em>73</em>(3),
397–419.
</p>


<h3>See Also</h3>

<p><code>detect_as()</code> to detect answer similarity.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Setup for Examples 1 and 2 ------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = preknowledge, 0 = no preknowledge)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Item Scores and Response Times ---------------------------------

# Generate person parameters for the 2PL model and lognormal model
xi &lt;- MASS::mvrnorm(
  N,
  mu = c(theta = 0.00, tau = 0.00),
  Sigma = matrix(c(1.00, 0.25, 0.25, 0.25), ncol = 2)
)

# Generate item parameters for the 2PL model and lognormal model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = NA,
  c = 0,
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = NA
)

# Generate positively correlated difficulty and time intensity parameters
psi[, c("b", "beta")] &lt;- MASS::mvrnorm(
  n,
  mu = c(b = 0.00, beta = 3.50),
  Sigma = matrix(c(1.00, 0.20, 0.20, 0.15), ncol = 2)
)

# Simulate uncontaminated data
dat &lt;- sim(psi, xi)
x &lt;- dat$x
y &lt;- dat$y

# Modify contaminated data by changing the item scores and reducing the log
# response times
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect preknowledge
out &lt;- detect_pk(
  method = c("L_S", "ML_S", "LR_S", "S_S", "W_S", "L_T", "L_ST"),
  ci = ci,
  psi = psi,
  x = x,
  y = y
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect preknowledge
out &lt;- detect_pk(
  method = c("L_S", "ML_S", "LR_S", "S_S", "W_S"),
  ci = ci,
  psi = psi,
  x = x
)
</code></pre>


</div>