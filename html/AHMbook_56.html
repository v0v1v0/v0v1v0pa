<div class="container">

<table style="width: 100%;"><tr>
<td>sim3Occ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate detection/nondetection data for static 3-level occupancy models
</h2>

<h3>Description</h3>

<p>Function generates 3-level occupancy data with possibility of site-specific random variation at every level, "time effects" at the middle and the lower levels and effects of one distinct covariate at each level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim3Occ(nunits = 100, nsubunits = 5, nreps = 3,
  mean.psi = 0.8, beta.Xpsi = 1, sd.logit.psi = 0,
  mean.theta = 0.6, theta.time.range = c(-1, 1), beta.Xtheta = 1, sd.logit.theta = 0,
  mean.p = 0.4, p.time.range = c(-2, 2), beta.Xp = -1, sd.logit.p = 0,
  show.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nunits</code></td>
<td>

<p>Number of main units (large quadrats)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsubunits</code></td>
<td>

<p>Number of subunits (nested subsamples within each main unit)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>

<p>Number of replicate surveys in every subunit
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.psi</code></td>
<td>

<p>Mean large-scale, unit-level occupancy probability (psi)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.Xpsi</code></td>
<td>

<p>effect on psi of covariate A (at main unit level)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.psi</code></td>
<td>

<p>SD of logit(psi), unstructured site variation in psi
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.theta</code></td>
<td>

<p>Mean small-scale (subunit) occupancy probability (theta)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.time.range</code></td>
<td>

<p>range of theta 'intercepts' for subunits
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.Xtheta</code></td>
<td>

<p>effect on theta of covariate B (at subunit level)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.theta</code></td>
<td>

<p>SD of logit(theta), unstructured site variation in theta
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.p</code></td>
<td>

<p>Mean per-survey detection probability
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.time.range</code></td>
<td>

<p>range of p 'intercepts' for replicates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.Xp</code></td>
<td>

<p>effect on p of covariate C (unit by subunit by replicate)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.p</code></td>
<td>

<p>SD of logit(p)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta.time.effect </code></td>
<td>
<p>Simulated time effect on theta, a vector of length <code>nsubunits</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.time.effect </code></td>
<td>
<p>Simulated time effect on p, a vector of length <code>nreps</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>Detection probabiliy, a <code>nunits x nsubunits x nreps</code> array</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z </code></td>
<td>
<p>Occupancy indicator for main units, a <code>nunits x 1</code> array of 0/1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a </code></td>
<td>
<p>Occupancy indicator for subunits, a <code>nunits x nsubunits</code> array of 0/1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>Detection array, a <code>nunits x nsubunits x nreps</code> array of 0/1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum.z </code></td>
<td>
<p>True number of occupied main units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.sum.z </code></td>
<td>
<p>Observed number of occupied main units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum.z.a </code></td>
<td>
<p>Number of units with &gt;=1 occupied, surveyed subunit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covA </code></td>
<td>
<p>Simulated covariate A, a vector of length <code>nunits</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covB </code></td>
<td>
<p>Simulated covariate B, a <code>nunits x nsubunits</code> matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covC </code></td>
<td>
<p>Simulated covariate C, a <code>nunits x nsubunits x nreps</code> array</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.10.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data with the default arguments and look at the structure:
tmp &lt;- sim3Occ()
str(tmp)

# 'Null' model (model 1)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 0, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(0, 0),
  beta.Xtheta = 0, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(0,0),
  beta.Xp = 0, sd.logit.p = 0))

# No covariate effects, no random variability (model 2)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 0, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 0, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = 0, sd.logit.p = 0))

# All covariate effects, but no random variability (model 3)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 1, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 1, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = -1, sd.logit.p = 0))

# Most complex model with all effects allowed for by sim function (model 4)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 1, sd.logit.psi = 1, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 1, sd.logit.theta = 1, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = -1, sd.logit.p = 1))
</code></pre>


</div>