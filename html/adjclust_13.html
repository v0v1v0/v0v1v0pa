<div class="container">

<table style="width: 100%;"><tr>
<td>plotSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot (dis)similarity matrix</h2>

<h3>Description</h3>

<p>Heatmap of the (dis)similarity matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSim(
  mat,
  type = c("similarity", "dissimilarity"),
  clustering = NULL,
  dendro = NULL,
  k = NULL,
  log = TRUE,
  legendName = "intensity",
  main = NULL,
  priorCount = 0.5,
  stats = c("R.squared", "D.prime"),
  h = NULL,
  axis = FALSE,
  naxis = min(10, nrow(mat)),
  axistext = NULL,
  xlab = "objects",
  cluster_col = "darkred",
  mode = c("standard", "corrected", "total-disp", "within-disp", "average-disp")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>matrix to plot. It can be of class <code>'matrix'</code>, 
<code>'dgCMatrix'</code>, <code>'dsCMatrix'</code>, <code>'dist'</code>, <code>'HTCexp'</code>,
<code>'snpMatrix'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>input matrix type. Can be either <code>"similarity"</code> or 
<code>"dissimilarity"</code> (kernels are supposed to be of type 
<code>"similarity"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>vector of clusters to display on the matrix (if not 
<code>NULL</code>). If <code>clustering</code> is provided, it must be a numeric vector
of length identical to the matrix size with clusters identified as 
consecutive integers 1, 2, 3, ...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendro</code></td>
<td>
<p>dendrogram provided as an <code>hclust</code> object, or as another
type of object that can be converted to <code>hclust</code> with <code>as.hclust</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of clusters to display. Used only when <code>dendro</code> is not
<code>NULL</code> and <code>clustering</code> is <code>NULL</code>. The clustering is then 
deduced from the dendrogram by a standard cut.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical. Should the breaks be based on log-scaled values of the
matrix entries. Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendName</code></td>
<td>
<p>character. Title of the legend. Default to 
<code>"intensity"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>character. Title of the plot. Default to <code>NULL</code> (no title).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorCount</code></td>
<td>
<p>numeric. Average count to be added to each entry of the
matrix to avoid taking log of zero. Used only if <code>log == TRUE</code> and 
default to 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>input SNP correlation type. Used when <code>mat</code> is of type 
<code>SnpMatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>positive integer. Threshold distance for SNP correlation 
computation. Used when <code>mat</code> is of type <code>SnpMatrix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>logical. Should x-axis be displayed on the plot? Default to 
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>naxis</code></td>
<td>
<p>integer. If <code>axis == TRUE</code>, number of ticks to display on
the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axistext</code></td>
<td>
<p>character vector. If <code>axis == TRUE</code>, labels to display
of the x-axis (its length has to be equal to <code>naxis</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>character. If <code>axis == TRUE</code>, x-axis title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster_col</code></td>
<td>
<p>colour for the cluster line if <code>clustering</code> is not
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>type of dendrogram to plot (see <code>plot.chac</code>). Default
to <code>"standard"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces a heatmap for the used (dis)similarity matrix that 
can be used as a diagnostic plot to check the consistency between the 
obtained clustering and the original (dis)similarity
</p>


<h3>See Also</h3>

<p><code>select</code>, <code>adjClust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
clustering &lt;- rep(1:3, each = 50)
dist_data &lt;- as.matrix(dist(iris[, 1:4]))
dendro_iris &lt;- adjClust(dist_data, type = "dissimilarity")
plotSim(dist_data, type = "dissimilarity", dendro = dendro_iris, axis = TRUE)
plotSim(dist_data, type = "dissimilarity", dendro = dendro_iris,
        clustering = clustering)
plotSim(dist_data, type = "dissimilarity", dendro = dendro_iris, axis = TRUE,
        k = 3)
plotSim(dist_data, type = "dissimilarity", legendName = "IF", axis = TRUE, 
        clustering = clustering)
p &lt;- plotSim(dist(iris[, 1:4]), type = "dissimilarity", log = FALSE, 
             clustering = clustering, cluster_col = "blue")
# custom palette
p + scale_fill_gradient(low = "yellow", high = "red")
# dsCMatrix
m &lt;- Matrix(c(0, 0, 2, 0, 3, 0, 2, 0, 0), ncol = 3)
res &lt;- adjClust(m)
plotSim(m, axis = TRUE)
plotSim(m, dendro = res)
# dgCMatrix
m &lt;- as(m, "generalMatrix")
plotSim(m)
m &lt;- as.dist(m)
if (require("HiTC", quietly = TRUE)) {
  load(system.file("extdata", "hic_imr90_40_XX.rda", package = "adjclust"))
  res &lt;- hicClust(hic_imr90_40_XX, log = TRUE)
  plotSim(hic_imr90_40_XX, axis = TRUE)
}
if (requireNamespace("snpStats", quietly = TRUE)) {
  data(testdata, package = "snpStats")
  plotSim(Autosomes[1:200, 1:5], h = 3, stats = "R.squared", axis = TRUE,
          axistext = c("A", "B", "C", "D", "E"))
}

## End(Not run)
</code></pre>


</div>