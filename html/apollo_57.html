<div class="container">

<table style="width: 100%;"><tr>
<td>apollo_mdcnev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates MDCNEV likelihoods</h2>

<h3>Description</h3>

<p>Calculates the likelihoods of a Multiple Discrete Continuous Nested Extreme Value (MDCNEV) model with an outside good and can also perform other operations based on the value of the <code>functionality</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">apollo_mdcnev(mdcnev_settings, functionality)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mdcnev_settings</code></td>
<td>
<p>List. Contains settings for this function. User input is required for all settings except those with a default or marked as optional. 
</p>

<ul>
<li> <p><strong><code>alpha</code></strong>: Named list. Alpha parameters for each alternative, including for the outside good. As many elements as alternatives.
</p>
</li>
<li> <p><strong><code>avail</code></strong>: Named list of numeric vectors or scalars. Availabilities of alternatives, one element per alternative. Names of elements must match those in <code>alternatives</code>. Values can be 0 or 1. These can be scalars or vectors (of length equal to rows in the database). A user can also specify <code>avail=1</code> to indicate universal availability, or omit the setting completely.
</p>
</li>
<li> <p><strong><code>alternatives</code></strong>: Character vector. Names of alternatives, elements must match the names in list 'utilities'.
</p>
</li>
<li> <p><strong><code>budget</code></strong>: Numeric vector. Budget for each observation.
</p>
</li>
<li> <p><strong><code>componentName</code></strong>: Character. Name given to model component. If not provided by the user, Apollo will set the name automatically according to the element in <code>P</code> to which the function output is directed.
</p>
</li>
<li> <p><strong><code>continuousChoice</code></strong>: Named list of numeric vectors. Amount of consumption of each alternative. One element per alternative, as long as the number of observations or a scalar. Names must match those in <code>alternatives</code>.
</p>
</li>
<li> <p><strong><code>cost</code></strong>: Named list of numeric vectors. Price of each alternative. One element per alternative, each one as long as the number of observations or a scalar. Names must match those in <code>alternatives</code>.
</p>
</li>
<li> <p><strong><code>gamma</code></strong>: Named list. Gamma parameters for each alternative, including for the outside good. As many elements as alternatives.
</p>
</li>
<li> <p><strong><code>mdcnevNests</code></strong>: Named list. Lambda parameters for each nest. Elements must be named with the nest name. The lambda at the root is fixed to 1, and therefore must be no be defined. The value of the estimated mdcnevNests parameters should be between 0 and 1 to ensure consistency with random utility maximization.
</p>
</li>
<li> <p><strong><code>mdcnevStructure</code></strong>: Numeric matrix. One row per nest and one column per alternative. Each element of the matrix is 1 if an alternative belongs to the corresponding nest.
</p>
</li>
<li> <p><strong><code>outside</code></strong>: Character. Alternative name for the outside good. Default is "outside"
</p>
</li>
<li> <p><strong><code>rows</code></strong>: Boolean vector. Consideration of which rows to include. Length equal to the number of observations (nObs), with entries equal to TRUE for rows to include, and FALSE for rows to exclude. Default is <code>"all"</code>, equivalent to <code>rep(TRUE, nObs)</code>.
</p>
</li>
<li> <p><strong><code>utilities</code></strong>: Named list. Utilities of the alternatives. Names of elements must match those in argument 'alternatives'.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functionality</code></td>
<td>
<p>Character. Setting instructing Apollo what processing to apply to the likelihood function. This is in general controlled by the functions that call <code>apollo_probabilities</code>, though the user can also call <code>apollo_probabilities</code> manually with a given functionality for testing/debugging. Possible values are:
</p>

<ul>
<li> <p><strong><code>"components"</code></strong>: For further processing/debugging, produces likelihood for each model component (if multiple components are present), at the level of individual draws and observations.
</p>
</li>
<li> <p><strong><code>"conditionals"</code></strong>: For conditionals, produces likelihood of the full model, at the level of individual inter-individual draws.
</p>
</li>
<li> <p><strong><code>"estimate"</code></strong>: For model estimation, produces likelihood of the full model, at the level of individual decision-makers, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"gradient"</code></strong>: For model estimation, produces analytical gradients of the likelihood, where possible.
</p>
</li>
<li> <p><strong><code>"output"</code></strong>: Prepares output for post-estimation reporting.
</p>
</li>
<li> <p><strong><code>"prediction"</code></strong>: For model prediction, produces probabilities for individual alternatives and individual model components (if multiple components are present) at the level of an observation, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"preprocess"</code></strong>: Prepares likelihood functions for use in estimation.
</p>
</li>
<li> <p><strong><code>"raw"</code></strong>: For debugging, produces probabilities of all alternatives and individual model components at the level of an observation, at the level of individual draws.
</p>
</li>
<li> <p><strong><code>"report"</code></strong>: Prepares output summarising model and choiceset structure.
</p>
</li>
<li> <p><strong><code>"shares_LL"</code></strong>: Produces overall model likelihood with constants only.
</p>
</li>
<li> <p><strong><code>"validate"</code></strong>: Validates model specification, produces likelihood of the full model, at the level of individual decision-makers, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"zero_LL"</code></strong>: Produces overall model likelihood with all parameters at zero.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned object depends on the value of argument <code>functionality</code> as follows.
</p>

<ul>
<li> <p><strong><code>"components"</code></strong>: Same as <code>"estimate"</code>
</p>
</li>
<li> <p><strong><code>"conditionals"</code></strong>: Same as <code>"estimate"</code>
</p>
</li>
<li> <p><strong><code>"estimate"</code></strong>: vector/matrix/array. Returns the probabilities for the observed consumption for each observation.
</p>
</li>
<li> <p><strong><code>"gradient"</code></strong>: Not implemented
</p>
</li>
<li> <p><strong><code>"output"</code></strong>: Same as <code>"estimate"</code> but also writes summary of input data to internal Apollo log.
</p>
</li>
<li> <p><strong><code>"prediction"</code></strong>: A matrix with one row per observation, and columns indicating means and s.d. of continuous and discrete predicted consumptions.
</p>
</li>
<li> <p><strong><code>"preprocess"</code></strong>: Returns a list with pre-processed inputs, based on <code>mdcnev_settings</code>.
</p>
</li>
<li> <p><strong><code>"raw"</code></strong>: Same as <code>"estimate"</code>
</p>
</li>
<li> <p><strong><code>"report"</code></strong>: Dependent variable overview.
</p>
</li>
<li> <p><strong><code>"shares_LL"</code></strong>: Not implemented. Returns a vector of NA with as many elements as observations.
</p>
</li>
<li> <p><strong><code>"validate"</code></strong>: Same as <code>"estimate"</code>, but it also runs a set of tests to validate the function inputs.
</p>
</li>
<li> <p><strong><code>"zero_LL"</code></strong>: Not implemented. Returns a vector of NA with as many elements as observations.
</p>
</li>
</ul>
</div>