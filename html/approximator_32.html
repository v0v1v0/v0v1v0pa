<div class="container">

<table style="width: 100%;"><tr>
<td>object</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimization of posterior likelihood of hyperparameters</h2>

<h3>Description</h3>

<p>Returns the likelihood of a set of hyperparameters given the data.
Functions <code>opt1()</code> and <code>opt.gt.1()</code> find hyperparameters
that maximize the relevant likelihood for level 1 and higher levels
respectively.   Function <code>object()</code> returns the expression given
by equation 9 in KOH2000, which is minimized <code>opt1()</code> and
<code>opt.gt.1()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">object(level, D, z, basis, subsets, hpa)
opt.1(D, z, basis, subsets, hpa.start, give.answers=FALSE, ...)
opt.gt.1(level, D, z, basis, subsets, hpa.start, give.answers=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Design matrix for top-level code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>Basis function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsets</code></td>
<td>
<p>subsets object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpa</code></td>
<td>
<p>hyperparameter object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hpa.start</code></td>
<td>
<p>Starting value for hyperparameter object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>give.answers</code></td>
<td>
<p>Boolean, with default <code>FALSE</code> meaning to
return just the point estimate, and <code>TRUE</code> meaning to return
extra information from the call  to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra arguments passed to <code>optim()</code>.  A common one
would be <code>control=list(trace=100)</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is the object function used in toy optimizers
<code>optimal.hpa()</code>. 
</p>


<h3>Author(s)</h3>

<p>Robin K. S. Hankin</p>


<h3>References</h3>

<p>M. C. Kennedy and A. O'Hagan 2000. “Predicting the output from
a complex computer code when fast approximations are available”
Biometrika, 87(1): pp1-13
</p>


<h3>See Also</h3>

<p><code>genie</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(toyapps)
object(level=4, D=D1.toy , z=z.toy,basis=basis.toy,
   subsets=subsets.toy, hpa=hpa.fun.toy(1:19))
object(level=4, D=D1.toy , z=z.toy,basis=basis.toy,
   subsets=subsets.toy, hpa=hpa.fun.toy(3+(1:19)))


# Now a little example of finding optimal hyperpameters in the toy case
# (a bigger example is given on the genie help page)
jj &lt;- list(trace=100,maxit=10)

hpa.toy.level1 &lt;- opt.1(D=D1.toy, z=z.toy, basis=basis.toy,
          subsets=subsets.toy, hpa.start=hpa.toy,control=jj)

hpa.toy.level2 &lt;- opt.gt.1(level=2, D=D1.toy, z=z.toy,
           basis=basis.toy, subsets=subsets.toy,
           hpa.start=hpa.toy.level1, control=jj)

hpa.toy.level3 &lt;- opt.gt.1(level=3, D=D1.toy, z=z.toy,
           basis=basis.toy, subsets=subsets.toy,
           hpa.start=hpa.toy.level2, control=jj) 

hpa.toy.level4 &lt;- opt.gt.1(level=4, D=D1.toy, z=z.toy,
           basis=basis.toy, subsets=subsets.toy,
           hpa.start=hpa.toy.level3, control=jj)

</code></pre>


</div>