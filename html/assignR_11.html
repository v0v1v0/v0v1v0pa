<div class="container">

<table style="width: 100%;"><tr>
<td>pdRaster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probability of origin surfaces
</h2>

<h3>Description</h3>

<p>Calculate posterior probabilities of origin for a sample based on its isotope ratio.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdRaster(r, unknown, prior = NULL, mask = NULL, genplot = TRUE, outDir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>SpatRaster with two layers, <code>rescale</code> object (see <code>calRaster</code>), or <code>isoStack</code> object. For user-generated raster objects, the first layer must be the substrate-specific isoscape (mean prediction) and the second the isoscape prediction uncertainty (1 standard deviation).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unknown</code></td>
<td>

<p>data.frame, <code>refTrans</code> object, or list of two or more <code>refTrans</code> objects. For user-created data.frame, first column should contain unique sample IDs, and subsequent columns should contain sample isotope values for one or more isotopes to be used in assignment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>SpatRaster. Optional raster layer with prior probabilities, which has the same projection, resolution and extent as <code>r</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>

<p>SpatVector. This polygon mask will constrain the assignment area. If this is not provided, a default of mask of the extent of <code>r</code> is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>

<p>logical. Plot results in R.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outDir</code></td>
<td>

<p>character string. Directory path to which output will be saved. If NULL no files are written.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If more than one isotope marker is to be used for multivariate assignment, <code>r</code> must be an <code>isoStack</code> object and the number of isoscapes in that object must be equal to the number of isotope-value columns or <code>refTrans</code> objects included in <code>unknown</code>. Isoscapes and unknown sample values will be matched based on order, so it is critical that the values appear in the same order in these two input objects.
</p>


<h3>Value</h3>

<p>SpatRaster including a probability density surface for each individual in <code>unknown</code>. If <code>outDir</code> is not NULL, writes individual rasters in GeoTIFF format and a single PDF file with images for each probability density raster to the designated directory.
</p>


<h3>See Also</h3>

<p><code>calRaster</code>
<code>refTrans</code>
<code>isoStack</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load hydrogen isotope data for human hair in North America
d = subOrigData(group = "Modern human", mask = naMap, genplot = FALSE)

# rescale from environmental isoscape to tissue isoscape
r = calRaster(d, d2h_lrNA, naMap, genplot = FALSE)

# sample to assign
id = "smile"
d2H = -80
un = data.frame(id, d2H)

# posterior probability surface
pp = pdRaster(r, un, mask = naMap)
</code></pre>


</div>