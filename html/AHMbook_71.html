<div class="container">

<table style="width: 100%;"><tr>
<td>simHDS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate data under hierarchical distance sampling protocol (line or point)
</h2>

<h3>Description</h3>

<p>The function simulates hierarchical distance sampling (HDS) data under either a line or a point transect protocol. At each site, it works with a strip of width <code>B*2</code> (for line transects) or a circle of radius <code>B</code> inscribed in a square of side <code>B*2</code> (for point transects).
</p>
<p>The state process is simulated by first drawing a covariate value, "habitat", for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>mean.lambda</code> and <code>beta.lam</code> to calculate the expected number of animals, lambda, in each strip or square.
</p>
<p>For line transects, the distance from the line is drawn from a Uniform(0, B) distribution. For point transects, the animals are distributed randomly over the square before calculating the distance of each from the point. Observations of animals further than B from the point are discarded.
</p>
<p>A detection covariate, "wind", for each site is drawn from a Uniform(-2, 2) distribution. This is used in a log-linear regression with arguments <code>mean.sigma</code> and <code>beta.sig</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated as Bernoulli trials with probability of success decreasing with distance from the line or point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simHDS(type=c("line", "point"), nsites = 100, mean.lambda = 2, beta.lam = 1,
  mean.sigma = 1, beta.sig = -0.5, B = 3, discard0 = TRUE, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>type of transect, "line" or "point".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lambda</code></td>
<td>

<p>the expected value of lambda when the habitat covariate = 0; the intercept of the log-linear regression for lambda is log(mean.lambda).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.lam</code></td>
<td>

<p>the slope of the log-linear regression for lambda on a habitat covariate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.sigma</code></td>
<td>

<p>the expected value of the scale parameter of the half-normal detection function when the wind speed = 0; the intercept of the log-linear regression for sigma is log(mean.sigma).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.sig</code></td>
<td>

<p>the slope of log-linear regression of scale parameter of the half-normal detection function on wind speed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p>the strip half-width or circle radius
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discard0</code></td>
<td>

<p>If TRUE, subset to sites at which individuals were captured. You may or may not want to do this depending on how the model is formulated so be careful.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>simulated distance sampling data: a matrix with a row for each individual detected and 5 columns: site ID, status (1 if captured), x and y coordinates (NA for line transects), distance from the line or point; if <code>discard0 = FALSE</code>, sites with no detections will appear in the matrix with NAs in columns 2 to 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>habitat </code></td>
<td>
<p>simulated habitat covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wind </code></td>
<td>
<p>simulated detection covariate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>simulated number of individuals at each site</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.true </code></td>
<td>
<p>for point counts, the simulated number of individuals within the circle sampled</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.5.1.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate a data set with the default arguments and look at the structure of the output
set.seed(123)
tmp &lt;- simHDS()
str(tmp)
head(tmp$data)

tmp &lt;- simHDS("point", discard0=FALSE)
str(tmp)
head(tmp$data, 10)
</code></pre>


</div>