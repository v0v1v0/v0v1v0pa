<div class="container">

<table style="width: 100%;"><tr>
<td>apollo_ol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculates Ordered Logit probabilities</h2>

<h3>Description</h3>

<p>Calculates the probabilities of an Ordered Logit model and can also perform other operations based on the value of the <code>functionality</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">apollo_ol(ol_settings, functionality)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ol_settings</code></td>
<td>
<p>List of settings for the OL model. It should include the following.
</p>

<ul>
<li> <p><strong><code>coding</code></strong>: Numeric or character vector. Optional argument. Defines the order of the levels in <code>outcomeOrdered</code>. The first value is associated with the lowest level of <code>outcomeOrdered</code>, and the last one with the highest value. If not provided, is assumed to be <code>1:(length(tau) + 1)</code>.
</p>
</li>
<li> <p><strong><code>componentName</code></strong>: Character. Name given to model component. If not provided by the user, Apollo will set the name automatically according to the element in <code>P</code> to which the function output is directed.
</p>
</li>
<li> <p><strong><code>outcomeOrdered</code></strong>: Numeric vector. Dependent variable. The coding of this variable is assumed to be from 1 to the maximum number of different levels. For example, if the ordered response has three possible values: "never", "sometimes" and "always", then it is assumed that outcomeOrdered contains "1" for "never", "2" for "sometimes", and 3 for "always". If another coding is used, then it should be specified using the <code>coding</code> argument.
</p>
</li>
<li> <p><strong><code>rows</code></strong>: Boolean vector. TRUE if a row must be considered in the calculations, FALSE if it must be excluded. It must have length equal to the length of argument <code>outcomeOrdered</code>. Default value is <code>"all"</code>, meaning all rows are considered in the calculation.
</p>
</li>
<li> <p><strong><code>tau</code></strong>: List of numeric vectors/matrices/3-dim arrays. Thresholds. As many as number of different levels in the dependent variable - 1. Extreme thresholds are fixed at -inf and +inf. Mixing is allowed in thresholds. Can also be a matrix with as many rows as observations and as many columns as thresholds.
</p>
</li>
<li> <p><strong><code>utilities</code></strong>: Numeric vector/matrix/3-sim array. A single explanatory variable (usually a latent variable). Must have the same number of rows as outcomeOrdered.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>functionality</code></td>
<td>
<p>Character. Setting instructing Apollo what processing to apply to the likelihood function. This is in general controlled by the functions that call <code>apollo_probabilities</code>, though the user can also call <code>apollo_probabilities</code> manually with a given functionality for testing/debugging. Possible values are:
</p>

<ul>
<li> <p><strong><code>"components"</code></strong>: For further processing/debugging, produces likelihood for each model component (if multiple components are present), at the level of individual draws and observations.
</p>
</li>
<li> <p><strong><code>"conditionals"</code></strong>: For conditionals, produces likelihood of the full model, at the level of individual inter-individual draws.
</p>
</li>
<li> <p><strong><code>"estimate"</code></strong>: For model estimation, produces likelihood of the full model, at the level of individual decision-makers, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"gradient"</code></strong>: For model estimation, produces analytical gradients of the likelihood, where possible.
</p>
</li>
<li> <p><strong><code>"output"</code></strong>: Prepares output for post-estimation reporting.
</p>
</li>
<li> <p><strong><code>"prediction"</code></strong>: For model prediction, produces probabilities for individual alternatives and individual model components (if multiple components are present) at the level of an observation, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"preprocess"</code></strong>: Prepares likelihood functions for use in estimation.
</p>
</li>
<li> <p><strong><code>"raw"</code></strong>: For debugging, produces probabilities of all alternatives and individual model components at the level of an observation, at the level of individual draws.
</p>
</li>
<li> <p><strong><code>"report"</code></strong>: Prepares output summarising model and choiceset structure.
</p>
</li>
<li> <p><strong><code>"shares_LL"</code></strong>: Produces overall model likelihood with constants only.
</p>
</li>
<li> <p><strong><code>"validate"</code></strong>: Validates model specification, produces likelihood of the full model, at the level of individual decision-makers, after averaging across draws.
</p>
</li>
<li> <p><strong><code>"zero_LL"</code></strong>: Produces overall model likelihood with all parameters at zero.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates an Ordered Logit model of the type:
y* = V + epsilon
outcomeOrdered =  1 if   -Inf &lt; y* &lt; tau[1]
2 if tau[1] &lt; y* &lt; tau[2]
...
maxLvl if tau[length(tau)] &lt; y* &lt; +Inf
Where epsilon is distributed standard logistic, and the values 1, 2, ..., maxLvl can be
replaces by coding[1], coding[2], ..., coding[maxLvl].
The behaviour of the function changes depending on the value of the <code>functionality</code> argument.
</p>


<h3>Value</h3>

<p>The returned object depends on the value of argument <code>functionality</code> as follows.
</p>

<ul>
<li> <p><strong><code>"components"</code></strong>: Same as <code>"estimate"</code>
</p>
</li>
<li> <p><strong><code>"conditionals"</code></strong>: Same as <code>"estimate"</code>
</p>
</li>
<li> <p><strong><code>"estimate"</code></strong>: vector/matrix/array. Returns the probabilities for the chosen alternative for each observation.
</p>
</li>
<li> <p><strong><code>"gradient"</code></strong>: List containing the likelihood and gradient of the model component.
</p>
</li>
<li> <p><strong><code>"output"</code></strong>: Same as <code>"estimate"</code> but also writes summary of input data to internal Apollo log.
</p>
</li>
<li> <p><strong><code>"prediction"</code></strong>: List of vectors/matrices/arrays. Returns a list with the probabilities for all possible levels, with an extra element for the probability of the chosen alternative.
</p>
</li>
<li> <p><strong><code>"preprocess"</code></strong>: Returns a list with pre-processed inputs, based on <code>ol_settings</code>.
</p>
</li>
<li> <p><strong><code>"raw"</code></strong>: Same as <code>"prediction"</code>
</p>
</li>
<li> <p><strong><code>"report"</code></strong>: Dependent variable overview.
</p>
</li>
<li> <p><strong><code>"shares_LL"</code></strong>: vector/matrix/array. Returns the probability of the chosen alternative when only constants are estimated.
</p>
</li>
<li> <p><strong><code>"validate"</code></strong>: Same as <code>"estimate"</code>, but it also runs a set of tests to validate the function inputs.
</p>
</li>
<li> <p><strong><code>"zero_LL"</code></strong>: Not implemented. Returns a vector of NA with as many elements as observations.
</p>
</li>
</ul>
</div>