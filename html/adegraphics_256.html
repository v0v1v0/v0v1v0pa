<div class="container">

<table style="width: 100%;"><tr>
<td>s.image</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>2-D scatter plot with loess estimation of an additional numeric score (levelplot)</h2>

<h3>Description</h3>

<p>This function represents a two dimensional scatter plot with a continuous convex colored surface
and/or contour lines representing a third variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">s.image(dfxy, z, xax = 1, yax = 2, span = 0.5, gridsize = c(80L, 80L), 
  contour = TRUE, region = TRUE, outsideLimits = NULL, breaks = NULL,
  nclass = 8, col = NULL, facets = NULL, 
  plot = TRUE, storeData = TRUE, add = FALSE, pos = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dfxy</code></td>
<td>
<p>a data frame used to produce the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a vector (or a matrix) of values on the <code>dfxy</code> rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xax</code></td>
<td>
<p>an integer (or a vector) indicating which column(s) of <code>dfxy</code> is(are) plotted on the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yax</code></td>
<td>
<p>an integer (or a vector) indicating which column(s) of <code>dfxy</code> is(are) plotted on the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>a value to control the degree of smoothing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridsize</code></td>
<td>
<p>a 1 or 2-length vector indicating the cell numbers (horizontally and vertically) of the grid for the colored surface</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contour</code></td>
<td>
<p>a logical to draw contour lines</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>region</code></td>
<td>
<p>a logical to fill inter-contour regions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>a vector of values to split <code>z</code>. If <code>NULL</code>, <code>pretty(z, nclass)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclass</code></td>
<td>
<p>an integer for the number of desired intervals, ignored
if <code>breaks</code> is not missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outsideLimits</code></td>
<td>
<p>specific limits for the surface as a set of polygons. It must be an <code>SpatialPolygons</code> object. Hole are authorized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a color or a colors vector used for the colored cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facets</code></td>
<td>
<p>a factor splitting the rows of <code>dfxy</code> so that subsets
of the data are represented on different sub-graphics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical indicating if the graphics is displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>storeData</code></td>
<td>
<p>a logical indicating if the data should be stored in
the returned object. If <code>FALSE</code>, only the names of the data
arguments are stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical. If <code>TRUE</code>, the graphic is superposed to the graphics
already plotted in the current device</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>an integer indicating the position of the
environment where the data are stored, relative to the environment
where the function is called. Useful only if <code>storeData</code> is
<code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional graphical parameters (see
<code>adegpar</code> and <code>trellis.par.get</code>)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>ADEg</code> (subclass <code>S2.image</code>) or <code>ADEgS</code> (if <code>add</code> is <code>TRUE</code> and/or 
if facets or multidimensional <code>z</code> or vectors for <code>xax</code>/<code>yax</code> are used).<br>
The result is displayed if <code>plot</code> is <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Alice Julien-Laferriere, Aurelie Siberchicot <a href="mailto:aurelie.siberchicot@univ-lyon1.fr">aurelie.siberchicot@univ-lyon1.fr</a> and Stephane Dray
</p>


<h3>See Also</h3>

<p><code>S2.image</code>
<code>ADEg.S2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">df1 &lt;- data.frame(expand.grid(-3:3, -3:3))
names(df1) &lt;- c("x", "y")
z1 &lt;- (1 / sqrt(2)) * exp(-(df1$x ^ 2 + df1$y ^ 2) / 2)
g1 &lt;- s.image(df1, z1)

# add a continuous color bar as legend
# update(g1, plegend.drawColorKey = TRUE)

g2 &lt;- s.image(df1, z1, gridsize = 50)

g3 &lt;- s.image(df1, z1, gridsize = 100)
## g4 &lt;- s.image(df1, z1, gridsize = 1000, plot = FALSE)

## Not run: 
  if(require(splancs, quietly = TRUE) &amp; require(sp, quietly = TRUE)) {
    Sr1 &lt;- Polygon(cbind(c(0, 1, 2, 1, 2, 0, -2, -1, -2, -1, 0), 
      c(2.5, 1.5, 2, 0, -2, -1, -2, 0, 2, 1.5, 2.5)))
    Sr2 &lt;- Polygon(cbind(c(-0.5, 0.5, 0.5, -0.5, -0.5), c(0, 0, 1 ,1, 0)), hole = TRUE)
    Srs2 &lt;- Polygons(list(Sr1, Sr2), ID = "star and hole")
    SPp &lt;- SpatialPolygons(list(Srs2))
    df2 &lt;- cbind(c(rnorm(2000, 1, 0.25), rnorm(3000, -1, 1.5)), c(rnorm(2000, 1, 0.5), 
      rnorm(3000, -1, 3)))
    z2 &lt;- c(rnorm(2000, 12, 1), rnorm(3000, 1, 2))
    g5 &lt;- s.image(df2, z2, outsideLimits = SPp, grid = 200, xlim = c(-2.5, 2.5), 
      ylim = c(-2, 3), ppalette.quanti = colorRampPalette(c(grey(0.1), grey(0.9))))
  
    data(t3012, package = "ade4")  
    g6 &lt;- s.image(t3012$xy, ade4::scalewt(t3012$temp), porigin.include = FALSE)
    g7 &lt;- s.image(t3012$xy, ade4::scalewt(t3012$temp), outsideLimits = t3012$Spatial, 
      Sp = t3012$Spatial)
  }

## End(Not run)
</code></pre>


</div>