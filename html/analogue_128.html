<div class="container">

<table style="width: 100%;"><tr>
<td>plot.mat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot diagnostics for a mat object</h2>

<h3>Description</h3>

<p>Five plots (selectable by <code>which</code>) are currently available: a
plot of estimated against observed values, a plot of residuals against
estimated values, and screeplots of the apparent RMSE, average bias
and maximum bias for MAT models of size <code class="reqn">k</code>, where <code class="reqn">k = 1,
    \dots, n</code>. By default, the first three and ‘5’ are provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mat'
plot(x,
     which = c(1:3, 5),
     weighted = FALSE,
     k,
     caption = c("Inferred vs Observed", "Residuals vs Fitted",
                 "Leave-one-out errors", "Average bias",
                 "Maximum bias"),
     max.bias = TRUE,
     n.bias = 10,
     restrict = 20,
     sub.caption = NULL,
     main = "",
     ask = prod(par("mfcol")) &lt; length(which) &amp;&amp;
                                  dev.interactive(),
     ...,
     panel = if (add.smooth) panel.smooth else points,
     add.smooth = getOption("add.smooth"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"mat"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>which aspects of the <code>"mat"</code> object to plot if a
subset of the plots is required, specify a subset of the numbers
<code>1:5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>logical; should the analysis use weighted mean of env
data of analogues as fitted/estimated values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric; the number of analogues to use. If missing <code>k</code>
is chosen automatically as the <code>k</code> that achieves lowest RMSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.bias</code></td>
<td>
<p>logical, should max bias lines be added to residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bias</code></td>
<td>
<p>numeric, number of sections to calculate maximum bias
for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restrict</code></td>
<td>
<p>logical; restrict comparison of k-closest model to
<code class="reqn">k \le</code> <code>restrict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub.caption</code></td>
<td>
<p>common title-above figures if there are multiple;
used as ‘sub’ (s.‘title’) otherwise.  If <code>NULL</code>,
as by default, a possibly shortened version of
<code>deparse(x$call)</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title to each plot-in addition to the above
<code>caption</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ask</code></td>
<td>
<p>logical; if <code>TRUE</code>, the user is <em>ask</em>ed before
each plot, see <code>par(ask=.)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical arguments passed to other graphics functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel</code></td>
<td>
<p>panel function.  The useful alternative to
<code>points</code>, <code>panel.smooth</code>, can be chosen by
<code>add.smooth = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.smooth</code></td>
<td>
<p>logical indicating if a smoother should be added to
fitted &amp; residuals plots; see also <code>panel</code> above.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This plotting function is modelled closely on <code>plot.lm</code>
and many of the conventions and defaults for that function are
replicated here.
</p>
<p><code>sub.caption</code> - by default the function call - is shown as a
subtitle (under the x-axis title) on each plot when plots are on
separate pages, or as a subtitle in the outer margin (if any) when
there are multiple plots per page.
</p>


<h3>Value</h3>

<p>One or more plots, drawn on the current device.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson. Code borrows heavily from <code>plot.lm</code>.</p>


<h3>See Also</h3>

<p><code>mat</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Imbrie and Kipp example
## load the example data
data(ImbrieKipp)
data(SumSST)
data(V12.122)

## merge training and test set on columns
dat &lt;- join(ImbrieKipp, V12.122, verbose = TRUE)

## extract the merged data sets and convert to proportions
ImbrieKipp &lt;- dat[[1]] / 100
V12.122 &lt;- dat[[2]] / 100

## MAT
ik.mat &lt;- mat(ImbrieKipp, SumSST, method = "chord")

## summary plot of MAT model
layout(matrix(1:4, ncol = 2, byrow = TRUE))
plot(ik.mat)
layout(1)

</code></pre>


</div>