<div class="container">

<table style="width: 100%;"><tr>
<td>afc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Generalized Discrimination Score 2AFC</h2>

<h3>Description</h3>

<p>This is the master routine for the calculation the Generalized
Discrimination Score (aka Two-Alternatives Forced Choice Score - 2AFC) as
described in the Paper of Mason and Weigel (2009). This routine requires, as
input, datasets of forecasts and corresponding observations, as well as a
specification of the verification context. The routine checks whether the
input data are consistent with the verification context, then calls the
appropriate function to calculate the 2AFC, and finally returns the 2AFC
skill value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">afc(obsv, fcst, obsv.type, fcst.type, m = 0, m2 = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obsv</code></td>
<td>
<p>Vector of observations. The required format depends on the
specific verification context. More details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcst</code></td>
<td>
<p>Vector or two-dimensional array of forecasts. The required
format depends on the specific verification context. More details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obsv.type</code></td>
<td>
<p>Character specifying the type of the observations. Possible
values: "d" (dichotomous), "m" (polychotomous with ordinal categories), "n"
(polychotomous with nominal categories), "c" (continuous).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fcst.type</code></td>
<td>
<p>Character specifying the type of the forecasts. Possible
values: "d" (dichotomous), "m" (polychotomous with ordinal categories), "n"
(polychotomous with nominal categories), "p" (probabilistic), "c"
(continuous) and "e" (ensemble).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Number of observation or forecast categories (only required if
obsv.type or fcst.type equals "m" or "n")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>Number of forecast categories (only required if both obsv.type and
fcst.type equal "m"). The number of observation categories is then specified
by the argument <em>m</em> above.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the specific verification context (i.e. the choice for
<em>obsv.type</em> and <em>fcst.type</em>), this routine calls the appropriate
function(s) to calculate the 2AFC score. The following combinations of
<em>obsv.type</em> and <em>fcst.type</em> are possible: (1) "d-d"; (2) "d-m";
(3) "d-p"; (4) "d-c"; (5) "d-e"; (6) "m-m"; (7) "m-p"; (8) "m-c"; (9) "m-e";
(10) "n-n"; (11) "n-p"; (12) "c-c"; (13) "c-e". The required format of the
input data <em>obsv</em> and <em>fcst</em> depends on the verification
context:<br></p>
<p>(1) "d-d": <br><em>obsv</em>: vector with dichotomous observations (values in
0,1)<br><em>fcst</em>: vector of same length as <em>obsv</em> with dichotomous
forecasts (values in 0,1) <br></p>
<p>(2) "d-m": <br><em>obsv</em>: vector with dichotomous observations (values in
0,1)<br><em>fcst</em>: vector of same length as <em>obsv</em> with
polychotomous forecasts (values in 1,..,m) <br></p>
<p>(3) "d-p": <br><em>obsv</em>: vector with dichotomous observations (values in
0,1)<br><em>fcst</em>: vector of same length as <em>obsv</em> with forecast
probabilities for the event to happen <br></p>
<p>(4) "d-c": <br><em>obsv</em>: vector with dichotomous observations (values in
0,1)<br><em>fcst</em>: vector of same length as <em>obsv</em> with real-valued
forecasts <br></p>
<p>(5) "d-e": <br><em>obsv</em>: vector with dichotomous observations (values in
0,1)<br><em>fcst</em>: two-dimensional array with ensemble forecasts;
dim(fcst)[1] = length(obsv); dim(fcst)[2] = ensemble size.<br></p>
<p>(6) "m-m": <br><em>obsv</em>: vector with polychotomous observations (values
in 1,..,m)<br><em>fcst</em>: vector of same length as <em>obsv</em> with
polychotomous forecasts (values in 1,..,m2) <br></p>
<p>(7) "m-p": <br><em>obsv</em>: vector with polychotomous observations (values
in 1,..,m)<br><em>fcst</em>: two-dimensional array with forecast
probabilities for the m categories; dim(fcst)[1] = length(obsv);
dim(fcst)[2] = m <br></p>
<p>(8) "m-c": <br><em>obsv</em>: vector with polychotomous observations (values
in 1,..,m)<br><em>fcst</em>: vector of same length as <em>obsv</em> with
real-valued forecasts <br></p>
<p>(9) "m-e": <br><em>obsv</em>: vector with polychotomous observations (values
in 1,..,m)<br><em>fcst</em>: two-dimensional array with ensemble forecasts;
dim(fcst)[1] = length(obsv); dim(fcst)[2] = ensemble size.<br></p>
<p>(10) "n-n": <br><em>obsv</em>: vector with polychotomous observations (values
in 1,..,m)<br><em>fcst</em>: vector of same length as <em>obsv</em> with
polychotomous forecasts (values in 1,..,m) <br></p>
<p>(11) "n-p": <br> Same as "m-p".<br></p>
<p>(12) "c-c": <br><em>obsv</em>: vector with real-valued observations <br><em>fcst</em>: vector of same length as <em>obsv</em> with real-valued forecasts
<br></p>
<p>(13) "c-e": <br><em>obsv</em>: vector with real-valued observations <br><em>fcst</em>: two-dimensional array with ensemble forecasts; dim(fcst)[1] =
length(obsv); dim(fcst)[2] = ensemble size.<br></p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code> p.afc </code></td>
<td>
<p> Value of Generalized Discrimination Score (2AFC) </p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Andreas Weigel, Federal Office of Meteorology and Climatology,
MeteoSwiss, Zurich, Switzerland
</p>


<h3>References</h3>

<p>S.J. Mason and A.P. Weigel, 2009. A generic verification
framework for administrative purposes. Mon. Wea. Rev., 137, 331-349
</p>


<h3>See Also</h3>

<p><code>afc.dd</code> <code>afc.dm</code> <code>afc.dp</code>
<code>afc.dc</code> <code>afc.de</code> <code>afc.mm</code>
<code>afc.mp</code> <code>afc.mc</code> <code>afc.me</code>
<code>afc.nn</code> <code>afc.np</code> <code>afc.cc</code>
<code>afc.ce</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  #
  #In all following examples, forecasts of the Nino-3.4 index are evaluated
  #
  #----------------------
  #Example 1: Dichotomous observations, dichotomous forecasts
  # ---------------------
  #Load set of dichotomous observations and dichotomous forecasts
  data(cnrm.nino34.dd)
  obsv = cnrm.nino34.dd$obsv
  fcst = cnrm.nino34.dd$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="d", fcst.type="d")

  # ---------------------
  #Example 2: Dichotomous observations, (ordinal) polychotomous forecasts
  # ---------------------
  #Load set of dichotomous observations and polychotomous forecasts (4 categories)
  data(cnrm.nino34.dm)
  obsv = cnrm.nino34.dm$obsv
  fcst = cnrm.nino34.dm$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="d", fcst.type="m", m=4)

  # ---------------------
  #Example 3: Dichotomous observations, probabilistic forecasts
  # ---------------------
  #Load set of dichotomous observations and probabilistic forecasts
  data(cnrm.nino34.dp)
  obsv = cnrm.nino34.dp$obsv
  fcst = cnrm.nino34.dp$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="d", fcst.type="p")

  # ---------------------
  #Example 4: Dichotomous observations, continuous forecasts
  # ---------------------
  #Load set of dichotomous observations and continuous forecasts
  data(cnrm.nino34.dc)
  obsv = cnrm.nino34.dc$obsv
  fcst = cnrm.nino34.dc$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="d", fcst.type="c")

  # ---------------------
  #Example 5: Dichotomous observations, ensemble forecasts
  # ---------------------
  #Load set of dichotomous observations and 9-member ensemble forecasts
  data(cnrm.nino34.de)
  obsv = cnrm.nino34.de$obsv
  fcst = cnrm.nino34.de$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="d", fcst.type="e")

  # ---------------------
  #Example 6: Polychotomous (ordinal) observations, polychotomous (ordinal) forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and polychotomous forecasts (4 categories)
  data(cnrm.nino34.mm)
  obsv = cnrm.nino34.mm$obsv
  fcst = cnrm.nino34.mm$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="m", fcst.type="m", m=4, m2=4)

  # ---------------------
  #Example 7: Polychotomous (ordinal) observations, probabilistic forecasts forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and probabilistic forecasts
  data(cnrm.nino34.mp)
  obsv = cnrm.nino34.mp$obsv
  fcst = cnrm.nino34.mp$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="m", fcst.type="p", m=4)

  # ---------------------
  #Example 8: Polychotomous (ordinal) observations, continuous forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and continuous forecasts
  data(cnrm.nino34.mc)
  obsv = cnrm.nino34.mc$obsv
  fcst = cnrm.nino34.mc$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="m", fcst.type="c", m=4)

  # ---------------------
  #Example 9: Polychotomous (ordinal) observations, ensemble forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and 9-member ensemble forecasts
  data(cnrm.nino34.me)
  obsv = cnrm.nino34.me$obsv
  fcst = cnrm.nino34.me$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="m", fcst.type="e", m=4)

  # ---------------------
  #Example 10: Polychotomous (nominal) observations, polychotomous (nominal) forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and polychotomous forecasts (4 categories)
  data(cnrm.nino34.mm)
  obsv = cnrm.nino34.mm$obsv
  fcst = cnrm.nino34.mm$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="n", fcst.type="n", m=4)

  # ---------------------
  #Example 11: Polychotomous (nominal) observations, probabilistic forecasts
  # ---------------------
  #Load set of polychotomous observations (4 categories) and probabilistic forecasts
  data(cnrm.nino34.mp)
  obsv = cnrm.nino34.mp$obsv
  fcst = cnrm.nino34.mp$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="n", fcst.type="p", m=4)

  # ---------------------
  #Example 12: Continuous observations, continuous forecasts
  # ---------------------
  #Load set of continuous observations and continuous forecasts
  data(cnrm.nino34.cc)
  obsv = cnrm.nino34.cc$obsv
  fcst = cnrm.nino34.cc$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="c", fcst.type="c")

  # ---------------------
  #Example 13: Continuous observations, ensemble forecasts
  # ---------------------
  #Load set of continuous observations and 9-member ensemble forecasts
  data(cnrm.nino34.ce)
  obsv = cnrm.nino34.ce$obsv
  fcst = cnrm.nino34.ce$fcst
  #Calculate skill score
  afc(obsv, fcst, obsv.type="c", fcst.type="e")

</code></pre>


</div>