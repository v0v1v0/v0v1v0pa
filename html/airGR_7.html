<div class="container">

<table style="width: 100%;"><tr>
<td>CreateCalibOptions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creation of the CalibOptions object required but the Calibration* functions</h2>

<h3>Description</h3>

<p>Creation of the <em>CalibOptions</em> object required by the <code>Calibration*</code> functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CreateCalibOptions(FUN_MOD, FUN_CALIB = Calibration_Michel,
                   FUN_TRANSFO = NULL, IsHyst = FALSE, IsSD = FALSE,
                   FixedParam = NULL,
                   SearchRanges = NULL, StartParamList = NULL,
                   StartParamDistrib = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FUN_MOD</code></td>
<td>
<p>[function] hydrological model function (e.g. <code>RunModel_GR4J</code>, <code>RunModel_CemaNeigeGR4J</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN_CALIB</code></td>
<td>
<p>(optional) [function] calibration algorithm function (e.g. Calibration_Michel), default = <code>Calibration_Michel</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN_TRANSFO</code></td>
<td>
<p>(optional) [function] model parameters transformation function, if the <code>FUN_MOD</code> used is native in the package, <code>FUN_TRANSFO</code> is automatically defined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IsHyst</code></td>
<td>
<p>[boolean] boolean indicating if the hysteresis version of CemaNeige is used. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IsSD</code></td>
<td>
<p>[boolean] boolean indicating if the semi-distributed lag model is used. See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FixedParam</code></td>
<td>
<p>(optional) [numeric] vector giving the values set for the non-optimised parameter values (NParam columns, 1 line)
<br> Example:
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;">   NA   </td>
<td style="text-align: left;">   NA   </td>
<td style="text-align: left;"> 3.34   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">   NA </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SearchRanges</code></td>
<td>
<p>(optional) [numeric] matrix giving the ranges of real parameters (NParam columns, 2 lines)
<br> Example:
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;"> [X1]   </td>
<td style="text-align: left;"> [X2]   </td>
<td style="text-align: left;"> [X3]   </td>
<td style="text-align: left;"> [...]   </td>
<td style="text-align: left;"> [Xi] </td>
</tr>
<tr>
<td style="text-align: left;">
     [1,]     </td>
<td style="text-align: left;">    0   </td>
<td style="text-align: left;">   -1   </td>
<td style="text-align: left;">    0   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  0.0 </td>
</tr>
<tr>
<td style="text-align: left;">
     [2,]     </td>
<td style="text-align: left;"> 3000   </td>
<td style="text-align: left;">   +1   </td>
<td style="text-align: left;">  100   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  3.0 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StartParamList</code></td>
<td>
<p>(optional) [numeric] matrix of parameter sets used for grid-screening calibration procedure (values in columns, sets in line)
<br> Example:
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;"> [X1]   </td>
<td style="text-align: left;"> [X2]   </td>
<td style="text-align: left;"> [X3]   </td>
<td style="text-align: left;"> [...]   </td>
<td style="text-align: left;"> [Xi] </td>
</tr>
<tr>
<td style="text-align: left;">
     [set1]   </td>
<td style="text-align: left;">  800   </td>
<td style="text-align: left;"> -0.7   </td>
<td style="text-align: left;">   25   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.0 </td>
</tr>
<tr>
<td style="text-align: left;">
     [set2]   </td>
<td style="text-align: left;"> 1000   </td>
<td style="text-align: left;"> -0.5   </td>
<td style="text-align: left;">   22   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.1 </td>
</tr>
<tr>
<td style="text-align: left;">
     [...]    </td>
<td style="text-align: left;">  ...   </td>
<td style="text-align: left;">  ...   </td>
<td style="text-align: left;">  ...   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  ... </td>
</tr>
<tr>
<td style="text-align: left;">
     [set n]  </td>
<td style="text-align: left;">  200   </td>
<td style="text-align: left;"> -0.3   </td>
<td style="text-align: left;">   17   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.0 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>StartParamDistrib</code></td>
<td>
<p>(optional) [numeric] matrix of parameter values used for grid-screening calibration procedure (values in columns, percentiles in line)
<br> Example:
</p>

<table>
<tr>
<td style="text-align: left;">
              </td>
<td style="text-align: left;"> [X1]   </td>
<td style="text-align: left;"> [X2]   </td>
<td style="text-align: left;"> [X3]   </td>
<td style="text-align: left;"> [...]   </td>
<td style="text-align: left;"> [Xi] </td>
</tr>
<tr>
<td style="text-align: left;">
     [value1] </td>
<td style="text-align: left;">  800   </td>
<td style="text-align: left;"> -0.7   </td>
<td style="text-align: left;">   25   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.0 </td>
</tr>
<tr>
<td style="text-align: left;">
     [value2] </td>
<td style="text-align: left;"> 1000   </td>
<td style="text-align: left;">   NA   </td>
<td style="text-align: left;">   50   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.2 </td>
</tr>
<tr>
<td style="text-align: left;">
     [value3] </td>
<td style="text-align: left;"> 1200   </td>
<td style="text-align: left;">   NA   </td>
<td style="text-align: left;">   NA   </td>
<td style="text-align: left;">  ...    </td>
<td style="text-align: left;">  1.6 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Users wanting to use <code>FUN_MOD</code>, <code>FUN_CALIB</code> or <code>FUN_TRANSFO</code> functions that are not included in
the package must create their own <code>CalibOptions</code> object accordingly. <br></p>
<p>## — CemaNeige version
</p>
<p>If <code>IsHyst = FALSE</code>, the original CemaNeige version from Valéry et al. (2014) is used. <br>
If <code>IsHyst = TRUE</code>, the CemaNeige version from Riboust et al. (2019) is used. Compared to the original version, this version of CemaNeige needs two more parameters and it includes a representation of the hysteretic relationship between the Snow Cover Area (SCA) and the Snow Water Equivalent (SWE) in the catchment. The hysteresis included in airGR is the Modified Linear hysteresis (LH*); it is represented on panel b) of Fig. 3 in Riboust et al. (2019). Riboust et al. (2019) advise to use the LH* version of CemaNeige with parameters calibrated using an objective function combining 75 % of KGE calculated on discharge simulated from a rainfall-runoff model compared to observed discharge and 5 % of KGE calculated on SCA on 5 CemaNeige elevation bands compared to satellite (e.g. MODIS) SCA (see Eq. (18), Table 3 and Fig. 6). Riboust et al. (2019)'s tests were realized with GR4J as the chosen rainfall-runoff model. <br></p>
<p>If <code>InputsModel</code> parameter has been created for using a semi-distributed (SD) model (See <code>CreateInputsModel</code>), the parameter <code>isSD</code> should be set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>[list] object of class <em>CalibOptions</em> containing the data required to evaluate the model outputs; it can include the following:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>$FixedParam       </em> </td>
<td style="text-align: left;"> [numeric] vector giving the values to allocate to non-optimised parameter values   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$SearchRanges     </em> </td>
<td style="text-align: left;"> [numeric] matrix giving the ranges of raw parameters                               </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StartParamList   </em> </td>
<td style="text-align: left;"> [numeric] matrix of parameter sets used for grid-screening calibration procedure   </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>$StartParamDistrib</em> </td>
<td style="text-align: left;"> [numeric] matrix of parameter values used for grid-screening calibration procedure </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Laurent Coron, Olivier Delaigue, Guillaume Thirel, David Dorchies
</p>


<h3>See Also</h3>

<p><code>Calibration</code>, <code>RunModel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## loading catchment data
data(L0123001)

## preparation of InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_GR4J, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E)

## calibration period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))

## preparation of RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_GR4J,
                               InputsModel = InputsModel, IndPeriod_Run = Ind_Run)

## calibration criterion: preparation of the InputsCrit object
InputsCrit &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                               RunOptions = RunOptions, Obs = BasinObs$Qmm[Ind_Run])

## preparation of CalibOptions object
CalibOptions &lt;- CreateCalibOptions(FUN_MOD = RunModel_GR4J, FUN_CALIB = Calibration_Michel)

## calibration
OutputsCalib &lt;- Calibration(InputsModel = InputsModel, RunOptions = RunOptions,
                            InputsCrit = InputsCrit, CalibOptions = CalibOptions,
                            FUN_MOD = RunModel_GR4J,
                            FUN_CALIB = Calibration_Michel)

## simulation
Param &lt;- OutputsCalib$ParamFinalR
OutputsModel &lt;- RunModel(InputsModel = InputsModel, RunOptions = RunOptions,
                         Param = Param, FUN = RunModel_GR4J)

## results preview
plot(OutputsModel, Qobs = BasinObs$Qmm[Ind_Run])

## efficiency criterion: Nash-Sutcliffe Efficiency
InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_NSE, InputsModel = InputsModel,
                                RunOptions = RunOptions, Obs = BasinObs$Qmm[Ind_Run])
OutputsCrit &lt;- ErrorCrit_NSE(InputsCrit = InputsCrit, OutputsModel = OutputsModel)

## efficiency criterion: Kling-Gupta Efficiency
InputsCrit  &lt;- CreateInputsCrit(FUN_CRIT = ErrorCrit_KGE, InputsModel = InputsModel,
                                RunOptions = RunOptions, Obs = BasinObs$Qmm[Ind_Run])
OutputsCrit &lt;- ErrorCrit_KGE(InputsCrit = InputsCrit, OutputsModel = OutputsModel)
</code></pre>


</div>