<div class="container">

<table style="width: 100%;"><tr>
<td>intraAMLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic Maximum Likelihood Estimator
</h2>

<h3>Description</h3>

<p>This estimator is based on the assumption of infinitely large portfolio size and a sufficient length of the default time series. In the asymptotic case, neither the default rate of 0 or a 1 occur. Hence one has to make an adjustment in these cases.
</p>


<h3>Usage</h3>

<pre><code class="language-R">intraAMLE(d, n, B = 0, DB=c(0,0),JC = FALSE, Adjust = 0,
CI_1,CI_2, CI_Boot,VaR=0.99, VaR_CI=0.95, ES=0.975, ES_CI=0.95,
type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a vector, containing the default time series of the sector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a vector, containing the number of obligors at the beginning of the period in the sector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adjust</code></td>
<td>
<p>a number, which should be added to a observed default rate of 0 or subtracted form a observed default rate of 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_1</code></td>
<td>
<p>a number, indicating the desired analytical confidence interval of the estimate. The interval is computed by asymptotic Cramer-Rao lower bound for the standard deviation of the estimate based on Duellmann and Gehde-Trapp (2004). Additionally the asymptotic confidence interval for the unconditional PD is computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_2</code></td>
<td>
<p>a number, indicating the desired analytical confidence interval of the estimate. The interval is computed by constructing a confidence interval for the variance, which can be transferred to the estimate based on Hoese and Huschens (2011).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>a number, indicating the desired confidence interval if the single bootstrap correction is specified.
By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR</code></td>
<td>
<p>a number, indicating the desired confidence level for the asymptotic Value-at-Risk.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR_CI</code></td>
<td>
<p> a number, indicating the desired confidence interval for the asymptotic Value-at-Risk, derived by the delta method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ES</code></td>
<td>
<p>a number, indicating the desired confidence level for the asymptotic Expected Shortfall.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ES_CI</code></td>
<td>
<p> a number, indicating the desired confidence interval for the asymptotic Expected Shortfall, derived by the delta method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code>boot.ci</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This estimator is based on the asymptotic assumptions of the Vasicek model, especially the assumption of an infinite large portfolio. If a 0 or 1 occurs at least once in the default rate time series, the estimator can not converge. Therefore, an adjustment (<code>Adjust</code>) can be made. Nevertheless, Meyer (2009) argued that the adjustment can harm the estimation efficiency.
</p>
<p>Additionally two different asymptotic confidence intervals are provided. Bootstrap and jackknife corrections are also possible. If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PD</code></td>
<td>
<p>Estimate of the unconditional PD based on Duellmann and Gehde-Trapp (2004)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PD_CI_1</code></td>
<td>

<p>[Two-sided asymptotic confidence interval for the unconditional PD based on Duellmann and Gehde-Trapp (2004)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_1</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval based on Duellmann and Gehde-Trapp (2004)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_2</code></td>
<td>
<p>Selected two-sided asymptotic confidence interval based on Hoese and Huschens (2011)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR</code></td>
<td>
<p>Asymptotic Value-at-Risk</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VaR_CI</code></td>
<td>
<p>Confidence interval for the asymptotic Value-at-Risk</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ES</code></td>
<td>
<p>Asymptotic Expected Shortfall</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ES_CI</code></td>
<td>
<p>Confidence interval for the asymptotic Expected Shortfall</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bValues</code></td>
<td>
<p>Estimates from the single bootstrap resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chang J, Hall P (2015).
“Double-bootstrap methods that use a single double-bootstrap simulation.”
<em>Biometrika</em>, <b>102</b>(1), 203–214.
</p>
<p>Duellmann K, Gehde-Trapp M (2004).
“Systematic risk in recovery rates: an empirical analysis of US corporate credit exposures.”
<em>Bundesbank Series 2, Discussion Paper</em>.
Available at SSRN: <a href="http://hdl.handle.net/10419/19729">http://hdl.handle.net/10419/19729</a>. Accessed: 02.11.2017.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Hoese S, Huschens S (2011).
“Confidence intervals for asset correlations in the asymptotic single risk factor model.”
In <em>Operations Research Proceedings 2010</em>, 111–116.
Springer.
</p>
<p>Meyer C (2009).
“Estimation of intra-sector asset correlations.”
<em>The Journal of Risk Model Validation</em>, <b>3</b>(3), 47–79.
</p>
<p>Pfeuffer M, Nagl M, Fischer M, Roesch D (2020).
“Parameter Estimation and Bias Correction in the Vasicek Credit Portfolio Model.”
<em>Journal of Risk</em>, <b>22number</b>.
</p>


<h3>See Also</h3>

<p><code>intraAMM</code>, <code>intraFMM</code>, <code>intraJDP2</code>,
<code>intraMLE</code>, <code>intraJDP1</code>, <code>intraCMM</code>,
<code>intraMode</code>,<code>intraBeta</code></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)
d=defaultTimeseries(100,0.01,10,0.01)
n=rep(100,10)

#Sensitivity to the adjustment
intraAMLE(d,n,Adjust=0.001)
intraAMLE(d,n,Adjust=0.0001)

#Estimation with confidence intervals- I
IntraCorr=intraAMLE(d,n, Adjust=0.001, CI_1=0.95 )

#Estimation with confidence intervals- II
IntraCorr=intraAMLE(d,n, Adjust=0.001, CI_2=0.95 )

#Jackknife correction
IntraCorr=intraAMLE(d,n,Adjust=0.001, JC=TRUE)


#Bootstrap correction with  bootstrap confidence intervals
IntraCorr=intraAMLE(d,n, Adjust=0.001, B=1000, CI_Boot=0.95 )

#Bootstrap correction with  bootstrap confidence intervals and plot
IntraCorr=intraAMLE(d,n, B=1000, Adjust=0.001, CI_Boot=0.95, plot=TRUE )

#Double Bootstrap correction with 10 repetitions in the inner loop and 50 in the outer loop
IntraCorr=intraAMLE(d,n,Adjust=0.001, DB=c(10,50))




</code></pre>


</div>