<div class="container">

<table style="width: 100%;"><tr>
<td>build_design_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build Design Matrix</h2>

<h3>Description</h3>

<p>This function first smooths the data and approximates the
derivative before building the design matrix to include monomial and fourier
terms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">build_design_matrix(
  x_t,
  dt = 1,
  sg_poly_order = 4,
  library_degree = 5,
  library_type = c("poly", "four", "poly_four")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x_t</code></td>
<td>
<p>Matrix of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Time step (default is 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sg_poly_order</code></td>
<td>
<p>Polynomial order for Savitzky-Golay Filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>library_degree</code></td>
<td>
<p>Degree of polynomial library (default is 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>library_type</code></td>
<td>
<p>Type of library to use. Can be one of "poly",
"four", or "poly_four".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with two elements:
</p>

<ul>
<li> <p><code>sorted_theta</code> - A matrix with sorted polynomial/trigonometric
terms.
</p>
</li>
<li> <p><code>monomial_orders</code> - A vector indicating the order of each
polynomial term.
</p>
</li>
<li> <p><code>xdot_filtered</code> - A matrix with derivative terms
(dependent variable).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Build a design matrix using the Duffing Oscillator as the state-space.
# Output provides matrix, and derivative matrix monomial orders
# (needed for running `argos`).
x_t &lt;- duffing_oscillator(n=5000, dt = 0.01,
                          init_conditions = c(1, 0),
                          gamma_value = 0.1, kappa_value = 1,
                          epsilon_value = 5, snr = 49)
duffing_design_matrix &lt;-
         build_design_matrix(x_t, dt = 0.01, sg_poly_order = 4,
                             library_degree = 5, library_type = "poly")
head(duffing_design_matrix$sorted_theta)
</code></pre>


</div>