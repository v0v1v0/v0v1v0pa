<div class="container">

<table style="width: 100%;"><tr>
<td>strata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Access and manipulate the population strata for genind or genlight objects.</h2>

<h3>Description</h3>

<p>The following methods allow the user to quickly change the strata of a genind
or genlight object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">strata(x, formula = NULL, combine = TRUE, value)

strata(x) &lt;- value

nameStrata(x, value)

nameStrata(x) &lt;- value

splitStrata(x, value, sep = "_")

splitStrata(x, sep = "_") &lt;- value

addStrata(x, value, name = "NEW")

addStrata(x, name = "NEW") &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a genind or genlight object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a nested formula indicating the order of the population
strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine</code></td>
<td>
<p>if <code>TRUE</code> (default), the levels will be combined according to the
formula argument. If it is <code>FALSE</code>, the levels will not be combined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a data frame OR vector OR formula (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>a <code>character</code> indicating the character used to separate
hierarchical levels. This defaults to "_".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>an optional name argument for use with addStrata if supplying
a vector. Defaults to "NEW".</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Function Specifics</h4>

  <ul>
<li> <p><strong>strata()</strong> -
Use this function to view or define population stratification of a 
genind or genlight object. </p>
</li>
<li> 
<p><strong>nameStrata()</strong> - View or rename the different levels of strata. 
</p>
</li>
<li> <p><strong>splitStrata()</strong> - Split strata that are combined with a common
separator. This function should only be used once during a workflow. 
</p>
 <ul><li> <p><em>Rationale:</em> It is often difficult to import files 
with several levels of strata as most data formats do not allow unlimited 
population levels. This is circumvented by collapsing all population strata
into a single population factor with a common separator for each 
observation. </p>
</li></ul>
</li>
<li> <p><strong>addStrata()</strong> - Add levels to your population 
strata. This is ideal for adding groups defined by 
<code>find.clusters</code>. You can input a data frame or a vector, but if
you put in a vector, you have the option to name it. </p>
</li>
</ul>
<h4>Argument Specifics</h4>

<p>These functions allow the user to seamlessly carry all possible population 
stratification with their genind or genlight 
object. Note that there are two ways of performing all methods: </p>
 
<ul>
<li>
<p> modifying: <code>strata(myData) &lt;- myStrata</code> </p>
</li>
<li>
<p> preserving: 
<code>myNewData &lt;- strata(myData, value = myStrata)</code> </p>
</li>
</ul>
<p> They essentially do 
the same thing except that the modifying assignment method (the one with 
the "<code>&lt;-</code>") will modify the object in place whereas the non-assignment
method will preserve the original object (unless you overwrite it). Due to 
convention, everything right of the assignment is termed <code>value</code>. To 
avoid confusion, here is a guide to the argument <strong><code>value</code></strong> for 
each function: </p>
 <ul>
<li> <p><strong>strata()</strong> <code>value = </code>a 
<code>data.frame</code> that defines the strata for each individual in the
rows. </p>
</li>
<li> <p><strong>nameStrata()</strong> <code>value = </code>a <code>vector</code> or 
a <code>formula</code> that will define the names. </p>
</li>
<li> 
<p><strong>splitStrata()</strong> <code>value = </code>a <code>formula</code> argument with
the same number of levels as the strata you wish to split. </p>
</li>
<li> 
<p><strong>addStrata()</strong> <code>value = </code>a <code>vector</code> or 
<code>data.frame</code> with the same length as the number of individuals 
in your data. </p>
</li>
</ul>
<h4>Details on Formulas</h4>

<p>The preferred use of these functions is with a <code>formula</code> 
object. Specifically, a hierarchical formula argument is used to assign the
levels of the strata. An example of a hierarchical formula would
be:</p>

<table><tr>
<td style="text-align: right;"> <code>~Country/City/Neighborhood</code>
</td>
</tr></table>
<p> This convention was
chosen as it becomes easier to type and makes intuitive sense when defining
a <code>hierarchy</code>. Note: it is important to use hiearchical
formulas when specifying hierarchies as other types of formulas (eg. 
<code>~Country*City*Neighborhood</code>) will give incorrect results.</p>



<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code>setPop</code> <code>genind</code>
<code>as.genind</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># let's look at the microbov data set:
data(microbov)
microbov

# We see that we have three vectors of different names in the 'other' slot. 
# ?microbov
# These are Country, Breed, and Species
names(other(microbov))

# Let's set the strata
strata(microbov) &lt;- data.frame(other(microbov))
microbov

# And change the names so we know what they are
nameStrata(microbov) &lt;- ~Country/Breed/Species

## Not run: 
# let's see what the strata looks like by Species and Breed:
head(strata(microbov, ~Breed/Species))

# If we didn't want the last column combined with the first, we can set
# combine = FALSE
head(strata(microbov, ~Breed/Species, combine = FALSE))

#### USING splitStrata ####

# For the sake of example, we'll imagine that we have imported our data set
# with all of the stratifications combined. 
setPop(microbov) &lt;- ~Country/Breed/Species
strata(microbov) &lt;- NULL

# This is what our data would look like after import.
microbov

# To set our strata here, we need to use the functions strata and splitStrata
strata(microbov) &lt;- data.frame(x = pop(microbov))
microbov # shows us that we have "one" level of stratification
head(strata(microbov)) # all strata are separated by "_"

splitStrata(microbov) &lt;- ~Country/Breed/Species
microbov # Now we have all of our strata named and split
head(strata(microbov)) # all strata are appropriately named and split.

## End(Not run)
</code></pre>


</div>