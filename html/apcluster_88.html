<div class="container">

<table style="width: 100%;"><tr>
<td>plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Clustering Results</h2>

<h3>Description</h3>

<p>Functions for Visualizing Clustering Results
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'APResult,missing'
plot(x, y, type=c("netsim", "dpsim", "expref"),
    xlab="# Iterations", ylab="Similarity", ...)
## S4 method for signature 'ExClust,matrix'
plot(x, y, connect=TRUE, xlab="", ylab="",
labels=NA, limitNo=15, ...)
## S4 method for signature 'ExClust,data.frame'
plot(x, y, connect=TRUE, xlab="",
ylab="", labels=NA, limitNo=15, ...)
## S4 method for signature 'AggExResult,missing'
plot(x, y, main="Cluster dendrogram",
    xlab="", ylab="", ticks=4, digits=2, base=0.05, showSamples=FALSE,
    horiz=FALSE, ...)
## S4 method for signature 'AggExResult,matrix'
plot(x, y, k=NA, h=NA, ...)
## S4 method for signature 'AggExResult,data.frame'
plot(x, y, k=NA, h=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a clustering result object of class
<code>APResult</code>, <code>ExClust</code>,
or <code>AggExResult</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a matrix or data frame (see details below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string or array of strings indicating which
performance measures should be plotted; valid values are
<code>"netsim"</code>, <code>"dpsim"</code>, and <code>"expref"</code>
which can be used in any combination or order;
all other strings are ignored (for the meaning see
<code>APResult</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>labels for axes of 2D plots; ignored if <code>y</code> has
more than two columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>names used for variables in scatter plot matrix
(displayed if <code>y</code> has more than two columns). If <code>NA</code>
(default), column names are used. If no column names are available,
labels such as <code>x[, 2]</code> are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limitNo</code></td>
<td>
<p>if the number of columns/features in <code>y</code> is too large,
problems may occur when attempting to plot a scatter plot matrix.
To avoid problems, the <code>plot</code> method throws an error if the
number of columns exceeds <code>limitNo</code>. For special applications,
users can increase the value (15 by default). If <code>limitNo</code>
is set to <code>NA</code> or any other non-numeric value, the limit is
ignored entirely. Please note that attempting to plot scatter plot
matrices with too many features may corrupt the graphics device.
So users are making changes at their own risk. If plotting of many
features is necessary, make sure that the graphics device is large
enough to accommodate the plot (e.g. by using a sufficiently large
graphics file device).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>connect</code></td>
<td>
<p>used only if clustering is plotted on original data,
ignored otherwise. If <code>connect</code> is <code>TRUE</code>, lines are
drawn connecting exemplars with their cluster members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title of plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ticks</code></td>
<td>
<p>number of ticks used for the axis on the left side of the
plot (applies to dendrogram plots only, see below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits used for the axis tickmarks on the left
side of the plot (applies to dendrogram plots only, see below)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>fraction of height used for the very first join; defaults
to 0.05, i.e. the first join appears at 5% of the total height of the
dendrogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showSamples</code></td>
<td>
<p>if <code>TRUE</code>, a complete cluster hierarchy is
shown, otherwise, in case that <code>x</code> is a hierarchy of clusters,
the dendrogram of clusters is shown. For backward compatibility, the
default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
<p>if <code>TRUE</code>, the dendrogram is plotted horizontally
(analogous to <code>plot.dendrogram</code>).
The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>level to be selected when plotting a single clustering
level of cluster hierarchy (i.e. the number of clusters; see
<code>cutree-methods</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>cut-off to be used  when plotting a single clustering
level of cluster hierarchy (see <code>cutree-methods</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>all other arguments are passed to the plotting command that
are used internally, <code>plot</code> or
<code>heatmap</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>plot</code> is called for an <code>APResult</code> object
without specifying the second argument <code>y</code>,
a plot is created that displays graphs of performance
measures over execution time of the affinity propagation run.
This only works if <code>apcluster</code> was called with
<code>details=TRUE</code>.
</p>
<p>If <code>plot</code> is called for an <code>APResult</code> object
along with a matrix or data frame as argument <code>y</code>, then the dimensions of
the matrix determine the behavior of <code>plot</code>:
</p>

<ol>
<li>
<p>If the matrix <code>y</code> has two columns, <code>y</code> is
interpreted as the original data set. Then a plot of
the clustering result superimposed on the original
data set is created. Each cluster is displayed in a
different color. The exemplar of each cluster is highlighted
by a black square. If <code>connect</code> is <code>TRUE</code>, lines
connecting the cluster members to their exemplars are drawn.
This variant of <code>plot</code> does not return any value.
</p>
</li>
<li>
<p>If <code>y</code> has more than two columns, clustering results are
superimposed in a sort of scatter plot matrix. The variant
that <code>y</code> is interpreted as similarity matrix if it is
quadratic has been removed in version 1.3.2. Use
<code>heatmap</code> instead.
</p>
</li>
<li>
<p>If <code>y</code> has only one column, an error is displayed.
</p>
</li>
</ol>
<p>If <code>plot</code> is called for an <code>ExClust</code> object
along with a matrix or data frame as argument <code>y</code>, then
<code>plot</code> behaves exactly the same as described in the previous
paragraph.
</p>
<p>If <code>plot</code> is called for an <code>AggExResult</code> object
without specifying the second argument <code>y</code>, then a dendrogram
plot is drawn. This variant returns an invisible
<code>dendrogram</code> object. The <code>showSamples</code> argument
determines whether a complete dendrogram or a dendrogram of clusters
is plotted (see above). If the option <code>horiz=TRUE</code> is used, the
dendrogram is rotated. Note that, in this case, the margin to the
right of the plot may not be wide enough to accommodate long
cluster/sample labels. In such a case, the figure margins have to
be widened before <code>plot</code> is called.
</p>
<p>If <code>plot</code> is called for an <code>AggExResult</code> object
along with a matrix or data frame <code>y</code>, <code>y</code> is
again interpreted
as original data set. If one of the two arguments <code>k</code> or
<code>h</code> is present, a clustering is cut out from the cluster hierarchy 
using <code>cutree</code> and this clustering is displayed with the
original data set as described above. This variant of
<code>plot</code> returns an invisible <code>ExClust</code> object
containing the extracted clustering.
</p>


<h3>Value</h3>

<p>see details above
</p>


<h3>Author(s)</h3>

<p>Ulrich Bodenhofer, Andreas Kothmeier, and Johannes Palme</p>


<h3>References</h3>

<p><a href="https://github.com/UBod/apcluster">https://github.com/UBod/apcluster</a>
</p>
<p>Bodenhofer, U., Kothmeier, A., and Hochreiter, S. (2011)
APCluster: an R package for affinity propagation clustering.
<em>Bioinformatics</em> <b>27</b>, 2463-2464.
DOI: <a href="https://doi.org/10.1093/bioinformatics/btr406">doi:10.1093/bioinformatics/btr406</a>.</p>


<h3>See Also</h3>

<p><code>APResult</code>,
<code>AggExResult</code>, <code>ExClust</code>,
<code>heatmap-methods</code>, <code>apcluster</code>, 
<code>apclusterL</code>, <code>aggExCluster</code>, 
<code>cutree-methods</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create two Gaussian clouds
cl1 &lt;- cbind(rnorm(50, 0.2, 0.05), rnorm(50, 0.8, 0.06))
cl2 &lt;- cbind(rnorm(50, 0.7, 0.08), rnorm(50, 0.3, 0.05))
x &lt;- rbind(cl1, cl2)

## run affinity propagation
apres &lt;- apcluster(negDistMat(r=2), x, q=0.7, details=TRUE)

## plot information about clustering run
plot(apres)

## plot clustering result
plot(apres, x)

## perform agglomerative clustering of affinity propagation clusters
aggres1 &lt;- aggExCluster(x=apres)

## show dendrograms
plot(aggres1)
plot(aggres1, showSamples=TRUE)

## show clustering result for 4 clusters
plot(aggres1, x, k=4)

## perform agglomerative clustering of whole data set
aggres2 &lt;- aggExCluster(negDistMat(r=2), x)

## show dendrogram
plot(aggres2)

## show heatmap along with dendrogram
heatmap(aggres2)

## show clustering result for 2 clusters
plot(aggres2, x, k=2)

## cluster iris data set
data(iris)
apIris &lt;- apcluster(negDistMat(r=2), iris, q=0)
plot(apIris, iris)
</code></pre>


</div>