<div class="container">

<table style="width: 100%;"><tr>
<td>isCompoundSymmetric.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests whether an object of class matrix is compound symmetric</h2>

<h3>Description</h3>

<p>Tests whether an object of class <code>matrix</code> is compound symmetric by checking whether all diagonal elements are equal and all off-diagonal elements are equal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'matrix'
isCompoundSymmetric(object, tol = 100 * .Machine$double.eps, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An <code>object</code> to be tested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a <code>numeric</code> scalar &gt; 0 specifying that values smaller than it 
are considered to be zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Provision for passing arguments to functions called internally - 
not used at present.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>logical</code>.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>See Also</h3>

<p><code>isSymmetric</code></p>


<h3>Examples</h3>

<pre><code class="language-R">  data(Oats.dat)
  
  ## Not run: 
  ## Use asreml to get the variance matrix of a set of predictions

  m1.asr &lt;- asreml(Yield ~ Nitrogen*Variety, 
                   random=~Blocks/Wplots,
                   data=Oats.dat)
  current.asrt &lt;- as.asrtests(m1.asr)
  Var.pred &lt;- asreml::predict.asreml(m1.asr, classify="Nitrogen:Variety", 
                                      vcov = TRUE)
                                    est.status = "status")
  isCompoundSymmetrix(Var.pred$vcov)

## End(Not run)
  
  ## Use lmerTest and emmmeans to get the variance matrix of a set of predictions
  if (requireNamespace("lmerTest", quietly = TRUE) &amp; 
      requireNamespace("emmeans", quietly = TRUE))
  {
    m1.lmer &lt;- lmerTest::lmer(Yield ~ Nitrogen*Variety + (1|Blocks/Wplots),
                              data=Oats.dat)
    Var.emm &lt;- emmeans::emmeans(m1.lmer, specs = ~ Nitrogen:Variety)
    Var.vcov &lt;- vcov(Var.emm)
  }

  if (exists("Var.vcov"))
  {
    ## Check the variance matrix of the predictions is compound symmetric
    isCompoundSymmetric(Var.vcov)
  }
</code></pre>


</div>