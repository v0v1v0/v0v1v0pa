<div class="container">

<table style="width: 100%;"><tr>
<td>sim_fun_on_tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate functions on a ginven tree</h2>

<h3>Description</h3>

<p>Simulate functions on a ginven tree
</p>
<p>
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_fun_on_tree(
  tree,
  tip.type,
  node.type,
  psi,
  mu_d,
  mu_s,
  eta,
  Pi,
  P = 1L,
  informative = getOption("aphylo_informative", FALSE),
  maxtries = 20L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object of class phylo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.type, node.type</code></td>
<td>
<p>Integer vectors with values 0,1. 0 denotes duplication node and 1 speciation node. This is used in LogLike.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>Numeric vector of length 2. Misclasification probabilities. (see <code>LogLike</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_d, mu_s</code></td>
<td>
<p>Numeric vector of length 2. Gain/loss probabilities (see <code>LogLike</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Numeric vector of length 2. Annotation bias probabilities (see <code>LogLike</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pi</code></td>
<td>
<p>Numeric scalar. Root node probability of having the function (see <code>LogLike</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Integer scalar. Number of functions to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>informative</code></td>
<td>
<p>Logical scalar. When <code>TRUE</code> (default) the function
re-runs the simulation algorithm until both 0s and 1s show in the leaf
nodes of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxtries</code></td>
<td>
<p>Integer scalar. If <code>informative = TRUE</code>, then the function
will try at most <code>maxtries</code> times.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using the model described in the vignette
<a href="../doc/peeling_phylo.html">peeling_phylo.html</a>
</p>
<p>The optiona <code>informative</code> was created such that when needed the
function can be forced to simualte annotations while making sure (or at
least trying <code>maxtries</code> times) that the leafs have both 0s and 9s. From what
we've learned while conducting simulation studies, using this option may
indirectly bias the data generating process.
</p>


<h3>Value</h3>

<p>An matrix of size <code>length(offspring)*P</code> with values 9, 0 and 1
indicating <code>"no information"</code>, <code>"no function"</code> and <code>"function"</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1 ----------------------------------------------------------------
# We need to simulate a tree
set.seed(1231)
newtree &lt;- sim_tree(1e3)

# Preprocessing the data

# Simulating
ans &lt;- sim_fun_on_tree(
  newtree,
  psi  = c(.01, .05),
  mu_d = c(.90, .80),
  mu_s = c(.1, .05),
  Pi   = .5,
  eta  = c(1, 1)
)

# Tabulating results
table(ans)
</code></pre>


</div>