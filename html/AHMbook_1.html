<div class="container">

<table style="width: 100%;"><tr>
<td>AHMbook-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Functions and data for the Book “Applied Hierarchical Modeling in Ecology” Volumes 1 and 2
</h2>

<h3>Description</h3>

<p>Provides functions to simulate data sets from hierarchical ecological models, including all the simulations described by Marc Kéry and Andy Royle in the two-volume publication, <em>Applied Hierarchical Modeling in Ecology: analysis of distribution, abundance and species richness in R and BUGS</em>, Academic Press (Vol 1, 2016; Vol 2, 2021), plus new models developed after publication of the books.
</p>
<p>It also has all the utility functions and data sets needed to replicate the analyses shown in the books.
</p>


<h3>SIMULATION FUNCTIONS</h3>



<h4>Introduction</h4>

 
<dl>
<dt><code>sim.fn</code></dt>
<dd>
<p> Simulate a homogeneous Poisson point process and illustrate the fundamental relationships between intensity, abundance and occurrence (AHM1 - section 1.1)</p>
</dd>
<dt><code>data.fn</code></dt>
<dd>
<p> Simulate count data that are replicated in space and in time according to the binomial N-mixture model of Royle (2004) (this is for much simpler cases than is possible with function <code>simNmix</code> in Chapter 6 below) (AHM1 - 4.3)</p>
</dd>
</dl>
<h4>Abundance from Counts: Binomial N-Mixture models</h4>

 
<dl>
<dt><code>simNmix</code></dt>
<dd>
<p> Simulate count data and individual detection histories for binomial and multinomial mixture models respectively under a wide range of conditions (AHM1 - 6.9.3)</p>
</dd>
<dt><code>simpleNmix</code></dt>
<dd>
<p> Simulate count data under a very simple version of the binomial mixture model, with time for space substitution (AHM1 - 6.12)</p>
</dd>
<dt><code>playRN</code></dt>
<dd>
<p> Play Royle-Nichols (RN) model: generate count data under the binomial N-mixture model of Royle (2004),  then 'degrade' the data to detection/nondetection and fit the RN model using <span class="pkg">unmarked</span> and estimate site-specific abundance (AHM1 - 6.13.1)   </p>
</dd>
</dl>
<h4>Abundance from Hierarchical Distance Sampling</h4>

 
<dl>
<dt><code>sim.ldata</code></dt>
<dd>
<p> Simulate data under a non-hierarchical line transect distance sampling model (AHM1 - 8.2.3)</p>
</dd>
<dt><code>sim.pdata</code></dt>
<dd>
<p> Simulate data under a non-hierarchical point transect (= point count) distance sampling model (AHM1 - 8.2.5.1)</p>
</dd>
<dt><code>simHDS</code></dt>
<dd>
<p> Simulate data under a hierarchical distance sampling protocol (line or point) (AHM1 - 8.5.1)</p>
</dd>
<dt><code>simHDSpoint</code></dt>
<dd>
<p> A simplified version of <code>simHDS</code> for point transects only.</p>
</dd>
<dt><code>simHDSg</code></dt>
<dd>
<p> Simulate data under a hierarchical distance sampling (HDS) protocol with groups (AHM1 - 9.2.1)</p>
</dd>
<dt><code>simHDStr</code></dt>
<dd>
<p> Simulate data under a time-removal/distance sampling design (AHM1 - 9.3.2)</p>
</dd>
<dt><code>simHDSopen</code></dt>
<dd>
<p> Simulate open hierarchical distance sampling data (AHM1 - 9.5.4)</p>
</dd>
<dt><code>issj.sim</code></dt>
<dd>
<p> Simulate data under the open distance sampling protocol for the Island Scrub Jays (AHM1 - 9.7.1)</p>
</dd>
<dt><code>sim.spatialDS</code></dt>
<dd>
<p> Simulate data under a basic spatial distance sampling model  (AHM1 - 9.8.3)</p>
</dd>
<dt><code>sim.spatialHDS</code></dt>
<dd>
<p> Simulate data under a spatial hierarchical distance sampling model  (AHM1 - 9.8.5)</p>
</dd>
<dt><code>simIDS</code></dt>
<dd>
<p> Simulate data for an integrated distance sampling, point count and occupancy study</p>
</dd>
</dl>
<h4>Static Occurrence using Site-Occupancy Models</h4>

 
<dl>
<dt><code>simOcc</code></dt>
<dd>
<p> Simulate detection/nondetection data under static occupancy models under a wide range of conditions (AHM1 - 10.5)</p>
</dd>
<dt><code>simOccCat</code></dt>
<dd>
<p> As above, but allows simulation of categorical covariates</p>
</dd>
<dt><code>sim3Occ</code></dt>
<dd>
<p> Simulate detection/nondetection data under a static 3-level occupancy model (AHM1 - 10.10)</p>
</dd>
<dt><code>simOccttd</code></dt>
<dd>
<p> Simulate 'timing data' under a static time-to-detection occupancy design (AHM1 - 10.12.1)</p>
</dd>
<dt><code>wigglyOcc</code></dt>
<dd>
<p> Simulate detection/nondetection data under a static occupancy model with really wiggly covariate relationships in occupancy and detection probability (AHM1 - 10.14)</p>
</dd>
</dl>
<h4>Hierarchical Models for Communities</h4>

 
<dl>
<dt><code>simComm</code></dt>
<dd>
<p> Simulate detection/nondetection or count data under a community occupancy or abundance model respectively (AHM1 - 11.2)</p>
</dd>
</dl>
<h4>Relative Abundance Models for Population Dynamics</h4>

 
<dl>
<dt><code>simNpC</code></dt>
<dd>
<p> Simulate data on abundance (N), detection probability (p) and resulting counts (C) under a counting process with imperfect detection  (AHM2 - 1.2)</p>
</dd>
<dt><code>simPOP</code></dt>
<dd>
<p> Simulate count data under a demographic state-space, or Dail-Madsen, model (no robust design) (AHM2 - 1.7.1)</p>
</dd>
<dt><code>simPH</code></dt>
<dd>
<p> Simulate count data with phenological curves within a year (AHM2 - 1.8.1)</p>
</dd>
</dl>
<h4>Modeling Population Dynamics with Count Data</h4>

 
<dl>
<dt><code>simDM0</code></dt>
<dd>
<p> Simulate count data from a Dail-Madsen model under a robust design, no covariates (AHM2 - 2.5.1)</p>
</dd>
<dt><code>simDM</code></dt>
<dd>
<p>  Simulate count data from a Dail-Madsen model under a robust design, with covariates (AHM2 - 2.5.5)</p>
</dd>
<dt><code>simMultMix</code></dt>
<dd>
<p>  Simulate “removal” count data from a multinomial-mixture model (AHM2 - 2.7.1)</p>
</dd>
<dt><code>simFrogDisease</code></dt>
<dd>
<p>  Simulate detection data for diseased frogs (AHM2 - 2.9.1)</p>
</dd>
</dl>
<h4>Hierarchical Models of Survival</h4>

 
<dl>
<dt><code>simCJS</code></dt>
<dd>
<p> Simulate individual capture history data under a Cormack-Jolly-Seber (CJS) survival model (AHM2 - 3.2.2)</p>
</dd>
</dl>
<h4>Dynamic Occupancy Models</h4>

 
<dl>
<dt><code>simDynocc</code></dt>
<dd>
<p> Simulate detection/nondetection data under a dynamic occupancy model under a wide range of conditions (AHM2 - 4.4)</p>
</dd>
<dt><code>simDemoDynocc</code></dt>
<dd>
<p> Simulate detection/nondetection data under a demographic dynamic occupancy model (AHM2 - 4.12)</p>
</dd>
</dl>
<h4>Dynamic Community Models</h4>

 
<dl>
<dt><code>simDCM</code></dt>
<dd>
<p> Simulate detection/nondetection data under a general dynamic community model (site-occupancy variant)  (AHM2 - 5.2)</p>
</dd>
</dl>
<h4>Spatial Models of Distribution and Abundance</h4>

 
<dl>
<dt><code>simDynoccSpatial</code></dt>
<dd>
<p> Simulate detection/nondetection data under a dynamic occupancy model with spatial covariate and spatial autocorrelation (AHM2 - 9.6.1.1). See also <code>simDynoccSpatialData</code></p>
</dd>
<dt><code>simExpCorrRF</code></dt>
<dd>
<p> Simulate data from a Gaussian random field with negative exponential correlation function (AHM2 - 9.2)</p>
</dd>
<dt><code>simOccSpatial</code></dt>
<dd>
<p> Simulate detection/nondetection data under a spatial, static occupancy model for a real landscape in the Bernese Oberland (Swiss Alps) (AHM2 - 9.2)</p>
</dd>
<dt><code>simNmixSpatial</code></dt>
<dd>
<p> Simulate counts under a spatial, static binomial N-mixture model for a real landscape in the Bernese Oberland (Swiss Alps) (AHM2 - 9.2)</p>
</dd>
</dl>
<h4>Integrated Models for Multiple Types of Data</h4>

 
<dl>
<dt><code>simPPe</code></dt>
<dd>
<p> Simulate a spatial point pattern in a heterogeneous landscape and show aggregation to abundance and occurrence ('e' for educational version)  (AHM2 - 10.2)</p>
</dd>
<dt><code>simDataDK</code></dt>
<dd>
<p> Simulate data for an integrated species distribution model (SDM) of Dorazio-Koshkina (AHM2 - 10.6.1)</p>
</dd>
</dl>
<h4>Spatially Explicit Distance Sampling</h4>

 
<dl>
<dt><code>simSpatialDSline</code></dt>
<dd>
<p> Simulate line transect distance sampling data with spatial variation in density  (AHM2 - 11.5)</p>
</dd>
<dt><code>simSpatialDSte</code></dt>
<dd>
<p> Simulate data for replicate line transect distance sampling surveys with spatial variation in density and temporary emigration (AHM2 - 11.8.1)</p>
</dd>
<dt><code>simDSM</code></dt>
<dd>
<p> Simulate line transect data for density surface modeling (AHM2 - 11.10.1)</p>
</dd>
</dl>
<h3>DATA SETS</h3>


<dl>
<dt><code>BerneseOberland</code></dt>
<dd>
<p> Landscape data for the Bernese Oberland around Interlaken, Switzerland (AHM2 - 9.2)</p>
</dd>
<dt><code>crestedTit</code></dt>
<dd>
<p> Crested Tit data from the Swiss Breeding Bird Survey MHB (Monitoring Häufige Brutvögel) for 1999 to 2015 (AHM2 - 1.3)</p>
</dd>
<dt><code>cswa</code></dt>
<dd>
<p> Chestnut-sided Warbler data for point counts and spot-mapping from White Mountain National Forest (AHM2 - 2.4.3)</p>
</dd>
<dt><code>crossbillAHM</code></dt>
<dd>
<p> Crossbill data from the Swiss Breeding Bird Survey for 2001 to 2012 (AHM2 - 4.9)</p>
</dd>
<dt><code>dragonflies</code></dt>
<dd>
<p> Toy data set used in AHM1 - 3.1</p>
</dd>
<dt><code>duskySalamanders</code></dt>
<dd>
<p> Counts of juvenile vs adult salamanders over 7 years (AHM2 - 2.9.2)</p>
</dd>
<dt><code>EurasianLynx</code></dt>
<dd>
<p> Data for Eurasian Lynx in Italy and Switzerland (AHM2 - 7.3.2)</p>
</dd>
<dt><code>Finnmark</code></dt>
<dd>
<p> Data from surveys of birds in Finnmark in NE Norway (AHM2 - 5.7)</p>
</dd>
<dt><code>FrenchPeregrines</code></dt>
<dd>
<p> Detection data for peregrines in the French Jura (AHM2 - 4.11)</p>
</dd>
<dt><code>greenWoodpecker</code></dt>
<dd>
<p> Count data for Green Woodpeckers in Switzerland from the MHB (AHM2 - 2.2)</p>
</dd>
<dt><code>HubbardBrook</code></dt>
<dd>
<p> Point count data for warblers from Hubbard Brook, New Hampshire (AHM2 - 8.2)</p>
</dd>
<dt><code>jay</code></dt>
<dd>
<p> The European Jay data set (from the MHB) is now included in <span class="pkg">unmarked</span> (AHM1 - 7.9)</p>
</dd>
<dt><code>MesoCarnivores</code></dt>
<dd>
<p> Camera trap data for 3 species of meso-carnivores (AHM2 - 8.2)</p>
</dd>
<dt><code>MHB2014</code></dt>
<dd>
<p> Complete data from the Swiss Breeding Bird Survey MHB (Monitoring Häufige Brutvögel) for the year 2014 (AHM1 - 11.3)</p>
</dd>
<dt><code>spottedWoodpecker</code></dt>
<dd>
<p> Data for Middle Spotted Woodpeckers in Switzerland (AHM2 - 4.11.2)</p>
</dd>
<dt><code>SwissAtlasHa</code></dt>
<dd>
<p> A 1ha-scale subset of the count data from the Swiss Breeding Bird Atlas (AHM2 - 8.4.2)</p>
</dd>
<dt><code>SwissEagleOwls</code></dt>
<dd>
<p> Territory-level, multi-state detection/nondetection data for Eagle Owls in Switzerland (AHM2 - 6.4)</p>
</dd>
<dt><code>SwissMarbledWhite</code></dt>
<dd>
<p> Data from the Biodiversity Monitoring Program (LANAG) in the Swiss Canton of Aargau for Marbled White butterfly (AHM2 - 1.8.2)</p>
</dd>
<dt><code>SwissSquirrels</code></dt>
<dd>
<p> Count data for Red Squirrels in Switzerland from the Swiss breeding bird survey MHB (AHM1 - 10.9)</p>
</dd>
<dt><code>SwissTits</code></dt>
<dd>
<p> Data for 6 species of tits in Switzerland from from the Swiss breeding bird survey MHB  during 2004 to 2013 (AHM1 - 6.13.1)</p>
</dd>
<dt><code>treeSparrow</code></dt>
<dd>
<p> Data for Tree Sparrows in Alaska (AHM2 - 11.8.4)</p>
</dd>
<dt><code>ttdPeregrine</code></dt>
<dd>
<p> Time-to-detection data for Peregrines (AHM1 - 10.12.2)</p>
</dd>
<dt><code>UKmarbledWhite</code></dt>
<dd>
<p> Data from the UK Butterfly Monitoring Scheme (UKBMS) for Marbled White butterfly (AHM2 - 1.8.2)</p>
</dd>
<dt><code>wagtail</code></dt>
<dd>
<p> Distance sampling data for Yellow Wagtails in The Netherlands (AHM1 - 9.5.3)</p>
</dd>
<dt><code>waterVoles</code></dt>
<dd>
<p> Detection/nondetection data for the Mighty Water Vole of Scotland (AHM2 - 7.2.2)</p>
</dd>
<dt><code>wigglyLine</code></dt>
<dd>
<p> Coordinates for a wiggly transect line (AHM2 - 11.9)</p>
</dd>
<dt><code>willowWarbler</code></dt>
<dd>
<p> Capture-history (survival) data for Willow Warblers in Britain (AHM2 - 3.4.1)</p>
</dd>
</dl>
<h3>UTILITY FUNCTIONS</h3>


<dl>
<dt><code>ppc.plot</code></dt>
<dd>
<p> Plot results from posterior predictive checks in section AHM1 - 6.8, for a fitted binomial N-mixture model object with JAGS</p>
</dd>
<dt><code>plot_Nmix_resi</code></dt>
<dd>
<p> Do diagnostic plots for one binomial N-mixture model fitted with all three mixture distributions currently available in unmarked: Poisson, negative binomial and zero-inflated Poisson (AHM1 - 6.9.3)</p>
</dd>
<dt><code>map.Nmix.resi</code></dt>
<dd>
<p> Produce a map of the residuals from a binomial N-mixture model (see Section AHM1 - 6.9.3)</p>
</dd>
<dt>
<code>instRemPiFun</code>, <code>crPiFun</code>, <code>crPiFun.Mb</code>, <code>MhPiFun</code>
</dt>
<dd>
<p> Define the relationship between the multinomial cell probabilities and the underlying detection probability parameters (i.e., a pi function) in various designs (AHM1 - 7.8 and AHM2 - Chapter 2)</p>
</dd>
<dt><code>spline.prep</code></dt>
<dd>
<p> Prepare input for BUGS model when fitting a spline for a covariate (AHM1 - 10.14)</p>
</dd>
<dt><code>graphSSM</code></dt>
<dd>
<p> Plot trajectories of counts and latent abundance from a fitted Gaussian state-space model (AHM2 - 1.6.1)</p>
</dd>
<dt><code>ch2marray</code></dt>
<dd>
<p> Convert capture history data to the m-array aggregation (AHM2 - 3.4.1)</p>
</dd>
<dt><code>valid_data</code></dt>
<dd>
<p> Partial validation of simulated data with false positives (AHM2 - 7.6.2)</p>
</dd>
<dt><code>getLVcorrMat</code></dt>
<dd>
<p> Compute the correlation matrix from an analysis of a latent variable occupancy or binomial N-mixture model (AHM2 - 8.4.2)</p>
</dd>
<dt><code>zinit</code></dt>
<dd>
<p> Generate starting values for fitting survival models (introduced in AHM2 - 3.2.3).</p>
</dd>
<dt><code>standardize</code></dt>
<dd>
<p> Standardize covariates to mean 0, SD 1.</p>
</dd>
<dt>
<code>fitstats</code>, <code>fitstats2</code>
</dt>
<dd>
<p> Calculate fit-statistics used in parboot GOF tests throughout the book (eg, Sections AHM1 - 7.5.4, AHM1 - 7.9.3, AHM2 - 2.3.3)</p>
</dd>
<dt><code>e2dist</code></dt>
<dd>
<p> Compute a matrix of Euclidean distances</p>
</dd>
<dt><code>image_scale</code></dt>
<dd>
<p> Draw scale for image (introduced in chapter AHM1 - 9.8.3) </p>
</dd>
<dt><code>bigCrossCorr</code></dt>
<dd>
<p> Report cross-correlations above a given threshold </p>
</dd>
<dt><code>Color_Ramps</code></dt>
<dd>
<p> Color ramps for use with image or raster plots </p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle, Mike Meredith
</p>


</div>