<div class="container">

<table style="width: 100%;"><tr>
<td>moranNP.randtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute positive and negative parts of Moran's index of spatial
autocorrelation</h2>

<h3>Description</h3>

<p>This function computes positive and negative parts of Moran's I statistic and
provide a testing procedure using random permutations. The functions compute
the Moran's eigenvector maps (MEM) and eigenvalues for the <code>listw</code>
object. If <code>alter = "greater"</code>, the statistic 'I+' is computed as the
sum of the products between positive eigenvalues and squared correlations
between <code>x</code> and associated MEMs. If <code>alter = "less"</code>, the statistic
'I-' is computed as the sum of the products between negative eigenvalues and
squared correlations between <code>x</code> and associated MEMs. If <code>alter =
"two-sided"</code>, both statistics are computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moranNP.randtest(
  x,
  listw,
  nrepet = 999,
  alter = c("greater", "less", "two-sided"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>vector</code> with numeric data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>an object of class <code>listw</code> created for example by
<code>nb2listw</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an integer indicating the number of permutations used in the 
randomization procedure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alter</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must
be one of "greater" (default), "less" or "two-sided"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments (e.g., <code>p.adjust.method</code>) to be passed to
the <code>as.krandtest</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>randtest</code> (for unilateral test) or
<code>krandtest</code> (for bilateral test)
</p>


<h3>Author(s)</h3>

<p>St√©phane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Dray, S. (2011). A new perspective about Moran's coefficient:
spatial autocorrelation as a linear regression problem. Geographical
Analysis, 43, 127-141.
</p>


<h3>See Also</h3>

<p><code>moran.randtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if(require("ade4", quietly = TRUE)  &amp; require("spdep", quiet = TRUE)){
data(mafragh)
tests &lt;- moranNP.randtest(mafragh$env[,1], nb2listw(mafragh$nb),
 alter = "two-sided", p.adjust.method = "holm")
tests
moran.randtest(mafragh$env[,1], nb2listw(mafragh$nb))$obs
sum(tests$obs)
}

</code></pre>


</div>