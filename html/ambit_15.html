<div class="container">

<table style="width: 100%;"><tr>
<td>nonpar_trawlest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric estimation of the trawl function</h2>

<h3>Description</h3>

<p>This function implements the nonparametric trawl estimation proposed in
Sauri and Veraart (2022).
</p>


<h3>Usage</h3>

<pre><code class="language-R">nonpar_trawlest(data, Delta, lag = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data to be used in the trawl function estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>Width of the grid on which we observe the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>
<p>The lag until which the trawl function should be estimated</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of the trawl function using the methodology proposed in
Sauri and Veraart (2022). Suppose the data is observed on the grid
0, Delta, 2Delta, ..., (n-1)Delta. Given the path contained in data,
the function  returns the lag-dimensional
vector </p>
<p style="text-align: center;"><code class="reqn">(\hat a(0), \hat a(\Delta), \ldots, \hat a((lag-1) \Delta)).</code>
</p>

<p>In the case when lag=n, the n-1 dimensional vector
</p>
<p style="text-align: center;"><code class="reqn">(\hat a(0), \hat a(\Delta), \ldots, \hat a((n-2) \Delta))</code>
</p>
<p> is returned.
</p>


<h3>Value</h3>

<p>ahat Returns the lag-dimensional vector
<code class="reqn">(\hat a(0), \hat a(\Delta), \ldots, \hat a((lag-1) \Delta)).</code>
Here, <code class="reqn">\hat a(0)</code> is estimated
based on the realised variance estimator.
</p>
<p>a0_alt Returns the alternative estimator of a(0) using
the same methodology as the one used for
t&gt;0. Note that this is not the recommended estimator to use, but can be
used for comparison purposes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##Simulate a trawl process
##Determine the sampling grid
my_n &lt;- 5000
my_delta &lt;- 0.1
my_t &lt;- my_n*my_delta

###Choose the model parameter
#Exponential trawl function:
my_lambda &lt;- 2
#Poisson marginal distribution trawl
my_v &lt;- 1

#Set the seed
set.seed(1726)
#Simulate the trawl process
Poi_data&lt;-ambit::sim_weighted_trawl(my_n, my_delta, "Exp", my_lambda, "Poi", my_v)$path

#Estimate the trawl function
my_lag &lt;- 100+1
PoiEx_trawl &lt;- nonpar_trawlest(Poi_data, my_delta, lag=my_lag)$a_hat

#Plot the estimated trawl function and superimpose the true one
l_seq &lt;- seq(from = 0,to = (my_lag-1), by = 1)
esttrawlfct.data &lt;- base::data.frame(l=l_seq[1:31],
                               value=PoiEx_trawl[1:31])
p1 &lt;- ggplot2::ggplot(esttrawlfct.data, ggplot2::aes(x=l,y=value))+
  ggplot2::geom_point(size=3)+
  ggplot2::geom_function(fun = function(x) acf_Exp(x*my_delta,my_lambda), colour="red", size=1.5)+
  ggplot2::xlab("l")+
  ggplot2::ylab(latex2exp::TeX("$\\hat{a}(\\cdot)$ for Poisson trawl process"))
p1

</code></pre>


</div>