<div class="container">

<table style="width: 100%;"><tr>
<td>apc.indiv.est.model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a single APC model</h2>

<h3>Description</h3>

<p>The function <code>apc.indiv.est.model</code> is used to estimate any of:
the APC model, any APC submodel, or the time-saturated model. To estimate
the APC model or a submodel, it calls <code>apc.indiv.design.collinear</code>,
<code>apc.indiv.design.model</code>, and <code>apc.indiv.fit.model</code> in that order.
To estimate the time-saturated (TS) model it calls either
<code>apc.indiv.estimate.TS</code> or <code>apc.indiv.logit.TS</code>, depending on the
selected <code>model.family</code>. These functions can also be called directly by
the user.</p>


<h3>Usage</h3>

<pre><code class="language-R">  apc.indiv.est.model(data, unit = 1,
                      n.coh.excl.start=0, n.coh.excl.end=0,
                      n.per.excl.start=0, n.per.excl.end=0,
                      n.age.excl.start=0, n.age.excl.end=0,  
                      model.design = "APC", dep.var = NULL, 
                      covariates = NULL, model.family = "gaussian",
                      NR.controls = NULL, 
                      existing.collinear = NULL,
                      existing.design = NULL,
					  plmmodel = "notplm", id.var = NULL,
                      wt.var = NULL)					  
  apc.indiv.design.collinear(data, unit = 1,
                             n.coh.excl.start = 0, n.coh.excl.end = 0,
                             n.per.excl.start = 0, n.per.excl.end = 0,
                             n.age.excl.start = 0, n.age.excl.end = 0)
  apc.indiv.design.model(apc.indiv.design.collinear,
                         model.design = "APC", dep.var = NULL, 
                         covariates = NULL, plmmodel = "notplm",
                         wt.var = NULL, id.var = NULL)
  apc.indiv.fit.model(apc.indiv.design.model, model.family = "gaussian", DV = NULL)
  apc.indiv.estimate.TS(data, dep.var, covariates = NULL)
  apc.indiv.logit.TS(data, dep.var, covariates = NULL, NR.controls = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data.frame in use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit</code></td>
<td>
<p>The interval at which age, period, and cohort are recorded 
(must be the same for each). Default 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.coh.excl.start</code></td>
<td>
<p>If any cohorts have been censored (AP data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.coh.excl.end</code></td>
<td>
<p>If any cohorts have been censored (AP data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.per.excl.start</code></td>
<td>
<p>If any periods have been censored (AC data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.per.excl.end</code></td>
<td>
<p>If any periods have been censored (AC data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.age.excl.start</code></td>
<td>
<p>If any ages have been censored (PC data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.age.excl.end</code></td>
<td>
<p>If any ages have been censored (PC data only). 
Default 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.design</code></td>
<td>
<p>The name of the model to be estimated. One of "TS",
"APC", "AC", etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep.var</code></td>
<td>
<p>The name of the dependent variable as it appears in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV</code></td>
<td>
<p>apc.indiv.fit.model only. Optional. Vector containing dependent 
variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A vector of the names of covariates as they appear in the 
data. Default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plmmodel</code></td>
<td>
<p>Used to indicate whether a panel data model is to be estimated and if so what type. Default is "notplm", for not panel data. Other values are "pooling", "within", "random". Further details in <code>plm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.var</code></td>
<td>
<p>Only if using panel data. The name of the individual ID variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wt.var</code></td>
<td>
<p>Only if using survey weights. The name of the weights variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.family</code></td>
<td>
<p>Either "gaussian" or "binomial". Default "gaussian".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NR.controls</code></td>
<td>
<p>Optional list to modify aspects of the Newton-Rhapson 
iteration for binomial TS model. Further information in "Details", below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>existing.collinear</code></td>
<td>
<p>Optional specify the output of 
apc.indiv.design.collinear, if already run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>existing.design</code></td>
<td>
<p>Optional specify the output of apc.indiv.design.model,
if already run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apc.indiv.design.collinear</code></td>
<td>
<p>Output from the command 
<code>apc.indiv.design.collinear</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apc.indiv.design.model</code></td>
<td>
<p>Output from the command 
<code>apc.indiv.design.model</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The casual user should start with the general function 
<code>apc.indiv.est.model</code> for analysis. The underlying functions should be
employed if the user needs to run many models using the same relatively large
dataset, in which case time can be saved by running 
<code>apc.indiv.design.collinear</code> just once and using 
<code>apc.indiv.design.model</code> and <code>apc.indiv.fit.model</code> to estimate 
each of the models.
</p>
<p>The time-saturated (TS) binomial model is estimated by a customized
Newton-Rhapson iteration. Aspects of this iteration can be controlled by
specifying the <code>NR.controls</code> option of <code>apc.indiv.est.model</code> or of
<code>apc.indiv.logit.TS</code>.
<code>NR.controls</code> is a named list of length <code>8</code>.
In order, the elements are:
<code>maxit.loop</code>, <code>maxit.linesearch</code>, <code>tolerance</code>, <code>init</code>,
<code>inv.tol</code>, <code>d1.tol</code>, <code>custom.kappa</code>, <code>custom.zeta</code>.
<code>maxit.loop</code> sets the maximum number of Newton-Rhapson iterations, and has a default of 10.
<code>maxit.linesearch</code> sets the maximum number of linesearch iterations
within each Newton-Rhapson iteration, and has a default of 20.
<code>tolerance</code> sets the condition for convergence, i.e. the tolerated
difference between likelihoods from one Newton-Rhapson iteration to the
next; the default is <code>.002</code>.
<code>init</code> sets the starting values for the iteration. The default is
<code>"ols"</code>, meaning that estimates from the linear probability model are
the starting values; one can also use <code>"zero"</code> to set the starting
values to zero, or use <code>"custom"</code> and specify custom starting values
using <code>custom.kappa</code> and <code>custom.zeta</code>.
<code>inv.tol</code>sets the tolerance of small values when inverting a matrix
(using <code>solve</code>), and the default is the machine precision.
<code>d1.tol</code> sets the magnitude of norm of first derivative to be tolerated
in Newton-Rhapson iteration, and has a default of <code>.002</code>.
<code>custom.kappa</code> is used to specify custom starting values for the TS
indicator parameters, while <code>custom.zeta</code> is used to specify custom
starting values for parameters on any covariates.
</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The output of either <code>glm</code>, <code>svyglm</code>, or <code>plm</code> for repeated cross-section, repeated cross-section with survey weights, or panel models respectively. Can be used directly with follow-on functions like <code>waldtest</code></p>
</td>
</tr></table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients.canonical</code></td>
<td>
<p>Matrix of estimates, standard error, t-statistic, and p-value of canonical parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients.covariates</code></td>
<td>
<p>Matrix of estimates, standard error, t-statistic, and p-value of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients.TS</code></td>
<td>
<p>TS model only: matrix of estimates, standard error, t-statistic, and p-value of TS indicators. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>TS model only: Akaike Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood</code></td>
<td>
<p>model likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.design</code></td>
<td>
<p>which APC submodel has been estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixef</code></td>
<td>
<p>When plmmodel = "within", estimated individual fixed effects. Otherwise NULL. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.design.collinear</code></td>
<td>
<p>from apc.indiv.design.collinear only. The 
collinear design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.design</code></td>
<td>
<p>from apc.indiv.design.model only. The design matrix used to estimate the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DV</code></td>
<td>
<p>from apc.indiv.design.model only, if dep.var specified. A vector of the outcome variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID</code></td>
<td>
<p>from apc.indiv.design.model only, if panel model. A vector of the individual ID variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PER</code></td>
<td>
<p>from apc.indiv.design.model only, if panel model. A vector of the period variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WT</code></td>
<td>
<p>from apc.indiv.design.model only, if wt.var specified. A vector of the survey weight variable. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.formula</code></td>
<td>
<p>from apc.indiv.design.model only, the implied model formula. NULL if dep.var not specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.string</code></td>
<td>
<p>from apc.indiv.design.model only, the implied model formula as a character string. RHS only if dep.var not specified. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zoe Fannon &lt;zoe.fannon@economics.ox.ac.uk&gt; 26 Jun 2020</p>


<h3>References</h3>

<p>Fannon, Z. (2018) <code>apc.indiv</code>: R tools to estimate age-period-cohort models with
repeated cross section data. Mimeo. University of Oxford.
</p>
<p>Fannon, Z., Monden, C. and Nielsen, B. (2018) Age-period-cohort modelling and
covariates, with an application to obesity in England 2001-2014. Mimeo. 
University of Oxford.
</p>


<h3>See Also</h3>

<p>For model estimation: <code>glm</code>, <code>svyglm</code>, <code>plm</code>
For model testing: <code>apc.indiv.model.table</code>, codeapc.indiv.compare.direct, <code>waldtest</code>, <code>linearHypothesis</code>
For plotting: <code>apc.plot.fit</code>.
The data in these examples are the
<code>Wage</code> data from the package ISLR
and the
<code>PSID7682</code> data from the package AER.
</p>
<p>For examples, see the vignette
<a href="../doc/IntroductionIndividualData.pdf"><code>IntroductionIndividualData.pdf</code></a>,
<a href="../doc/IntroductionIndividualData.R"><code>IntroductionIndividualData.R</code></a>
on
<a href="../doc/index.html"><code>Vignettes</code></a>.
Further examples in the vignette
<a href="../doc/IntroductionIndividualDataFurtherExamples.pdf"><code>IntroductionIndividualDataFurtherExamples.pdf</code></a>,
<a href="../doc/IntroductionIndividualDataFurtherExamples.R"><code>IntroductionIndividualDataFurtherExamples.R</code></a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### see vignettes
</code></pre>


</div>