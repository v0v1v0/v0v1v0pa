<div class="container">

<table style="width: 100%;"><tr>
<td>Q.AR1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision matrix for an AR1 process</h2>

<h3>Description</h3>

<p>Functions for creating precision matricies and observations of
an AR1 process
</p>


<h3>Usage</h3>

<pre><code class="language-R">Q.AR1(M, sigma, rho, sparse=FALSE, vcov=FALSE)

r.AR1(n, M, sigma, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>int &gt; 0, number of elements in the AR1 process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>float &gt; 0, pairwise observation standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>float &gt;= 0 &amp; &lt; 1, how correlated pairwise observations are. The
function will still run with values outside of the range [0,1) however the
stability of the simulation results are not gaurunteed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>bool Should the matrix be of class 'dsCMatrix'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>bool If the vcov matrix should be returned instead of the
precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>int &gt; 0, number of observations to simulate from the GMRF.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Q.AR1 returns either a precision or variance-covariance function
with a AR1 structure.
</p>
<p>r.AR1 retrurns a matrix with n rows which are the n observations of a
Gaussian Markov random field  AR1 process.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("ggplot2")
# simulate AR1 GMRF
obs &lt;- r.AR1(100, M=30, sigma=1, rho=.98)
# resulting matrix is n x M
dim(obs)
# subtract off the first time point to more easily observe correlation
obs_adj &lt;- obs - obs[,1]
# move objects to a data frame
ar1_df &lt;- data.frame(obs=c(t(obs_adj)), realization=rep(1:100, each=30),
                     time=rep(1:30, 100))
# plot each realization
ggplot(data=ar1_df, aes(time, obs, group=realization, color=realization)) +
    geom_line()

</code></pre>


</div>