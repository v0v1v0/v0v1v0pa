<div class="container">

<table style="width: 100%;"><tr>
<td>mahasuhab</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Habitat Suitability Mapping with Mahalanobis Distances.</h2>

<h3>Description</h3>

<p>This function computes the habitat suitability map of an area
for a species, given a set of locations of the species occurences (Clark
et al. 1993).  This function is
to be used in habitat selection studies, when animals are not
identified.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mahasuhab(x, pts, type = c("distance", "probability"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a raster map of class <code>SpatialPixelsDataFrame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>a data frame with two columns, giving the coordinates
of the species locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character string. Whether the raw <code>"distance"</code> should be
returned, or rather the <code>"probability"</code> (see details). </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let assume that a set of locations of the species on an area is available
(gathered on transects, or during the monitoring of the population,
etc.).  If we assume that the probability of detecting an individual
is independent from the habitat variables, then we can consider that
the habitat found at these sites reflects the habitat use by the animals.
</p>
<p>The Mahalanobis distances method has become more and more popular
during the past few years to derive habitat suitability maps.  The
niche of a species is defined as the probability density function of
presence of a species in the multidimensionnal space defined by the
habitat variables.  If this function can be assumed to
be multivariate normal, then the mean vector of this distribution
corresponds to the optimum for the species.
</p>
<p>The function <code>mahasuhab</code> first computes this mean vector as well
as the variance-covariance matrix of the niche density function, based
on the value of habitat variables in the sample of locations.
Then, the *squared* Mahalanobis distance from this optimum is computed
for each pixel of the map.  Thus, the smaller this squared
distance is for a given pixel, and the better is the habitat in this
pixel.
</p>
<p>Assuming multivariate normality, squared Mahalanobis distances are
approximately distributed as Chi-square with n degrees of freedom,
where n equals the number of habitat characteristics (see the section
note below on this question).  If the
argument <code>type = "probability"</code>, maps of these p-values are
returned by the function. As such these are the probabilities of a
larger squared Mahalanobis distance than that observed when x is
sampled from the niche.
</p>


<h3>Value</h3>

<p>Returns a raster map of class <code>SpatialPixelsDataFrame</code>.
</p>


<h3>Note</h3>

<p>The computation of the squared Mahalanobis distances inverts the
variance-covariance matrix of the niche density function (see
<code>?mahalanobis</code>).
It is therefore important that the habitat variables considered
are not too correlated among each other.  When the habitat variables
are too correlated, the variance-covariance matrix is singular and
cannot be inverted.
</p>
<p>Note also that it is recommended to scale the variables before the
computation, so that they all have the same variance, and therefore
the same weight in the analysis (see examples below).
</p>
<p>Finally, note that in versions of adehabitatHS prior to 0.3.16,
<code>mahasuhab</code> incorrectly calculated the probability, when
<code>type = "probability"</code>, based on a Chi-square with (n-1) degrees
of freedom instead of n degrees of freedom (see Etherington 2019 on
this issue). 
</p>


<h3>Author(s)</h3>

<p> Clement Calenge <a href="mailto:clement.calenge@ofb.gouv.fr">clement.calenge@ofb.gouv.fr</a> </p>


<h3>References</h3>

<p>Clark, J.D., Dunn, J.E. and Smith, K.G. (1993) A multivariate model of
female black bear habitat use for a geographic information
system. <em>Journal of Wildlife Management</em>, <b>57</b>, 519â€“526.
</p>
<p>Etherington, T.R. (2019) Mahalanobis distances and ecological niche
modelling: correcting a chi-squared probability error. <em>Peer J</em>,
<b>7</b>, e6678.
</p>


<h3>See Also</h3>

 <p><code>madifa</code> and <code>dunnfa</code> for factor
analyses of the Mahalanobis distances, <code>domain</code> for
another method of habitat suitability mapping,
<code>mahalanobis</code> for
information on the computation of Mahalanobis distances. </p>


<h3>Examples</h3>

<pre><code class="language-R">## loads the data
data(lynxjura)
ma &lt;- lynxjura$map
lo &lt;- lynxjura$locs[,1:2]

## We first scale the maps
slot(ma, "data") &lt;- dudi.pca(slot(ma, "data"), scannf=FALSE)$tab

## habitat suitability mapping
hsm &lt;- mahasuhab(ma, lo, type = "probability")
image(hsm)
title(main = "Habitat suitability map for the Lynx")
points(lo, pch = 3)

</code></pre>


</div>