<div class="container">

<table style="width: 100%;"><tr>
<td>simDM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate count data under the dynamic N-mixture model of Dail-Madsen
</h2>

<h3>Description</h3>

<p>Simulation for multiple-visit data (from <code>pcountOpen</code> help file in package <span class="pkg">unmarked</span>). <code>simDM0</code> has no covariates while <code>simDM</code> allows for covariates. Both functions assume constant time intervals between primary periods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simDM0(nsites = 50, nsurveys = 3, nyears = 5,
  lambda = 4, gamma = 1.5, phi = 0.8, p = 0.7, show.plots=TRUE)

simDM(nsites = 50, nsurveys = 3, nyears = 5,
  mean.lambda = 4, mean.gamma.rel = 0.5,
  mean.phi = 0.8, mean.p = 0.7,
  beta.lam = 1, beta.gamma = 1, beta.phi = -1, beta.p = -1,
  show.plots=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsites</code></td>
<td>

<p>number of sites.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsurveys</code></td>
<td>

<p>number of replicate (secondary) samples within period of closure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nyears</code></td>
<td>

<p>number of primary samples: years, seasons etc.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>Initial expected abundance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>

<p>recruitment rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>apparent survival rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>detection probability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lambda</code></td>
<td>

<p>Initial expected abundance at cov.lam = 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.gamma.rel</code></td>
<td>

<p>recruitment rate at cov.gamma = 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.phi</code></td>
<td>

<p>apparent survival rate at cov.phi = 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.p</code></td>
<td>

<p>detection probability at cov.p = 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.lam</code></td>
<td>

<p>the slope of parameter lambda (link transformed) on the cov.lam covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.gamma</code></td>
<td>

<p>the slope of parameter gamma (link transformed) on the cov.gamma covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.phi</code></td>
<td>

<p>the slope of parameter phi (link transformed) on the cov.phi covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p</code></td>
<td>

<p>the slope of parameter p (link transformed) on the cov.p covariate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plots</code></td>
<td>

<p>if TRUE, plots are produced. Set this to FALSE when running simulations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>For <code>simDM0</code>, a list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>true number of individuals, nsites x nyears</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S </code></td>
<td>
<p>number of survivors, nsites x (nyears-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R </code></td>
<td>
<p>number of recruits, nsites x (nyears-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y </code></td>
<td>
<p>number detected, nsites x nyears x nsurveys</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yy </code></td>
<td>
<p>number detected as a matrix, nsites x (nyears*nsurveys)</p>
</td>
</tr>
</table>
<p><code>simDM</code> has the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cov.lam </code></td>
<td>
<p>covariate for lambda generated from Uniform(-1, 1), nsites vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.gamma </code></td>
<td>
<p>covariate for gamma generated from Uniform(-1, 1), nsites vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.phi </code></td>
<td>
<p>covariate for phi generated from Uniform(-1, 1), nsites vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.p </code></td>
<td>
<p>covariate for p generated from Uniform(-1, 1), nsites x nyears x nsurveys</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccov.p </code></td>
<td>
<p>cov.p formatted as a matrix, nsites x (nyears*nsurveys)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, based in part on code written by Richard Chandler.
</p>


<h3>References</h3>

<p>Dail, D. &amp; Madsen, L. (2011) Models for estimating abundance from repeated counts of an open metapopulation. <em>Biometrics</em>, 67, 577-587.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.5.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Simulate a data set with the default arguments and look at the structure of the output:
tmp0 &lt;- simDM0()
str(tmp0)

tmp &lt;- simDM()
str(tmp)

</code></pre>


</div>