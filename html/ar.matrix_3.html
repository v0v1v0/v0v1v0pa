<div class="container">

<table style="width: 100%;"><tr>
<td>Q.lCAR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Precision matrix for a pCAR process</h2>

<h3>Description</h3>

<p>Functions for creating precision matricies and observations
of a Leroux CAR(lCAR) process as defined in MacNab 2011. The matrix defines
the precision of estimates when observations share connections which are
conditionally auto-regressive(CAR).
</p>


<h3>Usage</h3>

<pre><code class="language-R">Q.lCAR(graph, sigma, rho, sparse=FALSE, vcov=FALSE)

r.lCAR(n, graph, sigma, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>matrix, square matrix indicating where two observations are
connected (and therefore conditionally auto-regressive).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>float &gt; 0, process standard derviation see MacNab 2011.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>float &gt;= 0 &amp; &lt; 1, how correlated neighbors are. The
function will still run with values outside of the range [0,1) however the
stability of the simulation results are not gaurunteed. see MacNab 2011.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>bool Should the matrix be of class 'dsCMatrix'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>bool If the vcov matrix should be returned instead of the
precision matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>int &gt; 0, number of observations to simulate from the GMRF.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Q.lCAR returns either a precision or variance-covariance function
with a lCAR structure.
</p>
<p>r.lCAR retrurns a matrix with n rows which are the n observations of a
Gaussian Markov random field lCAR process.
</p>


<h3>References</h3>

<p>Y.C. MacNab On Gaussian Markov random fields and Bayesian
disease mapping. Statistical Methods in Medical Research. 2011.
</p>


<h3>Examples</h3>

<pre><code class="language-R">require("leaflet")
require("sp")

# simulate lCAR data and attach to spatial polygons data frame
US.df@data$data &lt;- c(r.lCAR(1, graph=US.graph, sigma=1, rho=.99))

# color palette of data
pal &lt;- colorNumeric(palette="YlGnBu", domain=US.df@data$data)

# see map
map1&lt;-leaflet() %&gt;%
    addProviderTiles("CartoDB.Positron") %&gt;%
    addPolygons(data=US.df, fillColor=~pal(data), color="#b2aeae",
                fillOpacity=0.7, weight=0.3, smoothFactor=0.2) %&gt;%
    addLegend("bottomright", pal=pal, values=US.df$data, title="", opacity=1)
map1

</code></pre>


</div>