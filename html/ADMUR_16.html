<div class="container">

<table style="width: 100%;"><tr>
<td>objectiveFunction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Objective function to be minimised in a search. Returns the negative log likelihood.</h2>

<h3>Description</h3>

<p>Calculates the negative log likelihood of a model given a calibrated date matrix.</p>


<h3>Usage</h3>

<pre><code class="language-R">objectiveFunction(pars, PDarray, type, taphonomy=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>A numeric vector of parameters. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PDarray</code></td>
<td>

<p>A data frame typically generated by <code>phaseCalibrator</code>, such that each column represents the PD of each calibrated date (or phase), and row names are the corresponding years.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Choose from 'CPL', 'exponential', or 'uniform'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taphonomy</code></td>
<td>

<p>If TRUE, the last two parameters determine the taphonomic loss rate.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If type is 'CPL', pars must be an odd length each between 0 and 1 since parameters correspond to: (y,x,...y). 
If type is 'exp', pars must be a single positive or negative numeric (the exponential rate can be growth or decay). Typically this parameter should be close to zero (-0.1 to 0.1) to avoid numbers beyond floating point limits) 
If type is 'norm', pars must have length 2 (mean and sd)
If type is 'uniform', then no parameters are required, and pars must be NULL or c(). 
</p>


<h3>Value</h3>

<p>Returns a single value, the negative log likelihood.
</p>


<h3>Examples</h3>

<pre><code class="language-R">	# generate a PD array from a handful of dates
	data &lt;- subset(SAAD, site %in% c('Carrizal','Pacopampa'))
	CalArray &lt;- makeCalArray(shcal13, calrange = c(2000,6000))
	PD &lt;- phaseCalibrator(data, CalArray)

	# the negative log likelihood given some random parameters for a 3-CPL model
	pars &lt;- runif(5)
	objectiveFunction(pars, PD, type='CPL')	

	# the negative log likelihood given a random exponential model
	pars &lt;- runif(1, -0.01, 0.01)
	objectiveFunction(pars, PD, type='exp')	

	# the negative log likelihood given a random Gaussian model
	pars &lt;- c(runif(1, 2000, 6000), runif(1, 100, 1000))
	objectiveFunction(pars, PD, type='norm')	

	# the negative log likelihood given a uniform model
	objectiveFunction(pars=NULL, PD, type='uniform')	

	# the negative log likelihood given a uniform model with taphonomy
	pars &lt;- c(runif(1, 0, 20000), runif(1, -3, 0))
	objectiveFunction(pars=pars, PD, type='uniform', taphonomy=TRUE)	
</code></pre>


</div>