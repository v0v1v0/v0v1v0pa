<div class="container">

<table style="width: 100%;"><tr>
<td>mafragh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phyto-Ecological Survey</h2>

<h3>Description</h3>

<p>This data set gives environmental and spatial informations about species and 
sites.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data(mafragh)</code></pre>


<h3>Format</h3>

<p><code>mafragh</code> is a list with the following components:
</p>

<dl>
<dt>xy</dt>
<dd>
<p>the coordinates of 97 sites</p>
</dd>
<dt>flo</dt>
<dd>
<p>a data frame with 97 sites and 56 species</p>
</dd>
<dt>neig</dt>
<dd>
<p>the neighbourhood graph of the 97 sites (an object of class <code>neig</code>)</p>
</dd>
<dt>env</dt>
<dd>
<p>a data frame with 97 sites and 11 environmental variables</p>
</dd>
<dt>partition</dt>
<dd>
<p>a factor classifying the 97 sites in 7 classes</p>
</dd>
<dt>area</dt>
<dd>
<p>a data frame of class <code>area</code></p>
</dd>
<dt>tre</dt>
<dd>
<p>a character providing the phylogeny as a newick object</p>
</dd>
<dt>traits</dt>
<dd>
<p>a list of data frame. Each data frame provides the value of biological traits for plant species</p>
</dd>
<dt>nb</dt>
<dd>
<p>the neighbourhood graph of the 97 Mafragh sites (an object of class <code>nb</code>)</p>
</dd>
<dt>Spatial</dt>
<dd>
<p>the map of the 97 Mafragh sites (an object of the class <code>SpatialPolygons</code> of <code>sp</code>)</p>
</dd>
<dt>spenames</dt>
<dd>
<p>a data frame with 56 rows (species) and 2 columns (names)</p>
</dd>
<dt>Spatial.contour</dt>
<dd>
<p>the contour of the Magragh map (an object of the class <code>SpatialPolygons</code> of <code>sp</code>)</p>
</dd>
</dl>
<h3>Source</h3>

<p>de Bélair, Gérard and Bencheikh-Lehocine, Mahmoud (1987) Composition et déterminisme de la végétation d'une 
plaine côtière marécageuse : La Mafragh (Annaba, Algérie). <em>Bulletin d'Ecologie</em>, <b>18</b>(4), 393–407.
</p>
<p>Pavoine, S., Vela, E., Gachet, S., de Bélair, G. and Bonsall, M. B. (2011)
Linking patterns in phylogeny, traits, abiotic variables and space: a novel approach to linking environmental filtering and plant community assembly. 
<em>Journal of Ecology</em>, <b>99</b>, 165–175. doi:10.1111/j.1365-2745.2010.01743.x
</p>


<h3>References</h3>

<p>See a data description at <a href="http://pbil.univ-lyon1.fr/R/pdf/pps053.pdf">http://pbil.univ-lyon1.fr/R/pdf/pps053.pdf</a> (in French).</p>


<h3>Examples</h3>

<pre><code class="language-R">data(mafragh)
coa1 &lt;- dudi.coa(mafragh$flo, scan = FALSE)
pca1 &lt;- dudi.pca(mafragh$xy, scan = FALSE)
if(adegraphicsLoaded()) {
  g1 &lt;- s.label(mafragh$xy, nb = mafragh$nb, psub.text = "Samples &amp; Neighbourhood graph", 
    plot = FALSE)
  g2 &lt;- s.value(mafragh$xy, coa1$li[, 1], psub.text = "Axis 1 - COA", plot = FALSE)
  g3 &lt;- s.value(mafragh$xy, pca1$li[, 1], psub.text = "Axis 1 - PCA", plot = FALSE)
  g4 &lt;- s.class(pca1$li, mafragh$partition, psub.text = "Plane 1-2 - PCA", plot = FALSE)
  g5 &lt;- s.class(coa1$li, mafragh$partition, psub.text = "Plane 1-2 - COA", plot = FALSE)
  g6 &lt;- s.class(mafragh$xy, mafragh$partition, chullSize = 1, ellipseSize = 0, starSize = 0, 
    ppoints.cex = 0, plot = FALSE)
  G &lt;- ADEgS(c(g1, g2, g3, g4, g5, g6), layout = c(3, 2))

} else {
  par(mfrow = c(3, 2))
  s.label(mafragh$xy, inc = FALSE, neig = mafragh$neig, sub = "Samples &amp; Neighbourhood graph")
  s.value(mafragh$xy, coa1$li[, 1], sub = "Axis 1 - COA")
  s.value(mafragh$xy, pca1$li[, 1], sub = "Axis 1 - PCA")
  s.class(pca1$li, mafragh$partition, sub = "Plane 1-2 - PCA")
  s.class(coa1$li, mafragh$partition, sub = "Plane 1-2 - COA")
  s.chull(mafragh$xy, mafragh$partition, optchull = 1)
  par(mfrow = c(1, 1))
}

## Not run: 
link1 &lt;- area2link(mafragh$area)
neig1 &lt;- neig(mat01 = 1*(link1 &gt; 0))
nb1 &lt;- neig2nb(neig1)

if(adegraphicsLoaded()) {
  if(requireNamespace("sp", quietly = TRUE)) {
    g7 &lt;- s.label(mafragh$xy, Sp = mafragh$Spatial, pSp.col = "white", plot = FALSE)
    g8 &lt;- s.label(mafragh$xy, Sp = mafragh$Spatial, pSp.col = "white", nb = nb1, plab.cex = 0, 
      pnb.node.cex = 0, ppoints.cex = 0, plot = FALSE)
    G &lt;- ADEgS(c(g7, g8), layout = c(2, 1))
  }

} else {
  par(mfrow = c(2, 1))
  area.plot(mafragh$area, center = mafragh$xy, clab = 0.75)
  area.plot(mafragh$area, center = mafragh$xy, graph = neig1)
  par(mfrow = c(1, 1))
}

if(requireNamespace("spdep", quietly = TRUE)) {
  lw1 &lt;- apply(link1, 1, function(x) x[x &gt; 0])
  listw1 &lt;- spdep::nb2listw(nb1, lw1)
  coa1 &lt;- dudi.coa(mafragh$flo, scan = FALSE, nf = 4)
  ms1 &lt;- multispati(coa1, listw1, scan = FALSE, nfp = 2, nfn = 0)
  summary(ms1)
  
  if(adegraphicsLoaded()) {
    if(requireNamespace("lattice", quietly = TRUE)) {
      g9 &lt;- s1d.barchart(coa1$eig, p1d.hori = FALSE, plot = FALSE)
      g10 &lt;- s1d.barchart(ms1$eig, p1d.hori = FALSE, plot = FALSE)
      g11 &lt;- s.corcircle(ms1$as, plot = FALSE)
      g12 &lt;- lattice::xyplot(ms1$li[, 1] ~ coa1$li[, 1])
      G &lt;- ADEgS(list(g9, g10, g11, g12), layout = c(2, 2))
    }
    
  } else {    
    par(mfrow = c(2, 2))
    barplot(coa1$eig)
    barplot(ms1$eig)
    s.corcircle(ms1$as)
    plot(coa1$li[, 1], ms1$li[, 1])
    par(mfrow = c(1, 1))
  }
}

## End(Not run)</code></pre>


</div>