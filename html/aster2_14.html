<div class="container">

<table style="width: 100%;"><tr>
<td>constancy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constancy Spaces for Aster Models</h2>

<h3>Description</h3>

<p>Produce basis for constancy space of an aster model.
Test whether the difference of two canonical parameter vectors is
in the constancy space (so the two parameter vectors correspond
to the same probability model).
</p>


<h3>Usage</h3>

<pre><code class="language-R">constancy(data, parm.type = c("theta", "phi"))
is.same(parm1, parm2, data, parm.type = c("theta", "phi"),
    tolerance = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an object of class <code>"asterdata"</code> produced by
<code>asterdata</code> or “by hand” such that
<code>is.validasterdata(data)</code> returns <code>TRUE</code>.  The specification
of the aster model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm.type</code></td>
<td>
<p>the parametrization for which the constancy space is wanted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm1</code></td>
<td>
<p>a parameter vector of the type specified by <code>parm.type</code>
for the saturated aster model specified by <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parm2</code></td>
<td>
<p>another parameter vector of the type specified
by <code>parm.type</code> for the saturated aster model specified
by <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>numeric &gt;= 0.  Relative errors smaller
than <code>tolerance</code> are not considered in the comparison.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There is no need for functions to test whether different mean value parameters
(<code class="reqn">\xi</code> or <code class="reqn">\mu</code>) correspond to the same probability
distribution because these parametrizations are identifiable (different valid
parameter vectors correspond to different probability distributions).
</p>


<h3>Value</h3>

<p>for <code>is.same</code> a logical value;
for <code>constancy</code>
a matrix whose rows constitute a basis for the constancy space.
This means that if <code class="reqn">\delta</code> is a linear combination of rows
of this matrix then for all real <code class="reqn">s</code> the distributions having parameter
vectors <code class="reqn">\psi</code> and <code class="reqn">\psi + s \delta</code> are the
same, where <code class="reqn">\psi = \theta</code>
or <code class="reqn">\psi = \varphi</code> depending on whether
<code>parm.type = "theta"</code> or <code>parm.type = "phi"</code>.
Conversely, if <code class="reqn">\psi_1</code> and <code class="reqn">\psi_2</code> are valid parameter
vectors of the same type, then they correspond to the same probability
distribution only if <code class="reqn">\psi_1 - \psi_2</code> is a linear
combination of rows of this matrix.
</p>


<h3>See Also</h3>

<p><code>asterdata</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(test1)
fred &lt;- asterdata(test1,
    vars = c("m1", "m2", "m3", "n1", "n2", "b1", "p1", "z1"),
    pred = c(0, 0, 0, 1, 1, 2, 3, 6), group = c(0, 1, 2, 0, 4, 0, 0, 0),
    code = c(1, 1, 1, 2, 2, 3, 4, 5),
    families = list(fam.multinomial(3), "normal.location.scale",
    "bernoulli", "poisson", "zero.truncated.poisson"))
cmat &lt;- constancy(fred, parm.type = "phi")
</code></pre>


</div>