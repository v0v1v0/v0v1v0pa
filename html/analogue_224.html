<div class="container">

<table style="width: 100%;"><tr>
<td>residLen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Squared residual length diagnostics</h2>

<h3>Description</h3>

<p>The squared residual length between the fitted values of a constrained
ordination and the original species data is one diagnostic for
transfer function models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">residLen(X, env, passive, method = c("cca","rda"))

fittedY(ord, newdata, colsum)

sqrlLinear(Y, fitted)

sqrlUnimodal(Y, colsum, fitted)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>data frame; the training set species data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>vector; the training set environmental data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>passive</code></td>
<td>
<p>data frame; the passive samples species data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the ordination technique to use. One of <code>"rda"</code> or
<code>"cca"</code>, with the latter the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ord</code></td>
<td>
<p>an ordination object, the result of a call to
<code>cca</code> or <code>rda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>Species data matrix for passive samples. Must have same
columns as data used to fit <code>ord</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colsum</code></td>
<td>
<p>column (species) sums for training set data used to fit
<code>ord</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Original species data matrix, the response for which squared
residual lengths are to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>The fitted values of the response derived from the
constrained ordination model.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The squared residual lengths are computed for the training set samples
and the passive samples separately. Passive samples that are poorly
fitted in the transfer function model will have large squared residual
distances between the observed species data and the fitted values from
the constrained ordination.
</p>
<p><code>residLen</code> is the main user-interface function and can be called
with either the training data and passive samples.
</p>
<p><code>fittedY</code> returns the fitted approximation of the passive sample
response data (i.e. species data). <code>sqrlLinear</code> and
<code>sqrlUnimodal</code> return the squared residual distances between the
observed species data and the fitted values from the constrained
ordination model.
</p>


<h3>Value</h3>

<p><code>fittedY</code> returns a matrix of fitted species abundances for
passive samples.
</p>
<p><code>sqrlLinear</code> and <code>sqrlUnimodal</code> return a vector of
residual distances.
</p>
<p><code>residLen</code> returns an object of class <code>"residLen"</code> with the
attribute <code>"method"</code> set to <code>"method"</code>. This object is a
list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>train, passive</code></td>
<td>
<p>The squared residual lengths for the training
set and the passive samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ordination</code></td>
<td>
<p>The fitted ordination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>References</h3>

<p>Ter Braak C.J.F. and Smilauer P. (2002) CANOCO Reference manual and
CanoDraw for Windows User's guide: Software for Canonical Ordination
(version 4.5). Microcomputer Power (Ithaca, NY, USA), 500pp.
</p>


<h3>See Also</h3>

<p><code>cca</code> and <code>predict.cca</code> for some
of the underlying computations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load the Imbrie and Kipp example data
data(ImbrieKipp, SumSST, V12.122)

## squared residual lengths for Core V12.122
rlens &lt;- residLen(ImbrieKipp, SumSST, V12.122)
rlens

## as before but using linear RDA
residLen(ImbrieKipp, SumSST, V12.122, method = "rda")
</code></pre>


</div>