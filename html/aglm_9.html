<div class="container">

<table style="width: 100%;"><tr>
<td>cva.aglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an AGLM model with cross-validation for both <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code>
</h2>

<h3>Description</h3>

<p>A fitting function with cross-validation for both <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code>.
See aglm-package for more details on <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cva.aglm(
  x,
  y,
  alpha = seq(0, 1, len = 11)^3,
  nfolds = 10,
  foldid = NULL,
  parallel.alpha = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A design matrix.
See aglm for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numeric vector representing <code class="reqn">\alpha</code> values to be examined in cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>An integer value representing the number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>An integer vector with the same length as observations.
Each element should take a value from 1 to <code>nfolds</code>, identifying which fold it belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel.alpha</code></td>
<td>
<p>(not used yet)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments are passed directly to <code>cv.aglm()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object storing fitted models and information of cross-validation.
See CVA_AccurateGLM-class for more details.
</p>


<h3>Author(s)</h3>


<ul>
<li>
<p> Kenji Kondo,
</p>
</li>
<li>
<p> Kazuhisa Takahashi and Hikari Banno (worked on L-Variable related features)
</p>
</li>
</ul>
<h3>References</h3>

<p>Suguru Fujita, Toyoto Tanaka, Kenji Kondo and Hirokazu Iwasawa. (2020)
<em>AGLM: A Hybrid Modeling Method of GLM and Data Science Techniques</em>, <br><a href="https://www.institutdesactuaires.com/global/gene/link.php?doc_id=16273&amp;fg=1">https://www.institutdesactuaires.com/global/gene/link.php?doc_id=16273&amp;fg=1</a> <br><em>Actuarial Colloquium Paris 2020</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#################### Cross-validation for alpha and lambda ####################

library(aglm)
library(faraway)

## Read data
xy &lt;- nes96

## Split data into train and test
n &lt;- nrow(xy) # Sample size.
set.seed(2018) # For reproducibility.
test.id &lt;- sample(n, round(n/5)) # ID numbders for test data.
test &lt;- xy[test.id,] # test is the data.frame for testing.
train &lt;- xy[-test.id,] # train is the data.frame for training.
x &lt;- train[, c("popul", "TVnews", "selfLR", "ClinLR", "DoleLR", "PID", "age", "educ", "income")]
y &lt;- train$vote
newx &lt;- test[, c("popul", "TVnews", "selfLR", "ClinLR", "DoleLR", "PID", "age", "educ", "income")]

# NOTE: Codes bellow will take considerable time, so run it when you have time.


## Fit the model
cva_result &lt;- cva.aglm(x, y, family="binomial")

alpha &lt;- cva_result@alpha.min
lambda &lt;- cva_result@lambda.min

mod_idx &lt;- cva_result@alpha.min.index
model &lt;- cva_result@models_list[[mod_idx]]

## Make the confusion matrix
y_true &lt;- test$vote
y_pred &lt;- levels(y_true)[as.integer(predict(model, newx, s=lambda, type="class"))]

cat(sprintf("Confusion matrix for alpha=%.5f and lambda=%.5f:\n", alpha, lambda))
print(table(y_true, y_pred))


</code></pre>


</div>