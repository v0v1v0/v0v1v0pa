<div class="container">

<table style="width: 100%;"><tr>
<td>interCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Copula Based Maximum Likelihood Estimator
</h2>

<h3>Description</h3>

<p>The inter correlation parameter can be estimated by fitting a Gaussian copula with Vasicek distributed margins on two observed default rate time series. The estimated parameter is the inter correlation of the systematic factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">interCopula(df1, df2, B = 0, DB=c(0,0),JC = FALSE, 
 CI, CI_Boot, type="bca", plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df1</code></td>
<td>
<p>a vector, containing the default rate time series of sector 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df2</code></td>
<td>
<p>a vector, containing the default rate times eries of sector 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>an integer, indicating how many bootstrap repetitions should be used for the single bootstrap corrected estimate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DB</code></td>
<td>
<p>a combined vector, indicating how many bootstrap repetitions should be used for the inner (first entry) and outer loop (second entry) to correct the bias using the double bootstrap.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>JC</code></td>
<td>
<p> a logical variable, indicating if the jackknife corrected estimate should be calculated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>a number, indicating the desired asymptotic confidence interval of the estimate. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>a number, indicating the desired bootstrap confidence interval if the single bootstrap correction is specified. By default, the interval is calculated as the bootstrap corrected and accelerated confidence interval (Bca). Furthermore, the analytical confidence intervals are provided, using the same value as <code>CI_Boot</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string, indicating the desired method to calculate the confidence intervals. For more details see <code>boot.ci</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical variable, indicating whether a plot of the single bootstrap density should be generated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function estimates the inter correlation of the systematic factors. In general the inter correlation can be estimated for the asset variables or the systematic factors. This method estimates the inter correlation of the systematic factors. The parameter will be estimated via Maximum Likelihood estimation, which ensures that an asymptotic confidence interval can be provided. The inter correlation of the systematic factors can be transformed to the correlation of the asset variables as follows:
</p>
<p style="text-align: center;"><code class="reqn">rho_Asset= rho_Systematic*sqrt(rho_1*rho_2)</code>
</p>

<p>The estimated inter correlation of the systematic factors lies between -1 and 1.
If <code>DB</code> is specified, the single bootstrap corrected estimate will be calculated using the bootstrap values of the outer loop (<code>oValues</code>).
</p>


<h3>Value</h3>

<p>The returned value is a list, containing the following components (depending on the selected arguments):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Original</code></td>
<td>
<p>Estimate of the original method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bootstrap</code></td>
<td>
<p>Bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Double_Bootstrap</code></td>
<td>
<p>Double bootstrap corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jackknife</code></td>
<td>
<p>Jackknife corrected estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>Selected two-sided asymptotic bootstrap confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_Boot</code></td>
<td>
<p>Selected two-sided bootstrap confidence interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bValues</code></td>
<td>
<p>Estimates from the bootstrap resampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- inner loop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oValues</code></td>
<td>
<p>Estimates from the double bootstrap resampling- outer loop</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chang J, Hall P (2015).
“Double-bootstrap methods that use a single double-bootstrap simulation.”
<em>Biometrika</em>, <b>102</b>(1), 203–214.
</p>
<p>Efron B, Tibshirani RJ (1994).
<em>An introduction to the bootstrap</em>.
CRC press.
</p>
<p>Pfeuffer M, Nagl M, Fischer M, Roesch D (2020).
“Parameter Estimation and Bias Correction in the Vasicek Credit Portfolio Model.”
<em>Journal of Risk</em>, <b>22number</b>.
</p>


<h3>See Also</h3>

<p><code>interJDP</code>, <code>interCMM</code>, <code>interMLE</code>, <code>interCov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)
d1=defaultTimeseries(1000,0.1,10,0.01)
d2=defaultTimeseries(1000,0.2,10,0.01)
n=rep(1000,10)

df1=d1/n
df2=d2/n

InterCorr=interCopula(df1,df2, CI=0.95)



InterCorr=interCopula(df1,df2, JC=TRUE)

InterCorr=interCopula(df1,df2, B=1000, CI_Boot=0.95, plot=TRUE)

InterCorr=interCopula(df1,df2, DB=c(50,50))


</code></pre>


</div>