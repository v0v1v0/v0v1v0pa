<div class="container">

<table style="width: 100%;"><tr>
<td>table.phylo4d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical display of phylogeny and traits</h2>

<h3>Description</h3>

<p>This function represents traits onto the tips of a phylogeny. Plotted objects
must be valid phylo4d objects (implemented by the 
<code>phylobase</code> package). Current version allows plotting of a tree and one 
or more quantitative traits (possibly containing missing data, represented by
an 'x').<br></p>


<h3>Usage</h3>

<pre><code class="language-R">table.phylo4d(
  x,
  treetype = c("phylogram", "cladogram"),
  symbol = c("circles", "squares", "colors"),
  repVar = 1:ncol(tdata(x, type = "tip")),
  center = TRUE,
  scale = TRUE,
  legend = TRUE,
  grid = TRUE,
  box = TRUE,
  show.tip.label = TRUE,
  show.node.label = TRUE,
  show.var.label = TRUE,
  ratio.tree = 1/3,
  font = 3,
  tip.label = tipLabels(x),
  var.label = colnames(tdata(x, type = "tip")),
  cex.symbol = 1,
  cex.label = 1,
  cex.legend = 1,
  pch = 20,
  col = heat.colors(100),
  coord.legend = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a phylo4d object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treetype</code></td>
<td>
<p>the type of tree to be plotted ("phylogram" or "cladogram")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbol</code></td>
<td>
<p>the type of symbol used to represent data ("circles", 
"squares", or "colors")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repVar</code></td>
<td>
<p>the numerical index of variables to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a logical stating whether variables should be centred (TRUE, 
default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>a logical stating whether variables should be scaled (TRUE, 
default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a logical stating whether a legend should be added to the plot 
(TRUE) or not (FALSE, default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>a logical stating whether a grid should be added to the plot 
(TRUE, default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>box</code></td>
<td>
<p>a logical stating whether a box should be added around the plot 
(TRUE, default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.tip.label</code></td>
<td>
<p>a logical stating whether tip labels should be printed 
(TRUE, default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.node.label</code></td>
<td>
<p>a logical stating whether node labels should be 
printed (TRUE, default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.var.label</code></td>
<td>
<p>a logical stating whether labels of variables should be
printed (TRUE, default) or not (FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio.tree</code></td>
<td>
<p>the proportion of width of the figure occupied by the tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>an integer specifying the type of font for the labels: 1 (plain 
text), 2 (bold), 3 (italic, default), or 4 (bold italic).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.label</code></td>
<td>
<p>a character vector giving the tip labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.label</code></td>
<td>
<p>a character vector giving the labels of variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.symbol</code></td>
<td>
<p>a numeric giving the factor scaling the symbols</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.label</code></td>
<td>
<p>a numeric giving the factor scaling all labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>a numeric giving the factor scaling the legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>is <code>symbol</code> is set to 'colors', a number indicating the type 
of point to be plotted (see ?points)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>is <code>symbol</code> is set to 'colors', a vector of colors to be used
to represent the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coord.legend</code></td>
<td>
<p>an optional list with two components 'x' and 'y' 
indicating the lower-left position of the legend. Can be set to 
<code>locator(1) to position the legend interactively.</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to plot methods from <code>ape</code>. 
See <code>plot.phylo</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot of phylogenies is performed by a call to 
<code>plot.phylo</code> from the <code>ape</code> package. Hence, many of the
arguments of <code>plot.phylo</code> can be passed to 
<code>table.phylo4d</code>, through the ... argument, but their names must be 
complete.
</p>
<p>For large trees, consider using <code>bullseye</code>.
</p>
<p>The function <code>table.phylo4d</code> is based on former plot method for 
phylo4d objects from the <code>phylobase</code> package.  It replaces
the deprecated <code>ade4</code> functions <code>symbols.phylog</code> and
<code>table.phylog</code>.
</p>


<h3>Value</h3>

<p>No return value, function produces only a plot.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:tjombart@imperial.ac.uk">tjombart@imperial.ac.uk</a>
</p>


<h3>See Also</h3>

<p>The phylo4d class for storing 
<code>phylogeny+data</code>.<br></p>
<p>For large trees, consider using <code>bullseye</code>.
</p>
<p><code>plot.phylo</code> from the <code>ape</code> package.<br></p>
<p>An alternative (deprecated) representation is available from 
<code>dotchart.phylog</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require(ape) &amp; require(phylobase) &amp; require(ade4)){

## simulated data
tr &lt;- rtree(20)
dat &lt;- data.frame(a = rnorm(20), b = scale(1:20), c=runif(20,-2,2) )
dat[3:6, 2] &lt;- NA # introduce some NAs
obj &lt;- phylo4d(tr, dat) # build a phylo4d object
table.phylo4d(obj) # default scatterplot
table.phylo4d(obj,cex.leg=.6, use.edge.length=FALSE) # customized
table.phylo4d(obj,treetype="clad", show.node=FALSE, cex.leg=.6,
use.edge.length=FALSE, edge.color="blue", edge.width=3) # more customized


## teleost fishes data
data(mjrochet)
temp &lt;- read.tree(text=mjrochet$tre) # make a tree
mjr &lt;- phylo4d(x=temp,tip.data=mjrochet$tab) # male a phylo4d object
table.phylo4d(mjr,cex.lab=.5,show.node=FALSE,symb="square")


## lizards data
data(lizards)
liz.tr &lt;- read.tree(tex=lizards$hprA) # make a tree
liz &lt;- phylo4d(liz.tr, lizards$traits) # make a phylo4d object
table.phylo4d(liz)


## plotting principal components
liz.pca1 &lt;- dudi.pca(lizards$traits, scannf=FALSE, nf=2) # PCA of traits
myPC &lt;- phylo4d(liz.tr, liz.pca1$li) # store PC in a phylo4d object
varlab &lt;- paste("Principal \ncomponent", 1:2) # make labels for PCs
table.phylo4d(myPC, ratio=.8, var.lab=varlab) # plot the PCs
add.scatter.eig(liz.pca1$eig,2,1,2,posi="topleft", inset=c(0,.15))
title("Phylogeny and the principal components")

}

</code></pre>


</div>