<div class="container">

<table style="width: 100%;"><tr>
<td>dnds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>dN/dS Ratio</h2>

<h3>Description</h3>

<p>This function computes the pairwise ratios dN/dS for a set of aligned
DNA sequences using Li's (1993) method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dnds(x, code = 1, codonstart = 1, quiet = FALSE,
     details = FALSE, return.categories = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"DNAbin"</code> (matrix or list) with the
aligned sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>an integer value giving the genetic code to be
used. Currently, the codes 1 to 6 are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>codonstart</code></td>
<td>
<p>an integer giving where to start the translation. This
should be 1, 2, or 3, but larger values are accepted and have for
effect to start the translation further within the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>single logical value: whether to indicate progress of
calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>single logical value (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.categories</code></td>
<td>
<p>a logical value: if <code>TRUE</code>, a matrix of
the same size than <code>x</code> is returned giving the degeneracy category
of each base in the original alignment.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Since <span class="pkg">ape</span> 5.6, the degeneracy of each codon is calculated
directly from the genetic code using the function
<code>trans</code>. A consequence is that ambiguous bases are ignored
(see <code>solveAmbiguousBases</code>).
</p>
<p>If <code>details = TRUE</code>, a table is printed for each pair of
sequences giving the numbers of transitions and transversions for each
category of degeneracy (nondegenerate, twofold, and fourfold). This is
helpful when non-meaningful values are returned (e.g., NaN, Inf,
negative values).
</p>


<h3>Value</h3>

<p>an object of class <code>"dist"</code>, or a numeric matrix if
<code>return.categories = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Li, W.-H. (1993) Unbiased estimation of the rates of synonymous and
nonsynonymous substitution. <em>Journal of Molecular Evolution</em>,
<b>36</b>, 96â€“99.
</p>


<h3>See Also</h3>

<p><code>AAbin</code>, <code>trans</code>, <code>alview</code>,
<code>solveAmbiguousBases</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(woodmouse)
res &lt;- dnds(woodmouse, quiet = TRUE) # NOT correct
res2 &lt;- dnds(woodmouse, code = 2, quiet = TRUE) # using the correct code
identical(res, res2) # FALSE...
cor(res, res2) # ... but very close
## There a few N's in the woodmouse data, but this does not affect
## greatly the results:
res3 &lt;- dnds(solveAmbiguousBases(woodmouse), code = 2, quiet = TRUE)
cor(res, res3)

## a simple example showing the usefulness of 'details = TRUE'
X &lt;- as.DNAbin(matrix(c("C", "A", "G", "G", "T", "T"), 2, 3))
alview(X)
dnds(X, quiet = TRUE) # NaN
dnds(X, details = TRUE) # only a TV at a nondegenerate site
</code></pre>


</div>