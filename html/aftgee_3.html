<div class="container">

<table style="width: 100%;"><tr>
<td>aftgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Least-Squares Approach for Accelerated Failure Time with Generalized Estimating Equation</h2>

<h3>Description</h3>

<p>Fits a semiparametric accelerated failure time (AFT) model with least-squares approach.
Generalized estimating equation is generalized to multivariate AFT modeling to account
for multivariate dependence through working correlation structures to improve efficiency.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aftgee(
  formula,
  data,
  subset,
  id = NULL,
  contrasts = NULL,
  weights = NULL,
  margin = NULL,
  corstr = c("independence", "exchangeable", "ar1", "unstructured", "userdefined",
    "fixed"),
  binit = "srrgehan",
  B = 100,
  control = aftgee.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula expression, of the form <code>response ~ predictors</code>.
The <code>response</code> is a <code>Surv</code> object with right censoring.
In the case of no censoring, <code>aftgee</code> will return an ordinary
least estimate when <code>corstr = "independence"</code>.
See the documentation of <code>lm</code>, <code>coxph</code> and <code>formula</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data.frame in which to interpret the variables occurring
in the <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>an optional vector used to identify the clusters.
If missing, then each individual row of <code>data</code> is presumed to
represent a distinct subject.
The length of <code>id</code> should be the same as the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>an optional list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of observation weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>a <code>sformula</code> vector; default at 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corstr</code></td>
<td>
<p>a character string specifying the correlation structure.
The following are permitted:
</p>

<ul>
<li> <p><code>independence</code>
</p>
</li>
<li> <p><code>exchangeable</code>
</p>
</li>
<li> <p><code>ar1</code>
</p>
</li>
<li> <p><code>unstructured</code>
</p>
</li>
<li> <p><code>userdefined</code>
</p>
</li>
<li> <p><code>fixed</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binit</code></td>
<td>
<p>an optional vector can be either a numeric vector or a character string
specifying the initial slope estimator.
</p>

<ul>
<li>
<p> When <code>binit</code> is a vector, its length should be the same as the
dimension of covariates.
</p>
</li>
<li>
<p> When <code>binit</code> is a character string, it should be either <code>lm</code> for simple linear
regression, or <code>srrgehan</code> for smoothed Gehan weight estimator.
</p>
</li>
</ul>
<p> The default value is "srrgehan".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>a numeric value specifies the resampling number.
When B = 0, only the beta estimate will be displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>controls maxiter and tolerance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class "<code>aftgee</code>" representing the fit.
The <code>aftgee</code> object is a list containing at least the following components:
</p>

<dl>
<dt>coefficients</dt>
<dd>
<p>a vector of initial value and a vector of point estimates</p>
</dd>
<dt>coef.res</dt>
<dd>
<p>a vector of point estimates</p>
</dd>
<dt>var.res</dt>
<dd>
<p>estimated covariance matrix</p>
</dd>
<dt>coef.init</dt>
<dd>
<p>a vector of initial value</p>
</dd>
<dt>var.init.mat</dt>
<dd>
<p>estimated initial covariance matrix</p>
</dd>
<dt>binit</dt>
<dd>
<p>a character string specifying the initial estimator.</p>
</dd>
<dt>conv</dt>
<dd>
<p>An integer code indicating type of convergence after GEE
iteration. 0 indicates successful convergence; 1 indicates that the
iteration limit <code>maxit</code> has been reached</p>
</dd>
<dt>ini.conv</dt>
<dd>
<p>An integer code indicating type of convergence for
initial value. 0 indicates successful convergence; 1 indicates that the
iteration limit <code>maxit</code> has been reached</p>
</dd>
<dt>conv.step</dt>
<dd>
<p>An integer code indicating the step until convergence</p>
</dd>
</dl>
<h3>References</h3>

<p>Chiou, S., Kim, J. and Yan, J. (2014) Marginal Semiparametric Multivariate
Accelerated Failure Time Model with Generalized Estimating Equation.
<em>Lifetime Data Analysis</em>, <b>20</b>(4): 599–618.
</p>
<p>Jin, Z. and Lin, D. Y. and Ying, Z. (2006)
On Least-squares Regression with Censored Data. <em>Biometrika</em>, <b>90</b>, 341–353.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate data from an AFT model with possible depended response
datgen &lt;- function(n = 100, tau = 0.3, dim = 2) {
    x1 &lt;- rbinom(dim * n, 1, 0.5)
    x2 &lt;- rnorm(dim * n)
    e &lt;- c(t(exp(MASS::mvrnorm(n = n, mu = rep(0, dim), Sigma = tau + (1 - tau) * diag(dim)))))
    tt &lt;- exp(2 + x1 + x2 + e)
    cen &lt;- runif(n, 0, 100)
    data.frame(Time = pmin(tt, cen), status = 1 * (tt &lt; cen),
               x1 = x1, x2 = x2, id = rep(1:n, each = dim))
}
set.seed(1); dat &lt;- datgen(n = 50, dim = 2)
fm &lt;- Surv(Time, status) ~ x1 + x2
fit1 &lt;- aftgee(fm, data = dat, id = id, corstr = "ind")
fit2 &lt;- aftgee(fm, data = dat, id = id, corstr = "ex")
summary(fit1)
summary(fit2)

confint(fit1)
confint(fit2)
</code></pre>


</div>