<div class="container">

<table style="width: 100%;"><tr>
<td>merge_p_values</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Merge a list or matrix of p-values</h2>

<h3>Description</h3>

<p>Merge a list or matrix of p-values
</p>


<h3>Usage</h3>

<pre><code class="language-R">merge_p_values(
  scores,
  method = "Fisher",
  scores_direction = NULL,
  constraints_vector = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Either a list/vector of p-values or a matrix where each column is a test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method to merge p-values. See 'methods' section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores_direction</code></td>
<td>
<p>Either a vector of log2 transformed fold-change values or a matrix where each column is a test. 
Must contain the same dimensions as the scores parameter. Datasets without directional information should be set to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constraints_vector</code></td>
<td>
<p>A numerical vector of +1 or -1 values corresponding to the user-defined
directional relationship between the columns in scores_direction. Datasets without directional information should
be set to 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>scores</code> is a vector or list, returns a number. If <code>scores</code> is a
matrix, returns a named list of p-values merged by row.
</p>


<h3>Methods</h3>

<p>Eight methods are available to merge a list of p-values:
</p>

<dl>
<dt>Fisher</dt>
<dd>
<p>Fisher's method (default) assumes that p-values are uniformly
distributed and performs a chi-squared test on the statistic sum(-2 log(p)).
This method is most appropriate when the columns in <code>scores</code> are
independent.</p>
</dd>
<dt>Fisher_directional</dt>
<dd>
<p>Fisher's method modification that allows for 
directional information to be incorporated with the <code>scores_direction</code>
and <code>constraints_vector</code> parameters.</p>
</dd>
<dt>Brown</dt>
<dd>
<p>Brown's method extends Fisher's method by accounting for the
covariance in the columns of <code>scores</code>. It is more appropriate when the
tests of significance used to create the columns in <code>scores</code> are not
necessarily independent. Note that the "Brown" method cannot be used with a 
single list of p-values. However, in this case Brown's method is identical 
to Fisher's method and should be used instead.</p>
</dd>
<dt>DPM</dt>
<dd>
<p>DPM extends Brown's method by incorporating directional information
using the <code>scores_direction</code> and <code>constraints_vector</code> parameters.</p>
</dd>
<dt>Stouffer</dt>
<dd>
<p>Stouffer's method assumes p-values are uniformly distributed
and transforms p-values into a Z-score using the cumulative distribution function of a
standard normal distribution. This method is appropriate when the columns in <code>scores</code>
are independent.</p>
</dd>
<dt>Stouffer_directional</dt>
<dd>
<p>Stouffer's method modification that allows for 
directional information to be incorporated with the <code>scores_direction</code>
and <code>constraints_vector</code> parameters.</p>
</dd>
<dt>Strube</dt>
<dd>
<p>Strube's method extends Stouffer's method by accounting for the 
covariance in the columns of <code>scores</code>.</p>
</dd>
<dt>Strube_directional</dt>
<dd>
<p>Strube's method modification that allows for 
directional information to be incorporated with the <code>scores_direction</code>
and <code>constraints_vector</code> parameters.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">  merge_p_values(c(0.05, 0.09, 0.01))
  merge_p_values(list(a=0.01, b=1, c=0.0015, d=0.025), method='Fisher')
  merge_p_values(matrix(data=c(0.03, 0.061, 0.48, 0.052), nrow = 2), method='Brown')

</code></pre>


</div>