<div class="container">

<table style="width: 100%;"><tr>
<td>bayesF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayes factors</h2>

<h3>Description</h3>

<p>Calculates Bayes factors or likelihood ratios of analogue and
no-analogue results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bayesF(x, prior = rep(0.5, 2))

## S3 method for class 'bayesF'
plot(x, group = "all", xlab = NULL, ylab = "Pr (A+ | d)",
        col = "red", abline.col = "lightgrey", abline.lty = "dashed", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for <code>bayesF</code> an object of class <code>roc</code>. For the plot
method, an object of class <code>bayesF</code>, usually the result of a
call to <code>bayesF</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>numeric; the prior probabilities of analogue and
no-analogue, provided as a vector of length 2 whose elements sum to
1. If not provided, the function will use the relative occurences of
analogue and no analogue situations used to evaluate the ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>character vector of length 1 giving the name of the group
to plot, or <code>"all"</code> to plot all groups in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>the x- and y-axis labels for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colour of the line used to draw the posterior probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline.col</code></td>
<td>
<p>colour of the vertical line drawn to indicate the
optimal dissimilarity determined from the ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abline.lty</code></td>
<td>
<p>Line type for indicator of optimal ROC dissimilarity
threshold. See <code>par</code> for the allowed line types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other plot arguments passed to plotting
functions. Currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>LR(+), is the likelihood ratio of a positive test result, that
the value of <em>d</em> assigns the sample to the group it belongs
to. LR(-) is the likelihood ratio of a negative test result, that the
value of <em>d</em> assigns the sample to the wrong group.
</p>
<p>LR(+) is defined as <code class="reqn">LR(+) = TPF / FPF</code> (or sensitivity / (1 -
specificity)), and LR(-) is defined as <code class="reqn">LR(-) = FPF / TNF</code> (or (1
- sensitivity) / specificity), in Henderson (1993).
</p>
<p>The posterior probability of analogue given a dissimilarity is the 
LR(+) likelihood ratio values multiplied by the prior odds of
analogue, for given values of the dissimilarity, and is then converted
to a  probability.
</p>
<p>The plotting function currently only draws the posterior probability
of analogue based on the Bayes factor or likelihood ratio of a
positive event (analogue).
</p>


<h3>Value</h3>

<p>For <code>plot.bayesF</code> a plot on the currently active device.
</p>
<p>For <code>bayesF</code>, a list containing the results of computing Bayes
factors for each group in <code>x</code>. Each component of this list is
itself a list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>bayesF, posterior.odds, posterior.probs, prior.prob</code></td>
<td>
<p>Bayes
factors, posterior odds and probabilities and prior probabilities of
true analogue and true non-analogue events. Each components is a list
with two components; <code>pos</code> (for true analogue events) and
<code>neg</code> (for true non-analogue events). The components of
<code>prior.prob</code> are vectors of length 1, whilst components of the
other lists are numeric vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>roc.points</code></td>
<td>
<p>numeric; the points at which the ROC curve was
evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p>numeric; the optimal dissimilarity as assessed by the
ROC curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.roc</code></td>
<td>
<p>numeric; the position along the ROC curve at which the
slope of the ROC curve is maximal. This is the index of this point
on the curve, and can be used to extract the element of
<code>bayesF</code>, <code>posterior.odds</code> and <code>posterior.probs</code> for
the optimal dissimilarity.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>References</h3>

<p>Brown, C.D., and Davis, H.T. (2006) Receiver operating characteristics
curves and related decision measures: A tutorial. <em>Chemometrics
and Intelligent Laboratory Systems</em> <b>80</b>, 24–38.
</p>
<p>Gavin, D.G., Oswald, W.W., Wahl, E.R. and Williams, J.W. (2003) A
statistical approach to evaluating distance metrics and analog
assignments for pollen records. <em>Quaternary Research</em>
<strong>60</strong>, 356–367.
</p>
<p>Henderson, A.R. (1993) Assessing test accuracy and its clinical
consequences: a primer for receiver operating characteristic curve
analysis. <em>Annals of Clinical Biochemistry</em> <strong>30</strong>,
834–846.
</p>


<h3>See Also</h3>

<p><code>roc</code> and <code>plot.bayesF</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">## load the example data
data(swapdiat, swappH, rlgh)

## merge training and test set on columns
dat &lt;- join(swapdiat, rlgh, verbose = TRUE)

## extract the merged data sets and convert to proportions
swapdiat &lt;- dat[[1]] / 100
rlgh &lt;- dat[[2]] / 100

## fit an analogue matching (AM) model using the squared chord distance
## measure - need to keep the training set dissimilarities
swap.ana &lt;- analog(swapdiat, rlgh, method = "SQchord",
                   keep.train = TRUE)

## fit the ROC curve to the SWAP diatom data using the AM results
## Generate a grouping for the SWAP lakes
METHOD &lt;- if (getRversion() &lt; "3.1.0") {"ward"} else {"ward.D"}
clust &lt;- hclust(as.dist(swap.ana$train), method = METHOD)
grps &lt;- cutree(clust, 12)

## fit the ROC curve
swap.roc &lt;- roc(swap.ana, groups = grps)
swap.roc

## calculate the Bayes factors of analogue and no-analogue
## (uses observed probabilities of analogue/no-analogue
swap.bayes &lt;- bayesF(swap.roc)
swap.bayes

## plot the probability of analogue
plot(swap.bayes)

## Not run: 
## calculate the Bayes factors of analogue and no-analogue
## with prior probabilities c(0.5, 0.05)
swap.bayes2 &lt;- bayesF(swap.roc, prior = c(0.5, 0.05))
swap.bayes

## plot the probability of analogue
plot(swap.bayes2)

## End(Not run)
</code></pre>


</div>