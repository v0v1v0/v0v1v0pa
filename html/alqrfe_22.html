<div class="container">

<table style="width: 100%;"><tr>
<td>qr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>quantile regression</h2>

<h3>Description</h3>

<p>Estimate quantile regression with fixed effects for one tau
</p>


<h3>Usage</h3>

<pre><code class="language-R">qr(x, y, subj, tau = 0.5, method = "qr", ngrid = 20, inf = 1e-08, digt = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric matrix, covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, outcome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subj</code></td>
<td>
<p>Numeric vector, identifies the unit to which the observation belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Numeric, identifies the percentile.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Factor, "qr" quantile regression, "qrfe" quantile regression with fixed effects, "lqrfe" Lasso quantile regression with fixed effects, "alqr" adaptive Lasso quantile regression with fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrid</code></td>
<td>
<p>Numeric scalar greater than one, number of BIC to test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inf</code></td>
<td>
<p>Numeric scalar, internal value, small value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digt</code></td>
<td>
<p>Numeric scalar, internal value greater than one, define "zero" coefficient.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>alpha       Numeric vector, intercepts' coefficients.
</p>
<p>beta        Numeric vector, exploratory variables' coefficients.
</p>
<p>lambda      Numeric, estimated lambda.
</p>
<p>res         Numeric vector, percentile residuals.
</p>
<p>tau         Numeric scalar, the percentile.
</p>
<p>penalty     Numeric scalar, indicate the chosen effect.
</p>
<p>sig2_alpha  Numeric vector, intercepts' standard errors.
</p>
<p>sig2_beta   Numeric vector, exploratory variables' standard errors.
</p>
<p>Tab_alpha   Data.frame, intercepts' summary.
</p>
<p>Tab_beta    Data.frame, exploratory variables' summary.
</p>
<p>Mat_alpha   Numeric matrix, intercepts' summary.
</p>
<p>Mat_beta    Numeric matrix, exploratory variables' summary.
</p>
<p>method      Factor, method applied.
</p>


<h3>References</h3>

<p>Koenker, R. (2004) "Quantile regression for longitudinal data", J. Multivar. Anal., 91(1): 74-89, &lt;doi:10.1016/j.jmva.2004.05.006&gt;
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1
n = 10
m = 5
d = 4
N = n*m
L = N*d
x = matrix(rnorm(L), ncol=d, nrow=N)
subj = rep(1:n, each=m)
alpha = rnorm(n)
beta = rnorm(d)
eps = rnorm(N)
y = x %*% beta  + matrix(rep(alpha, each=m) + eps)
y = as.vector(y)
m1 = qr(x,y,subj,tau=0.75, method="qrfe")
m1
m2 = qr(x,y,subj,tau=0.3, method="lqrfe", ngrid = 10)
m2

# Example 2, from MASS package
Rabbit = MASS::Rabbit
Rabbit$Treatment = ifelse(Rabbit$Treatment=="Control",0,1)
Rabbit$Animal = ifelse(Rabbit$Animal == "R1",1,ifelse(Rabbit$Animal == "R2",2,
ifelse(Rabbit$Animal == "R3",3,ifelse(Rabbit$Animal == "R4",4,5))))
X = matrix(cbind(Rabbit$Dose,Rabbit$Treatment), ncol=2)
m3 = qr(x=X, y=Rabbit$BPchange, subj=Rabbit$Animal,tau=0.5, method="alqrfe", ngrid = 10)
m3

</code></pre>


</div>