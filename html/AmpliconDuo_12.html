<div class="container">

<table style="width: 100%;"><tr>
<td>plotAmpliconduo.set</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Frequeny-Frequency Plot Arrangement Focusing On Significant Deviations In Amplicon Occurences
</h2>

<h3>Description</h3>

<p>Called on the return value of the <code>ampliconduo</code> function, a list of ampliconduo data frames. Generates for each ampliconduo data frame a plot with <code>freqB</code> over <code>freqA</code> and arranges them in a 2-dimensional array, whereas plots in the same row and column share the same scale. Points with a p-value or adjusted p-value below a certain treshold are colored differently (default: red) indicating significant deviations of amplicon occurences between the two samples in an ampliconduo data frame.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotAmpliconduo.set(x, color.treshold = 0.05, xlab = "Abundance (PCR A)", 
ylab = "Abundance (PCR B)",log = "xy", corrected = TRUE, asp = 1, nrow = 1,
legend.position = NULL, save = FALSE, path = NULL, file.name = NULL,
format = "jpeg", h.start = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>List of ampliconduo data frames, return value of the <code>ampliconduo</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color.treshold</code></td>
<td>

<p>Optional. Numeric value specifying at which p-value or adjusted p-value points in the plot are drawn in complementary color.
Default value is 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>

<p>Optional. Character indicating the x-axis label. Default is “Abundance (PCR A)”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>

<p>Optional. Character indicating the y-axis label. Default is “Abundance (PCR B)”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>

<p>Optional. Character specifying the variables to transform to log (“”,“x”, “y”, or “xy”).
Default is “xy”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrected</code></td>
<td>

<p>Optional. Logical to decide whether the p-value (<code>FALSE</code>), or corrected p-value (<code>TRUE</code>) is used for coloring.
Default value is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>

<p>Optional. Numeric value, the y/x aspect ratio. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>

<p>Optional. Integer value specifying the numer of rows used to arrange the plots. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.position</code></td>
<td>

<p>Optional. Numeric vector of length two. Defines the position of the legend. By default tries to find a position that fits
the arrangement of the plots best.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>

<p>Optional. Logical value indicationg if the plot should be saved to file. Default value is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>

<p>Optional. Character, in case the argument <code>save</code> was set to <code>TRUE</code>, specifies the directory (no backslash or slash at the end) for saving.
By default (parameter <code>save</code> is set to TRUE) the plot is saved in the working directory.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.name</code></td>
<td>

<p>Optional. If  argument <code>save</code> was set to <code>TRUE</code> specifies the file name for the plot.
The default name is “ampliconduo_&lt;date&gt;.&lt;file extension&gt;”
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>

<p>Optional. Character specifying the format of the saved file. One of “eps”, “ps”, “tex”, “pdf”, “jpeg”, “tiff”, “png”, “bmp”, “svg” and “wmf” (windows only). Default format is “jpeg”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.start</code></td>
<td>

<p>Optional. Numeric value between 0 and 360, defines the color of the plotted points. Default value is 0 (blue-green, red). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Optional. Allows to pass other aesthetics.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Generates an arrangement of plots from the return value of the <code>ampliconduo</code> function, that nicely visualizes those amplicons with a significant deviations in read numbers between the two amplicon data sets. The data in <code>x</code> are transformed and passed to the <code>qplot</code> function. The 2-dimensional arrangement of the different plots is achieved using <code>facet_wrap</code>. Important aestetic parameters like color, aspect ratio, legend position ... are easily customized. Optionally, the plot can be saved in a variety of formats.
</p>


<h3>Author(s)</h3>

<p>Anja Lange 
&amp;
Daniel Hoffmann
</p>


<h3>References</h3>

<p><a href="https://ggplot2.tidyverse.org/reference/qplot.html">https://ggplot2.tidyverse.org/reference/qplot.html</a>
</p>


<h3>See Also</h3>

<p><span class="pkg">ggplot2</span> package
</p>
<p><code>qplot</code>, used by <code>plotAmpliconduo.set</code> to create the plots.
</p>
<p><code>facet_wrap</code>, called for 2-dimensional arrangement of the plots.
</p>
<p><code>plotAmpliconduo</code>, generates a very similar plot for a single ampliconduo data frame.
</p>
<p><code>ampliconduo</code>, generates the input data, an ampliconduo data frame.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## loads example data of ampliconduo data frames
data(amplicons)

## plot amplicon frequencies of multiple ampliconduo data frames
plotAmpliconduo.set(amplicons[1:4], nrow = 3, h.start = 100)

plotAmpliconduo.set(amplicons[1:4], nrow = 1, corrected = FALSE, color.treshold = 0.1)
</code></pre>


</div>