<div class="container">

<table style="width: 100%;"><tr>
<td>cv4abc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Cross validation for Approximate Bayesian Computation (ABC)
</h2>

<h3>Description</h3>

<p>This function performs a leave-one-out cross validation for ABC via
subsequent calls to the function <code>abc</code>. A potential use of
this function is to evaluate the effect of the choice of the tolerance
rate on the quality of the estimation with ABC.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv4abc(param, sumstat, abc.out = NULL, nval, tols, statistic = "median",
prior.range = NULL, method, hcorr = TRUE, transf = "none", logit.bounds
= c(0,0), subset = NULL, kernel = "epanechnikov", numnet = 10, sizenet =
5, lambda = c(0.0001,0.001,0.01), trace = FALSE, maxit = 500, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>

<p>a vector, matrix or data frame of the simulated parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumstat</code></td>
<td>

<p>a vector, matrix or data frame of the simulated summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abc.out</code></td>
<td>

<p>an object of class <code>"abc"</code>, optional. If supplied, all arguments
passed to <code>abc</code> are extracted from this object,
except for <code>sumstat</code>, <code>param</code>, and <code>tol</code>, which
always have to be supplied as arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nval</code></td>
<td>

<p>size of the cross-validation sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tols</code></td>
<td>

<p>a single tolerance rate or a vector of tolerance rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>

<p>a character string specifying the statistic to calculate a point
estimate from the posterior distribution of the
parameter(s). Possible values are <code>"median"</code> (default),
<code>"mean"</code>, or <code>"mode"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.range</code></td>
<td>

<p>a range to truncate the prior range.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string indicating the type of ABC algorithm to be
applied.  Possible values are <code>"rejection"</code>,
<code>"loclinear"</code>, and <code>"neuralnet"</code>. See also
<code>abc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hcorr</code></td>
<td>

<p>logical, if <code>TRUE</code> (default) the conditional heteroscedastic
model is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transf</code></td>
<td>

<p>a vector of character strings indicating the kind of transformation
to be applied to the parameter values. The possible values are
<code>"log"</code>, <code>"logit"</code>, and <code>"none"</code> (default), when no
is transformation applied. See also <code>abc</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logit.bounds</code></td>
<td>

<p>a vector of bounds if <code>transf</code> is <code>"logit"</code>. These bounds
are applied to all parameters that are to be logit transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>

<p>a logical expression indicating elements or rows to keep. Missing
values in <code>param</code> and/or <code>sumstat</code> are taken as
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>a character string specifying the kernel to be used when
<code>method</code> is <code>"loclinear"</code> or <code>"neuralnet"</code>. Defaults
to <code>"epanechnikov"</code>. See <code>density</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numnet</code></td>
<td>

<p>the number of neural networks when <code>method</code> is
<code>"neuralnet"</code>. Defaults to 10. It indicates the number of times
the function <code>nnet</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizenet</code></td>
<td>

<p>the number of units in the hidden layer. Defaults to 5. Can be zero
if there are no skip-layer units. See <code>nnet</code> for more
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>a numeric vector or a single value indicating the weight decay when
<code>method</code> is <code>"neuralnet"</code>. See <code>nnet</code> for more
details. By default, 0.0001, 0.001, or 0.01 is randomly chosen for
each of the networks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>

<p>logical, <code>TRUE</code> switches on tracing the optimization of
<code>nnet</code>. Applies only when <code>method</code> is
<code>"neuralnet"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>

<p>numeric, the maximum number of iterations. Defaults to 500. Applies
only when <code>method</code> is <code>"neuralnet"</code>. See also
<code>nnet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>other arguments passed to <code>nnet</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

  
<p>A simulation is selected repeatedly to be a validation simulation,
while the other simulations are used as training simulations. Each
time the function <code>abc</code> is called to estimate the
parameter(s). A total of <code>nval</code> validation simulations are
selected.
</p>
<p>The arguments of the function <code>abc</code> can be supplied in two
ways. First, simply give them as arguments when calling this function,
in which case <code>abc.out</code> can be <code>NULL</code>. Second, via an
existing object of class <code>"abc"</code>, here <code>abc.out</code>. WARNING:
when <code>abc.out</code> is supplied, the same <code>sumstat</code> and
<code>param</code> objects have to be used as in the original call to
<code>abc</code>. Column names of <code>sumstat</code> and <code>param</code> are
checked for match.
</p>
<p>See <code>summary.cv4abc</code> for calculating the prediction error
from an object of class <code>"cv4abc"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv4abc"</code>, which is a list with the following
elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The original calls to <code>abc</code> for each tolerance
rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvsamples</code></td>
<td>
<p>Numeric vector of length <code>nval</code>, indicating
which rows of the <code>param</code> and <code>sumstat</code> matrices were used
as validation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tols</code></td>
<td>
<p>The tolerance rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>true</code></td>
<td>
<p>The parameter values that served as validation values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estim</code></td>
<td>
<p>The estimated parameter values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>A list with two elements: <code>parameter.names</code> and
<code>statistics.names</code>. Both contain a vector of character strings
with the parameter and statistics names, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The value of <code>.Random.seed</code> when <code>cv4abc</code> is
called.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>abc</code>, <code>plot.cv4abc</code>, <code>summary.cv4abc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(abc.data)
data(musigma2)
## this data set contains five R objects, see ?musigma2 for
## details 

## cv4abc() calls abc(). Here we show two ways for the supplying
## arguments of abc(). 1st way: passing arguments directly. In this
## example only 'param', 'sumstat', 'tol', and 'method', while default
## values are used for the other arguments.
## Number of eval. should be much more greater in realistic settings
cv.rej &lt;- cv4abc(param=par.sim, sumstat=stat.sim, nval=5,
tols=c(.1,.2,.3), method="rejection")

## 2nd way: first creating an object of class 'abc', and then using it
## to pass its arguments to abc().
##
lin &lt;- abc(target=stat.obs, param=par.sim, sumstat=stat.sim, tol=.2,
method="loclinear", transf=c("none","log"))
cv.lin &lt;- cv4abc(param=par.sim, sumstat=stat.sim, abc.out=lin, nval=5,
tols=c(.1,.2,.3))

## using the plot method. Different tolerance levels are plotted with
## different heat.colors. Smaller the tolerance levels correspond to
## "more red" points.
## !!! consider using the argument 'exclude' (plot.cv4abc) to supress
## the plotting of any outliers that mask readibility !!!
plot(cv.lin, log=c("xy", "xy"), caption=c(expression(mu),
expression(sigma^2)))

## comparing with the rejection sampling
plot(cv.rej, log=c("", "xy"), caption=c(expression(mu), expression(sigma^2)))

## or printing results directly to a postscript file...
## Not run: 
plot(cv.lin, log=c("xy", "xy"), caption=c(expression(mu),
expression(sigma^2)), file="CVrej", postscript=TRUE)

## End(Not run)

## using the summary method to calculate the prediction error
summary(cv.lin)
## compare with rejection sampling
summary(cv.rej)
</code></pre>


</div>