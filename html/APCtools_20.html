<div class="container">

<table style="width: 100%;"><tr>
<td>plot_densityMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a matrix of density plots</h2>

<h3>Description</h3>

<p>This function creates a matrix of individual density plots
(i.e., a <em>ridgeline matrix</em>) or boxplots (for
metric variables) or of individual barplots (for categorical variables).
The age, period or cohort information can each either be plotted on the
x-axis or the y-axis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_densityMatrix(
  dat,
  y_var,
  dimensions = c("period", "age"),
  age_groups = NULL,
  period_groups = NULL,
  cohort_groups = NULL,
  plot_type = "density",
  highlight_diagonals = NULL,
  y_var_cat_breaks = NULL,
  y_var_cat_labels = NULL,
  weights_var = NULL,
  log_scale = FALSE,
  legend_title = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Dataset with columns <code>period</code> and <code>age</code> and the
main variable specified through argument <code>y_var</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_var</code></td>
<td>
<p>Character name of the main variable to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>Character vector specifying the two APC dimensions that
should be visualized along the x-axis and y-axis. Defaults to
<code>c("period","age")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age_groups, period_groups, cohort_groups</code></td>
<td>
<p>Each a list. Either containing
purely scalar values or with each element specifying the two borders of one
row or column in the density matrix. E.g., if the period should be visualized
in decade columns from 1980 to 2009, specify
<code>period_groups = list(c(1980,1989), c(1990,1999), c(2000,2009))</code>.
The list can be named to specify labels for the categories. Only the two
arguments must be passed that were specified by the <code>dimensions</code>
argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>One of <code>c("density","boxplot")</code>. Only used if the
<code>y_var</code> column is metric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_diagonals</code></td>
<td>
<p>Optional list to define diagonals in the density
that should be highlighted with different colors. Each list element should be
a numeric vector stating the index of the diagonals (counted from the top
left) that should be highlighted in the same color. If the list is named, the
names are used as legend labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_var_cat_breaks</code></td>
<td>
<p>Optional numeric vector of breaks to categorize
<code>y_var</code> based on calling function <code>cut</code>. Only used to
highlight the categories based on different colors. And only used if the
<code>y_var</code> column is numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_var_cat_labels</code></td>
<td>
<p>Optional character vector for the names of the
categories that were defined based on <code>y_var_cat_breaks</code>. The length of
this vector must be one shorter than <code>length(y_var_cat_breaks)</code>. Only
used if the <code>y_var</code> column is numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_var</code></td>
<td>
<p>Optional character name of a weights variable used to
project the results in the sample to some population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_scale</code></td>
<td>
<p>Indicator if the main variable should be log10 transformed.
Only used if the <code>y_var</code> column is numeric. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_title</code></td>
<td>
<p>Optional plot annotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>plot_density</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ggplot object
</p>


<h3>Author(s)</h3>

<p>Alexander Bauer <a href="mailto:alexander.bauer@stat.uni-muenchen.de">alexander.bauer@stat.uni-muenchen.de</a>,
Maximilian Weigert <a href="mailto:maximilian.weigert@stat.uni-muenchen.de">maximilian.weigert@stat.uni-muenchen.de</a>
</p>


<h3>References</h3>

<p>Weigert, M., Bauer, A., Gernert, J., Karl, M., Nalmpatian, A.,
KÃ¼chenhoff, H., and Schmude, J. (2021). Semiparametric APC analysis of
destination choice patterns: Using generalized additive models to quantify
the impact of age, period, and cohort on travel distances.
<em>Tourism Economics</em>. doi:10.1177/1354816620987198.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(APCtools)

# define categorizations for the main trip distance
dist_cat_breaks &lt;- c(1,500,1000,2000,6000,100000)
dist_cat_labels &lt;- c("&lt; 500 km","500 - 1,000 km", "1,000 - 2,000 km",
                     "2,000 - 6,000 km", "&gt; 6,000 km")

age_groups    &lt;- list(c(80,89),c(70,79),c(60,69),c(50,59),c(40,49),c(30,39),c(20,29))
period_groups &lt;- list(c(1970,1979),c(1980,1989),c(1990,1999),c(2000,2009),c(2010,2019))
cohort_groups &lt;- list(c(1980,1989),c(1970,1979),c(1960,1969),c(1950,1959),c(1940,1949),
                      c(1930,1939),c(1920,1929))

plot_densityMatrix(dat              = travel,
                   y_var            = "mainTrip_distance",
                   age_groups       = age_groups,
                   period_groups    = period_groups,
                   log_scale        = TRUE)


# highlight two cohorts
plot_densityMatrix(dat                 = travel,
                   y_var               = "mainTrip_distance",
                   age_groups          = age_groups,
                   period_groups       = period_groups,
                   highlight_diagonals = list(8, 10),
                   log_scale           = TRUE)

# also mark different distance categories
plot_densityMatrix(dat              = travel,
                   y_var            = "mainTrip_distance",
                   age_groups       = age_groups,
                   period_groups    = period_groups,
                   log_scale        = TRUE,
                   y_var_cat_breaks = dist_cat_breaks,
                   y_var_cat_labels = dist_cat_labels,
                   highlight_diagonals = list(8, 10),
                   legend_title     = "Distance category")

# flexibly assign the APC dimensions to the x-axis and y-axis
plot_densityMatrix(dat              = travel,
                   y_var            = "mainTrip_distance",
                   dimensions       = c("period","cohort"),
                   period_groups    = period_groups,
                   cohort_groups    = cohort_groups,
                   log_scale        = TRUE,
                   y_var_cat_breaks = dist_cat_breaks,
                   y_var_cat_labels = dist_cat_labels,
                   legend_title     = "Distance category")

# use boxplots instead of densities
plot_densityMatrix(dat           = travel,
                   y_var         = "mainTrip_distance",
                   plot_type     = "boxplot",
                   age_groups    = age_groups,
                   period_groups = period_groups,
                   log_scale     = TRUE,
                   highlight_diagonals = list(8, 10))

# plot categorical variables instead of metric ones
plot_densityMatrix(dat                 = travel,
                   y_var               = "household_size",
                   age_groups          = age_groups,
                   period_groups       = period_groups,
                   highlight_diagonals = list(8, 10))


</code></pre>


</div>