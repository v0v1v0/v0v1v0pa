<div class="container">

<table style="width: 100%;"><tr>
<td>heat_ppoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Display colored scatterplot for projected coordinates</h2>

<h3>Description</h3>

<p><code>heat_ppoints</code> plots a "heated" scatterplot for
(potentially) projected locations. A color scale is
automatically provided with the scatterplot. The function
is similar in purpose to <code>pimage</code>,
but the <code>z</code>-values are not interpolated. The color
scale can be changed by passing a vector of colors to
the <code>col</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heat_ppoints(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  lratio = 0.2,
  map = "none",
  n = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric vector containing the values to be
plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A character string indicating where the
color scale should be placed.  The default is
<code>"horizontal"</code>.  The other valid options are
<code>"none"</code> and <code>"vertical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>A character string indicating what projection
should be used for the included <code>x</code> and <code>y</code>
coordinates.  The default is <code>"none"</code>.  The other
valid choices correspond to the <code>"projection"</code>
argument in the <code>mapproject</code>
function, which is used for the projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A numeric vector specifying the values
of the <code>parameters</code> argument in the
<code>mapproject</code>.  This may be
necessary when <code>proj != "none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orientation</code></td>
<td>
<p>A vector
<code>c(latitude,longitude,rotation)</code> which describes
where the "North Pole" should be when computing the
projection.  See <code>mapproject</code> for
more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the
smaller dimension of the legend scale to the width of
the image.  Default is <code>lratio = 0.2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>The name of the map to draw on the image.
Default is <code>"none"</code>.  Other options include
<code>"world"</code>, <code>"usa"</code>, <code>"state"</code>,
<code>"county"</code>, <code>"france"</code>, <code>"nz"</code> (New
Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer giving the <em>desired</em> number of
intervals.  Non-integer values are rounded down.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the
<code>plot</code> function.  e.g.,
<code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>,
<code>zlim</code>, etc.  Additionally, arguments that can be
used to further customize the plot (like adding lines
or points), as described in Details and Examples.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When <code>proj != "none"</code>, the
<code>mapproject</code> function is used to
project the <code>x</code> and <code>y</code> coordinates. In that
case, <code>proj</code> must correspond to one of the choices
for the <code>projection</code> argument in the
<code>mapproject</code> function.  Necessary
arguments for <code>mapproject</code> should be
provided via the <code>parameters</code> and <code>orientation</code>
arguments. See Examples and the
<code>mapproject</code> function.
</p>
<p>Valid options for <code>legend</code> are <code>"none"</code>,
<code>"horizontal"</code>, and <code>"vertical"</code>.  If
<code>legend = "none"</code>, then no color scale is provided.
If <code>legend = "horizontal"</code>, then a color scale is
included under the plot.  If <code>legend = "vertical"</code>,
then a color scale is added to the right of the plot.
</p>
<p>Lines can be added to each plot by passing the
<code>lines</code> argument through <code>...</code>.  In that case,
<code>lines</code> should be a list with components <code>x</code>
and <code>y</code> specifying the locations to draw the lines.
The appearance of the plotted lines can be customized by
passing a named list called <code>lines.args</code> through
<code>...</code>. The components of <code>lines.args</code> should
match the arguments of <code>lines</code>.
See Examples.
</p>
<p>Points can be added to each image by passing the
<code>points</code> argument through <code>...</code>.  In that case,
<code>points</code> should be a list with components <code>x</code>
and <code>y</code> specifying the locations to draw the points.
The appearance of the plotted points can be customized by
passing a named list called <code>points.args</code> through
<code>...</code>. The components of <code>points.args</code> should
match the components of <code>points</code>.
See Examples.
</p>
<p>Text can be added to each image by passing the
<code>text</code> argument through <code>...</code>.  In that case,
<code>text</code> should be a list with components <code>x</code> and
<code>y</code> specifying the locations to draw the text, and
<code>labels</code>, a component specifying the actual text to
write.  The appearance of the plotted text can be
customized by passing a named list called
<code>text.args</code> through <code>...</code>. The components of
<code>text.args</code> should match the components of
<code>text</code>.  See Examples.
</p>
<p>The legend scale can be modified by passing
<code>legend.axis.args</code> through <code>...</code>.  The argument
should be a named list corresponding to the arguments of
the <code>axis</code> function.  See Examples.
</p>
<p>The plot axes can be modified by passing
<code>axis.args</code> through <code>...</code>.  The argument should
be a named list corresponding to the arguments of the
<code>axis</code> function.  The exception to
this is that arguments <code>xat</code> and <code>yat</code> can be
specified (instead of <code>at</code>) to specify the location
of the x and y ticks.  If <code>xat</code> or <code>yat</code> are
specified, then this overrides the <code>xaxt</code> and
<code>yaxt</code> arguments, respectively.  See the
<code>paxes</code> function to see how
<code>axis.args</code> can be used.
</p>
<p>The legend margin can be customized by passing
<code>legend.mar</code> to <code>heat_ppoints</code> through <code>...</code>.
This should be a numeric vector indicating the margins of
the legend, identical to how <code>par("mar")</code> is
specified.
</p>
<p>The various options of the labeling, axes, and legend are
largely independent.  e.g., passing <code>col.axis</code>
through <code>...</code> will not affect the axis unless it is
passed as part of the named list <code>axis.args</code>.
However, one can set the various <code>par</code> options prior
to plotting to simultaneously affect the appearance of
multiple aspects of the plot.  See Examples.  After
plotting, <code>reset.par()</code> can be used to reset the
graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code>plot</code>,
<code>axis</code>,
<code>pimage</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(co, package = "gear")
# heated scatterplot for data on an irregular grid
heat_ppoints(co$lon, co$lat, co$Al, legend = "v", map = "state")
reset.par()

# change color scale
heat_ppoints(co$lon, co$lat, co$Al, col = cm.colors(5))
reset.par()

# Use custom border, x and y limits, breaks for legend axis
data(copoly)
heat_ppoints(co$lon, co$lat, co$Al, legend = "h",
       xlab = "longitude", ylab = "latitude",
       proj = "bonne", parameters = 40,
       lines = copoly,
       lines.args = list(lwd = 2, col = "grey"),
       xlim = c(-109.1, -102),
       ylim = c(36.8, 41.1),
       breaks = seq(0, 10, len = 6))
reset.par()
</code></pre>


</div>