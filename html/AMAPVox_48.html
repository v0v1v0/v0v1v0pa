<div class="container">

<table style="width: 100%;"><tr>
<td>plantAreaDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plant Area Density (PAD)</h2>

<h3>Description</h3>

<p>Computes Plant Area Density either from transmittance or
attenuation coefficient estimates.
Details of calculation and underlying assumptions can be found online at
doi: <a href="https://doi.org/10.23708/1AJNMP">10.23708/1AJNMP</a>.
PAD is defind as the plant area per unit volume
( PAD plant area / voxel volume = m^2 / m^3).
</p>


<h3>Usage</h3>

<pre><code class="language-R">plantAreaDensity(
  vxsp,
  vx,
  lad = "spherical",
  angle.name = "angleMean",
  variable.name = c("transmittance", "attenuation_FPL_unbiasedMLE",
    "attenuation_PPL_MLE"),
  pad.max = 5,
  pulse.min = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vxsp</code></td>
<td>
<p>a <code>VoxelSpace</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vx</code></td>
<td>
<p>a subset of voxel index. A data.table with <code style="white-space: pre;">⁠i, j, k⁠</code> columns.
Missing parameter means whole voxel space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lad</code></td>
<td>
<p>the name of the probability density function of the leaf angle
distribution. One of <code>AMAPVox:::leafAngleDistribution</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle.name</code></td>
<td>
<p>the name of the mean angle variable in the VoxelSpace
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable.name</code></td>
<td>
<p>the name of the transmittance/attenuation variables in
the VoxelSpace object. Transmittance variables are expected to start with
"tra" and attenuation variables with "att".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pad.max</code></td>
<td>
<p>a float, the maximal PAD value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pulse.min</code></td>
<td>
<p>an integer, the minimal number of pulses in a voxel for
computing the PAD. PAD set to NA otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters which will be passed to the leaf angle
distribution functions. Details in <code>computeG()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A voxel space object with the requested PAD variables.
</p>


<h3>References</h3>

<p>VINCENT, Gregoire; PIMONT, François; VERLEY, Philippe, 2021,
"A note on PAD/LAD estimators implemented in AMAPVox 1.7",
doi: <a href="https://doi.org/10.23708/1AJNMP">10.23708/1AJNMP</a>, DataSuds, V1
</p>


<h3>See Also</h3>

<p><code>computeG()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load a voxel file
vxsp &lt;- readVoxelSpace(system.file("extdata", "tls_sample.vox", package = "AMAPVox"))
# compute PAD
pad &lt;- plantAreaDensity(vxsp, variable.name = "attenuation_PPL_MLE")
# merge pad variables into voxel space
vxsp@data &lt;- merge(vxsp@data, pad, by = c("i", "j", "k"))
grep("^pad", names(vxsp), value = TRUE) # print PAD variables in vxsp
# PAD on a subset
pad.i2j3 &lt;- plantAreaDensity(vxsp, vxsp@data[i ==2 &amp; j==3, .(i, j, k)])
pad.i2j3[["ground_distance"]] &lt;- vxsp@data[i ==2 &amp; j==3]$ground_distance
## Not run: 
# plot vertical profile
library(ggplot2)
# meld data.table (wide-to-long reshaping)
pad &lt;- data.table::melt(pad.i2j3,
  id.vars = "ground_distance",
  measure.vars = c("pad_transmittance", "pad_attenuation_FPL_unbiasedMLE",
    "pad_attenuation_PPL_MLE"))
ggplot(data = pad, aes(x=value, y=ground_distance, color=variable)) +
  geom_path() + geom_point()

## End(Not run)
</code></pre>


</div>