<div class="container">

<table style="width: 100%;"><tr>
<td>discretize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discretization of a Continuous Distribution</h2>

<h3>Description</h3>

<p>Compute a discrete probability mass function from a continuous
cumulative distribution function (cdf) with various methods.
</p>
<p><code>discretise</code> is an alias for <code>discretize</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">discretize(cdf, from, to, step = 1,
           method = c("upper", "lower", "rounding", "unbiased"),
           lev, by = step, xlim = NULL)

discretise(cdf, from, to, step = 1,
           method = c("upper", "lower", "rounding", "unbiased"),
           lev, by = step, xlim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cdf</code></td>
<td>
<p>an expression written as a function of <code>x</code>, or
alternatively the name of a function, giving the cdf to discretize.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from, to</code></td>
<td>
<p>the range over which the function will be discretized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>numeric; the discretization step (or span, or lag).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>discretization method to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lev</code></td>
<td>
<p>an expression written as a function of <code>x</code>, or
alternatively the name of a function, to compute the limited
expected value of the distribution corresponding to
<code>cdf</code>. Used only with the <code>"unbiased"</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>an alias for <code>step</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>numeric of length 2; if specified, it serves as default
for <code>c(from, to)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Usage is similar to <code>curve</code>.
</p>
<p><code>discretize</code> returns the probability mass function (pmf) of the
random variable obtained by discretization of the cdf specified in
<code>cdf</code>.
</p>
<p>Let <code class="reqn">F(x)</code> denote the cdf, <code class="reqn">E[\min(X, x)]</code> the
limited expected value at <code class="reqn">x</code>, <code class="reqn">h</code> the step, <code class="reqn">p_x</code>
the probability mass at <code class="reqn">x</code> in the discretized distribution and
set <code class="reqn">a =</code> <code>from</code> and <code class="reqn">b =</code> <code>to</code>.
</p>
<p>Method <code>"upper"</code> is the forward difference of the cdf <code class="reqn">F</code>:
</p>
<p style="text-align: center;"><code class="reqn">p_x = F(x + h) - F(x)</code>
</p>

<p>for <code class="reqn">x = a, a + h, \dots, b - step</code>.
</p>
<p>Method <code>"lower"</code> is the backward difference of the cdf <code class="reqn">F</code>:
</p>
<p style="text-align: center;"><code class="reqn">p_x = F(x) - F(x - h)</code>
</p>
<p> for <code class="reqn">x = a +
    h, \dots, b</code> and <code class="reqn">p_a = F(a)</code>.
</p>
<p>Method <code>"rounding"</code> has the true cdf pass through the
midpoints of the intervals <code class="reqn">[x - h/2, x + h/2)</code>:
</p>
<p style="text-align: center;"><code class="reqn">p_x = F(x + h/2) - F(x - h/2)</code>
</p>

<p>for <code class="reqn">x = a + h, \dots, b - step</code> and <code class="reqn">p_a = F(a + h/2)</code>. The function assumes the cdf is continuous. Any
adjusment necessary for discrete distributions can be done via
<code>cdf</code>.
</p>
<p>Method <code>"unbiased"</code> matches the first moment of the discretized
and the true distributions. The probabilities are as follows:
</p>
<p style="text-align: center;"><code class="reqn">p_a = \frac{E[\min(X, a)] - E[\min(X, a + h)]}{h} + 1 - F(a)</code>
</p>

<p style="text-align: center;"><code class="reqn">p_x = \frac{2 E[\min(X, x)] - E[\min(X, x - h)] - E[\min(X, x +
      h)]}{h}, \quad a &lt; x &lt; b</code>
</p>

<p style="text-align: center;"><code class="reqn">p_b = \frac{E[\min(X, b)] - E[\min(X, b - h)]}{h} - 1 + F(b),</code>
</p>



<h3>Value</h3>

<p>A numeric vector of probabilities suitable for use in
<code>aggregateDist</code>.
</p>


<h3>Author(s)</h3>

<p>Vincent Goulet <a href="mailto:vincent.goulet@act.ulaval.ca">vincent.goulet@act.ulaval.ca</a>
</p>


<h3>References</h3>

<p>Klugman, S. A., Panjer, H. H. and Willmot, G. E. (2012),
<em>Loss Models, From Data to Decisions, Fourth Edition</em>, Wiley.
</p>


<h3>See Also</h3>

<p><code>aggregateDist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- seq(0, 5, 0.5)

op &lt;- par(mfrow = c(1, 1), col = "black")

## Upper and lower discretization
fu &lt;- discretize(pgamma(x, 1), method = "upper",
                 from = 0, to = 5, step = 0.5)
fl &lt;- discretize(pgamma(x, 1), method = "lower",
                 from = 0, to = 5, step = 0.5)
curve(pgamma(x, 1), xlim = c(0, 5))
par(col = "blue")
plot(stepfun(head(x, -1), diffinv(fu)), pch = 19, add = TRUE)
par(col = "green")
plot(stepfun(x, diffinv(fl)), pch = 19, add = TRUE)
par(col = "black")

## Rounding (or midpoint) discretization
fr &lt;- discretize(pgamma(x, 1), method = "rounding",
                 from = 0, to = 5, step = 0.5)
curve(pgamma(x, 1), xlim = c(0, 5))
par(col = "blue")
plot(stepfun(head(x, -1), diffinv(fr)), pch = 19, add = TRUE)
par(col = "black")

## First moment matching
fb &lt;- discretize(pgamma(x, 1), method = "unbiased",
                 lev = levgamma(x, 1), from = 0, to = 5, step = 0.5)
curve(pgamma(x, 1), xlim = c(0, 5))
par(col = "blue")
plot(stepfun(x, diffinv(fb)), pch = 19, add = TRUE)

par(op)
</code></pre>


</div>