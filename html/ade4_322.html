<div class="container">

<table style="width: 100%;"><tr>
<td>varipart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partition of the variation of a response multivariate table by 2 explanatory tables</h2>

<h3>Description</h3>

<p>The function partitions the variation of a response table (usually community data) with respect to two
explanatory tables. The function performs the variation partitioning based on
redundancy analysis (RDA, if <code>dudiY</code> is obtained by <code>dudi.pca</code>) or canonical correspondance analysis (CCA, if <code>dudiY</code> is obtained by <code>dudi.coa</code>) 
and computes 
unadjusted and adjusted R-squared. 
The significance of R-squared are evaluated by a randomization procedure
where the rows of the explanatory tables are permuted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varipart(Y, X, W = NULL, nrepet = 999, type = c("simulated", "parametric"),
scale = FALSE, ...)
## S3 method for class 'varipart'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector, matrix or data frame or an object of class <code>dudi</code>. If not a <code>dudi</code> object, the data are trated by a principal component analysis (<code>dudi.pca</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X, W</code></td>
<td>
<p>dataframes or matrices of explanatory (co)variables (numeric and/or factor
variables). By default, no covariables are considered (<code>W</code> is <code>NULL</code>) and this case corresponds to simple caonical ordination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an integer indicating the number of permutations
.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character specifying the algorithm which should be used to adjust R-squared (either <code>"simulated"</code> or \ code"parametric").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If <code>Y</code> is not a dudi, a <code>logical</code> indicating if variables should be scaled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>as.krandtest</code> or <code>as.randtest</code> (if no covariables are considered) for function <code>varipart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>varipart</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two types of algorithm are provided to adjust R-squared. The "simulated" procedure 
estimates the unadjusted R-squared expected under the null hypothesis H0 and uses it to adjust the
observed R-squared as follows: R2.adj = 1 - (1 - R2) / (1 - E(R2|H0)) with R2.adj the
adjusted R-squared and R2 the unadjusted R-squared.
The "parametric" procedure performs the Ezequiel's adjustement on the unadjusted R-squared as: 
R2.adj = 1 - (1 - R2) / (1 - p / (n - 1)) where n is the number of sites, and p the number of
predictors.
</p>


<h3>Value</h3>

<p>It returns an object of class <code>varipart</code>. It is a <code>list</code> with:
</p>

<dl>
<dt><code>test</code></dt>
<dd>
<p>the significance test of fractions [ab], [bc], and [abc] based on randomization procedure. An object of class <code>krandtest</code></p>
</dd>
<dt><code>R2</code></dt>
<dd>
<p>unadjusted estimations of fractions [a], [b], [c], and [d]</p>
</dd>
<dt><code>R2.adj</code></dt>
<dd>
<p>adjusted estimations of fractions [a], [b], [c], and [d]</p>
</dd>
<dt><code>call</code></dt>
<dd>
<p>the matched call</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a> and Sylvie Clappe <a href="mailto:sylvie.clappe@univ-lyon1.fr">sylvie.clappe@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Borcard, D., P. Legendre, and P. Drapeau. 1992. Partialling out the spatial component
of ecological variation. Ecology 73:1045. 
</p>
<p>Peres-Neto, P. R., P. Legendre, S. Dray, and D. Borcard. 2006. Variation partitioning of
species data matrices: estimation and comparison of fractions. Ecology 87:2614-2625.
</p>


<h3>See Also</h3>

<p><code>pcaiv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(mafragh)

# PCA on response table Y
Y &lt;- mafragh$flo
dudiY &lt;- dudi.pca(Y, scannf = FALSE, scale = FALSE)

# Variation partitioning based on RDA
# without covariables
vprda &lt;- varipart(dudiY,  mafragh$env)
vprda
# Variation partitioning based on RDA
# with covariables and parametric estimation
vprda &lt;- varipart(dudiY,  mafragh$env, mafragh$xy, type = "parametric")
vprda
names(vprda)
</code></pre>


</div>