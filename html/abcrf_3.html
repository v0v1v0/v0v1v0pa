<div class="container">

<table style="width: 100%;"><tr>
<td>covRegAbcrf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predict posterior covariance between two parameters for new data using two reg-ABC-RF objects
</h2>

<h3>Description</h3>

<p>Using two reg-ABC-RF objects constructed on the same reference table for two different response variables, this function predicts the posterior covariance between those two response variables, given a new dataset of summaries.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'regAbcrf'
covRegAbcrf(regForest1, regForest2, obs, training1, training2,
ntree=500, mtry=max(floor((dim(training1)[2]-1)/3), 1),
sampsize=min(1e5, dim(training1)[1]), paral = FALSE, 
ncores = if(paral) max(detectCores()-1,1) else 1, paral.predict = FALSE,
ncores.predict = if(paral.predict) max(detectCores()-1,1) else 1, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>regForest1, regForest2</code></td>
<td>
<p><code>regAbcrf</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>a data frame containing the summary statistics of the observed data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>training1, training2</code></td>
<td>
<p>data frames containing the reference table respectively used to train the <code>regAbcrf</code> objects regForest1 and regForest2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>number of trees to grow in the forest, by default equal to 500 trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>
<p>Number of variables to possibly split at in each node for the regression random forest. Default is the minimum between 1 and the number of variables divided by 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampsize</code></td>
<td>
<p>size of the sample from the reference table used to grow a tree of the regression forest, by default the minimum between the number of elements of the reference table and 100,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paral</code></td>
<td>
<p>a boolean that indicates whether or not the calculations of the regression random forest (forest used to predict a response from the observed dataset) should be parallelized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>the number of CPU cores to use. If paral=TRUE, it is used the number of CPU cores minus 1. If ncores is not specified and <code>detectCores</code> does not detect the number of CPU cores with success then 1 core is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paral.predict</code></td>
<td>
<p>a boolean that indicates if random forests predictions should be parallelized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores.predict</code></td>
<td>
<p>the number of CPU cores to use for the regression random forest predictions. If paral.predict=TRUE, it is used the number of CPU cores minus 1. If ncores.predict is not specified and <code>detectCores</code> does not detect the number of CPU cores with success then 1 core is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed on to <code>ranger</code> used to construct the regression random forest that predicts posterior covariance.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>covRegAbcrf</code> returns predicted posterior covariances between response variables of two reg-ABC-RF objects, for a new data set.
</p>


<h3>References</h3>

<p>Raynal L., Marin J.-M. Pudlo P., Ribatet M., Robert C. P. and Estoup, A. (2019)
<em>ABC random forests for Bayesian parameter inference</em> Bioinformatics
<a href="https://doi.org/10.1093/bioinformatics/bty867">doi:10.1093/bioinformatics/bty867</a>
</p>


<h3>See Also</h3>

<p><code>regAbcrf</code>,
<code>predict.regAbcrf</code>,
<code>err.regAbcrf</code>,
<code>plot.regAbcrf</code>,
<code>ranger</code>,
<code>densityPlot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(snp)
modindex &lt;- snp$modindex
sumsta &lt;- snp$sumsta[modindex == "3",]
r &lt;- snp$param$r[modindex == "3"]
r &lt;- r[1:500]
sumsta &lt;- sumsta[1:500,]
data2 &lt;- data.frame(r, sumsta)
model.rf.r &lt;- regAbcrf(r~., data2, ntree=100)
N1 &lt;- snp$param$N1[modindex == "3"]
N1 &lt;- N1[1:500]
data3 &lt;- data.frame(N1, sumsta) 
model.rf.N1 &lt;- regAbcrf(N1~., data3, ntree=100)
data(snp.obs)
covRegAbcrf(model.rf.r, model.rf.N1, snp.obs, 
            data2, data3, ntree=100)
</code></pre>


</div>