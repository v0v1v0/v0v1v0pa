<div class="container">

<table style="width: 100%;"><tr>
<td>albatross-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
PARAFAC Analysis of Fluorescence Excitation-Emission Matrices
</h2>

<h3>Description</h3>

<div style="text-align: right; font-size: small;">

<p>Day after day, day after day, <br>
We stuck, nor breath nor motion; <br>
As idle as a painted ship <br>
Upon a painted ocean.
</p>
<p>Water, water, every where, <br>
And all the boards did shrink; <br>
Water, water, every where, <br>
Nor any drop to drink.
</p>
<p>– Samuel Taylor Coleridge, <em>The Rime of the Ancient Mariner</em>
</p>

</div>
<p>Perform parallel factor analysis (PARAFAC: Hitchcock, 1927)
	&lt;doi:10.1002/sapm192761164&gt; on fluorescence excitation-emission
	matrices: handle scattering signal and inner filter effect, scale
	the dataset, fit the model; perform split-half validation or
	jack-knifing. Modified approaches such as Whittaker interpolation,
	randomised split-half, and fluorescence and scattering model
	estimation are also available. The package has a low dependency
	footprint and has been tested on a wide range of R versions.
</p>


<h3>Details</h3>

<p>In order to work with your data, create <code>feem</code> and/or
<code>feemcube</code> objects from files or matrix or array objects.
Use <code>feemlist</code> to import files in bulk. If your files
aren't in one of the formats supported by <code>feem</code> but you
can read their contents by other means, you can supply an importer
function to <code>feemlist</code>; it should take a file name and
return the corresponding <code>feem</code> object.
</p>
<p>Operations that can be performed on the objects include plotting
(<code>plot.feem</code>), calculation of fluorescence indices
(<code>feemindex</code>), inner-filter effect correction
(<code>feemife</code>), handling of scattering signal
(<code>feemscatter</code>), changing the wavelength grid of the data
by means of interpolation (<code>feemgrid</code>), and scaling
(<code>feemscale</code>). Scaling may be automatically undone after
performing the PARAFAC decomposition so that the resulting scores
would correspond to the data as it was before the scaling.
</p>
<p>All processing functions can take individual <code>feem</code>
objects, lists of them, or <code>feemcube</code> objects and return
values of the appropriate kind. For example, <code>feemscatter</code>
always returns an object of the same class but with the scattering
signal handled, while <code>feemindex</code> returns named numeric
vectors for individual <code>feem</code>s but
<code>data.frame</code>s for collections of them. There's a
slight memory benefit to using lists of <code>feem</code> objects,
but the difference shouldn't be noticeable, so there's nothing to
worry about if you started with a <code>feemcube</code>.
</p>
<p>In order to compute PARAFAC, you need to convert your data into a
<code>feemcube</code>. Whether you perform jack-knifing, split-half
analysis, or PARAFAC itself, a copy of the data cube is kept together
with the results and can be extracted back using the
<code>feemcube</code> function. The resulting objects support a
<code>plot</code> method (described in the same help page) and can give you
the data as a few-column <code>data.frame</code> using the
<code>coef</code> method.
</p>
<p>Once the analysis is finished, the PARAFAC model can be exported for
the OpenFluor database (<code>write.openfluor</code>) or stored as an
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object using standard <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> tools (<code>save</code> or
<code>saveRDS</code>).
</p>

<p>Index of help topics:
</p>
<pre>
[.feem                  Extract or replace parts of FEEM objects
[.feemcube              Extract or replace parts of FEEM cubes
absindex                Functions of absorbance data
albatross-package       PARAFAC Analysis of Fluorescence
                        Excitation-Emission Matrices
as.data.frame.feem      Transform a FEEM object into a data.frame
feem                    Create a fluorescence excitation-emission
                        matrix object
feemcorcondia           Core consistency diagnostic for PARAFAC models
feemcube                Data cubes of fluorescence excitation-emission
                        matrices
feemflame               Fluorescence and scAttering Model Estimation
feemgrid                Interpolate FEEMs on a given wavelength grid
feemife                 Absorbance-based inner filter effect correction
feemindex               Fluorescence indices and peak values
feemjackknife           Jack-knife outlier detection in PARAFAC models
feemlist                Create lists of FEEM objects
feemparafac             Compute PARAFAC on a FEEM cube object and
                        access the results
feems                   Synthetic fluorescence excitation-emission
                        matrices and absorbance spectra
feemscale               Rescale FEEM spectra to a given norm and
                        remember the scale factor
feemscatter             Handle scattering signal in FEEMs
feemsplithalf           Split-half analysis of PARAFAC models
marine.colours          Perceptually uniform palettes
plot.feem               Plot a FEEM object
write.openfluor         Export a PARAFAC model for the OpenFluor
                        database
</pre>


<h3>Author(s)</h3>

<p>Ivan Krylov [aut, cre],
  Timur Labutin [ths],
  Anastasia Drozdova [rev]</p>


<h3>References</h3>

<p>Murphy KR, Stedmon CA, Graeber D, Bro R (2013).
“Fluorescence spectroscopy and multi-way techniques. PARAFAC.”
<em>Analytical Methods</em>, <b>5</b>, 6557-6566.
<a href="https://doi.org/10.1039/c3ay41160e">doi:10.1039/c3ay41160e</a>.
</p>
<p>Pucher M, Wünsch U, Weigelhofer G, Murphy K, Hein T, Graeber D (2019).
“staRdom: Versatile Software for Analyzing Spectroscopic Data of Dissolved Organic Matter in R.”
<em>Water</em>, <b>11</b>(11), 2366.
<a href="https://doi.org/10.3390/w11112366">doi:10.3390/w11112366</a>.
</p>
<p>Cleese J, Jones T (1970).
“Albatross: Flavours of different sea birds.”
<em>Journal of Flying Circus</em>, <b>1.13</b>, 7:05-7:45.
</p>
<p>Krylov I, Drozdova A, Labutin T (2020).
“Albatross R package to study PARAFAC components of DOM fluorescence from mixing zones of arctic shelf seas.”
<em>Chemometrics and Intelligent Laboratory Systems</em>, <b>207</b>(104176).
<a href="https://doi.org/10.1016/j.chemolab.2020.104176">doi:10.1016/j.chemolab.2020.104176</a>.
</p>


<h3>See Also</h3>

<p><code>feem</code>, <code>feemlist</code>, <code>feemindex</code>,
<code>feemife</code>, <code>feemscatter</code>,
<code>feemgrid</code>, <code>feemcube</code>,
<code>feemscale</code>, <code>feemsplithalf</code>,
<code>feemparafac</code>, <code>feemjackknife</code>,
<code>feemflame</code>, <code>absindex</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(feems)

  dataset &lt;- feemcube(feems, FALSE)
  dataset &lt;- feemscatter(dataset, c(24, 15, 10), 'whittaker')
  dataset &lt;- feemife(dataset, absorp)
  plot(dataset &lt;- feemscale(dataset, na.rm = TRUE))

  
    # takes a long time
    (sh &lt;- feemsplithalf(
      feemscatter(cube, c(24, 15)),
      # in real life, set a stricter stopping criterion, 1e-6..1e-8
      nfac = 2:4, splits = 4, ctol = 1e-4
    ))
    plot(sh)
  

  pf &lt;- feemparafac(cube, nfac = 3, ctol = 1e-4)
  plot(pf)
</code></pre>


</div>