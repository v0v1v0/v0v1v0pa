<div class="container">

<table style="width: 100%;"><tr>
<td>newfit.asreml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Refits an <code>asreml</code> model with changed arguments by extracting, modifying 
and evaluating its <code>call</code> - an alternate to update.asreml.</h2>

<h3>Description</h3>

<p>Extracts the call from the <code>asreml.obj</code> and evaluates that call, 
replacing supplied <code>asreml</code> arguments with changed values. 
If <code>update</code> is <code>TRUE</code> and <code>set.terms</code> is <code>NULL</code>, 
the call is evaluated using the variance parameter estimates 
from the <code>call</code> stored in <code>asreml.obj</code>; if some 
variance terms in the newly fitted model are singular (S) or 
bound (B), a refit of the model will be tried in which the 
variance parameter estimates in <code>asreml.obj</code> are not used 
and will become the fitted model if its boundary terms are a 
subset of those in the fitted model stored in <code>asreml.obj</code>. 
If <code>update</code> is <code>FALSE</code> or <code>set.terms</code> is not 
<code>NULL</code>, the previous values of the variance parameters 
are not used as initial values for fitting the new model; 
<code>G.param</code> and <code>R.param</code> are set to <code>NULL</code> or 
to values as specified for <code>set.terms</code>. The <code>...</code> 
argument can be used to pass <code>G.param</code> and/or 
<code>R.param</code>, provided <code>update</code> is <code>FALSE</code> and 
<code>set.terms</code> is <code>NULL</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'asreml'
newfit(asreml.obj, fixed., random., sparse., 
       residual., rcov., update = TRUE, trace = FALSE, 
       allow.unconverged = TRUE, allow.fixedcorrelation = TRUE,
       keep.order = TRUE, 
       set.terms = NULL, ignore.suffices = TRUE, 
       bounds = "P", initial.values = NA, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>asreml.obj</code></td>
<td>
<p>A valid <code>asreml</code> object with 
a component named <code>call</code> (from a previous 
call to either <code>asreml</code> or <code>update.asreml</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.</code></td>
<td>
<p>A character or formula specifying changes to the fixed 
formula. This is a two-sided formula 
where "." is substituted for existing components in the 
fixed component of <code>asreml.obj$call</code>. If changes are 
specified, the fixed terms will be reordered so that 
single-variable terms come first, followed by two-variable 
terms and so on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.</code></td>
<td>
<p>A character or formula specifying changes to the random 
formula. This is a one-sided formula 
where "." is substituted for existing components in the 
random component of <code>asreml.obj$call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse.</code></td>
<td>
<p>A character or formula specifying changes to the sparse 
formula. This is a one-sided formula 
where "." is substituted for existing components in the 
sparse component of <code>asreml.obj$call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residual.</code></td>
<td>
<p>A character or formula specifying changes to the error 
formula, used when version 4 or later of ASReml-R is loaded.
This is a one-sided formula 
where "." is substituted for existing components in the 
residual component of <code>asreml.obj$call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rcov.</code></td>
<td>
<p>A character or formula specifying changes to the error 
formula, used when version 3 of ASReml-R is loaded. 
This is a one-sided formula 
where "." is substituted for existing components in the 
residual component of <code>asreml.obj$call</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>A logical indicating whether to use the variance parameter 
estimates in fitting a new model using <code>newfit.asreml</code>. 
If <code>update</code> is <code>TRUE</code> and <code>set.terms</code> is <code>NULL</code>, 
the call stored in the <code>asreml.obj</code> is evaluated using the 
variance parameter estimates stored in <code>R.param</code> and 
<code>G.param</code>, as well as the changes specified in the 
arguments to <code>newfit.asreml</code>. If <code>FALSE</code> or   
<code>set.terms</code> is not <code>NULL</code>, then the use of previous 
values of the variance parameters as initial values is not 
enforced; <code>G.param</code> and <code>R.param</code> are set to 
<code>NULL</code> or to values as specified for <code>set.terms</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>A <code>logical</code> that control output from ASReml-R. 
If TRUE then partial iteration details are displayed when ASReml-R 
functions are invoked; if FALSE then no output is displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.unconverged</code></td>
<td>
<p>A <code>logical</code> indicating whether to accept a new model 
even when it does not converge. If <code>FALSE</code> and the fit does not 
converge, the supplied <code>asreml.obj</code> is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.fixedcorrelation</code></td>
<td>
<p>A <code>logical</code> indicating whether to accept a new model 
even when it contains correlations in the model whose values have been 
designated as fixed, bound or singular. If <code>FALSE</code> and the new model 
contains correlations whose values have not been able to be estimated, 
the supplied <code>asreml.obj</code> is returned. The fit in the supplied 
the <code>asreml.obj</code> will also be tested and a warning issued if 
both fixed correlations are found in it and 
<code>allow.fixedcorrelation</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.order</code></td>
<td>
<p>A logical value indicating whether the terms should keep 
their positions. If <code>FALSE</code> the terms are reordered so 
that main effects come first, followed by the interactions, 
all second-order, all third-order and so on. Effects of a 
given order are kept in the order specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.terms</code></td>
<td>
<p>A character vector specifying the terms that are to have 
bounds and/or initial values set prior to fitting.
The names must match those in the <code>vparameters</code> component of the 
new <code>asreml.obj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.suffices</code></td>
<td>
<p>A logical vector specifying whether the suffices of the 
<code>asreml</code>-assigned names of the variance terms (i.e. the 
information to the right of an "!", other than "R!") is to 
be ignored in matching elements of <code>terms</code>. 
If <code>TRUE</code> for an element of <code>terms</code>, the suffices 
are stripped from the <code>asreml</code>-assigned names. 
If <code>FALSE</code> for an element of <code>terms</code>, the element 
must exactly match an <code>asreml</code>-assigned name for a 
variance term. This vector must be of length one or the 
same length as <code>terms</code>. If it is of length one then 
the same action is applied to the <code>asreml</code>-assigned 
suffices for all the terms in <code>terms</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>A <code>character</code> vector specifying the bounds to be applied 
to the terms specified in <code>set.terms</code>. This vector 
must be of length one or the same length as <code>set.terms</code>. 
If it is of length one then the same constraint is 
applied to all the terms in <code>set.terms</code>. 
If any of the bounds are equal to NA then they are 
left unchanged for those terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.values</code></td>
<td>
<p>A character vector specifying the initial values for  
the terms specified in <code>terms</code>. This vector 
must be of length one or the same length as <code>terms</code>. 
If it is of length one then the same initial value is 
applied to all the terms in <code>terms</code>. 
If any of the initial.values are equal to NA then they are 
left unchanged for those terms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to the call, or arguments with changed 
values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>asreml</code> object.</p>


<h3>Author(s)</h3>

<p>Chris Brien</p>


<h3>References</h3>

<p>Butler, D. G., Cullis, B. R., Gilmour, A. R., Gogel, B. J. and 
Thompson, R. (2023). <em>ASReml-R Reference Manual Version 4.2.</em>  
VSN International Ltd, <a href="https://asreml.kb.vsni.co.uk/">https://asreml.kb.vsni.co.uk/</a>.</p>


<h3>See Also</h3>

<p><code>convAsremlobj.asreml</code>, <code>update.asreml</code>, <code>setvarianceterms.call</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
    m2.asreml &lt;- newfit(m1.asreml, random. = "~ . - Blocks:Plots", maxiter=75)

## End(Not run)</code></pre>


</div>