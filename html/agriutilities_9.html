<div class="container">

<table style="width: 100%;"><tr>
<td>heritability_fa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heritability for Factor Analytic Models in ASReml-R</h2>

<h3>Description</h3>

<p>Heritability for Factor Analytic Models in ASReml-R
</p>


<h3>Usage</h3>

<pre><code class="language-R">heritability_fa(
  model_fa = NULL,
  genotype = "line",
  env = "loc",
  vc_model = c("fa2"),
  diag = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model_fa</code></td>
<td>
<p>Factor Analytic ASReml model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype</code></td>
<td>
<p>A character string indicating the column in data that
contains genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>A character string indicating the column in data that contains
environments or trials.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vc_model</code></td>
<td>
<p>A character string indicating the variance-covariance
structure. Can be "fa1", "fa2", "fa3", "fa4" or "us".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diag</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> depending on the user if they want to
take the elements on the diagonal of the variance-covariance matrix or the
elements out of the diagonal to estimate the heritability. <code>FALSE</code> by
default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object with a list of:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>h2_cullis</code></td>
<td>
<p>A numerical value of the Cullis heritability estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2_se</code></td>
<td>
<p>A numerical value of the Cullis heritability estimate based on
the standard error.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(agridat)
library(agriutilities)
data(besag.met)
dat &lt;- besag.met
results &lt;- check_design_met(
  data = dat,
  genotype = "gen",
  trial = "county",
  traits = c("yield"),
  rep = "rep",
  block = "block",
  col = "col",
  row = "row"
)
out &lt;- single_trial_analysis(results, progress = FALSE)
met_results &lt;- met_analysis(out, progress = FALSE)
model &lt;- met_results$met_models$yield
heritability_fa(
   model_fa = model,
   genotype = "genotype",
   env = "trial",
   vc_model = "us"
 )

## End(Not run)
</code></pre>


</div>