<div class="container">

<table style="width: 100%;"><tr>
<td>simPOP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate data for a demographic state-space model
</h2>

<h3>Description</h3>

<p>Simulate multiple time-series of counts under a pure Markov model (with exponential population model) or under an extended Markov model with exponential-plus-random-immigration population model; see Sollmann et al.(2015). Default is Markov model, setting <code>sd.rho</code> to a value greater than 0 changes to extended Markov and sets the amount of random immigration.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simPOP(M = 100, T = 10, mean.lam = 3, beta.lam = 0, sd.log.lam = 0,
  mean.gamma = 1.0, beta.gamma = 0, sd.log.gamma.site = 0,
  sd.log.gamma.time = 0, sd.log.gamma.survey = 0, sd.rho = 0,
  mean.p = 0.6, beta.p = 0, sd.logit.p.site = 0, sd.logit.p.time = 0,
  sd.logit.p.survey = 0, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>

<p>The number of sites.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>

<p>The number of years.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.lam</code></td>
<td>

<p>The mean abundance for year 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.lam</code></td>
<td>

<p>The covariate coefficient for lambda.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.log.lam</code></td>
<td>

<p>The over-dispersion in lambda.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.gamma</code></td>
<td>

<p>The mean population growth rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.gamma</code></td>
<td>

<p>The covariate coefficient for gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.log.gamma.site</code></td>
<td>

<p>SD of random site effects for gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.log.gamma.time</code></td>
<td>

<p>SD of random time effects for gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.log.gamma.survey</code></td>
<td>

<p>SD of random survey (site+time) effects for gamma.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.rho</code></td>
<td>

<p>The random immigration term.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.p</code></td>
<td>

<p>The mean detection probability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.p</code></td>
<td>

<p>The covariate coefficient for p.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.p.site</code></td>
<td>

<p>SD of random site effects for p on the logit scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.p.time</code></td>
<td>

<p>SD of random time effects for p on the logit scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.logit.p.survey</code></td>
<td>

<p>SD of random survey (site+time) effects for p on the logit scale.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.plot</code></td>
<td>

<p>Choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Xsite1 </code></td>
<td>
<p>M vector, site covariate affecting initial abundance (lambda).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xsiteyear1 </code></td>
<td>
<p>M x T matrix, yearly site covariate affecting recruitment (gamma).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xsiteyear2 </code></td>
<td>
<p>M x T matrix, yearly site covariate affecting detection (p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.N </code></td>
<td>
<p>M vector, site over-dispersion at t = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda </code></td>
<td>
<p>M vector, abundance in year 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.gamma.site </code></td>
<td>
<p>M vector, random site effect for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.gamma.time </code></td>
<td>
<p>T vector, random time effect for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.gamma.survey </code></td>
<td>
<p>M x T matrix, random survey effect for gamma.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma </code></td>
<td>
<p>M x T matrix, population growth rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho </code></td>
<td>
<p>(T-1) vector, immigration rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.p.site </code></td>
<td>
<p>M vector, random site effect for detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.p.time </code></td>
<td>
<p>T vector, random time effect for detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps.p.survey </code></td>
<td>
<p>M x T matrix, random survey effect for detection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>M x T matrix, detection probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N </code></td>
<td>
<p>M x T matrix, true population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C </code></td>
<td>
<p>M x T matrix, simulated counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeroNyears </code></td>
<td>
<p>scalar, sum(N == 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nextinct </code></td>
<td>
<p>scalar, number of sites where N == 0 at time T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrate </code></td>
<td>
<p>scalar, proportion of sites where N == 0 at time T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumN </code></td>
<td>
<p>T vector, total population in each year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gammaX </code></td>
<td>
<p>(T-1) vector, realized population growth rate.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Sollmann, R. et al. (2015) An open-population hierarchical distance sampling model. <em>Ecology</em>, 96, 325-331.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.7.1.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Run with the default arguments and look at the structure of the output
set.seed(123)
tmp &lt;- simPOP()
str(tmp)
head(tmp$C)


</code></pre>


</div>