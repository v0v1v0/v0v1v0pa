<div class="container">

<table style="width: 100%;"><tr>
<td>anacor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple and Canonical Correspondence Analysis</h2>

<h3>Description</h3>

<p>This function performs simple and canonical CA for possibly incomplete tables based on SVD. 
Different scaling methods for row and column scores are provided. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">anacor(tab, ndim = 2, row.covariates, col.covariates, scaling = c("Benzecri","Benzecri"), 
ellipse = FALSE, eps = 1e-06)

## S3 method for class 'anacor'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>Data frame of dimension n times m with frequencies. Missings are coded as <code>NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Number of dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.covariates</code></td>
<td>
<p>Matrix with n rows containing covariates for the row scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.covariates</code></td>
<td>
<p>Matrix with m rows containing covariates for the column scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>A vector with two elements. The first one corresponds to the method for row scaling, the second one for column scaling. Available scaling methods are <code>"standard"</code>, <code>"Benzecri"</code>, <code>"Goodman"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ellipse</code></td>
<td>
<p>If <code>TRUE</code>, confidence ellipses are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Convergence criterion for reconstitution algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Object of class <code>"anacor"</code> in <code>print.anacor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Missing values in <code>tab</code> are imputed using the reconstitution algorithm. Setting <code>scaling</code> to <code>"standard"</code> leads to standard coordinates. Principal coordinates can be computed by means of Benzecri decomposition. 
Goodman scaling is based on Fisher-Maung decomposition.  
</p>
<p>For large datasets it is suggested to set <code>ellipse = FALSE</code>. If <code>ellipse = TRUE</code>, make sure
that there are no rows and columns that have full 0 entries. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>row.scores</code></td>
<td>
<p>Scaled row scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.scores</code></td>
<td>
<p>Scaled column scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndim</code></td>
<td>
<p>Number of dimensions extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>Total chi-square value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.decomp</code></td>
<td>
<p>Chi-square decomposition across dimensions with p-values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>singular.values</code></td>
<td>
<p>Singular values without trivial solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.singular.values</code></td>
<td>
<p>Standard errors for the singular values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stestmat</code></td>
<td>
<p>Test results for singular values (only for <code>ellipse = TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>left.singvec</code></td>
<td>
<p>Left singular vectors without trivial solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>right.singvec</code></td>
<td>
<p>Right singular vectors without trivial solution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigen.values</code></td>
<td>
<p>Eigenvalues for the fitted dimensionality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eigenvall</code></td>
<td>
<p>Full vector of eigenvalues (principal inertias).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datname</code></td>
<td>
<p>Name of the dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>Table with imputed frequencies in case of missings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.covariates</code></td>
<td>
<p>Matrix with row covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.covariates</code></td>
<td>
<p>Matrix with column covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>Scaling Method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bdmat</code></td>
<td>
<p>List of matrices with observed and fitted Benzecri distances for rows and columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmse</code></td>
<td>
<p>Root mean squared error of Bezencri distances (rows and columns).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.acov</code></td>
<td>
<p>Covariance matrix for row scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.acov</code></td>
<td>
<p>Covariance matrix for column scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cancoef</code></td>
<td>
<p>List containing canonical coefficients (CCA only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sitescores</code></td>
<td>
<p>List containing the site scores (CCA only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isetcor</code></td>
<td>
<p>List containing the intraset correlations (CCA only).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jan de Leeuw, Patrick Mair</p>


<h3>References</h3>

<p>De Leeuw, J. and Mair, P. (2009). Simple and Canonical Correspondence Analysis Using the R Package anacor. Journal of Statistical Software, 31(5), 1-18. <a href="https://www.jstatsoft.org/v31/i05/">https://www.jstatsoft.org/v31/i05/</a>
</p>


<h3>See Also</h3>

<p><code>plot.anacor</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
## simple CA on Tocher data, symmetric standard coordinates
data(tocher)
res &lt;- anacor(tocher)
res

## simple CA on Tocher data, asymmetric coordinates
res &lt;- anacor(tocher, scaling = c("standard", "Benzecri"))
res

## 2- and 5-dimensional solutions for bitterling data, Benzecri scaling
data(bitterling)
res1 &lt;- anacor(bitterling, ndim = 2, scaling = c("Benzecri", "Benzecri"))
res2 &lt;- anacor(bitterling, ndim = 5, scaling = c("Benzecri", "Benzecri"))
res1
res2

## Canonical CA on Maxwell data, Goodman scaling
data(maxwell)
res &lt;- anacor(maxwell$table, row.covariates = maxwell$row.covariates, 
scaling = c("Goodman", "Goodman"))
res

</code></pre>


</div>