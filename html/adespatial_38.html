<div class="container">

<table style="width: 100%;"><tr>
<td>msr.mantelrtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Moran spectral randomization for Mantel test</h2>

<h3>Description</h3>

<p>This function allows to test the Mantel statistic using constrained null
models in the presence of spatial autocorrelation. Random replicates of the
second distance matrix are produced. They are spatially-constrained to
preserve the global autocorrelation (Moran's I) and the spatial structures at
multiple scales. Multiscale property is defined by the power spectrum (i.e.
decomposition of the variance of the original variables) on a basis of
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mantelrtest'
msr(
  x,
  listwORorthobasis,
  nrepet = x$rep,
  method = c("pair", "triplet", "singleton"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object generated by the <code>mantel.randtest</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listwORorthobasis</code></td>
<td>
<p>an object of the class <code>listw</code> (spatial
weights) created by the functions of the <span class="pkg">spdep</span> package or an object
of class <code>orthobasis</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrepet</code></td>
<td>
<p>an <code>integer</code> indicating the number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>an character specifying which algorithm should be used to
produce spatial replicates (see <code>msr.default</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments of the <code>msr.default</code> function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>randtest</code>.
</p>


<h3>Author(s)</h3>

<p>Sylvie Clappe, Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a>
</p>


<h3>References</h3>

<p>Crabot, J., Clappe, S., Dray, S. and Datry, T. (2019) Testing the
Mantel statistic with a spatially-constrained permutation procedure.
Methods in Ecology and Evolution. in press.
</p>


<h3>See Also</h3>

<p><code>msr.default</code>, <code>mantel.randtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if(require("ade4", quietly = TRUE)
&amp; require("spdep", quietly = TRUE)){
data(mafragh, package = "ade4")

d1 &lt;- dist(mafragh$env[,1:3])
d2 &lt;- dist(mafragh$env[,7])
t1 &lt;- mantel.randtest(d1,d2)
t1

lw &lt;- nb2listw(mafragh$nb)
t2 &lt;- msr(t1, listwORorthobasis = lw)
t2

}

</code></pre>


</div>