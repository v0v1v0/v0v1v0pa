<div class="container">

<table style="width: 100%;"><tr>
<td>getMRCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Retrieve the first non-root node of a lineage tree</h2>

<h3>Description</h3>

<p><code>getMRCA</code> returns the set of lineage tree nodes with the minimum weighted or 
unweighted path length from the root (germline) of the lineage tree, allowing for 
exclusion of specific groups of nodes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getMRCA(
  graph,
  path = c("distance", "steps"),
  root = "Germline",
  field = NULL,
  exclude = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>igraph object containing an annotated lineage tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>string defining whether to use unweighted (steps) or weighted (distance) 
measures for determining the founder node set..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root</code></td>
<td>
<p>name of the root (germline) node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>field</code></td>
<td>
<p>annotation field to use for both unweighted path length exclusion and
consideration as an MRCA node. If <code>NULL</code> do not exclude any nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude</code></td>
<td>
<p>vector of annotation values in <code>field</code> to exclude from the potential 
MRCA set. If <code>NULL</code> do not exclude any nodes. Has no effect if 
<code>field=NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame of the MRCA node(s) containing the columns:
</p>

<ul>
<li>  <p><code>name</code>:      node name
</p>
</li>
<li>  <p><code>steps</code>:     path length as the number of nodes traversed
</p>
</li>
<li>  <p><code>distance</code>:  path length as the sum of edge weights
</p>
</li>
</ul>
<p>Along with additional columns corresponding to the 
annotations of the input graph.
</p>


<h3>See Also</h3>

<p>Path lengths are determined with getPathLengths.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Define example graph
graph &lt;- ExampleTrees[[23]]

# Use unweighted path length and do not exclude any nodes
getMRCA(graph, path="steps", root="Germline")

# Exclude nodes without an isotype annotation and use weighted path length
getMRCA(graph, path="distance", root="Germline", field="c_call", exclude=NA)

</code></pre>


</div>