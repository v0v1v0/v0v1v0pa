<div class="container">

<table style="width: 100%;"><tr>
<td>reallocate_probs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Update allocation probabilities</h2>

<h3>Description</h3>

<p>Used internally. This function calculates new allocation probabilities for
each arm, based on the information specified in <code>setup_trial()</code>,
<code>setup_trial_binom()</code> or <code>setup_trial_norm()</code> and the calculated
probabilities of each arm being the best by <code>prob_best()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">reallocate_probs(
  probs_best,
  fixed_probs,
  min_probs,
  max_probs,
  soften_power = 1,
  match_arm = NULL,
  rescale_fixed = FALSE,
  rescale_limits = FALSE,
  rescale_factor = 1,
  rescale_ignore = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probs_best</code></td>
<td>
<p>a resulting named vector from the <code>prob_best()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_probs</code></td>
<td>
<p>numeric vector, fixed allocation probabilities for each
arm. Must be either a numeric vector with <code>NA</code> for arms without fixed
probabilities and values between <code>0</code> and <code>1</code> for the other arms or <code>NULL</code>
(default), if adaptive randomisation is used for all arms or if one of the
special settings (<code>"sqrt-based"</code>, <code>"sqrt-based start"</code>,
<code>"sqrt-based fixed"</code>, or <code>"match"</code>) is specified for <code>control_prob_fixed</code>
(described below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_probs</code></td>
<td>
<p>numeric vector, lower threshold for adaptive allocation
probabilities; lower probabilities will be rounded up to these values. Must
be <code>NA</code> (default for all arms) if no lower threshold is wanted and for arms
using fixed allocation probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_probs</code></td>
<td>
<p>numeric vector, upper threshold for adaptive allocation
probabilities; higher probabilities will be rounded down to these values.
Must be <code>NA</code> (default for all arms) if no threshold is wanted and for arms
using fixed allocation probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soften_power</code></td>
<td>
<p>either a single numeric value or a numeric vector of
exactly the same length as the maximum number of looks/adaptive analyses.
Values must be between <code>0</code> and <code>1</code> (default); if <code style="white-space: pre;">⁠&lt; 1⁠</code>, then re-allocated
non-fixed allocation probabilities are all raised to this power (followed
by rescaling to sum to <code>1</code>) to make adaptive allocation probabilities
less extreme, in turn used to redistribute remaining probability while
respecting limits when defined by <code>min_probs</code> and/or <code>max_probs</code>. If <code>1</code>,
then no <em>softening</em> is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match_arm</code></td>
<td>
<p>index of the <code>control</code> arm. If not <code>NULL</code> (default), the
control arm allocation probability will be similar to that of the best
non-control arm. Must be <code>NULL</code> in designs without a common control arm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_fixed</code></td>
<td>
<p>logical indicating whether <code>fixed_probs</code> should be
rescaled following arm dropping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_limits</code></td>
<td>
<p>logical indicating whether <code>min/max_probs</code> should be
rescaled following arm dropping.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_factor</code></td>
<td>
<p>numerical, rescale factor defined as
<code style="white-space: pre;">⁠initial number of arms/number of active arms⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale_ignore</code></td>
<td>
<p><code>NULL</code> or index of an arm that will be ignored by the
<code>rescale_fixed</code> and <code>rescale_limits</code> arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named (according to the <code>arms</code>) numeric vector with updated
allocation probabilities.
</p>


</div>