<div class="container">

<table style="width: 100%;"><tr>
<td>plot_1d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Functions for AdaPT with 1D Covariates</h2>

<h3>Description</h3>

<p>Plotting the outputs of <code>adapt</code> when <code>x</code> is 1-dimensional, including threshold curves and level curves of local FDR.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_1d_thresh(obj, x, pvals, alpha, title, xlab = "x", xlim = NULL,
  disp_ymax = 0.2, num_yticks = 3, rand_seed_perturb = NA, ...)

plot_1d_lfdr(obj, x, pvals, alpha, title, xlab = "x", xlim = NULL,
  disp_ymax = 0.2, num_yticks = 3, legend_pos = "topright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>an 'adapt' object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariates (i.e. side-information). Should be compatible to <code>models</code> and 1-dimensional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>a vector of values in [0, 1]. P-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a positive scalar in (0, 1). Target FDR level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a string. Title of the figure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>a string. Label of the x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>a vector of length 2. Limits of x-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp_ymax</code></td>
<td>
<p>a positive scalar in (0, 1]. Maximum value displayed in the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_yticks</code></td>
<td>
<p>a positive integer. Number of ticks in the y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand_seed_perturb</code></td>
<td>
<p>random seed if jitter is added. NA if no jittering is needed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_pos</code></td>
<td>
<p>a string. Position of the legend</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Load estrogen data
data(estrogen)
pvals &lt;- as.numeric(estrogen$pvals)
x &lt;- data.frame(x = as.numeric(estrogen$ord_high))
dist &lt;- beta_family()

# Subsample the data for convenience
inds &lt;- (x$x &lt;= 5000)
pvals &lt;- pvals[inds]
x &lt;- x[inds,,drop = FALSE]

# Run adapt_glm
library("splines")
formulas &lt;- paste0("ns(x, df = ", 6:10, ")")
res &lt;- adapt_glm(x = x, pvals = pvals, pi_formulas = formulas,
                 mu_formulas = formulas, dist = dist, nfits = 10)

# Plots
par(mfrow = c(2, 1))
plot_1d_thresh(res, x, pvals, 0.1, "P-value Thresholds (alpha = 0.1)",
               disp_ymax = 0.5)
plot_1d_lfdr(res, x, pvals, 0.1, "Level Curves of lfdr (alpha = 0.1)",
             disp_ymax = 0.5)

</code></pre>


</div>