<div class="container">

<table style="width: 100%;"><tr>
<td>plot_history</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot trial metric history</h2>

<h3>Description</h3>

<p>Plots the history of relevant metrics over the progress of a single or
multiple trial simulations. Simulated trials <strong>only</strong> contribute until the
time they are stopped, i.e., if some trials are stopped earlier than others,
they will not contribute to the summary statistics at later adaptive looks.
Data from individual arms in a trial contribute until the complete trial is
stopped.<br>
These history plots require non-sparse results (<code>sparse</code> set to
<code>FALSE</code>; see <code>run_trial()</code> and <code>run_trials()</code>) and the <code>ggplot2</code> package
installed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_history(object, x_value = "look", y_value = "prob", line = NULL, ...)

## S3 method for class 'trial_result'
plot_history(object, x_value = "look", y_value = "prob", line = NULL, ...)

## S3 method for class 'trial_results'
plot_history(
  object,
  x_value = "look",
  y_value = "prob",
  line = NULL,
  ribbon = list(width = 0.5, alpha = 0.2),
  cores = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>trial_results</code> object, output from the <code>run_trials()</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_value</code></td>
<td>
<p>single character string, determining whether the number of
adaptive analysis looks (<code>"look"</code>, default), the total cumulated number of
patients randomised (<code>"total n"</code>) or the total cumulated number of patients
with outcome data available at each adaptive analysis (<code>"followed n"</code>) are
plotted on the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_value</code></td>
<td>
<p>single character string, determining which values are plotted
on the y-axis. The following options are available: allocation
probabilities (<code>"prob"</code>, default), the total number of patients with
outcome data available (<code>"n"</code>) or randomised (<code>"n all"</code>) to each arm,
the percentage of patients with outcome data available (<code>"pct"</code>) or
randomised (<code>"pct all"</code>) to each arm out of the current total, the sum of
all available (<code>"sum ys"</code>) outcome data or all outcome data for randomised
patients including outcome data not available at the time of the current
adaptive analysis (<code>"sum ys all"</code>), the ratio of outcomes as defined for
<code>"sum ys"</code>/<code>"sum ys all"</code> divided by the corresponding number of patients
in each arm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line</code></td>
<td>
<p>list styling the lines as per <code>ggplot2</code> conventions (e.g.,
<code>linetype</code>, <code>linewidth</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments, not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ribbon</code></td>
<td>
<p>list, as <code>line</code> but only appropriate for <code>trial_results</code>
objects (i.e., when multiple simulations are run). Also allows to specify
the <code>width</code> of the interval: must be between 0 and 1, with <code>0.5</code> (default)
showing the inter-quartile ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p><code>NULL</code> or single integer. If <code>NULL</code>, a default value set by
<code>setup_cluster()</code> will be used to control whether extractions of simulation
results are done in parallel on a default cluster or sequentially in the
main process; if a value has not been specified by <code>setup_cluster()</code>,
<code>cores</code> will then be set to the value stored in the global <code>"mc.cores"</code>
option (if previously set by <code style="white-space: pre;">⁠options(mc.cores = &lt;number of cores&gt;⁠</code>), and
<code>1</code> if that option has not been specified.<br>
If <code>cores = 1</code>, computations
will be run sequentially in the primary process, and if <code>cores &gt; 1</code>, a new
parallel cluster will be setup using the <code>parallel</code> library and removed
once the function completes. See <code>setup_cluster()</code> for details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ggplot2</code> plot object.
</p>


<h3>See Also</h3>

<p><code>plot_status()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#### Only run examples if ggplot2 is installed ####
if (requireNamespace("ggplot2", quietly = TRUE)){

  # Setup a trial specification
  binom_trial &lt;- setup_trial_binom(arms = c("A", "B", "C", "D"),
                                   control = "A",
                                   true_ys = c(0.20, 0.18, 0.22, 0.24),
                                   data_looks = 1:20 * 100)



  # Run a single simulation with a fixed random seed
  res &lt;- run_trial(binom_trial, seed = 12345)

  # Plot total allocations to each arm according to overall total allocations
  plot_history(res, x_value = "total n", y_value = "n")

}

if (requireNamespace("ggplot2", quietly = TRUE)){

  # Run multiple simulation with a fixed random base seed
  # Notice that sparse = FALSE is required
  res_mult &lt;- run_trials(binom_trial, n_rep = 15, base_seed = 12345, sparse = FALSE)

  # Plot allocation probabilities at each look
  plot_history(res_mult, x_value = "look", y_value = "prob")

  # Other y_value options are available but not shown in these examples

}

</code></pre>


</div>