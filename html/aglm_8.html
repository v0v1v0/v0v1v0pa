<div class="container">

<table style="width: 100%;"><tr>
<td>cv.aglm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit an AGLM model with cross-validation for <code class="reqn">\lambda</code>
</h2>

<h3>Description</h3>

<p>A fitting function with given <code class="reqn">\alpha</code> and cross-validation for <code class="reqn">\lambda</code>.
See aglm-package for more details on <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.aglm(
  x,
  y,
  qualitative_vars_UD_only = NULL,
  qualitative_vars_both = NULL,
  qualitative_vars_OD_only = NULL,
  quantitative_vars = NULL,
  use_LVar = FALSE,
  extrapolation = "default",
  add_linear_columns = TRUE,
  add_OD_columns_of_qualitatives = TRUE,
  add_interaction_columns = FALSE,
  OD_type_of_quantitatives = "C",
  nbin.max = NULL,
  bins_list = NULL,
  bins_names = NULL,
  family = c("gaussian", "binomial", "poisson"),
  keep = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A design matrix.
See aglm for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qualitative_vars_UD_only</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qualitative_vars_both</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qualitative_vars_OD_only</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantitative_vars</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_LVar</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extrapolation</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_linear_columns</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_OD_columns_of_qualitatives</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_interaction_columns</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OD_type_of_quantitatives</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbin.max</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins_list</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bins_names</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Same as in aglm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>Set to <code>TRUE</code> if you need the <code>fit.preval</code> field in the returned value, as in <code>cv.glmnet()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments are passed directly when calling <code>cv.glmnet()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A model object fitted to the data with cross-validation results.
Functions such as <code>predict</code> and <code>plot</code> can be applied to the returned object, same as the result of <code>aglm()</code>.
See AccurateGLM-class for more details.
</p>


<h3>Author(s)</h3>


<ul>
<li>
<p> Kenji Kondo,
</p>
</li>
<li>
<p> Kazuhisa Takahashi and Hikari Banno (worked on L-Variable related features)
</p>
</li>
</ul>
<h3>References</h3>

<p>Suguru Fujita, Toyoto Tanaka, Kenji Kondo and Hirokazu Iwasawa. (2020)
<em>AGLM: A Hybrid Modeling Method of GLM and Data Science Techniques</em>, <br><a href="https://www.institutdesactuaires.com/global/gene/link.php?doc_id=16273&amp;fg=1">https://www.institutdesactuaires.com/global/gene/link.php?doc_id=16273&amp;fg=1</a> <br><em>Actuarial Colloquium Paris 2020</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#################### Cross-validation for lambda ####################

library(aglm)
library(faraway)

## Read data
xy &lt;- nes96

## Split data into train and test
n &lt;- nrow(xy) # Sample size.
set.seed(2018) # For reproducibility.
test.id &lt;- sample(n, round(n/5)) # ID numbders for test data.
test &lt;- xy[test.id,] # test is the data.frame for testing.
train &lt;- xy[-test.id,] # train is the data.frame for training.
x &lt;- train[, c("popul", "TVnews", "selfLR", "ClinLR", "DoleLR", "PID", "age", "educ", "income")]
y &lt;- train$vote
newx &lt;- test[, c("popul", "TVnews", "selfLR", "ClinLR", "DoleLR", "PID", "age", "educ", "income")]

# NOTE: Codes bellow will take considerable time, so run it when you have time.


## Fit the model
model &lt;- cv.aglm(x, y, family="binomial")

## Make the confusion matrix
lambda &lt;- model@lambda.min
y_true &lt;- test$vote
y_pred &lt;- levels(y_true)[as.integer(predict(model, newx, s=lambda, type="class"))]

cat(sprintf("Confusion matrix for lambda=%.5f:\n", lambda))
print(table(y_true, y_pred))


</code></pre>


</div>