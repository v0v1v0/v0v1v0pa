<div class="container">

<table style="width: 100%;"><tr>
<td>mean_amr_distance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Mean AMR Distance</h2>

<h3>Description</h3>

<p>Calculates a normalised mean for antimicrobial resistance between multiple observations, to help to identify similar isolates without comparing antibiograms by hand.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mean_amr_distance(x, ...)

## S3 method for class 'sir'
mean_amr_distance(x, ..., combine_SI = TRUE)

## S3 method for class 'data.frame'
mean_amr_distance(x, ..., combine_SI = TRUE)

amr_distance_from_row(amr_distance, row)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of class sir, mic or disk, or a data.frame containing columns of any of these classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>variables to select (supports tidyselect language such as <code>column1:column4</code> and <code>where(is.mic)</code>, and can thus also be antibiotic selectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine_SI</code></td>
<td>
<p>a logical to indicate whether all values of S and I must be merged into one, so the input only consists of S+I vs. R (susceptible vs. resistant) - the default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amr_distance</code></td>
<td>
<p>the outcome of <code>mean_amr_distance()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row</code></td>
<td>
<p>an index, such as a row number</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mean AMR distance is effectively <a href="https://en.wikipedia.org/wiki/Standard_score">the Z-score</a>; a normalised numeric value to compare AMR test results which can help to identify similar isolates, without comparing antibiograms by hand.
</p>
<p>MIC values (see <code>as.mic()</code>) are transformed with <code>log2()</code> first; their distance is thus calculated as <code>(log2(x) - mean(log2(x))) / sd(log2(x))</code>.
</p>
<p>SIR values (see <code>as.sir()</code>) are transformed using <code>"S"</code> = 1, <code>"I"</code> = 2, and <code>"R"</code> = 3. If <code>combine_SI</code> is <code>TRUE</code> (default), the <code>"I"</code> will be considered to be 1.
</p>
<p>For data sets, the mean AMR distance will be calculated per column, after which the mean per row will be returned, see <em>Examples</em>.
</p>
<p>Use <code>amr_distance_from_row()</code> to subtract distances from the distance of one row, see <em>Examples</em>.
</p>


<h3>Interpretation</h3>

<p>Isolates with distances less than 0.01 difference from each other should be considered similar. Differences lower than 0.025 should be considered suspicious.
</p>


<h3>Examples</h3>

<pre><code class="language-R">sir &lt;- random_sir(10)
sir
mean_amr_distance(sir)

mic &lt;- random_mic(10)
mic
mean_amr_distance(mic)
# equal to the Z-score of their log2:
(log2(mic) - mean(log2(mic))) / sd(log2(mic))

disk &lt;- random_disk(10)
disk
mean_amr_distance(disk)

y &lt;- data.frame(
  id = LETTERS[1:10],
  amox = random_sir(10, ab = "amox", mo = "Escherichia coli"),
  cipr = random_disk(10, ab = "cipr", mo = "Escherichia coli"),
  gent = random_mic(10, ab = "gent", mo = "Escherichia coli"),
  tobr = random_mic(10, ab = "tobr", mo = "Escherichia coli")
)
y
mean_amr_distance(y)
y$amr_distance &lt;- mean_amr_distance(y, where(is.mic))
y[order(y$amr_distance), ]

if (require("dplyr")) {
  y %&gt;%
    mutate(
      amr_distance = mean_amr_distance(y),
      check_id_C = amr_distance_from_row(amr_distance, id == "C")
    ) %&gt;%
    arrange(check_id_C)
}
if (require("dplyr")) {
  # support for groups
  example_isolates %&gt;%
    filter(mo_genus() == "Enterococcus" &amp; mo_species() != "") %&gt;%
    select(mo, TCY, carbapenems()) %&gt;%
    group_by(mo) %&gt;%
    mutate(dist = mean_amr_distance(.)) %&gt;%
    arrange(mo, dist)
}
</code></pre>


</div>