<div class="container">

<table style="width: 100%;"><tr>
<td>CreateInputsCrit_Lavenne</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creation of the InputsCrit object for Lavenne Criterion</h2>

<h3>Description</h3>

<p>Creation of the <code>InputsCrit</code> object required to the <code>ErrorCrit</code> function. This function defines a composite criterion based on the formula proposed by Lavenne et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CreateInputsCrit_Lavenne(FUN_CRIT = ErrorCrit_KGE,
                         InputsModel,
                         RunOptions,
                         Obs,
                         VarObs = "Q",
                         AprParamR,
                         AprCrit = 1,
                         k = 0.15,
                         BoolCrit = NULL,
                         transfo = "sqrt",
                         epsilon = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>FUN_CRIT</code></td>
<td>
<p>[function] error criterion function (e.g. <code>ErrorCrit_KGE</code>, <code>ErrorCrit_NSE</code>). Default <code>ErrorCrit_KGE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>InputsModel</code></td>
<td>
<p>[object of class <em>InputsModel</em>] see <code>CreateInputsModel</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RunOptions</code></td>
<td>
<p>[object of class <em>RunOptions</em>] see <code>CreateRunOptions</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Obs</code></td>
<td>
<p>[numeric (atomic or list)] series of observed variable ([mm/time step] for discharge or SWE, [-] for SCA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarObs</code></td>
<td>
<p>(optional) [character (atomic or list)] names of the observed variable (<code>"Q"</code> by default, or one of <code>"SCA"</code>, <code>"SWE"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AprParamR</code></td>
<td>
<p>[numeric] a priori parameter set from a donor catchment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AprCrit</code></td>
<td>
<p>(optional) [numeric] performance criterion of the donor catchment (1 by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(optional) [numeric] coefficient used for the weighted average between <code>FUN_CRIT</code> and the gap between the optimised parameter set and an a priori parameter set calculated with the function produced by <code>CreateErrorCrit_GAPX</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BoolCrit</code></td>
<td>
<p>(optional) [boolean] boolean (the same length as <code>Obs</code>) giving the time steps to consider in the computation (all time steps are considered by default. See details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transfo</code></td>
<td>
<p>(optional) [character] name of the transformation applied to the variables (e.g. <code>""</code>, <code>"sqrt"</code>, <code>"log"</code>, <code>"inv"</code>, <code>"sort"</code>, <code>"boxcox"</code> or a numeric value for power transformation for <code>FUN_CRIT</code>. Default value is <code>"sqrt"</code>. See details of <code>CreateInputsCrit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>(optional) [numeric] small value to add to all observations and simulations for <code>FUN_CRIT</code> when <code>"log"</code> or <code>"inv"</code> transformations are used [same unit as <code>Obs</code>]. See details of <code>CreateInputsCrit</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameters <code>FUN_CRIT</code>, <code>Obs</code>, <code>VarObs</code>, <code>BoolCrit</code>, <code>transfo</code>, and <code>epsilon</code> must be used as they would be used for <code>CreateInputsCrit</code> in the case of a single criterion.
</p>
<p><code>ErrorCrit_RMSE</code> cannot be used in a composite criterion since it is not a unitless value.
</p>
<p><code>CreateInputsCrit_Lavenne</code> creates a composite criterion in respect with Equations 1 and 2 of de Lavenne et al. (2019).
</p>


<h3>Value</h3>

<p>[list] object of class InputsCrit containing the data required to evaluate the model outputs (see <code>CreateInputsCrit</code> for more details).
</p>
<p><code>CreateInputsCrit_Lavenne</code> returns an object of class <em>Compo</em>.
</p>
<p>Items <code>Weights</code> of the criteria are respectively equal to <code>k</code> and <code>k * max(0, AprCrit)</code>.
</p>
<p>To calculate the Lavenne criterion, it is necessary to use the <code>ErrorCrit</code> function as for any other composite criterion.
</p>


<h3>Author(s)</h3>

<p>David Dorchies
</p>


<h3>References</h3>

<p>de Lavenne, A., Andréassian, V., Thirel, G., Ramos, M.-H. and Perrin, C. (2019).
A Regularization Approach to Improve the Sequential Calibration of a Semidistributed Hydrological Model.
Water Resources Research 55, 8821–8839. <a href="https://doi.org/10.1029/2018WR024266">doi:10.1029/2018WR024266</a>
</p>


<h3>See Also</h3>

<p><code>RunModel</code>, <code>CreateInputsModel</code>, <code>CreateRunOptions</code>, <code>CreateCalibOptions</code>, <code>ErrorCrit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(airGR)

## loading catchment data
data(L0123001)

## preparation of the InputsModel object
InputsModel &lt;- CreateInputsModel(FUN_MOD = RunModel_GR4J, DatesR = BasinObs$DatesR,
                                 Precip = BasinObs$P, PotEvap = BasinObs$E)

## calibration period selection
Ind_Run &lt;- seq(which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1990-01-01"),
               which(format(BasinObs$DatesR, format = "%Y-%m-%d")=="1999-12-31"))

## preparation of RunOptions object
RunOptions &lt;- CreateRunOptions(FUN_MOD = RunModel_GR4J, InputsModel = InputsModel,
                               IndPeriod_Run = Ind_Run)

## simulation
Param &lt;- c(X1 = 257.238, X2 = 1.012, X3 = 88.235, X4 = 2.208)
OutputsModel &lt;- RunModel_GR4J(InputsModel = InputsModel,
                              RunOptions = RunOptions, Param = Param)

## The "a priori" parameters for the Lavenne formula
AprParamR &lt;- c(X1 = 157, X2 = 0.8, X3 = 100, X4 = 1.5)

## Single efficiency criterion: GAPX with a priori parameters
IC_DL &lt;- CreateInputsCrit_Lavenne(InputsModel = InputsModel,
                                    RunOptions = RunOptions,
                                    Obs = BasinObs$Qmm[Ind_Run],
                                    AprParamR = AprParamR)
str(ErrorCrit(InputsCrit = IC_DL, OutputsModel = OutputsModel))
</code></pre>


</div>