<div class="container">

<table style="width: 100%;"><tr>
<td>aisoph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Additive Isotonic Proportional Hazards Model</h2>

<h3>Description</h3>

<p>Nonparametric estimation of additive isotonic covariate effects for proportional hazards model.</p>


<h3>Usage</h3>

<pre><code class="language-R">  aisoph(time, status, z1, z2, x, shape1, shape2, K1, K2, maxiter, eps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>survival time. It must be greater than 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>censoring indication. It must be 0 or 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z1</code></td>
<td>
<p>First covariate under order-restriction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z2</code></td>
<td>
<p>Second covariate under-order restriction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Additional covariates (vector or data.frame). This argument is optional</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>
<p>Shape-restriction for <code class="reqn"> z1 </code>, "increasing" or "decreasing".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>
<p>Shape-restriction for <code class="reqn"> z2 </code>, "increasing" or "decreasing".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K1</code></td>
<td>
<p>anchor constraint for <code class="reqn"> z1 </code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K2</code></td>
<td>
<p>anchor constraint for <code class="reqn"> z2 </code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iteration (default is 10^5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>stopping convergence criteria (default is 10^-3).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The aisoph function allows to analyze additive isotonic proportional hazards model, which is defined as
</p>
<p style="text-align: center;"><code class="reqn"> \lambda(t|z1, z2, x)=\lambda0(t)exp(\psi1(z1)+\psi2(z2)+\beta x), </code>
</p>

<p>where <code class="reqn"> \lambda0 </code> is an unspecified baseline hazard function, <code class="reqn"> \psi1 </code> and <code class="reqn"> \psi2 </code> are monotone increasing (or decreasing) functions in <code class="reqn">z1</code> and <code class="reqn">z2</code>, respectively, <code class="reqn">x</code> is a covariate, and <code class="reqn"> \beta </code> is a regression paramter. If <code class="reqn"> x </code> is omitted in the formulation above, <code class="reqn"> \psi1 </code> and <code class="reqn"> \psi2 </code> are only estimated.
</p>
<p>The model is not identifiable without the anchor constraint, <code class="reqn">\psi1(K1)=0</code> and <code class="reqn">\psi2(K2)=0</code>. By default, <code class="reqn">K1</code> and <code class="reqn">K2</code> are set to medians of <code class="reqn">z1</code> and <code class="reqn">z2</code> values, respectively. The choice of the anchor points is less important in the sense that hazard ratios do not depend on the anchors.</p>


<h3>Value</h3>

<p>A list of class isoph:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>iso1</code></td>
<td>
<p>data.frame estimated <code class="reqn">\psi1</code>, estimated <code class="reqn">\exp(\psi1)</code>, and cens at <code class="reqn">z1</code>, where <code class="reqn">\exp(\psi1)</code> is a hazard ratio between <code class="reqn">z1</code> and <code class="reqn">K1</code>, and cens="no" if (at least one) subject is not censored at <code class="reqn">z1</code> or cens="yes" otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iso2</code></td>
<td>
<p>data.frame estimated <code class="reqn">\psi2</code>, estimated <code class="reqn">\exp(\psi2)</code>, and cens at <code class="reqn">z2</code>, where <code class="reqn">\exp(\psi2)</code> is a hazard ratio between <code class="reqn">z2</code> and <code class="reqn">K2</code>, and cens="no" if (at least one) subject is not censored at <code class="reqn">z2</code> or cens="yes" otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>data.frame with estimated <code class="reqn">\beta</code>, and <code class="reqn">\exp(\beta)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>status of algorithm convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape1</code></td>
<td>
<p>shape-constrain for <code class="reqn">\psi1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape2</code></td>
<td>
<p>shape-constrain for <code class="reqn">\psi2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K1</code></td>
<td>
<p>anchor point for K1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K2</code></td>
<td>
<p>anchor point for K2.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yunro Chung [aut, cre]</p>


<h3>References</h3>

<p>Yunro Chung, Anastasia Ivanova, Jason P. Fine, Additive isotonic proportional hazards models (working in progress).</p>


<h3>Examples</h3>

<pre><code class="language-R">#require(survival)
#require(Iso)

###
# 1. time-independent covariate with monotone increasing effect
###
# 1.1. create a test data set 1
time=  c(1, 6, 3, 6, 7, 8, 1, 4, 0, 2, 1, 5, 8, 7, 4)
status=c(1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
z1=     c(3, 1, 2, 4, 8, 3, 3, 4, 1, 9, 4, 2, 2, 8, 5)
z2=     c(1, 3, 5, 6, 1, 7, 6, 8, 3, 4, 8, 8, 5, 2, 3)

# 1.2. Fit isotonic proportional hazards model
res1 = aisoph(time=time, status=status, z1=z1, z2=z2, 
              shape1="increasing", shape2="increasing")

# 1.3. print result
res1

#1.4. plot
plot(res1)

###
# 2. time-independent covariate with monotone increasing effect
###
# 2.1. create a test data set 1
time=  c(0,4,8,9,5,6,9,8,2,7,4,2,6,2,5,9,4,3,8,2)
status=c(0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1)
z1=    c(3,2,1,1,3,1,8,4,3,6,2,9,9,0,7,7,2,3,4,6)
z2=    c(3,6,9,9,4,3,9,8,4,7,2,3,1,3,7,0,1,6,4,1)
trt=   c(0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1)

# 2.2. Fit isotonic proportional hazards model
res2 = aisoph(time=time, status=status, z1=z1, z2=z2, x=trt,
              shape1="increasing", shape2="increasing")

# 2.3. print result
res2

#2.4. plot
plot(res2)
</code></pre>


</div>