<div class="container">

<table style="width: 100%;"><tr>
<td>SPDsimulationTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Goodness of Fit test, using SPD simulation</h2>

<h3>Description</h3>

<p>Calculates the data p-value given a model.</p>


<h3>Usage</h3>

<pre><code class="language-R">SPDsimulationTest(data, calcurve, calrange, pars, type, inc=5, N=20000)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A dataframe of 14C dates. Requires 'age' and 'sd', and at least one of 'site' and 'phase'. Optional 'datingType' comprising '14C' and/or anything else.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calcurve</code></td>
<td>

<p>A calibration curve object. Choose from intcal20 (default), shcal20, intcal13 or shcal13.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calrange</code></td>
<td>

<p>A vector of two calendar dates BP, giving the calendar range of CalArray. Can be in either order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>

<p>A single vector of one parameter combination. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>Choose 'CPL' for a Continuous Piecewise Linear model, 'exp' for an exponential model, or 'uniform' for a uniform model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc</code></td>
<td>

<p>Increments to interpolate calendar years. Default = 5
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>The number of simulations to generate.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The returned list provides various summary statistics and timeseries of the observed and simulated data:
</p>
<p>timeseries: a data frame containing various CIs and: 
</p>
<p>calBP: a vector of calendar years BP. 
</p>
<p>expected.sim: a vector of the expected simulation (mean average of all N simulations). 
</p>
<p>local.sd: a vector of the local (for each year) standard deviation of all N simulations.
</p>
<p>model: a vector of the model PDF.
</p>
<p>SPD: a vector of the observed SPD PDF, generated from data.
</p>
<p>index: a vector of -1,0,+1 corresponding to the SPD points that are above, within or below the 95% CI of all N simulations.
</p>
<p>pvalue: the proportion of N simulated SPDs that have more points outside the 95% CI than the observed SPD has.
</p>
<p>observed.stat: the summary statistic for the observed data (number of points outside the 95% CI).
</p>
<p>simulated.stat: a vector of summary statistics (number of points outside the 95% CI), one for each simulated SPD.
</p>
<p>n.dates.all: the total number of dates in the whole data set. Trivially, the number of rows in data.
</p>
<p>n.dates.effective: the effective number of dates within the date range. Will be non-integer since a proportion of some dates will be outside the date range.
</p>
<p>n.phases.all: the total number of phases in the whole data set. 
</p>
<p>n.phases.effective: the effective number of phases within the date range. Will be non-integer since a proportion of some phases will be outside the date range.
</p>
<p>n.phases.internal: an integer subset of n.phases.all that have more than 50% of their total probability mass within the date range.
</p>
<p>The default N = 20000 can be increased if greater precision is required, however this can be very time costly.
</p>


<h3>Value</h3>

<p>Returns a list. See details.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# trivial example showing a single date can never be rejected under a uniform model:
data &lt;- data.frame(age=6500, sd=50, phase=1, datingType='14C')
x &lt;- SPDsimulationTest(data, 
	calcurve=intcal20, 
	calrange=c(6000,9000), 
	pars=NULL, 
	type='uniform')
print(x$pvalue)

</code></pre>


</div>