<div class="container">

<table style="width: 100%;"><tr>
<td>ext_img</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>External images for Word output</h2>

<h3>Description</h3>

<p>This is a modified version of the <code>external_img</code>
function from the <code>officer</code> package for use in <code>rmd2word</code>.
The modification is to allow the use of the <code>knitr</code> chunk
options <code>out.width</code> and/or <code>out.height</code> to set the dimensions of a
figure (R-generated or external image) when the output format is a Word
document. This functionality is not normally available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ext_img(src, width = 0.5, height = 0.2, alt = "", ref_docx_dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>src</code></td>
<td>
<p>image file path</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width in inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>height in inches</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alt</code></td>
<td>
<p>alternative text for images</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref_docx_dim</code></td>
<td>
<p>A list containing the components <code>page</code> (a named
numeric vector containing the <code>width</code> and <code>height</code>),
<code>landscape</code> (a logical vector) and <code>margins</code> (a named numeric
vector containing the <code>top</code>, <code>bottom</code>, <code>left</code>,
<code>right</code>, <code>header</code> and <code>footer</code> margins). See
<strong>Details</strong>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If in the current R code chunk <code>out.width</code> or
<code>out.height</code> have been set then the corresponding values of
<code>fig.width</code> and <code>fig.height</code> are inferred from the dimensions
of the figure and the page dimensions of the output Word document.
The former are obtained using <code>readPNG</code> or
<code>readJPEG</code> as appropriate.  If only one of
<code>out.width</code> or <code>out.height</code> are set then the aspect ratio of the
figure is preserved.
</p>
<p><code>ref_docx_dim</code> can be produced using
<code>officer::docx_dim(officer::read_docx(doc))</code>, where <code>doc</code> is an
<code>docx_dim</code> object and <code>docx_dim</code>
and <code>read_docx</code> are functions in the <code>officer</code>
package.
</p>


<h3>Value</h3>

<p>An object of class <code>c("external_img", "cot", "run")</code> with
attributes <code>"dims"</code> (a named list containing the figure's
<code>width</code> and <code>height</code>) and <code>"alt"</code> (a character scalar
containing the alternative text for the figure).
</p>


<h3>Note</h3>

<p>This function has been designed for use inside <code>rmd2word</code>
but the object returned has the same structure as that returned from
<code>external_img</code>. Outside the context of a
<code>knitr</code> R code chunk the outputs from <code>external_img</code> and
<code>ext_img</code> are identical.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example from the officer::external_img() documentation
# Wrap R logo with external_img ----
srcfile &lt;- file.path( R.home("doc"), "html", "logo.jpg" )
extimg &lt;- ext_img(src = srcfile, height = 1.06 / 2, width = 1.39 / 2)
</code></pre>


</div>