<div class="container">

<table style="width: 100%;"><tr>
<td>aspline</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit B-splines with automatic knot selection.</h2>

<h3>Description</h3>

<p>Fit B-splines with automatic knot selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aspline(
  x,
  y,
  knots = seq(min(x), max(x), length = 42)[-c(1, 42)],
  pen = 10^seq(-3, 3, length = 100),
  degree = 3L,
  family = c("gaussian", "binomial", "poisson"),
  maxiter = 1000,
  epsilon = 1e-05,
  verbose = FALSE,
  tol = 1e-06
)

aridge_solver(
  x,
  y,
  knots = seq(min(x), max(x), length = 42)[-c(1, 42)],
  pen = 10^seq(-3, 3, length = 100),
  degree = 3L,
  family = c("gaussian", "binomial", "poisson"),
  maxiter = 1000,
  epsilon = 1e-05,
  verbose = FALSE,
  tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Input data, numeric vectors of same length</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>Knots</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen</code></td>
<td>
<p>A vector of positive penalty values. The adaptive spline regression is performed for every value of pen</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>The degree of the splines. Recommended value is 3, which corresponds to natural splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model. The "gaussian", "binomial", and "poisson" families are currently implemented, corresponding to the linear regression, logistic regression, and Poisson regression, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations  in the main loop.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>Value of the constant in the adaptive ridge procedure (see <em>Frommlet, F., Nuel, G. (2016)
An Adaptive Ridge Procedure for L0 Regularization</em>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to print details at each step of the iterative procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>The tolerance chosen to diagnostic convergence of the adaptive ridge procedure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li>
<p><code>sel</code>: list giving for each value of <code>lambda</code> the vector of the knot selection weights (a knot is selected if its weight is equal to 1.)
</p>
</li>
<li>
<p><code>knots_sel</code>: list giving for each value of <code>lambda</code> the vector of selected knots.
</p>
</li>
<li>
<p><code>model</code>: list giving for each value of <code>lambda</code> the fitted regression model.
</p>
</li>
<li>
<p><code>par</code>: parameters of the models for each value of <code>lambda</code>.
</p>
</li>
<li>
<p><code>sel_mat</code>: matrix of booleans whose columns indicate whether each knot is selected.
</p>
</li>
<li>
<p><code>aic</code>, <code>bic</code>, and <code>ebic</code>: Akaike Information Criterion (AIC), Bayesian Information Criterion (BIC), and Extended BIC (EBIC) scores, for each value of <code>lambda</code>.
</p>
</li>
<li>
<p><code>dim</code>: number of selected knots for each value of <code>lambda</code>.
</p>
</li>
<li>
<p><code>loglik</code>: log-likelihood of the selected model, for each value of <code>lambda</code>.
</p>
</li>
</ul>
<h3>Functions</h3>


<ul><li> <p><code>aridge_solver</code>: Alias for <code>aspline</code>, for backwards compatibility.
</p>
</li></ul>
</div>