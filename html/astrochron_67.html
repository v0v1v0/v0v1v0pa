<div class="container">

<table style="width: 100%;"><tr>
<td>mwCor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate moving window correlation coefficient for two stratigraphic series, using a 'dynamic window'</h2>

<h3>Description</h3>

<p>Calculate moving window correlation coefficient for two stratigraphic series, using a 'dynamic window'. 
This routine adjusts the number of data points in the window so it has a constant duration in time or space, for use with unevenly sampled data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mwCor(dat,cols=NULL,win=NULL,conv=1,cormethod=1,output=T,pl=1,genplot=T,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Your data frame containing stratigraphic data; any number of columns (variables) are permitted, but the first column should be a location identifier (e.g., depth, height, time).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>A vector that identifies the two variable columns to be extracted (first column automatically extracted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>
<p>Moving window size in units of space or time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p>Convention for window placement: (1) center each window on a stratigraphic level in 'dat' (DEFAULT), (2) start with the smallest location datum in 'dat', (3) start with the largest location datum in 'dat'. For options 2 and 3, the center of the window will not necessarily coincide with a measured stratigraphic level in 'dat', but edges of the data set are better preserved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cormethod</code></td>
<td>
<p>Method used for calculation of correlation coefficient (1=Pearson, 2=Spearman, 3=Kendall)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Output results? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pl</code></td>
<td>
<p>(1) Plot results at center of window, or (2) create "string of points plot" as in Sageman and Hollander (1999)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>B.B. Sageman and D.H. Hollander, 1999,
<em>Cross correlation of paleoecological and geochemical proxies: A holistic approach to the study of past global change</em>, in E. Barrera and C.C. Johnson, eds., GSA Special Paper 332, p. 365-384.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate example series
ex &lt;- cycles(freqs=c(1/40,1/20),noisevar=.2)

# add second variable
ex[3] &lt;- cycles(freqs=c(1/40,1/20),noisevar=0.2)[2]

# jitter sampling times
ex[1]=ex[1]+rnorm(500,sd=1)
# sort
ex = ex[order(ex[,1],na.last=NA,decreasing=FALSE),]

# run mwCor
mwCor(ex,win=50)
</code></pre>


</div>