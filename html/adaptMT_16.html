<div class="container">

<table style="width: 100%;"><tr>
<td>plot_2d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting Functions for AdaPT with 2D Covariates</h2>

<h3>Description</h3>

<p>Plotting the outputs of <code>adapt</code> when <code>x</code> is 2-dimensional, including threshold curves and level curves of local FDR.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_2d_thresh(obj, x, pvals, alpha, title, xlab = NULL, ylab = NULL,
  keyaxes = list(), ...)

plot_2d_lfdr(obj, x, pvals, alpha, title, targetp, xlab = NULL, ylab = NULL,
  keyaxes = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>an 'adapt' object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariates (i.e. side-information). Should be compatible to <code>models</code> and 2-dimensional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvals</code></td>
<td>
<p>a vector of values in [0, 1]. P-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a positive scalar in (0, 1). Target FDR level</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>a string. Title of the figure</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>a string. Label of x/y-axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keyaxes</code></td>
<td>
<p>a list of arguments passed into axis. The graphical setting for the legend bar. An empty list by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments passed to <code>par</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetp</code></td>
<td>
<p>a real in (0, 1). See Details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The breaks in the legend of <code>plot_2d_thresh</code> correspond to the maximum, the 95
</p>
<p><code>plot_2d_lfdr</code> gives the contour plot of local FDR estimates when all p-values are equal to <code>targetp</code>. It is recommended to run <code>plot_2d_lfdr</code> for multiple <code>targetp</code>'s ranging from 0.001, 0.005, 0.01, 0.05.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Generate a 2-dim x
n &lt;- 400
x1 &lt;- x2 &lt;- seq(-100, 100, length.out = 20)
x &lt;- expand.grid(x1, x2)
colnames(x) &lt;- c("x1", "x2")

# Generate p-values (one-sided z test)
# Set all hypotheses in the central circle with radius 30 to be
# non-nulls. For non-nulls, z~N(2,1) and for nulls, z~N(0,1).
H0 &lt;- apply(x, 1, function(coord){sum(coord^2) &lt; 900})
mu &lt;- ifelse(H0, 2, 0)
set.seed(0)
zvals &lt;- rnorm(n) + mu
pvals &lt;- 1 - pnorm(zvals)

# Run adapt_gam with a 2d spline basis
library("mgcv")
formula &lt;- "s(x1, x2)"
dist &lt;- beta_family()
res &lt;- adapt_gam(x = x, pvals = pvals, pi_formulas = formula,
                 mu_formulas = formula, dist = dist, nfits = 5)

# Plots
plot_2d_thresh(res, x, pvals, 0.3, "P-value Thresholds (alpha = 0.3)")
plot_2d_lfdr(res, x, pvals, 0.3, "Local FDR Estimates (alpha = 0.3, p = 0.01)", 0.01)

</code></pre>


</div>