<div class="container">

<table style="width: 100%;"><tr>
<td>plot.CMA1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot CMA0-derived objects.</h2>

<h3>Description</h3>

<p>Plots the event data and estimated CMA encapsulated in objects derived from
<code>CMA0</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'CMA1'
plot(
  x,
  ...,
  patients.to.plot = NULL,
  duration = NA,
  align.all.patients = FALSE,
  align.first.event.at.zero = FALSE,
  show.period = c("dates", "days")[2],
  period.in.days = 90,
  show.legend = TRUE,
  legend.x = "right",
  legend.y = "bottom",
  legend.bkg.opacity = 0.5,
  legend.cex = 0.75,
  legend.cex.title = 1,
  cex = 1,
  cex.axis = 0.75,
  cex.lab = 1,
  show.cma = TRUE,
  col.cats = rainbow,
  unspecified.category.label = "drug",
  medication.groups.to.plot = NULL,
  medication.groups.separator.show = TRUE,
  medication.groups.separator.lty = "solid",
  medication.groups.separator.lwd = 2,
  medication.groups.separator.color = "blue",
  medication.groups.allother.label = "*",
  lty.event = "solid",
  lwd.event = 2,
  pch.start.event = 15,
  pch.end.event = 16,
  show.event.intervals = TRUE,
  col.na = "lightgray",
  print.CMA = TRUE,
  CMA.cex = 0.5,
  plot.CMA = TRUE,
  CMA.plot.ratio = 0.1,
  CMA.plot.col = "lightgreen",
  CMA.plot.border = "darkgreen",
  CMA.plot.bkg = "aquamarine",
  CMA.plot.text = CMA.plot.border,
  highlight.followup.window = TRUE,
  followup.window.col = "green",
  highlight.observation.window = TRUE,
  observation.window.col = "yellow",
  observation.window.density = 35,
  observation.window.angle = -30,
  observation.window.opacity = 0.3,
  show.real.obs.window.start = TRUE,
  real.obs.window.density = 35,
  real.obs.window.angle = 30,
  print.dose = FALSE,
  cex.dose = 0.75,
  print.dose.outline.col = "white",
  print.dose.centered = FALSE,
  plot.dose = FALSE,
  lwd.event.max.dose = 8,
  plot.dose.lwd.across.medication.classes = FALSE,
  alternating.bands.cols = c("white", "gray95"),
  bw.plot = FALSE,
  rotate.text = -60,
  force.draw.text = FALSE,
  min.plot.size.in.characters.horiz = 0,
  min.plot.size.in.characters.vert = 0,
  max.patients.to.plot = 100,
  export.formats = NULL,
  export.formats.fileprefix = "AdhereR-plot",
  export.formats.height = NA,
  export.formats.width = NA,
  export.formats.save.svg.placeholder = TRUE,
  export.formats.svg.placeholder.type = c("jpg", "png", "webp")[2],
  export.formats.svg.placeholder.embed = FALSE,
  export.formats.directory = NA,
  export.formats.html.template = NULL,
  export.formats.html.javascript = NULL,
  export.formats.html.css = NULL,
  generate.R.plot = TRUE,
  do.not.draw.plot = FALSE
)

## S3 method for class 'CMA2'
plot(...)

## S3 method for class 'CMA3'
plot(...)

## S3 method for class 'CMA4'
plot(...)

## S3 method for class 'CMA5'
plot(...)

## S3 method for class 'CMA6'
plot(...)

## S3 method for class 'CMA7'
plot(...)

## S3 method for class 'CMA8'
plot(...)

## S3 method for class 'CMA9'
plot(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <em><code>CMA0</code></em> or derived object, representing the CMA to
plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other possible parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patients.to.plot</code></td>
<td>
<p>A vector of <em>strings</em> containing the list of
patient IDs to plot (a subset of those in the <code>cma</code> object), or
<code>NULL</code> for all</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration</code></td>
<td>
<p>A <em>number</em>, the total duration (in days) of the whole
period to plot; in <code>NA</code> it is automatically determined from the event
data such that the whole dataset fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align.all.patients</code></td>
<td>
<p><em>Logical</em>, should all patients be aligned
(i.e., the actual dates are discarded and all plots are relative to the
earliest date)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align.first.event.at.zero</code></td>
<td>
<p><em>Logical</em>, should the first event be
placed at the origin of the time axis (at 0)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.period</code></td>
<td>
<p>A <em>string</em>, if "dates" show the actual dates at the
regular grid intervals, while for "days" (the default) shows the days since
the beginning; if <code>align.all.patients == TRUE</code>, <code>show.period</code> is
taken as "days".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period.in.days</code></td>
<td>
<p>The <em>number</em> of days at which the regular grid is
drawn (or 0 for no grid).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.legend</code></td>
<td>
<p><em>Logical</em>, should the legend be drawn?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.x</code></td>
<td>
<p>The position of the legend on the x axis; can be "left",
"right" (default), or a <em>numeric</em> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.y</code></td>
<td>
<p>The position of the legend on the y axis; can be "bottom"
(default), "top", or a <em>numeric</em> value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.bkg.opacity</code></td>
<td>
<p>A <em>number</em> between 0.0 and 1.0 specifying the
opacity of the legend background.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex, cex.axis, cex.lab, legend.cex, legend.cex.title, CMA.cex</code></td>
<td>
<p><em>numeric</em>
values specifying the <code>cex</code> of the various types of text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.cma</code></td>
<td>
<p><em>Logical</em>, should the CMA type be shown in the title?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.cats</code></td>
<td>
<p>A <em>color</em> or a <em>function</em> that specifies the single
colour or the colour palette used to plot the different medication; by
default <code>rainbow</code>, but we recommend, whenever possible, a
colorblind-friendly palette such as <code>viridis</code> or <code>colorblind_pal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unspecified.category.label</code></td>
<td>
<p>A <em>string</em> giving the name of the
unspecified (generic) medication category.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.groups.to.plot</code></td>
<td>
<p>the names of the medication groups to plot or
<code>NULL</code> (the default) for all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.groups.separator.show</code></td>
<td>
<p>a <em>boolean</em>, if <code>TRUE</code> (the
default) visually mark the medication groups the belong to the same patient,
using horizontal lines and alternating vertical lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.groups.separator.lty, medication.groups.separator.lwd, medication.groups.separator.color</code></td>
<td>
<p>graphical parameters (line type, line width and colour describing the visual
marking og medication groups as beloning to the same patient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medication.groups.allother.label</code></td>
<td>
<p>a <em>string</em> giving the label to
use for the implicit <code>__ALL_OTHERS__</code> medication group (defaults to "*").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty.event, lwd.event, pch.start.event, pch.end.event</code></td>
<td>
<p>The style of the
event (line style, width, and start and end symbols).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.event.intervals</code></td>
<td>
<p><em>Logical</em>, should the actual event intervals
be shown?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.na</code></td>
<td>
<p>The colour used for missing event data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.CMA</code></td>
<td>
<p><em>Logical</em>, should the CMA values be printed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.CMA</code></td>
<td>
<p><em>Logical</em>, should the CMA values be represented
graphically?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CMA.plot.ratio</code></td>
<td>
<p>A <em>number</em>, the proportion of the total horizontal
plot space to be allocated to the CMA plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CMA.plot.col, CMA.plot.border, CMA.plot.bkg, CMA.plot.text</code></td>
<td>
<p><em>Strings</em>
giving the colours of the various components of the CMA plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.followup.window</code></td>
<td>
<p><em>Logical</em>, should the follow-up window
be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>followup.window.col</code></td>
<td>
<p>The follow-up window's colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight.observation.window</code></td>
<td>
<p><em>Logical</em>, should the observation
window be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>observation.window.col, observation.window.density, observation.window.angle, observation.window.opacity</code></td>
<td>
<p>Attributes of the observation window (colour, shading density, angle and
opacity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.real.obs.window.start, real.obs.window.density, real.obs.window.angle</code></td>
<td>
<p>For some CMAs, the observation window might
be adjusted, in which case should it be plotted and with that attributes?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.dose</code></td>
<td>
<p><em>Logical</em>, should the daily dose be printed as text?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.dose</code></td>
<td>
<p><em>Numeric</em>, if daily dose is printed, what text size
to use?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.dose.outline.col</code></td>
<td>
<p>If <em><code>NA</code></em>, don't print dose text with
outline, otherwise a color name/code for the outline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.dose.centered</code></td>
<td>
<p><em>Logical</em>, print the daily dose centered on
the segment or slightly below it?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dose</code></td>
<td>
<p><em>Logical</em>, should the daily dose be indicated through
segment width?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd.event.max.dose</code></td>
<td>
<p><em>Numeric</em>, the segment width corresponding to
the maximum daily dose (must be &gt;= lwd.event but not too big either).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dose.lwd.across.medication.classes</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code>,
the line width of the even is scaled relative to all medication classes (i.e.,
relative to the global minimum and maximum doses), otherwise it is scale
relative only to its medication class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternating.bands.cols</code></td>
<td>
<p>The colors of the alternating vertical bands
distinguishing the patients; can be <code>NULL</code> = don't draw the bandes;
or a vector of colors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw.plot</code></td>
<td>
<p><em>Logical</em>, should the plot use grayscale only (i.e., the
<code>gray.colors</code> function)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate.text</code></td>
<td>
<p><em>Numeric</em>, the angle by which certain text elements
(e.g., axis labels) should be rotated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force.draw.text</code></td>
<td>
<p><em>Logical</em>, if <code>TRUE</code>, always draw text even
if too big or too small</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.plot.size.in.characters.horiz, min.plot.size.in.characters.vert</code></td>
<td>
<p><em>Numeric</em>, the minimum size of the plotting surface in characters;
horizontally (min.plot.size.in.characters.horiz) refers to the the whole
duration of the events to plot; vertically (min.plot.size.in.characters.vert)
refers to a single event. If the plotting is too small, possible solutions
might be: if within <code>RStudio</code>, try to enlarge the "Plots" panel, or
(also valid outside <code>RStudio</code> but not if using <code>RStudio server</code>
start a new plotting device (e.g., using <code>X11()</code>, <code>quartz()</code>
or <code>windows()</code>, depending on OS) or (works always) save to an image
(e.g., <code>jpeg(...); ...; dev.off()</code>) and display it in a viewer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.patients.to.plot</code></td>
<td>
<p><em>Numeric</em>, the maximum patients to attempt
to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats</code></td>
<td>
<p>a <em>string</em> giving the formats to export the figure
to (by default <code>NULL</code>, meaning no exporting); can be any combination of
"svg" (just an <code>SVG</code> file), "html" (<code>SVG</code> + <code>HTML</code> + <code>CSS</code>
+ <code>JavaScript</code>, all embedded within one <code>HTML</code> document), "jpg",
"png", "webp", "ps" or "pdf".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.fileprefix</code></td>
<td>
<p>a <em>string</em> giving the file name prefix
for the exported formats (defaults to "AdhereR-plot").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.height, export.formats.width</code></td>
<td>
<p><em>numbers</em> giving the
desired dimensions (in pixels) for the exported figure (defaults to sane
values if <code>NA</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.save.svg.placeholder</code></td>
<td>
<p>a <em>logical</em>, if TRUE, save an
image placeholder of type given by <code>export.formats.svg.placeholder.type</code>
for the <code>SVG</code> image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.svg.placeholder.type</code></td>
<td>
<p>a <em>string</em>, giving the type of
placeholder for the <code>SVG</code> image to save; can be "jpg",
"png" (the default) or "webp".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.svg.placeholder.embed</code></td>
<td>
<p>a <em>logical</em>, if <code>TRUE</code>,
embed the placeholder image in the HTML document (if any) using <code>base64</code>
encoding, otherwise (the default) leave it as an external image file (works
only when an <code>HTML</code> document is exported and only for <code>JPEG</code> or
<code>PNG</code> images.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.directory</code></td>
<td>
<p>a <em>string</em>; if exporting, which directory
to export to; if <code>NA</code> (the default), creates the files in a temporary
directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>export.formats.html.template, export.formats.html.javascript, export.formats.html.css</code></td>
<td>
<p><em>character strings</em> or <code>NULL</code> (the default) giving the path to the
<code>HTML</code>, <code>JavaScript</code> and <code>CSS</code> templates, respectively, to be
used when generating the HTML+CSS semi-interactive plots; when <code>NULL</code>,
the default ones included with the package will be used. If you decide to define
new templates please use the default ones for inspiration and note that future
version are not guaranteed to be backwards compatible!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generate.R.plot</code></td>
<td>
<p>a <em>logical</em>, if <code>TRUE</code> (the default),
generate the standard (base <code>R</code>) plot for plotting within <code>R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.not.draw.plot</code></td>
<td>
<p>a <em>logical</em>, if <code>TRUE</code> (<em>not</em> the default),
does not draw the plot itself, but only the legend (if <code>show.legend</code> is
<code>TRUE</code>) at coordinates (0,0) irrespective of the given legend coordinates.
This is intended to allow (together with the <code>get.legend.plotting.area()</code>
function) the separate plotting of the legend.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please note that this function plots objects inheriting from <code>CMA0</code> but
not objects of type <code>CMA0</code> itself (these are plotted by
<code>plot.CMA0</code>).
</p>
<p>The x-axis represents time (either in days since the earliest date or as
actual dates), with consecutive events represented as ascending on the y-axis.
</p>
<p>Each event is represented as a segment with style <code>lty.event</code> and line
width <code>lwd.event</code> starting with a <code>pch.start.event</code> and ending with
a <code>pch.end.event</code> character, coloured with a unique color as given by
<code>col.cats</code>, extending from its start date until its end date.
Superimposed on these are shown the event intervals and gap days as estimated
by the particular CMA method, more precisely plotting the start and end of
the available events as solid filled-in rectangles, and the event gaps as
shaded rectangles.
</p>
<p>The follow-up and the observation windows are plotted as an empty rectangle
and as shaded rectangle, respectively (for some CMAs the observation window
might be adjusted in which case the adjustment may also be plotted using a
different shading).
</p>
<p>The CMA estimates can be visually represented as well in the left side of the
figure using bars (sometimes the estimates can go above 100%, in which case
the maximum possible bar filling is adjusted to reflect this).
</p>
<p>When several patients are displayed on the same plot, they are organized
vertically, and alternating bands (white and gray) help distinguish
consecutive patients.
Implicitely, all patients contained in the <code>cma</code> object will be plotted,
but the <code>patients.to.plot</code> parameter allows the selection of a subset of
patients.
</p>
<p>Finally, the y-axis shows the patient ID and possibly the CMA estimate as
well.
</p>


<h3>Examples</h3>

<pre><code class="language-R">cma1 &lt;- CMA1(data=med.events,
             ID.colname="PATIENT_ID",
             event.date.colname="DATE",
             event.duration.colname="DURATION",
             followup.window.start=30,
             observation.window.start=30,
             observation.window.duration=365,
             date.format="%m/%d/%Y"
            );
plot(cma1, patients.to.plot=c("1","2"));
</code></pre>


</div>