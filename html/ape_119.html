<div class="container">

<table style="width: 100%;"><tr>
<td>collapsed.intervals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Collapsed Coalescent Intervals</h2>

<h3>Description</h3>

<p>This function takes a <code>"coalescentIntervals"</code> objects and collapses neighbouring
coalescent intervals into a single combined interval so that every collapsed interval is
larger than <code>epsilon</code>. Collapsed coalescent intervals are used, e.g., to obtain the
generalized skyline plot (<code>skyline</code>). For <code>epsilon = 0</code> no interval
is collapsed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">collapsed.intervals(ci, epsilon=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>coalescent intervals (i.e. an object of class <code>"coalescentIntervals"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>collapsing parameter that controls the amount of smoothing
(allowed range: from <code>0</code> to <code>ci$total.depth</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Proceeding from the tips to the root of the tree each small
interval is pooled with the neighboring interval closer to the root. If the
neighboring interval is also small, then pooling continues until the composite
interval is larger than <code>epsilon</code>. Note that this approach prevents the
occurrence of zero-length intervals at the present.
For more details see Strimmer and Pybus (2001).
</p>


<h3>Value</h3>

<p>An object of class <code>"collapsedIntervals"</code> with the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lineages</code></td>
<td>
<p> A vector with the number of lineages at the start of each coalescent
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval.length</code></td>
<td>
<p> A vector with the length of each coalescent
interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapsed.interval</code></td>
<td>
<p>A vector indicating for each coalescent interval to which
collapsed interval it belongs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval.count</code></td>
<td>
<p> The total number of coalescent
intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapsed.interval.count</code></td>
<td>
<p>The number of collapsed intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.depth</code></td>
<td>
<p> The sum of the lengths of all coalescent
intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>The value of the underlying smoothing parameter.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Korbinian Strimmer</p>


<h3>References</h3>

<p>Strimmer, K. and Pybus, O. G. (2001) Exploring the demographic history
of DNA sequences using the generalized skyline plot. <em>Molecular
Biology and Evolution</em>, <b>18</b>, 2298â€“2305.
</p>


<h3>See Also</h3>

<p><code>coalescent.intervals</code>,<code>skyline</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("hivtree.table") # example tree
# colescent intervals from vector of interval lengths
ci &lt;- coalescent.intervals(hivtree.table$size)
ci
# collapsed intervals
cl1 &lt;- collapsed.intervals(ci,0)
cl2 &lt;- collapsed.intervals(ci,0.0119)
cl1
cl2
</code></pre>


</div>