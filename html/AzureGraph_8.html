<div class="container">

<table style="width: 100%;"><tr>
<td>call_batch_endpoint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Call the Graph API batch endpoint</h2>

<h3>Description</h3>

<p>Call the Graph API batch endpoint
</p>


<h3>Usage</h3>

<pre><code class="language-R">call_batch_endpoint(token, requests = list(), depends_on = NULL,
  api_version = getOption("azure_graph_api_version"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>An Azure OAuth token, of class AzureToken.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>requests</code></td>
<td>
<p>A list of graph_request objects, representing individual requests to the Graph API.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depends_on</code></td>
<td>
<p>An optional named vector, or TRUE. See below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_version</code></td>
<td>
<p>The API version to use, which will form part of the URL sent to the host.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use this function to combine multiple requests into a single HTTPS call. This can save significant network latency.
</p>
<p>The <code>depends_on</code> argument specifies the dependencies that may exist between requests. The default is to treat the requests as independent, which allows them to be executed in parallel. If <code>depends_on</code> is TRUE, each request is specified as depending on the immediately preceding request. Otherwise, this should be a named vector or list that gives the dependency or dependencies for each request.
</p>
<p>There are 2 restrictions on <code>depends_on</code>:
</p>

<ul>
<li>
<p> If one request has a dependency, then all requests must have dependencies specified
</p>
</li>
<li>
<p> A request can only depend on previous requests in the list, not on later ones.
</p>
</li>
</ul>
<p>A request list that has dependencies will be executed serially.
</p>


<h3>Value</h3>

<p>A list containing the responses to each request. Each item has components <code>id</code> and <code>status</code> at a minimum. It may also contain <code>headers</code> and <code>body</code>, depending on the specifics of the request.
</p>


<h3>See Also</h3>

<p>graph_request, call_graph_endpoint
</p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/json-batching">Batch endpoint documentation</a>
</p>
<p><a href="https://docs.oasis-open.org/odata/odata-json-format/v4.01/odata-json-format-v4.01.html#sec_BatchRequestsandResponses">OData documentation on batch requests</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

req1 &lt;- graph_request$new("me")

# a new email message in Outlook
req_create &lt;- graph_request$new("me/messages",
    body=list(
        body=list(
            content="Hello from R",
            content_type="text"
        ),
        subject="Hello",
        toRecipients="bob@example.com"
    ),
    http_verb="POST"
)

# messages in drafts
req_get &lt;- graph_request$new("me/mailFolders/drafts/messages")

# requests are dependent: 2nd list of drafts will include just-created message
call_batch_endpoint(token, list(req_get, req_create, req_get), depends_on=TRUE)

# alternate way: enumerate all requests
call_batch_endpoint(token, list(req_get, req_create, req_get), depends_on=c("2"=1, "3"=2))


## End(Not run)
</code></pre>


</div>