<div class="container">

<table style="width: 100%;"><tr>
<td>afmExpDecay</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Exponential decay fit</h2>

<h3>Description</h3>

<p>Fits a viscoelastic exponential decay in a Force-Relaxation or Creep
experiments as described in Nanotechnology 2010 (see references).
</p>


<h3>Usage</h3>

<pre><code class="language-R">afmExpDecay(afmdata, nexp = 2, tmax = NULL, type = c("CH","CF"), plt = TRUE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>afmdata</code></td>
<td>
<p>An object of <code>afmdata</code> class with a <b>pause</b> segment and a
<b>Time</b> column in the <code>data</code> dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nexp</code></td>
<td>
<p>Number of expontials in the Prony series to be fitted. Currently only one
or two exponentials are supported. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>Maximum time considered in the relaxation curve. It defaults to <code>Inf</code>,
meaning that the whole pause segment is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of the experiment. Can be either "CH" (Constant Height) for a
force-relaxation experiment or "CF" (Constant Force) for a creep experiment. Default
is <code>type = "CH"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plt</code></td>
<td>
<p>Logical. If TRUE (default) then a plot of the pause segment with the overlay
of the fit is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options passed to the <code>nlsM()</code> function from the <code>minpack.lm</code>
package. At least should contain the starting values (<code>start = list(...)</code>) for
the Levenberg-Mardquart nonlinear least square method.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An <code>afmdata</code> class variable which will consist on the original input
<code>afmdata</code> variable plus a new list named <code>ExpFit</code> with the following
fields:
</p>
<p><code>expdecayModel</code>: A nls object returned from  <code>nlsM()</code> function.
</p>
<p><code>expdecayFit</code>: The values predicted by the fit, returned from the 
<code>predict()</code> function.
</p>


<h3>References</h3>

<p>Susana Moreno-Flores, Rafael Benitez, Maria dM Vivanco and Jose Luis 
Toca-Herrera (2010). "Stress relaxation and creep on living cells with the atomic force
microscope: a means to calculate elastic moduli and viscosities of cell components".
Nanotechnology, <strong>21</strong> (44), pp. 445101.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data &lt;- afmReadJPK("force-save-JPK-3h.txt.gz", path = path.package("afmToolkit"))
width &lt;- 20
mul1 &lt;- 1
mul2 &lt;- 10
data &lt;- afmContactPoint(data, width = width, mul1 = mul1, mul2 = mul2)
data &lt;- afmDetachPoint(data, width = width, mul1 = mul1, mul2 = mul2)
data &lt;- afmBaselineCorrection(data)
data &lt;- afmExpDecay(data, nexp = 2, type = "CH")
</code></pre>


</div>