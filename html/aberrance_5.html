<div class="container">

<table style="width: 100%;"><tr>
<td>detect_nm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detect nonparametric misfit</h2>

<h3>Description</h3>

<p>Detect nonparametric misfit using person-fit statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">detect_nm(method, x = NULL, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The person-fit statistic(s) to compute. Options for score-based
statistics are:
</p>

<ul>
<li> <p><code>"G_S"</code> for the number of Guttman errors (Guttman, 1944; see also
Molenaar, 1991).
</p>
</li>
<li> <p><code>"NC_S"</code> for the norm conformity index (Tatsuoka &amp; Tatsuoka, 1983).
<em>Note:</em> This statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"U1_S"</code> for the <code class="reqn">U1</code> statistic, also known as the <code class="reqn">G^*</code>
statistic (van der Flier, 1977; see also Emons, 2008).
</p>
</li>
<li> <p><code>"U3_S"</code> for the <code class="reqn">U3</code> statistic (van der Flier, 1982; see also Emons,
2008).
</p>
</li>
<li> <p><code>"ZU3_S"</code> for the <code class="reqn">ZU3</code> statistic (van der Flier, 1982).
<em>Note:</em> This statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"A_S"</code> for the agreement index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"D_S"</code> for the disagreement index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"E_S"</code> for the dependability index (Kane &amp; Brennan, 1980). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"C_S"</code> for the caution index (Sato, 1975). <em>Note:</em> This statistic cannot
be computed for polytomous item scores.
</p>
</li>
<li> <p><code>"MC_S"</code> for the modified caution index, also known as the <code class="reqn">C^*</code>
statistic (Harnisch &amp; Linn, 1981). <em>Note:</em> This statistic cannot be
computed for polytomous item scores.
</p>
</li>
<li> <p><code>"PC_S"</code> for the personal point-biserial correlation (Donlon &amp; Fischer,
1968). <em>Note:</em> This statistic cannot be computed for polytomous item
scores.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠"HT_S⁠</code> for the <code class="reqn">H^T</code> statistic (Sijtsma, 1986). <em>Note:</em> This
statistic cannot be computed for polytomous item scores.
</p>
</li>
</ul>
<p>Options for response time-based statistics are:
</p>

<ul><li> <p><code>"KL_T"</code> for the Kullback-Leibler divergence (Man et al., 2018).
</p>
</li></ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>Matrices of raw data. <code>x</code> is for the item scores and <code>y</code> the item
log response times.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list is returned with the following elements:
</p>
<table><tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A matrix of nonparametric person-fit statistics.</p>
</td>
</tr></table>
<h3>References</h3>

<p>Donlon, T. F., &amp; Fischer, F. E. (1968). An index of an individual's agreement
with group-determined item difficulties. <em>Educational and Psychological
Measurement</em>, <em>28</em>(1), 105–113.
</p>
<p>Emons, W. H. M. (2008). Nonparametric person-fit analysis of polytomous item
scores. <em>Applied Psychological Measurement</em>, <em>32</em>(3), 224–247.
</p>
<p>Guttman, L. (1944). A basis for scaling qualitative data. <em>American
Sociological Review</em>, <em>9</em>(2), 139–150.
</p>
<p>Harnisch, D. L., &amp; Linn, R. L. (1981). Analysis of item response patterns:
Questionable test data and dissimilar curriculum practices. <em>Journal of
Educational Measurement</em>, <em>18</em>(3), 133–146.
</p>
<p>Kane, M. T., &amp; Brennan, R. L. (1980). Agreement coefficients as indices of
dependability for domain referenced tests. <em>Applied Psychological
Measurement</em>, <em>4</em>(1), 105–126.
</p>
<p>Man, K., Harring, J. R., Ouyang, Y., &amp; Thomas, S. L. (2018). Response time
based nonparametric Kullback-Leibler divergence measure for detecting
aberrant test-taking behavior. <em>International Journal of Testing</em>, <em>18</em>(2),
155–177.
</p>
<p>Molenaar, I. W. (1991). A weighted Loevinger H-coefficient extending Mokken
scaling to multicategory items. <em>Kwantitatieve Methoden</em>, <em>12</em>(37), 97–117.
</p>
<p>Sato, T. (1975). <em>The construction and interpretation of S-P tables</em>.
</p>
<p>Sijtsma, K. (1986). A coefficient of deviance of response patterns.
<em>Kwantitatieve Methoden</em>, <em>7</em>(22), 131–145.
</p>
<p>Tatsuoka, K. K., &amp; Tatsuoka, M. M. (1983). Spotting erroneous rules of
operation by the individual consistency index. <em>Journal of Educational
Measurement</em>, <em>20</em>(3), 221–230.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns.
In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology</em>.
Swets &amp; Zeitlinger Publishers.
</p>
<p>van der Flier, H. (1982). Deviant response patterns and comparability of test
scores. <em>Journal of Cross-Cultural Psychology</em>, <em>13</em>(3), 267–298.
</p>


<h3>See Also</h3>

<p><code>detect_pm()</code> to detect parametric misfit.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Setup for Examples 1 to 3 -------------------------------------------------

# Settings
set.seed(0)     # seed for reproducibility
N &lt;- 500        # number of persons
n &lt;- 40         # number of items

# Randomly select 10% examinees with preknowledge and 40% compromised items
cv &lt;- sample(1:N, size = N * 0.10)
ci &lt;- sample(1:n, size = n * 0.40)

# Create vector of indicators (1 = misfitting, 0 = fitting)
ind &lt;- ifelse(1:N %in% cv, 1, 0)

# Example 1: Dichotomous Item Scores ----------------------------------------

# Generate person parameters for the 3PL model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the 3PL model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  b = rnorm(n, mean = 0.00, sd = 1.00),
  c = runif(n, min = 0.05, max = 0.30)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores
x[cv, ci] &lt;- rbinom(length(cv) * length(ci), size = 1, prob = 0.90)

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = c("G_S", "NC_S", "U1_S", "U3_S", "ZU3_S", "A_S", "D_S", "E_S",
             "C_S", "MC_S", "PC_S", "HT_S"),
  x = x
)

# Example 2: Polytomous Item Scores -----------------------------------------

# Generate person parameters for the generalized partial credit model
xi &lt;- cbind(theta = rnorm(N, mean = 0.00, sd = 1.00))

# Generate item parameters for the generalized partial credit model
psi &lt;- cbind(
  a = rlnorm(n, meanlog = 0.00, sdlog = 0.25),
  c0 = 0,
  c1 = rnorm(n, mean = -1.00, sd = 0.50),
  c2 = rnorm(n, mean = 0.00, sd = 0.50),
  c3 = rnorm(n, mean = 1.00, sd = 0.50)
)

# Simulate uncontaminated data
x &lt;- sim(psi, xi)$x

# Modify contaminated data by changing the item scores to the maximum score
x[cv, ci] &lt;- 3

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = c("G_S", "U1_S", "U3_S"),
  x = x
)

# Example 3: Item Response Times --------------------------------------------

# Generate person parameters for the lognormal model
xi &lt;- cbind(tau = rnorm(N, mean = 0.00, sd = sqrt(0.25)))

# Generate item parameters for the lognormal model
psi &lt;- cbind(
  alpha = runif(n, min = 1.50, max = 2.50),
  beta = rnorm(n, mean = 3.50, sd = sqrt(0.15))
)

# Simulate uncontaminated data
y &lt;- sim(psi, xi)$y

# Modify contaminated data by reducing the log response times
y[cv, ci] &lt;- y[cv, ci] * 0.75

# Detect nonparametric misfit
out &lt;- detect_nm(
  method = "KL_T",
  y = y
)
</code></pre>


</div>