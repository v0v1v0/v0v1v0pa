<div class="container">

<table style="width: 100%;"><tr>
<td>sample_tmb_hmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw MCMC samples from a model posterior using a static HMC sampler.</h2>

<h3>Description</h3>

<p>Draw MCMC samples from a model posterior using a static HMC sampler.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample_tmb_hmc(
  iter,
  fn,
  gr,
  init,
  L,
  eps,
  warmup = floor(iter/2),
  seed = NULL,
  chain = 1,
  thin = 1,
  control = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>The number of samples to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>A function that returns the log of the posterior density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gr</code></td>
<td>
<p>A function that returns a vector of gradients of the log of
the posterior density (same as <code>fn</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>A list of lists containing the initial parameter
vectors, one for each chain or a function. It is strongly
recommended to initialize multiple chains from dispersed
points. A of NULL signifies to use the starting values
present in the model (i.e., <code>obj$par</code>) for all chains.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The number of leapfrog steps to take. The NUTS algorithm does
not require this as an input. If <code>L=1</code> this function will perform
Langevin sampling. In some contexts <code>L</code> can roughly be thought of
as a thinning rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>The step size. If a numeric value is passed, it will be used
throughout the entire chain. A <code>NULL</code> value will initiate
sampler_params of <code>eps</code> using the dual averaging algorithm during
the first <code>warmup</code> steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warmup</code></td>
<td>
<p>The number of warmup iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The random seed to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>The chain number, for printing only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The thinning rate to apply to samples. Typically
not used with NUTS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list to control the sampler. See details for
further use.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements algorithm 5 of Hoffman and Gelman
(2014), which includes adaptive step sizes (<code>eps</code>) via an
algorithm called dual averaging.
</p>


<h3>Value</h3>

<p>A list containing samples ('par') and algorithm details such as
step size adaptation and acceptance probabilities per iteration
('sampler_params').
</p>


<h3>References</h3>

 <ul>
<li>
<p>Neal, R. M. (2011). MCMC using Hamiltonian
dynamics. Handbook of Markov Chain Monte Carlo.  </p>
</li>
<li>
<p>Hoffman and
Gelman (2014). The No-U-Turn sampler: Adaptively setting path lengths
in Hamiltonian Monte Carlo. J. Mach. Learn. Res.  15:1593-1623.  </p>
</li>
</ul>
<p>Hoffman and Gelman (2014). The No-U-Turn sampler: Adaptively setting
path lengths in Hamiltonian Monte Carlo. J. Mach. Learn. Res.
15:1593-1623.
</p>


<h3>See Also</h3>

<p><code>sample_tmb</code>
</p>
<p><code>sample_tmb</code>
</p>


</div>