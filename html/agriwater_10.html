<div class="container">

<table style="width: 100%;"><tr>
<td>evapo_s2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Actual evapotranspiration (ETa) using Sentinel-2 images with single agrometeorological data.</h2>

<h3>Description</h3>

<p>Actual evapotranspiration (ETa) using Sentinel-2 images with single agrometeorological data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evapo_s2(doy, RG, Ta, ET0, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>doy</code></td>
<td>
<p>is the Day of Year (DOY)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RG</code></td>
<td>
<p>is the global solar radiation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ta</code></td>
<td>
<p>is the average air temperature</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ET0</code></td>
<td>
<p>is the reference evapotranspiration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>is one of the regression coefficients of SAFER algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>is one of the regression coefficients of SAFER algorithm</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>It returns in raster format (.tif) the Surface Albedo at 24h scale ("Alb_24"), NDVI, Surface Temperature ("LST"), net radiation ("Rn_MJ"), Crop Coefficient ("kc") and Actual Evapotranspiration (evapo).
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(agriwater)

# dependencies of package 'agriwater'
library(terra)


# Using a temporary folder to run example
wd &lt;- tempdir()
initial = getwd()
setwd(wd)

# creating raster which simulate Sentinel-2 reflectances - for using
# real data, please download:
# https://drive.google.com/open?id=14E1wHNLxG7_Dh4I-GqNYakj8YJDgKLzk

xy &lt;- matrix(rnorm(4, mean = 0.07, sd = 0.01), 2, 2)
rast &lt;- rast(xy, crs="+proj=longlat +datum=WGS84")
ext(rast) &lt;- c(-40.5,-40.45,-9.5,-9.45)
writeRaster(rast, file.path(wd, "B2.tif"),filetype = "GTiff", overwrite=TRUE)
xy &lt;- matrix(rnorm(4, mean = 0.05, sd = 0.015),2, 2)
rast &lt;- rast(xy, crs="+proj=longlat +datum=WGS84")
ext(rast) &lt;- c(-40.5,-40.45,-9.5,-9.45)
writeRaster(rast, file.path(wd, "B3.tif"),filetype = "GTiff", overwrite=TRUE)
xy &lt;- matrix(rnorm(4, mean = 0.03, sd = 0.018),2, 2)
rast &lt;- rast(xy, crs="+proj=longlat +datum=WGS84")
ext(rast) &lt;- c(-40.5,-40.45,-9.5,-9.45)
writeRaster(rast, file.path(wd, "B4.tif"),filetype = "GTiff", overwrite=TRUE)
xy &lt;- matrix(rnorm(4, mean = 0.05, sd = 0.015),2, 2)
rast &lt;- rast(xy, crs="+proj=longlat +datum=WGS84")
ext(rast) &lt;- c(-40.5,-40.45,-9.5,-9.45)
writeRaster(rast, file.path(wd, "B8.tif"),filetype = "GTiff", overwrite=TRUE)
mask &lt;- as.polygons(rast)
writeVector(mask, file.path(getwd(),"mask.shp"), overwrite=TRUE)

# using "agriwater"
evapo_s2(doy = 134, RG = 17.6, Ta = 27.9, ET0 = 3.8, a = 1.8, b = -0.008)

#Exiting temporary folder and returning to previous workspace
setwd(initial)
</code></pre>


</div>