<div class="container">

<table style="width: 100%;"><tr>
<td>bfTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Behrens-Fisher Test</h2>

<h3>Description</h3>

<p>Tests for a difference in means from two normally distributed variates with possibly different variances. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfTest(x, ...)

## Default S3 method:
bfTest(x, y,
       alternative = c("two.sided", "less", "greater"),
       mu = 0, conf.level = 0.95, control=bfControl(), ...)

## S3 method for class 'formula'
bfTest(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a (non-empty) numeric vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an optional (non-empty) numeric vector of data values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative
hypothesis, must be one of <code>"two.sided"</code> (default),
<code>"greater"</code> or <code>"less"</code>.  You can specify just the initial
letter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a number indicating the true value of the 
difference in means </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of arguments used for determining the calculation algorithm, see <code>bfControl</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>lhs ~ rhs</code> where <code>lhs</code>
is a numeric variable giving the data values and <code>rhs</code> a factor
with two levels giving the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to
<code>getOption("na.action")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fisher (1935) developed a fiducial 
solution to the two-sample difference in means problem
with normally distributed data with different variances. That has become known as the Behrens-Fisher solution.  Robinson (1976) showed through extensive simulations, that the Behrens-Fisher solution is valid (i.e., the test gives  
type I error rate less than the significance level, and its confidence intervals on the difference in means have coverage at least as large as the nominal confidence level). 
</p>
<p>The following are the same as with the usual t-test in <code>t.test</code>.
<code>alternative = "greater"</code> is the alternative that <code>x</code> has a
larger mean than <code>y</code>. Missing values are silently removed. If the input data are effectively constant an error is generated.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the t-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameter</code></td>
<td>
<p>R = <code>atan(SEMx/SEMy)</code> used in Behrens-Fisher distribution,
where SEMx=std error of the mean of x, see <code>pbf</code>, but not used in calculation for this function
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p-value for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>a confidence interval for the difference in means 
(mean.x-mean.y) 
appropriate to the
specified alternative hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the estimated means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.value</code></td>
<td>
<p>the specified hypothesized value of the mean
difference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string describing the alternative
hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string describing the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.name</code></td>
<td>
<p>a character string giving the name(s) of the data.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fisher, RA (1935). The fiducial argument in statistical inference.
Annals of Eugenics. 6, 391-398.
</p>
<p>Robinson, G (1976). Properties of Students t and of the Behrens-Fisher solution to the two means problem. The Annals of
Statistics 4, 963-971 (Corr: 1982, p. 321).
</p>


<h3>See Also</h3>

<p>The more common solution for this problem is Welch's t-test (the default in <code>t.test</code>). Welch's t-test does not guarantee that the type I error rate is less than the significance level, but it appears to work well in most cases.  
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Classical example: Student's sleep data
## Traditional interface
with(sleep, bfTest(extra[group == 1], extra[group == 2]))
## Formula interface
bfTest(extra ~ group, data = sleep)
## Results are simular to Welch's t-test, 
## but a little more conservative
t.test(extra~group,data=sleep)
</code></pre>


</div>