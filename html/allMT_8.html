<div class="container">

<table style="width: 100%;"><tr>
<td>convert_external_format</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get standard data structure</h2>

<h3>Description</h3>

<p>Convert a maintenance therapy excel sheet created by user into a standard format for analysis
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert_external_format(
  inputpath_to_excelfolder,
  exportpath_to_csvfolder,
  pat_data_file_path,
  daily_mp_dose = 60,
  weekly_mtx_dose = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>inputpath_to_excelfolder</code></td>
<td>
<p>Path to folder containing input excel files (in quotes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exportpath_to_csvfolder</code></td>
<td>
<p>Path to folder in which to save final output csv files (in quotes)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pat_data_file_path</code></td>
<td>
<p>Path to excel file with patient IDs and corresponding BSA (body surface area) values.
Column names - "ID", "BSA".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>daily_mp_dose</code></td>
<td>
<p>numeric value of DAILY 6-Mercaptopurine dose per <code class="reqn">1m^{2}</code> (<code class="reqn">mg/m^{2}</code>) as per the MT dosing protocol.
Default = <code class="reqn">60mg/m^{2}</code> (as per ICiCLe-ALL-14 protocol)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weekly_mtx_dose</code></td>
<td>
<p>numeric value of WEEKLY absolute Methotrexate dose per <code class="reqn">1m^{2}</code> (<code class="reqn">mg/m^{2}</code>) as per the MT dosing protocol.
Default = <code class="reqn">20mg/m^{2}</code> (as per ICiCLe-ALL-14 protocol)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Folder with converted csv files
</p>


<h3>Note</h3>

<p>If MT excel files are missing in the input folder for any patient IDs provided in the pat_data_file ID column,
the function will show a message of missing IDs but will continue to convert the available files.
</p>


<h3>See Also</h3>

<p><code>convert_tmc_format()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># As per ICiCLe-ALL-14 protocol (Reference PMID - 35101099):
path_to_excel = paste0(system.file("extdata/external_data/", package = "allMT"), "/")
save_path = paste0(tempdir(),"/")
path_to_bsa = system.file("extdata/external_data/", "BSA.xlsx", package = "allMT")
convert_external_format(inputpath_to_excelfolder = path_to_excel,
                   exportpath_to_csvfolder = save_path,
                   pat_data_file_path = path_to_bsa,
                   daily_mp_dose = 60,
                   weekly_mtx_dose = 20)

# As per ICiCLe-ALL-14 protocol (Reference PMID - 35101099):
convert_external_format(inputpath_to_excelfolder = "../csv_trial/",
                   exportpath_to_csvfolder = save_path,
                   pat_data_file_path = "BSAFile.xlsx")

# As per BFM protocol (Reference PMID - 15902295):
convert_external_format(inputpath_to_excelfolder = "../csv_trial/",
                   exportpath_to_csvfolder = save_path,
                   pat_data_file_path = "BSAFile.xlsx",
                   daily_mp_dose = 50,
                   weekly_mtx_dose = 20)

# As per St Jude protocol (Reference PMID - 15902295):
convert_external_format(inputpath_to_excelfolder = "../csv_trial/",
                   exportpath_to_csvfolder = save_path,
                   pat_data_file_path = "BSAFile.xlsx",
                   daily_mp_dose = 75,
                   weekly_mtx_dose = 40)


</code></pre>


</div>