<div class="container">

<table style="width: 100%;"><tr>
<td>testBackground</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate power spectrum false positive rates via Monte Carlo simulation</h2>

<h3>Description</h3>

<p>This is a simulation tool to evaluate power spectrum false positive rates, the 
frequency distribution of the false positives, and the behavior of numerous
"multiple correction" procedures, for a range of background estimation 
approaches that are implemented in Astrochron. The tool can be used to conduct
surrogate analyses, alongside analysis of real data, to better understand
the suitability of particular background estimation approaches. The resulting 
simulations are similar to those presented in Figure 3 of Meyers (2012) and 
Crampton et al. (PNAS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">testBackground(npts=1001,dt=5,noiseType="ar1",coeff=NULL,method="periodogramAR1",
               opt=NULL,demean=T,detrend=F,low=0,tbw=3,multi=F,iter=2000,output=F,
               genplot=F,verbose=T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>npts</code></td>
<td>
<p>Number of points in simulated stratigraphic series (surrogates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dt</code></td>
<td>
<p>Sampling interval for surrogates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseType</code></td>
<td>
<p>Select "ar1" for AR1 noise surrogates, or "pwrLaw" for Power Law noise surrogates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeff</code></td>
<td>
<p>AR1 coefficient (rho) or Power Law coefficient (beta) for surrogates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Background estimation method: (1) "mtmAR1" (function mtm), (2) "mtmML96" (function mtmML96), (3) "lowspec" (function lowspec), (4) "mtmPL" (function mtmPL), (5) "periodogramPL" (function periodogram), (6) "periodogramAR1" (function periodogram)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt</code></td>
<td>
<p>Method specific options. For mtmML96, this is medsmooth (see function mtmML96); for lowspec this is lowspan (see function lowspec); for periodogram this is percent cosine taper (see function cosTaper).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demean</code></td>
<td>
<p>Remove mean value from simulated surrogates? (T or F; this option does not apply to lowspec)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detrend</code></td>
<td>
<p>Remove linear trend from simulated surrogates? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>low</code></td>
<td>
<p>Remove long-term trend using a LOWESS smoother? Choose a value ranging from 0-1 (see function noLow). 0 = no long-term trend removal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbw</code></td>
<td>
<p>MTM time-bandwidth product. This option is ignored for methods 5 and 6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multi</code></td>
<td>
<p>Evaluate a range of multiple-comparison tests too? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>Number of iterations (surrogate series) for Monte Carlo simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>Output data frame? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>
<p>Generate summary plots? (T or F)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Verbose output? (T or F)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Monte Carlo simulations can utilize AR1 or Power Law noise surrogates.
Background estimation approaches include conventional AR1, ML96, LOWSPEC 
and Power Law. The function also allows evaluation of common data detrending
approaches (linear trend removal, LOWESS trend removal).
</p>
<p>Note that MTM-ML96 conducts the Mann and Lees (1996; ML96) "robust red noise" analysis, 
with an improved median smoothing approach. The original Mann and Lees (1996) approach 
applies a truncation of the median smoothing window to include fewer frequencies near 
the edges of the spectrum; while truncation is required, its implementation in the 
original method often results in an "edge effect" that can produce excess false positive 
rates at low frequencies, commonly within the eccentricity-band (Meyers, 2012). To help 
address this issue, an alternative median smoothing approach is applied that implements 
Tukey's robust end-point rule and symmetrical medians (see the function mtmML96 for more
details). This version of the ML96 algorithm was first implemented in Patterson et al. (2014).
</p>
<p>See function multiTest for more information on the multiple comparison tests evaluated.
</p>


<h3>References</h3>

<p>W.S. Cleveland, 1979, 
<em>Locally weighted regression and smoothing scatterplots</em>: Journal of the American Statistical Association, v. 74, p. 829-836.
</p>
<p>J.S. Campton, S.R. Meyers, R.A. Cooper, P.M Sadler, M. Foote, D. Harte, 2018, 
<em>Pacing of Paleozoic macroevolutionary rates by Milankovitch grand cycles</em>: Proceedings of the National Academy of Sciences, doi:10.1073/pnas.1714342115.
</p>
<p>M.E. Mann, and J.M. Lees, 1996,
<em>Robust estimation of background noise and signal detection in climatic time series</em>, Clim. Change, 33, 409-445.
</p>
<p>S.R. Meyers, 2012,
<em>Seeing Red in Cyclic Stratigraphy: Spectral Noise Estimation for Astrochronology</em>: Paleoceanography, 27, PA3228, doi:10.1029/2012PA002307.
</p>
<p>M.O. Patterson, R. McKay, T. Naish, C. Escutia, F.J. Jimenez-Espejo, M.E. Raymo, M.E., 
S.R. Meyers, L. Tauxe, H. Brinkhuis, and IODP Expedition 318 Scientists,2014, 
<em>Response of the East Antarctic Ice Sheet to orbital forcing during the Pliocene and Early Pleistocene</em>, Nature Geoscience, v. 7, p. 841-847.
</p>
<p>D.J. Thomson, 1982, 
<em>Spectrum estimation and harmonic analysis</em>: IEEE Proceedings, v. 70, p. 1055-1096.
</p>


<h3>See Also</h3>

 <p><code>confAdjust</code>,<code>multiTest</code>,<code>lowspec</code>, <code>mtm</code>, <code>mtmML96</code>, <code>mtmPL</code>, and <code>periodogram</code> </p>


<h3>Examples</h3>

<pre><code class="language-R"> ## Not run: 
# evaluate false positive rate for MTM-AR1 using AR1 surrogates
testBackground(noiseType="ar1",method="mtmAR1")

# evaluate false positive rate for MTM-AR1 using Power Law surrogates
testBackground(noiseType="pwrLaw",method="mtmAR1")
 
## End(Not run)
</code></pre>


</div>