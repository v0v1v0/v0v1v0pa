<div class="container">

<table style="width: 100%;"><tr>
<td>r3chisq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>3-variate positively correlated chi-squared sample generation when degrees of freedom are large</h2>

<h3>Description</h3>

<p>Generate samples approximately from three positively correlated chi-squared random variables
<code class="reqn">(\chi^2(d_1), \chi^2(d_2), \chi^2(d_3))</code>
when the degrees of freedom <code class="reqn">(d_1, d_2, d_3)</code> are large.
</p>


<h3>Usage</h3>

<pre><code class="language-R">r3chisq(size, df, corr_mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>the degree of freedoms of the marginal distributions. Must be non-negative, but can be non-integer.
The function uses <code>ceiling(df)</code> if non-integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr_mat</code></td>
<td>
<p>the target correlation matrix; negative elements will be set to 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is generally hard to sample from <code class="reqn">(\chi^2(d_1), \chi^2(d_2), \chi^2(d_3))</code> with a designed correlation matrix.
In the algorithm, we approximate the random vector by <code class="reqn">(z^T Q_1 z, z^T Q_2 z, z^T Q_3 z)</code>
where <code class="reqn">z</code> is a standard norm random vector and <code class="reqn">Q_1,Q_2,Q_3</code> are diagonal matrices
with diagonal elements 1's and 0's. The designed positive correlations is approximated by carefully
selecting common locations of 1's on the diagonals. The generated sample may have slightly larger marginal degrees
of freedom than the inputted <code>df</code>, also slightly different covariances.
</p>


<h3>Value</h3>


<ul>
<li>
<p><code>sample</code>: a <code>size</code>-by-3 matrix contains the generated sample.
</p>
</li>
<li>
<p><code>approx_cov</code>: the true covariance matrix of <code>sample</code>.</p>
</li>
</ul>
<h3>References</h3>

<p>Li, H., Aue, A., Paul, D., Peng, J., &amp; Wang, P. (2016). <em>
An adaptable generalization of Hotelling's  <code class="reqn">T^2</code>
test in high dimension.</em> arXiv preprint &lt;arXiv:1609.08725&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10086)
cor_examp = matrix(c(1,1/6,2/3,1/6,1,2/3,2/3,2/3,1),3,3)
a_sam = r3chisq(size = 10000,
                df = c(80,90,100),
                corr_mat = cor_examp)
cov(a_sam$sample) - a_sam$approx_cov
cov2cor(a_sam$approx_cov) - cor_examp
</code></pre>


</div>