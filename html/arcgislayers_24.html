<div class="container">

<table style="width: 100%;"><tr>
<td>query_layer_attachments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Query and download attachments</h2>

<h3>Description</h3>

<p>Get metadata about attachments associated with features in a layer.
Query attachment information using <code>query_layer_attachments()</code> and
download attachments using <code>download_attachments()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">query_layer_attachments(
  x,
  definition_expression = "1=1",
  attachments_definition_expression = NULL,
  object_ids = NULL,
  global_ids = NULL,
  attachment_types = NULL,
  keywords = NULL,
  return_metadata = TRUE,
  ...,
  token = arc_token()
)

download_attachments(
  attachments,
  out_dir,
  ...,
  overwrite = FALSE,
  .progress = TRUE,
  token = arc_token()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>FeatureLayer</code>, <code>Table</code>, or <code>ImageServer</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>definition_expression</code></td>
<td>
<p>default <code>1 = 1</code>. A SQL where clause that is applied to the layer. Only those records that conform to this expression will be returned. This parameter is required if neither <code>object_ids</code> or <code>global_ids</code> have been defined.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attachments_definition_expression</code></td>
<td>
<p>default <code>NULL</code>. A SQL where calsue that is applied to the attachment metadata.
only attachments that conform to this expression will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object_ids</code></td>
<td>
<p>mutually exclusive with <code>definition_expression</code> and <code>global_ids</code>. The object IDs of the features to query attachments of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>global_ids</code></td>
<td>
<p>mutally exclusive with <code>definition_expression</code> and <code>object_ids</code>. The global IDs of the features to query attachments of.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attachment_types</code></td>
<td>
<p>default <code>NULL</code>. A character vector of attachment types to filter on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keywords</code></td>
<td>
<p>default <code>NULL</code>. A character vector of the keywords to filter on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_metadata</code></td>
<td>
<p>default <code>TRUE</code>. Returns metadata stored in the <code>exifInfo</code> field.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>token</code></td>
<td>
<p>your authorization token.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attachments</code></td>
<td>
<p>a <code>data.frame</code> created by <code>query_layer_attachments()</code>. Must contain the columns <code>name</code>, <code>url</code>, and <code>contentType</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_dir</code></td>
<td>
<p>the path to the folder to download the file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overwrite</code></td>
<td>
<p>default <code>FALSE</code>. A</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.progress</code></td>
<td>
<p>default <code>TRUE.</code> Whether a progress bar should be provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>query_layer_attachments()</code> returns a data.frame.
</p>
<p><code>download_attachments()</code> returns a list. If an error occurs, the condition is captured and returned in the list.
Otherwise the path to the file that was downloaded is returned.
</p>


<h3>References</h3>

<p><a href="https://developers.arcgis.com/rest/services-reference/enterprise/query-attachments-feature-service-layer/">ArcGIS REST API Documentation</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# create a url path that isn't too wide for CRAN
furl &lt;- paste(
  c(
    "https://services1.arcgis.com/hLJbHVT9ZrDIzK0I",
    "arcgis/rest/services/v8_Wide_Area_Search_Form_Feature_Layer___a2fe9c",
    "FeatureServer/0"
  ),
  collapse = "/"
)
# connect to the layer
layer &lt;- arc_open(furl)

# get the attachment info
att &lt;- query_layer_attachments(layer)

# download them to a path
download_attachments(att, "layer_attachments")

## End(Not run)
</code></pre>


</div>