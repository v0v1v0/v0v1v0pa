<div class="container">

<table style="width: 100%;"><tr>
<td>AM_mcmc_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs a Gibbs sampling</h2>

<h3>Description</h3>

<p>The <code>AM_mcmc_fit</code> function performs a Gibbs sampling in order to estimate the mixture comprising the sample data <code>y</code>.
The mixture selected must be of a predefined type <code>mix_kernel_hyperparams</code> (defined with <code>AM_mix_hyperparams_*</code> functions, where star
<code>*</code> denotes the chosen kernel).
Additionally, a prior distribution on the number of mixture components
must be specified through <code>mix_components_prior</code>
(generated with  <code>AM_mix_components_prior_*</code> functions, where <code>*</code>  denotes the chosen prior). Similarly,
a prior on the weights of the mixture should be specified through <code>mix_weight_prior</code>
(defined with  <code>AM_mix_weights_prior_*</code> functions). Finally, with <code>mcmc_parameters</code>, the user sets
the MCMC parameters for the Gibbs sampler (defined with <code>AM_mcmc_parameters</code> functions).
</p>


<h3>Usage</h3>

<pre><code class="language-R">AM_mcmc_fit(
  y,
  mix_kernel_hyperparams,
  initial_clustering = NULL,
  init_K = NULL,
  fixed_clustering = NULL,
  mix_components_prior = AM_mix_components_prior_pois(),
  mix_weight_prior = AM_mix_weights_prior_gamma(),
  mcmc_parameters = AM_mcmc_parameters()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>input data, can be a vector or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_kernel_hyperparams</code></td>
<td>
<p>is a configuration list, defined by *_mix_hyperparams functions, where * denotes the chosen kernel.
See <code>AM_mix_hyperparams_multiber</code>, <code>AM_mix_hyperparams_multinorm</code>, <code>AM_mix_hyperparams_uninorm</code>, <code>AM_mix_hyperparams_unipois</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial_clustering</code></td>
<td>
<p>is a vector CI of initial cluster assignement. If no clustering is specified (either as <code>init_K</code> or <code>init_clustering</code>), then every observation is
assigned to its own cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_K</code></td>
<td>
<p>initial value for  the number of cluster. When this is specified, AntMAN intitialises the clustering assign usng K-means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed_clustering</code></td>
<td>
<p>if specified, this is the vector CI containing the cluster assignments. This will remain unchanged for every iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_components_prior</code></td>
<td>
<p>is a configuration list defined by AM_mix_components_prior_* functions, where * denotes the chosen prior.
See <code>AM_mix_components_prior_dirac</code>,
<br><code>AM_mix_components_prior_negbin</code>, <code>AM_mix_components_prior_pois</code> for more <br>
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mix_weight_prior</code></td>
<td>
<p>is a configuration list defined by AM_weight_prior_* functions, where * denotes the chosen prior specification.
See <code>AM_mix_weights_prior_gamma</code> for more <br> details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc_parameters</code></td>
<td>
<p>is a configuration list defined by AM_mcmc_parameters. See <code>AM_mcmc_parameters</code> for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no initial clustering is specified (either as <code>init_K</code> or <code>init_clustering</code>),
then every observation is allocated to a different cluster.
If <code>init_K</code> is specified then AntMAN initialises the clustering through K-means.
</p>
<p><strong>Warning</strong>: if the user does not specify init_K or initial_cluster, the first steps can be be time-consuming because of default setting of the initial clustering.
</p>


<h3>Value</h3>

<p>The return value is an <code>AM_mcmc_output</code> object.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 AM_mcmc_fit( AM_sample_unipois()$y, 
              AM_mix_hyperparams_unipois (alpha0=2, beta0=0.2), 
              mcmc_parameters = AM_mcmc_parameters(niter=50, burnin=0, thin=1, verbose=0))

</code></pre>


</div>