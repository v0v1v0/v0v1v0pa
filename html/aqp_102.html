<div class="container">

<table style="width: 100%;"><tr>
<td>get.ml.hz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine ML Horizon Boundaries</h2>

<h3>Description</h3>

<p>This function accepts input from <code>slab()</code> (a <code>data.frame</code>) along with a vector of
horizon names, and returns a <code>data.frame</code> of the most likely horizon
boundaries.
</p>
<p>This function expects that <code>x</code> is a <code>data.frame</code> generated by
<code>slab()</code>. If <code>x</code> was not generated by <code>slab()</code>, then <code>o.names</code> is required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get.ml.hz(x, o.names = attr(x, which = "original.levels"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>data.frame</code>, output from <code>slab()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>o.names</code></td>
<td>
<p>an optional character vector of horizon designations that will be used in the final table</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>data.frame</code> with the following columns:
</p>

<ul>
<li> <p><code>hz</code>: horizon names
</p>
</li>
<li> <p><code>top</code>: horizon top depth
</p>
</li>
<li> <p><code>bottom</code>: horizon bottom depth
</p>
</li>
<li> <p><code>confidence</code>: integrated probability over thickness of each ML horizon, rounded to the nearest integer
</p>
</li>
<li> <p><code>pseudo.brier</code>: A "pseudo"" Brier Score for a multi-class prediction, where the most-likely horizon label is treated as the "correct" outcome. Details on the calculation for traditional Brier Scores here: <a href="https://en.wikipedia.org/wiki/Brier_score">https://en.wikipedia.org/wiki/Brier_score</a>. Lower values suggest better agreement between ML horizon label and class-wise probabilities.
</p>
</li>
<li> <p><code>mean.H</code>: mean Shannon entropy (bits), derived from probabilities within each most-likely horizon. Larger values suggest more confusion within each ML.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>D.E. Beaudette
</p>


<h3>References</h3>

<p>Beaudette, D. E., Roudier, P., &amp; Skovlin, J. (2016). Probabilistic representation of genetic soil horizons. Digital soil morphometrics, 281-293.
</p>


<h3>See Also</h3>

<p><code>slab()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# init SPC
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# set horizon designation metadata
hzdesgnname(sp1) &lt;- 'name'

# generalize horizon designations from character vector
# result is an ordered factor
sp1$genhz &lt;- generalizeHz(
  sp1$name,
  new = c('O','A','B','C'),
  pat = c('O', '^A','^B','C'),
  ordered = TRUE
)

# compute slice-wise GHL probability
# so that it sums to contributing fraction
# from 0-150cm
a &lt;- slab(sp1, fm = ~ genhz, cpm = 1, slab.structure = 0:150)

# note original GHL names are set by slab()
attr(a, 'original.levels')

# generate table of ML horizonation
get.ml.hz(a)

</code></pre>


</div>