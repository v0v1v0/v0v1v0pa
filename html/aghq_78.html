<div class="container">

<table style="width: 100%;"><tr>
<td>summary.marginallaplace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Summary statistics for models using marginal Laplace approximations</h2>

<h3>Description</h3>

<p>The <code>summary.marginallaplace</code> calls <code>summary.aghq</code>, but also computes
summary statistics of the random effects, by drawing from their approximate
posterior using <code>aghq::sample_marginal</code> with the specified number
of samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'marginallaplace'
summary(object, M = 1000, max_print = 30, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>Object inheriting from <strong>both</strong> classes <code>aghq</code> and <code>marginallaplace</code>,
for example as returned by <code>aghq::marginal_laplace</code> or <code>aghq::marginal_laplace_tmb</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>Number of samples to use to compute summary statistics of the random effects.
Default <code>1000</code>. Lower runs faster, higher is more accurate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_print</code></td>
<td>
<p>Sometimes there are a lot of random effects. If there are more random
effects than <code>max_print</code>, the random effects aren't summarized, and a note is printed
to this effect. Default <code>30</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing an object of class <code>aghqsummary</code> (see <code>summary.aghq</code>).
</p>


<h3>See Also</h3>

<p>Other quadrature: 
<code>aghq()</code>,
<code>get_hessian()</code>,
<code>get_log_normconst()</code>,
<code>get_mode()</code>,
<code>get_nodesandweights()</code>,
<code>get_numquadpoints()</code>,
<code>get_opt_results()</code>,
<code>get_param_dim()</code>,
<code>laplace_approximation()</code>,
<code>marginal_laplace_tmb()</code>,
<code>marginal_laplace()</code>,
<code>nested_quadrature()</code>,
<code>normalize_logpost()</code>,
<code>optimize_theta()</code>,
<code>plot.aghq()</code>,
<code>print.aghqsummary()</code>,
<code>print.aghq()</code>,
<code>print.laplacesummary()</code>,
<code>print.laplace()</code>,
<code>print.marginallaplacesummary()</code>,
<code>summary.aghq()</code>,
<code>summary.laplace()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">logfteta2d &lt;- function(eta,y) {
  # eta is now (eta1,eta2)
  # y is now (y1,y2)
  n &lt;- length(y)
  n1 &lt;- ceiling(n/2)
  n2 &lt;- floor(n/2)
  y1 &lt;- y[1:n1]
  y2 &lt;- y[(n1+1):(n1+n2)]
  eta1 &lt;- eta[1]
  eta2 &lt;- eta[2]
  sum(y1) * eta1 - (length(y1) + 1) * exp(eta1) - sum(lgamma(y1+1)) + eta1 +
    sum(y2) * eta2 - (length(y2) + 1) * exp(eta2) - sum(lgamma(y2+1)) + eta2
}
set.seed(84343124)
n1 &lt;- 5
n2 &lt;- 5
n &lt;- n1+n2
y1 &lt;- rpois(n1,5)
y2 &lt;- rpois(n2,5)
objfunc2d &lt;- function(x) logfteta2d(x,c(y1,y2))
objfunc2dmarg &lt;- function(W,theta) objfunc2d(c(W,theta))
objfunc2dmarggr &lt;- function(W,theta) {
  fn &lt;- function(W) objfunc2dmarg(W,theta)
  numDeriv::grad(fn,W)
}
objfunc2dmarghe &lt;- function(W,theta) {
  fn &lt;- function(W) objfunc2dmarg(W,theta)
  numDeriv::hessian(fn,W)
}

funlist2dmarg &lt;- list(
  fn = objfunc2dmarg,
  gr = objfunc2dmarggr,
  he = objfunc2dmarghe
)

themarginallaplace &lt;- aghq::marginal_laplace(funlist2dmarg,3,list(W = 0,theta = 0))
summary(themarginallaplace)
</code></pre>


</div>