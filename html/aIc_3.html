<div class="container">

<table style="width: 100%;"><tr>
<td>aIc.perturb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
<code>aIc.perturb</code> calculates the perturbation invariance of distance for
samples with a given correction. This compares the distances of samples
of the full dataset and a the perturbed dataset.
This is expected to be true if the transform is behaving rationally in
compositional datasets.</h2>

<h3>Description</h3>

<p><code>aIc.perturb</code> calculates the perturbation invariance of distance for
samples with a given correction. This compares the distances of samples
of the full dataset and a the perturbed dataset.
This is expected to be true if the transform is behaving rationally in
compositional datasets.
</p>


<h3>Usage</h3>

<pre><code class="language-R">aIc.perturb(
  data,
  norm.method = "prop",
  zero.remove = 0.95,
  zero.method = "prior",
  distance = "euclidian",
  log = FALSE,
  group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>can be any dataframe or matrix with samples by column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.method</code></td>
<td>
<p>can be prop, clr, RLE, TMM, TMMwsp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.remove</code></td>
<td>
<p>is a value. Filter data to remove features that are 0 
across at least that proportion of samples: default 0.95</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.method</code></td>
<td>
<p>can be any of NULL, prior, GBM or CZM. NULL will not 
impute or change 0 values, GBM (preferred) and CZM are from the 
zCompositions R package, and prior will simply add 0.5 to all counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>can be euclidian, bray, or jaccard. euclidian on log-ratio
transformed data is the same as the Aitchison distance. default=euclidian</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>is a logical. log transform the RLE or TMM outputs, default=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>is a vector containing group information. Required for clr, RLE, 
TMM, lvha, and iqlr based normalizations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the maximum proportional perturbation in <code>ol</code> 
(expect 0, but values up to 1
<code>is.perturb</code>, the table of distances for the whole and perturbaton
in <code>dist.all</code> and <code>dist.perturb</code>, the histogram of the
perturbations in <code>plot</code>, and the plot and axis
labels in <code>main</code> <code>xlab</code> and <code>ylab</code>. .
</p>


<h3>Author(s)</h3>

<p>Greg Gloor
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(selex)
group = c(rep('N', 7), rep('S', 7))
x &lt;- aIc.perturb(selex, group=group, norm.method='clr', distance='euclidian', zero.method='prior')
plot(x$plot, main=x$main, ylab=x$ylab, xlab=x$xlab)
</code></pre>


</div>