<div class="container">

<table style="width: 100%;"><tr>
<td>autoimage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Automatic facetting of multiple projected images</h2>

<h3>Description</h3>

<p><code>autoimage</code> plots a sequence of images (with possibly 
projected coordinates) while also automatically plotting a 
color scale matching the image colors to the values of <code>z</code>.  
Many options are available for legend customization.  The coordinates
can be irregularly spaced, on a regular grid, or on an irregular 
grid.  <code>z</code> can be a numeric vector, matrix, or array, depending
on the context.
</p>


<h3>Usage</h3>

<pre><code class="language-R">autoimage(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  common.legend = TRUE,
  map = "none",
  size,
  lratio,
  outer.title,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric or logical vector or matrix containing the 
values to be plotted (NAs are allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>A character string indicating where the color scale 
should be placed.  The default is <code>"horizontal"</code>.  The other
valid options are <code>"none"</code> and <code>"vertical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code>mapproject</code> function, which is used for the
projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A numeric vector specifying the values of the 
<code>parameters</code> argument in the 
<code>mapproject</code>.  This may be necessary when
<code>proj != "none"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orientation</code></td>
<td>
<p>A vector <code>c(latitude,longitude,rotation)</code> 
which describes where the "North Pole" should be when computing 
the projection.  See <code>mapproject</code> for more
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>common.legend</code></td>
<td>
<p>A logical value indicating whether a common 
legend scale should be used for all images provided in the
<code>z</code> array.  Default is <code>TRUE</code>.  If <code>FALSE</code>, a
separate legend is used for each image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>The name of the map to draw on the image. Default is 
<code>"none"</code>.  Other options include <code>"world"</code>, 
<code>"usa"</code>, <code>"state"</code>, <code>"county"</code>, <code>"france"</code>, 
<code>"nz"</code> (New Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>A vector of length two indicating the number of rows 
and columns that should be used for the series of image data in 
<code>z</code>.  Note that <code>prod(size)</code> must match the length of 
the third dimension of <code>z</code> (if it is an array), or 
<code>c(1, 1)</code> if <code>z</code> is a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the smaller 
dimension of the legend scale to the width of the image.  Default
is 0.1 + 0.1 <code>* k</code>, where <code>k</code> is the number of image rows 
if <code>legend == "horizontal"</code> or the number of image 
columns if <code>legend == "vertical"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outer.title</code></td>
<td>
<p>A title related to all of the images that is plotted in the outer margin of the figure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to the <code>image</code> or 
<code>poly.image</code> functions.  e.g., <code>xlab</code>, <code>ylab</code>, 
<code>xlim</code>, <code>ylim</code>, <code>zlim</code>, etc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>mapproject</code> function is used to project 
the <code>x</code> and <code>y</code> coordinates when <code>proj != "none"</code>.
</p>
<p>If multiple images are to be plotted (i.e., if <code>z</code> is an array), 
then the <code>main</code> argument can be a vector with length matching 
<code>dim(z)[3]</code>, and each successive element of the vector will 
be used to add a title to each successive image plotted.  
See the Examples.
</p>
<p>Additionally, if <code>common.legend = FALSE</code>, then separate limits 
for the z-axis of each image can be provided as a list.  
Specifically, if <code>dim(z)[3] == k</code>, then <code>zlim</code> should 
be a list of length <code>k</code>, and each element of the list should 
be a 2-dimensional vector providing the lower and upper limit, 
respectively, of the legend for each image.  Alternatively, if 
<code>zlim</code> is a list of length <code>k</code>, then <code>common.legend</code>
is set to <code>FALSE</code>. 
</p>
<p>The range of <code>zlim</code> is cut into <code class="reqn">n</code> partitions, 
where <code>n</code> is the length of <code>col</code>.
</p>
<p>It is generally desirable to increase <code>lratio</code> when
more images are plotted simultaneously.
</p>
<p>The multiple plots are constructed using the 
<code>autolayout</code> function, which 
is incompatible with the <code>mfrow</code> and <code>mfcol</code> arguments 
in the <code>par</code> function and is also 
incompatible with the <code>split.screen</code> function.
</p>
<p>The <code>mtext.args</code> argument can be passed through <code>...</code> 
in order to customize the outer title.  This should be a named
list with components matching the arguments of 
<code>mtext</code>.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code>lines</code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code>points</code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code>text</code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code>axis</code>
function.  See Examples.
</p>
<p>The image axes can be modified by passing <code>axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code>axis</code>
function.  The exception to this is that arguments <code>xat</code> 
and <code>yat</code> can be specified (instead of <code>at</code>) to specify
the location of the x and y ticks.  If <code>xat</code> or <code>yat</code>
are specified, then this overrides the <code>xaxt</code> and <code>yaxt</code>
arguments, respectively.  See the <code>paxes</code>
function to see how <code>axis.args can be used.</code>
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code>
to <code>pimage</code> through <code>...</code>.  This should be a numeric
vector indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples for <code>pimage</code>.  After plotting, 
<code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code>pimage</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(narccap)
# restructure data for 2 images
tasmax2 &lt;- tasmax[,,1:2]

# plot irregularly gridded images with separate legends
# and usa border
autoimage(lon, lat, tasmax2, common.legend = FALSE, map = "usa")

# plot irregularly gridded images with common legend and world lines
# customize world lines
# add and customize title
autoimage(lon, lat, tasmax2, map = "world", 
          lines.args = list(col = "white", lwd = 2),
          outer.title = "Maximum Daily Surface Air Temperature (K)",
          mtext.args = list(col = "blue", cex = 2))

# plot irregularly-spaced responsed as images with separate legends
# and county borders.  Add observed data locations with custom point
# options.  Add text at locations of Denver and Colorado Springs.
data(co, package = "gear")
autoimage(co$lon, co$lat, co[,c("Al", "Ca")], common.legend = FALSE, 
          map = "county", main = c("Aluminum", "Cadmium"),
          points = list(x = co$lon, y = co$lat),
          points.args = list(pch = 20, col = "white"),
          text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                      labels = c("Denver", "Colorado Springs")),
          text.args = list(col = "red"))

# customize margins and lratio for large plot
# also use projection
# specify manual lines (though in this case it is the same as using 
# map = "world")
data(worldMapEnv, package = "maps")
worldpoly &lt;- maps::map("world", plot = FALSE)
par(mar = c(1.1, 4.1, 2.1, 1.1))
autoimage(lon, lat, tasmax, lines = worldpoly, 
          proj = "bonne", parameters = 40,
          main = c("day 1", "day 2", "day 3", "day 4", "day 5"),
          ylab = "",
          axes = FALSE,
          lratio = 0.5)
</code></pre>


</div>