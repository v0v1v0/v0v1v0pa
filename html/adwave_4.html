<div class="container">

<table style="width: 100%;"><tr>
<td>wavesum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wavelet Summaries of Localized Admixture Signals</h2>

<h3>Description</h3>

<p>Produces wavelet summaries for each individual and group. Returns the wavelet variance and average block size metric (ABS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">wavesum(x, populations, popA = NA, popB = NA, ml = NULL, type = "la8",
    t.factor = 1, fullWT = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>object of class <code>adsig</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>populations</code></td>
<td>

<p>list containing a vector of individual IDs for each population in the analysis. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popA</code></td>
<td>

<p>name of ancestral population 1 (used for forming the axes of variation). Must match one of the names in <code>populations</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>popB</code></td>
<td>

<p>name of ancestral population 2 (used for forming the axes of variation). Must match one of the names in <code>populations</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml</code></td>
<td>

<p>number of wavelet scales in the decomposition. Must not exceed <code class="reqn">log_2(T)</code>, where <em>T</em> is the length of the signal.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>name of the wavelet to use in the decomposition. The default, “la8”, is Daubechies Least Asymmetric wavelet of length 8. Other options include “haar”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.factor</code></td>
<td>

<p>multiplicative factor for thresholding. See paper for details. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fullWT</code></td>
<td>

<p>if <code>TRUE</code>, save the full wavelet periodogram, as well as the wavelet variance. Object size will be large. Default is <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Produces wavelet summaries for objects of class <code>adsig</code>. The function computes the wavelet variance for each individual and population, extracts the informative wavelet variance based on levels observed in the ancestral populations, and computes summary measures of average block size metric (ABS) and peak wavelet scale for each individual and population. <br><br>
See <code>waveslim</code> documentation for details of the <code>modwt</code> function and alternative wavelet options.
</p>


<h3>Value</h3>

<p>The code returns a list with the following components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>n.ind</code></td>
<td>
<p>number of individuals in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.group</code></td>
<td>
<p>number of groups in the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rv.ind</code></td>
<td>
<p>matrix of dimension <code class="reqn">n x ml</code>, returning the raw wavelet variance for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rv.group</code></td>
<td>
<p>matrix of dimension <code class="reqn">n.group x ml</code>, returning the raw wavelet variance for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold </code></td>
<td>
<p>vector of length <code class="reqn">ml</code>, returning threshold values for each wavelet scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iv.ind</code></td>
<td>
<p>matrix of dimension <code class="reqn">n x ml</code>, returning the informative (thresholded) wavelet variance for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iv.group</code></td>
<td>
<p>matrix of dimension <code class="reqn">n.group x ml</code>, returning the informative (thresholded) wavelet variance for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.ind</code></td>
<td>
<p>vector of length <code class="reqn">n</code>, returning the average block size metric (ABS) for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs.group</code></td>
<td>
<p>vector of length <code>n.group</code>, returning the average block size metric (ABS) for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pws.ind</code></td>
<td>
<p>vector of length <code class="reqn">n</code>, returning the peak wavelet scale for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pws.group</code></td>
<td>
<p>vector of length <code>n.group</code>, returning the peak wavelet scale for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtmatrix</code></td>
<td>
 <p><em>(only if <code>fullWT = TRUE</code>)</em>. Array of dimension <code class="reqn">T x n x ml</code>, containing squared wavelet coefficients for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtmatrix.group</code></td>
<td>
<p><em>(only if <code>fullWT = TRUE</code>)</em>. Array of dimension <code class="reqn">T x n.group x ml</code>, squared wavelet coefficients, averaged for each group.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jean Sanderson
</p>


<h3>References</h3>

<p>Sanderson J, H Sudoyo, TM Karafet, MF Hammer and MP Cox. 2015. Reconstructing past admixture processes from local genomic ancestry using wavelet transformation. <em>Genetics</em> 200:469-481. <a href="https://doi.org/10.1534/genetics.115.176842">https://doi.org/10.1534/genetics.115.176842</a>
</p>


<h3>See Also</h3>

<p><code>signal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(admix)

# Generate the admixture signal 
AdexPCA &lt;- signal(admix$data,popA="popA",popB="popB",populations=admix$populations,
  tol=0.001, n.signal=NULL)

# Compute wavelet summaries
WSN &lt;- wavesum(AdexPCA,populations=admix$populations,popA="popA",popB="popB")

# Plot raw wavelet variance for each population
barplot(WSN$rv.group[3,],ylim=c(0,0.9),col="red", names.arg=1:11,border=NA)
barplot(WSN$rv.group[1,],ylim=c(0,0.9),col="green3",names.arg=1:11,border=NA,add=TRUE)
barplot(WSN$rv.group[2,],ylim=c(0,0.9),col="blue", names.arg=1:11,border=NA,add=TRUE)
legend("topright",c("popA","popB","popAB"),col=c(3,4,2),pch=15)
box()

# Plot informative wavelet variance for admixed population
barplot(WSN$iv.group[3,],ylim=c(0,0.15),col="red",names.arg=1:11,border=NA)
ABS &lt;- round(WSN$abs.group[3],2) 
text(11,0.13,paste("ABS=",ABS))
box()
</code></pre>


</div>