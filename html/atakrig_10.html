<div class="container">

<table style="width: 100%;"><tr>
<td>ataKriging</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Area-to-area, area-to-point ordinary Kriging prediciton, cross-validation.
</h2>

<h3>Description</h3>

<p>Area-to-area, area-to-point ordinary Kriging prediciton, cross-validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ataKriging(x, unknown, ptVgm, nmax = 10, longlat = FALSE,
    showProgress = FALSE, nopar = FALSE, clarkAntiLog = FALSE)
atpKriging(x, unknown0, ptVgm, nmax = 10, longlat=FALSE,
    showProgress = FALSE, nopar = FALSE)
ataKriging.cv(x, nfold = 10, ptVgm, nmax=10, longlat = FALSE,
    showProgress = FALSE, nopar = FALSE, clarkAntiLog = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a discreteArea object: list(areaValues, discretePoints), where
areaValues: data.frame(areaId,centx,centy,value)
discretePoints: data.frame(areaId,ptx,pty,weight)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unknown</code></td>
<td>

<p>a discreted discreteArea object, or just data.frame(areaId,ptx,pty,weight).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unknown0</code></td>
<td>

<p>for points prediction, data.frame(ptx,pty), one point per row.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>

<p>number of fold for cross-validation. for leave-one-out cross-validation, nfold = nrow(x$areaValues).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ptVgm</code></td>
<td>

<p>point scale variogram, ataKrigVgm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>

<p>max number of neighborhoods used for interpolation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>longlat</code></td>
<td>

<p>coordinates are longitude/latitude or not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showProgress</code></td>
<td>

<p>show progress bar for batch interpolation (multi destination areas).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nopar</code></td>
<td>

<p>disable parallel process in the function even if ataStartCluster() has been called, mainly for  internal use.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clarkAntiLog</code></td>
<td>

<p>for log-transformed input data, whether the estimated value should be adjusted(i.e. exponentiation).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>estimated value of destination area and its variance.
</p>


<h3>References</h3>

<p>Clark, I., 1998. Geostatistical estimation and the lognormal distribution. Geocongress. Pretoria, RSA., [online] Available from: http://kriging.com/publications/Geocongress1998.pdf.
Goovaerts, P., 2008. Kriging and semivariogram deconvolution in the presence of irregular geographical units. Mathematical Geosciences 40 (1): 101-128.
Isaaks, E. H., Srivastava, R. M., 1989. An introduction to applied geostatistics. New York, Oxford University Press.
Skøien, J. O. and G. Blöschl, et al., 2014. rtop: an R package for interpolation of data with a variable spatial support, with an example from river networks. Computers &amp; Geosciences 67: 180-190.
</p>


<h3>See Also</h3>

<p>deconvPointVgm, ataCoKriging
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(atakrig)
library(sf)

## load demo data from rtop package ----
if (!require("rtop", quietly = TRUE)) message("rtop library is required for demo data.")
rpath &lt;- system.file("extdata", package="rtop")
observations &lt;- read_sf(rpath, "observations")
observations$obs &lt;- observations$QSUMMER_OB/observations$AREASQKM

## point-scale variogram ----
obs.discrete &lt;- discretizePolygon(observations, cellsize=1500, id="ID", value="obs")
pointsv &lt;- deconvPointVgm(obs.discrete, model="Exp", ngroup=12, rd=0.75, fig=TRUE)

## cross validation ----
pred.cv &lt;- ataKriging.cv(obs.discrete, nfold=length(observations), pointsv)
names(pred.cv)[6] &lt;- "obs"

summary(pred.cv[,c("obs","pred","var")])
cor(pred.cv$obs, pred.cv$pred)			# Pearson correlation
mean(abs(pred.cv$obs - pred.cv$pred))	# MAE
sqrt(mean((pred.cv$obs - pred.cv$pred)^2))	# RMSE

## prediction ----
predictionLocations &lt;- read_sf(rpath, "predictionLocations")
pred.discrete &lt;- discretizePolygon(predictionLocations, cellsize = 1500, id = "ID")
pred &lt;- ataKriging(obs.discrete, pred.discrete, pointsv$pointVariogram)

</code></pre>


</div>