<div class="container">

<table style="width: 100%;"><tr>
<td>calRaster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Rescale isoscape using linear regression
</h2>

<h3>Description</h3>

<p>This function uses known-origin tissue data to rescale a map of environmental isotope values to a map of tissue value (and associated uncertainty) using a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calRaster(known, isoscape, mask = NULL, interpMethod = 2, NA.value = NA, 
  ignore.NA = TRUE, genplot = TRUE, outDir =  NULL, verboseLM = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>known</code></td>
<td>

<p>subOrigData or SpatVector. Known-origin tissue isotope data from the subOrigData function or provided by user. User-provided data must be formatted as a subOrigData object (see <code>subOrigData</code>) or a SpatVector with point geometry in which the first data field contains the measured tissue isotope value and the second the 1 standard deviation uncertainty on that value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isoscape</code></td>
<td>

<p>SpatRaster. Isoscape raster with two layers. The first one is the mean and the second is one standard deviation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>

<p>SpatVector. Polygon layer that constrains the area of the output rasters. If this is not provided, the entire area of <code>isoscape</code> is returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpMethod</code></td>
<td>

<p>numeric. 1 or 2. Designate one of two methods for extracting values from <code>isoscape</code>. If 1, values for the cell in which a point falls are returned. If 2 the returned values are interpolated (bilinear interpolation) from the values of the four adjacent grid cells.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NA.value</code></td>
<td>

<p>NA or numeric. Value representing the absence of data in <code>isoscape</code>. Commonly used values include NA, -9999, and 9999.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.NA</code></td>
<td>

<p>logical. If NA values are extracted from <code>isoscape</code> at the location of samples in known, ignore these values and proceed with <code>calRaster</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genplot</code></td>
<td>

<p>logical. Plot the results.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outDir</code></td>
<td>

<p>character string. Directory path to which output will be saved. If NULL no files are written.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verboseLM</code></td>
<td>

<p>logical. Print out the linear regression results.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class “rescale”.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>isoscape.rescale</code></td>
<td>
<p>SpatRaster. <code>isoscape</code> rescaled using a linear regression model between values of <code>known</code> and <code>isoscape</code>. The first layer is the mean prediction and the second the standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm.data</code></td>
<td>
<p>data.frame. Known origin data and extracted <code>isoscape</code> values used for linear regression modeling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lm.model</code></td>
<td>
<p>list. Linear regression model.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>pdRaster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load hydrogen isotope data for human hair in North America
d = subOrigData(group = "Modern human", mask = naMap, niter = 100, genplot = FALSE)

# rescale from environmental isoscape to tissue isoscape
r = calRaster(d, d2h_lrNA, naMap)
</code></pre>


</div>